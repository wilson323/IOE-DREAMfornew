# ç”Ÿç‰©è¯†åˆ«æ¶æ„ä¸“å®¶æŠ€èƒ½
## Biometric Architecture Specialist

**ğŸ¯ æŠ€èƒ½å®šä½**: IOE-DREAMæ™ºæ…§å›­åŒºç”Ÿç‰©è¯†åˆ«æ¶æ„ä¸“å®¶ï¼Œç²¾é€šå¤šæ¨¡æ€ç”Ÿç‰©ç‰¹å¾ç®¡ç†ã€è®¾å¤‡ä¸‹å‘ã€æ¨¡æ¿ç®¡ç†ç­‰æ ¸å¿ƒæ¶æ„è®¾è®¡

**âš¡ æŠ€èƒ½ç­‰çº§**: â˜…â˜…â˜…â˜…â˜…â˜… (é¡¶çº§ä¸“å®¶)
**ğŸ¯ é€‚ç”¨åœºæ™¯**: ç”Ÿç‰©è¯†åˆ«æ¶æ„è®¾è®¡ã€å¤šæ¨¡æ€ç”Ÿç‰©ç‰¹å¾ç®¡ç†ã€è®¾å¤‡ä¸‹å‘åŒæ­¥ã€æ¨¡æ¿ç‰ˆæœ¬æ§åˆ¶
**ğŸ“Š æŠ€èƒ½è¦†ç›–**: ç”Ÿç‰©è¯†åˆ«æ¶æ„ | å¤šæ¨¡æ€èåˆ | è®¾å¤‡ä¸‹å‘ | æ¨¡æ¿ç®¡ç† | å®‰å…¨ç®¡æ§ | æ•°æ®æµè½¬
**ğŸ”§ æŠ€æœ¯æ ˆ**: Spring Boot 3.5.8 + OpenCV + TensorFlow + Redis + MinIO + è®¾å¤‡åè®®é€‚é…

---

## ğŸ“‹ æŠ€èƒ½æ¦‚è¿°

### **æ ¸å¿ƒä¸“é•¿**
- **ç”Ÿç‰©è¯†åˆ«æ¶æ„è®¾è®¡**: å¤šæ¨¡æ€ç”Ÿç‰©è¯†åˆ«ç³»ç»Ÿæ¶æ„ã€æ•°æ®æµè®¾è®¡ã€æ¨¡å—åŒ–åˆ†è§£
- **ç”Ÿç‰©ç‰¹å¾æ•°æ®ç®¡ç†**: äººè„¸ã€æŒ‡çº¹ã€è™¹è†œã€æŒçº¹ç­‰å¤šæ¨¡æ€ç”Ÿç‰©ç‰¹å¾ç»Ÿä¸€ç®¡ç†
- **è®¾å¤‡ä¸‹å‘åŒæ­¥**: å‘å„ç±»è®¾å¤‡ä¸‹å‘ç”Ÿç‰©ç‰¹å¾æ¨¡æ¿ï¼Œç¡®ä¿å®æ—¶åŒæ­¥å’Œä¸€è‡´æ€§
- **æ¨¡æ¿ç‰ˆæœ¬æ§åˆ¶**: ç”Ÿç‰©ç‰¹å¾æ¨¡æ¿ç‰ˆæœ¬ç®¡ç†ã€å¢é‡æ›´æ–°ã€å›æ»šæœºåˆ¶
- **å®‰å…¨æ¶æ„è®¾è®¡**: ç”Ÿç‰©ç‰¹å¾æ•°æ®åŠ å¯†ã€éšç§ä¿æŠ¤ã€å®‰å…¨ä¼ è¾“
- **æ€§èƒ½ä¼˜åŒ–**: å¤§è§„æ¨¡ç”Ÿç‰©ç‰¹å¾æ•°æ®ç®¡ç†ã€é«˜å¹¶å‘è¯†åˆ«æ€§èƒ½ä¼˜åŒ–

### **è§£å†³èƒ½åŠ›**
- **ç”Ÿç‰©è¯†åˆ«ç³»ç»Ÿæ¶æ„**: é«˜å¯ç”¨ã€é«˜æ€§èƒ½ã€å¯æ‰©å±•çš„ç”Ÿç‰©è¯†åˆ«æ¶æ„è®¾è®¡
- **å¤šæ¨¡æ€èåˆ**: ä¸åŒç”Ÿç‰©ç‰¹å¾æ•°æ®çš„ç»Ÿä¸€ç®¡ç†å’ŒèåˆéªŒè¯
- **è®¾å¤‡é›†æˆ**: å„ç§ç”Ÿç‰©è¯†åˆ«è®¾å¤‡çš„åè®®é€‚é…å’Œç»Ÿä¸€ç®¡ç†
- **æ•°æ®å®‰å…¨**: ç”Ÿç‰©ç‰¹å¾æ•°æ®çš„å…¨ç”Ÿå‘½å‘¨æœŸå®‰å…¨ç®¡ç†
- **æ€§èƒ½è°ƒä¼˜**: å¤§è§„æ¨¡ç”Ÿç‰©ç‰¹å¾æ•°æ®çš„å­˜å‚¨å’Œæ£€ç´¢æ€§èƒ½ä¼˜åŒ–

---

## æ ¸å¿ƒæ¶æ„ç†è§£

### ç”Ÿç‰©è¯†åˆ«ç³»ç»Ÿè¾¹ç•Œåˆ’åˆ†
**é‡è¦åŸåˆ™**: æœ¬é¡¹ç›®åªè´Ÿè´£ç”Ÿç‰©ç‰¹å¾æ•°æ®çš„é‡‡é›†ã€ç®¡ç†å’Œä¸‹å‘ï¼Œæ ¸å¿ƒçš„ç”Ÿç‰©è¯†åˆ«ç®—æ³•ç”±ä¸“ç”¨ç¡¬ä»¶è®¾å¤‡å®Œæˆã€‚

#### æœ¬é¡¹ç›®èŒè´£èŒƒå›´
1. **ç”Ÿç‰©ç‰¹å¾æ•°æ®é‡‡é›†**
   - äººè„¸å›¾åƒé‡‡é›†å’Œé¢„å¤„ç†
   - æŒ‡çº¹å›¾åƒé‡‡é›†å’Œè´¨é‡æ£€æŸ¥
   - ç”Ÿç‰©ç‰¹å¾æ¨¡æ¿æ ‡å‡†åŒ–å­˜å‚¨

2. **ç”Ÿç‰©ç‰¹å¾ç®¡ç†**
   - ç”¨æˆ·ç”Ÿç‰©ç‰¹å¾æ¡£æ¡ˆç®¡ç†
   - ç”Ÿç‰©ç‰¹å¾æ¨¡æ¿ç‰ˆæœ¬æ§åˆ¶
   - æƒé™æ§åˆ¶å’Œè®¿é—®ç®¡ç†

3. **è®¾å¤‡ä¸‹å‘ä¸åŒæ­¥**
   - å‘è€ƒå‹¤è®¾å¤‡ä¸‹å‘ç”¨æˆ·ç”Ÿç‰©ç‰¹å¾
   - å‘é—¨ç¦è®¾å¤‡ä¸‹å‘æƒé™ç”Ÿç‰©ç‰¹å¾
   - å‘æ¶ˆè´¹è®¾å¤‡ä¸‹å‘æ”¯ä»˜ç”Ÿç‰©ç‰¹å¾
   - å‘è®¿å®¢è®¾å¤‡ä¸‹å‘ä¸´æ—¶ç”Ÿç‰©ç‰¹å¾
   - å‘è§†é¢‘è®¾å¤‡ä¸‹å‘ç›‘æ§ç”Ÿç‰©ç‰¹å¾

#### ç¡¬ä»¶è®¾å¤‡èŒè´£èŒƒå›´
1. **ç”Ÿç‰©è¯†åˆ«ç®—æ³•æ‰§è¡Œ**
   - äººè„¸è¯†åˆ«ç®—æ³• (è®¾å¤‡ç«¯)
   - æŒ‡çº¹åŒ¹é…ç®—æ³• (è®¾å¤‡ç«¯)
   - æ´»ä½“æ£€æµ‹ç®—æ³• (è®¾å¤‡ç«¯)
   - å¤šæ¨¡æ€èåˆç®—æ³• (è®¾å¤‡ç«¯)

2. **å®æ—¶è¯†åˆ«å¤„ç†**
   - 1:Næˆ–1:1è¯†åˆ«æ¯”å¯¹
   - å®æ—¶å“åº”å’Œç»“æœè¿”å›
   - é˜²ä½œå¼Šå’Œå®‰å…¨æ€§æ£€æŸ¥

## æŠ€æœ¯æ¶æ„è®¾è®¡

### æ•°æ®æµè½¬æ¶æ„
```
ç”¨æˆ·å½•å…¥ â†’ ç³»ç»Ÿé‡‡é›† â†’ æ¨¡æ¿ç”Ÿæˆ â†’ è®¾å¤‡ä¸‹å‘ â†’ è®¾å¤‡è¯†åˆ« â†’ ç»“æœè¿”å›
    â†‘                                                      â†“
ç®¡ç†å¹³å° â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†â†
```

### æ¨¡å—åŒ–è®¾è®¡
- **biometric-data-service**: ç”Ÿç‰©ç‰¹å¾æ•°æ®ç®¡ç†
- **biometric-template-service**: æ¨¡æ¿ç®¡ç†å’Œç‰ˆæœ¬æ§åˆ¶
- **device-biometric-sync**: è®¾å¤‡ä¸‹å‘å’ŒåŒæ­¥
- **biometric-security**: ç”Ÿç‰©ç‰¹å¾å®‰å…¨åŠ å¯†

### è®¾å¤‡é›†æˆæ¥å£ (Jakarta EE 3.0+)
```java
import jakarta.annotation.Resource;
import jakarta.validation.Valid;
import jakarta.transaction.Transactional;
import jakarta.persistence.Entity;
import jakarta.persistence.Table;
import jakarta.persistence.Id;
import jakarta.persistence.Column;
import jakarta.persistence.Convert;

// ä¸‹å‘ç”Ÿç‰©ç‰¹å¾åˆ°è®¾å¤‡æ¥å£
public interface BiometricDeviceService {

    /**
     * åŒæ­¥ç”¨æˆ·ç”Ÿç‰©ç‰¹å¾åˆ°è®¾å¤‡
     */
    boolean syncUserBiometric(Long userId, BiometricType type, byte[] template);

    /**
     * ä»è®¾å¤‡ç§»é™¤ç”¨æˆ·ç”Ÿç‰©ç‰¹å¾
     */
    boolean removeUserBiometric(Long userId, BiometricType type);

    /**
     * æ£€æŸ¥è®¾å¤‡çŠ¶æ€
     */
    List<BiometricDeviceStatus> checkDeviceStatus();

    /**
     * æ‰¹é‡åŒæ­¥ç”Ÿç‰©ç‰¹å¾
     */
    BatchSyncResult batchSyncBiometric(List<BiometricSyncRequest> requests);
}

// æ¥æ”¶è®¾å¤‡è¯†åˆ«ç»“æœæ¥å£
public interface BiometricResultHandler {

    /**
     * å¤„ç†ç”Ÿç‰©è¯†åˆ«ç»“æœ
     */
    void handleRecognitionResult(@Valid BiometricRecognitionResult result);

    /**
     * å¤„ç†è¯†åˆ«å¼‚å¸¸
     */
    void handleRecognitionError(BiometricRecognitionError error);
}

// ç”Ÿç‰©ç‰¹å¾ç®¡ç†æœåŠ¡å®ç°
@Service
@Transactional(rollbackFor = Exception.class)
public class BiometricManagementServiceImpl implements BiometricManagementService {

    @Resource
    private BiometricDeviceService biometricDeviceService;

    @Resource
    private BiometricTemplateManager biometricTemplateManager;

    @Resource
    private GatewayServiceClient gatewayServiceClient;

    @Override
    public SyncResult syncUserToAllDevices(Long userId, BiometricType type) {
        try {
            // 1. è·å–ç”¨æˆ·ç”Ÿç‰©ç‰¹å¾æ¨¡æ¿
            BiometricTemplate template = biometricTemplateManager.getTemplate(userId, type);
            if (template == null) {
                throw new BusinessException("TEMPLATE_NOT_FOUND", "ç”Ÿç‰©ç‰¹å¾æ¨¡æ¿ä¸å­˜åœ¨");
            }

            // 2. è·å–éœ€è¦åŒæ­¥çš„è®¾å¤‡åˆ—è¡¨
            List<DeviceEntity> devices = getDevicesForBiometricType(type);

            // 3. æ‰¹é‡åŒæ­¥åˆ°æ‰€æœ‰è®¾å¤‡
            return batchSyncToDevices(userId, type, template.getTemplateData(), devices);
        } catch (Exception e) {
            log.error("[ç”Ÿç‰©ç‰¹å¾åŒæ­¥] åŒæ­¥å¤±è´¥, userId={}, type={}", userId, type, e);
            throw new BusinessException("BIOMETRIC_SYNC_ERROR", "ç”Ÿç‰©ç‰¹å¾åŒæ­¥å¤±è´¥");
        }
    }

    private List<DeviceEntity> getDevicesForBiometricType(BiometricType type) {
        // é€šè¿‡ç½‘å…³è°ƒç”¨è®¾å¤‡é€šè®¯æœåŠ¡è·å–æ”¯æŒæŒ‡å®šç”Ÿç‰©ç‰¹å¾ç±»å‹çš„è®¾å¤‡
        ResponseDTO<List<DeviceEntity>> result = gatewayServiceClient.callDeviceCommService(
                "/api/v1/device/biometric/supported-devices",
                HttpMethod.POST,
                Map.of("biometricType", type.getCode()),
                new ParameterizedTypeReference<ResponseDTO<List<DeviceEntity>>>() {}
        );

        if (result.getCode() == 200) {
            return result.getData();
        }

        throw new BusinessException("DEVICE_QUERY_FAILED", "è®¾å¤‡ä¿¡æ¯æŸ¥è¯¢å¤±è´¥");
    }
}

// å®ä½“ç±» - ç”Ÿç‰©ç‰¹å¾æ¨¡æ¿
@Data
@EqualsAndHashCode(callSuper = true)
@TableName("t_biometric_template")
public class BiometricTemplateEntity extends BaseEntity {

    @TableId(type = IdType.AUTO)
    private Long templateId;

    @TableField("user_id")
    private Long userId;

    @TableField("biometric_type")
    private Integer biometricType;  // 1-äººè„¸ 2-æŒ‡çº¹ 3-è™¹è†œ 4-æŒçº¹

    @TableField("template_data")
    @Lob
    @Convert(converter = EncryptedByteArrayConverter.class)
    private byte[] templateData;  // ç”Ÿç‰©ç‰¹å¾æ¨¡æ¿æ•°æ®(åŠ å¯†)

    @TableField("template_version")
    private Integer templateVersion;  // æ¨¡æ¿ç‰ˆæœ¬

    @TableField("quality_score")
    private BigDecimal qualityScore;  // è´¨é‡è¯„åˆ†

    @TableField("capture_device_id")
    private String captureDeviceId;  // é‡‡é›†è®¾å¤‡ID

    @TableField("algorithm_version")
    private String algorithmVersion;  // ç®—æ³•ç‰ˆæœ¬

    @TableField("status")
    private Integer status;  // 1-æ­£å¸¸ 2-è¿‡æœŸ 3-ç¦ç”¨

    @TableField("valid_until")
    private LocalDateTime validUntil;  // æœ‰æ•ˆæœŸ

    @TableField("last_sync_time")
    private LocalDateTime lastSyncTime;  // æœ€ååŒæ­¥æ—¶é—´

    @TableField(fill = FieldFill.INSERT)
    private LocalDateTime createTime;

    @TableField(fill = FieldFill.INSERT_UPDATE)
    private LocalDateTime updateTime;

    @TableLogic
    @TableField("deleted_flag")
    private Integer deletedFlag;

    @Version
    private Integer version;
}

// ç”Ÿç‰©è¯†åˆ«ç»“æœæ•°æ®ä¼ è¾“å¯¹è±¡
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class BiometricRecognitionResultDTO {

    @NotNull
    private String deviceId;  // è®¾å¤‡ID

    @NotNull
    private String recognitionId;  // è¯†åˆ«ID

    @NotNull
    private Long userId;  // è¯†åˆ«çš„ç”¨æˆ·ID

    @NotNull
    private BiometricType biometricType;  // ç”Ÿç‰©ç‰¹å¾ç±»å‹

    @NotNull
    private Double confidence;  // ç½®ä¿¡åº¦

    private LocalDateTime recognitionTime;  // è¯†åˆ«æ—¶é—´

    private String recognitionImage;  // è¯†åˆ«å›¾åƒURL

    private Map<String, Object> metadata;  // é™„åŠ å…ƒæ•°æ®
}
```

## è®¾å¤‡ç±»å‹æ”¯æŒ

### è€ƒå‹¤è®¾å¤‡
- äººè„¸è¯†åˆ«è€ƒå‹¤æœº
- æŒ‡çº¹æ‰“å¡æœº
- å¤šæ¨¡æ€ç”Ÿç‰©è¯†åˆ«è€ƒå‹¤è®¾å¤‡

### é—¨ç¦è®¾å¤‡
- äººè„¸è¯†åˆ«é—¨ç¦
- æŒ‡çº¹é—¨ç¦ç³»ç»Ÿ
- å¤šé‡ç”Ÿç‰©è¯†åˆ«é—¨ç¦

### æ¶ˆè´¹è®¾å¤‡
- äººè„¸æ”¯ä»˜ç»ˆç«¯
- æŒ‡çº¹æ”¯ä»˜è®¾å¤‡
- ç”Ÿç‰©è¯†åˆ«POSæœº

### è®¿å®¢è®¾å¤‡
- ä¸´æ—¶äººè„¸è¯†åˆ«è®¾å¤‡
- ç§»åŠ¨å¼ç”Ÿç‰©è¯†åˆ«ç»ˆç«¯

### è§†é¢‘è®¾å¤‡
- ç”Ÿç‰©ç‰¹å¾ç›‘æ§æ‘„åƒå¤´
- äººè„¸è¯†åˆ«è§†é¢‘åˆ†æè®¾å¤‡

## å®‰å…¨ä¸éšç§

### æ•°æ®å®‰å…¨
- ç”Ÿç‰©ç‰¹å¾æ¨¡æ¿åŠ å¯†å­˜å‚¨
- ä¼ è¾“è¿‡ç¨‹SSL/TLSåŠ å¯†
- æƒé™åˆ†çº§è®¿é—®æ§åˆ¶

### éšç§ä¿æŠ¤
- ç¬¦åˆGDPRç­‰éšç§æ³•è§„
- ç”¨æˆ·æˆæƒæœºåˆ¶
- æ•°æ®æœ€å°åŒ–åŸåˆ™

### åˆè§„è¦æ±‚
- å…¬å®‰éƒ¨ç›¸å…³æ ‡å‡†
- è¡Œä¸šå®‰å…¨è®¤è¯
- ç­‰ä¿2.0è¦æ±‚

## æŠ€æœ¯å®ç°è¦ç‚¹

### æ¨¡æ¿æ ¼å¼æ ‡å‡†åŒ–
- æ”¯æŒISO/IEC 19794æ ‡å‡†
- å¤šç§è®¾å¤‡å‚å•†æ ¼å¼å…¼å®¹
- æ¨¡æ¿å‹ç¼©å’Œä¼˜åŒ–

### è®¾å¤‡ç®¡ç†
- è®¾å¤‡çŠ¶æ€ç›‘æ§
- æ‰¹é‡ä¸‹å‘å’ŒåŒæ­¥
- å¤±è´¥é‡è¯•æœºåˆ¶

### æ€§èƒ½ä¼˜åŒ–
- å¢é‡åŒæ­¥ç­–ç•¥
- ç¼“å­˜æœºåˆ¶è®¾è®¡
- å¹¶å‘å¤„ç†ä¼˜åŒ–

## å¸¸è§é—®é¢˜è§£å†³

### è¯†åˆ«å‡†ç¡®ç‡é—®é¢˜
- æ¨¡æ¿è´¨é‡æ£€æŸ¥
- è®¾å¤‡æ ¡å‡†ç»´æŠ¤
- å¤šæ¨¡æ€èåˆç­–ç•¥

### è®¾å¤‡å…¼å®¹æ€§é—®é¢˜
- æ ‡å‡†åŒ–æ¥å£è®¾è®¡
- å‚å•†SDKé€‚é…
- åè®®è½¬æ¢å±‚

### æ€§èƒ½ç“¶é¢ˆ
- å¼‚æ­¥å¤„ç†æœºåˆ¶
- é˜Ÿåˆ—ç¼“å†²è®¾è®¡
- åˆ†å¸ƒå¼éƒ¨ç½²

## å¼€å‘è§„èŒƒ

### å‘½åè§„èŒƒ
```java
// ç”Ÿç‰©ç‰¹å¾ç›¸å…³ç±»å‘½å
BiometricTemplate, BiometricDevice, BiometricSyncStatus
UserBiometricProfile, BiometricAuthRecord

// æ¥å£å‘½å
BiometricDataService, BiometricDeviceManager
BiometricSecurityManager, BiometricTemplateProcessor
```

### å¼‚å¸¸å¤„ç†
```java
// è‡ªå®šä¹‰å¼‚å¸¸
BiometricTemplateException, BiometricDeviceException
BiometricSyncException, BiometricSecurityException
```

### æ—¥å¿—è§„èŒƒ
- å…³é”®æ“ä½œå®¡è®¡æ—¥å¿—
- é”™è¯¯è¯¦ç»†è®°å½•
- æ€§èƒ½æŒ‡æ ‡ç›‘æ§