# æ‰©å±•è¡¨æœºåˆ¶æ¶æ„ä¸“å®¶

**ç‰ˆæœ¬**: v1.0.0
**åˆ›å»ºæ—¶é—´**: 2025-11-25
**æœ€åæ›´æ–°**: 2025-11-25
**ä½œè€…**: SmartAdminæ¶æ„æ²»ç†å§”å‘˜ä¼š
**æŠ€èƒ½ç­‰çº§**: â˜…â˜…â˜… ä¸“å®¶çº§
**é€‚ç”¨è§’è‰²**: æ¶æ„å¸ˆã€é«˜çº§å¼€å‘å·¥ç¨‹å¸ˆã€æŠ€æœ¯è´Ÿè´£äºº
**é¢„è®¡å­¦æ—¶**: 8å°æ—¶

---

## ğŸ“‹ æŠ€èƒ½æ¦‚è¿°

æœ¬æŠ€èƒ½ä¸“é—¨è´Ÿè´£ç¡®ä¿IOE-DREAMé¡¹ç›®ä¸­æ‰€æœ‰ä¸šåŠ¡æ¨¡å—ä¸¥æ ¼éµå¾ª**åŸºç¡€å®ä½“+æ‰©å±•è¡¨**çš„æ¶æ„è®¾è®¡æ¨¡å¼ï¼Œå»ºç«‹ç»Ÿä¸€çš„æ‰©å±•è¡¨æœºåˆ¶æ¶æ„è§„èŒƒï¼Œé¿å…é‡å¤è®¾è®¡å’Œæ¶æ„ä¸ä¸€è‡´é—®é¢˜ã€‚

### ğŸ¯ æ ¸å¿ƒä»·å€¼
- **æ¶æ„ä¸€è‡´æ€§**: ç¡®ä¿æ‰€æœ‰æ¨¡å—éµå¾ªç»Ÿä¸€çš„æ‰©å±•è¡¨è®¾è®¡æ¨¡å¼
- **é¿å…é‡å¤å¼€å‘**: é€šè¿‡æ‰©å±•è¡¨æœºåˆ¶å¤ç”¨åŸºç¡€å®ä½“è®¾è®¡
- **ç»´æŠ¤æ€§æå‡**: ä¸šåŠ¡ç‰¹æœ‰åŠŸèƒ½ç‹¬ç«‹æ‰©å±•ï¼Œä¸å½±å“åŸºç¡€æ¶æ„
- **æ‰©å±•æ€§ä¿è¯**: æ–°ä¸šåŠ¡æ¨¡å—å¯ä»¥å¿«é€ŸåŸºäºæ‰©å±•è¡¨æœºåˆ¶å¼€å‘

### ğŸ”§ æŠ€èƒ½èŒƒå›´
- æ‰©å±•è¡¨æ¶æ„è®¾è®¡ä¸å®æ–½
- åŸºç¡€å®ä½“ä¸æ‰©å±•è¡¨å…³ç³»å»ºæ¨¡
- æ‰©å±•è¡¨æœºåˆ¶ä»£ç å®ç°
- æ¶æ„ä¸€è‡´æ€§æ£€æŸ¥ä¸ä¿®æ­£

---

## ğŸ“š çŸ¥è¯†è¦æ±‚

### ğŸ“ å¿…å¤‡ç†è®ºçŸ¥è¯†

#### 1. **æ•°æ®åº“è®¾è®¡ç†è®º**
- **å®ä½“å…³ç³»å»ºæ¨¡**: æŒæ¡ERå›¾è®¾è®¡å’Œå®ä½“å…³ç³»æ˜ å°„
- **æ•°æ®åº“èŒƒå¼**: ç†è§£ç¬¬ä¸€èŒƒå¼ã€ç¬¬äºŒèŒƒå¼ã€ç¬¬ä¸‰èŒƒå¼åœ¨æ‰©å±•è¡¨ä¸­çš„åº”ç”¨
- **ç´¢å¼•ä¼˜åŒ–**: æ‰©å±•è¡¨æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–ç­–ç•¥
- **äº‹åŠ¡ç®¡ç†**: è·¨è¡¨æ“ä½œçš„äº‹åŠ¡ä¸€è‡´æ€§è®¾è®¡

#### 2. **è½¯ä»¶æ¶æ„æ¨¡å¼**
- **æ‰©å±•è¡¨æ¨¡å¼**: åŸºç¡€å®ä½“+æ‰©å±•è¡¨çš„ç»„åˆè®¾è®¡æ¨¡å¼
- **é¢†åŸŸé©±åŠ¨è®¾è®¡(DDD)**: å®ä½“å»ºæ¨¡å’Œä¸šåŠ¡è¾¹ç•Œåˆ’åˆ†
- **å¾®æœåŠ¡æ¶æ„**: æœåŠ¡è¾¹ç•Œåˆ’åˆ†å’Œæ•°æ®ä¸€è‡´æ€§
- **ç»§æ‰¿vsç»„åˆ**: æ­£ç¡®é€‰æ‹©ç»§æ‰¿å’Œç»„åˆè®¾è®¡åŸåˆ™

#### 3. **ä¸šåŠ¡ç†è§£**
- **æ™ºæ…§å›­åŒºä¸šåŠ¡**: é—¨ç¦ã€è€ƒå‹¤ã€æ¶ˆè´¹ã€è§†é¢‘ç›‘æ§ç­‰ä¸šåŠ¡åŸŸç†è§£
- **ä¸€å¡é€šç³»ç»Ÿ**: ç»Ÿä¸€èº«ä»½è®¤è¯å’Œæƒé™ç®¡ç†çš„ä¸šåŠ¡é€»è¾‘
- **å¤šç§Ÿæˆ·æ¶æ„**: æ”¯æŒå¤šå›­åŒºã€å¤šä¸šåŠ¡åœºæ™¯çš„æ¶æ„è®¾è®¡

### ğŸ› ï¸ æŠ€æœ¯èƒŒæ™¯è¦æ±‚

#### **åç«¯æŠ€æœ¯æ ˆ**
- **Java 17+**: ç°ä»£Javaç‰¹æ€§åº”ç”¨
- **Spring Boot 3.x**: ä¼ä¸šçº§åº”ç”¨å¼€å‘æ¡†æ¶
- **MyBatis-Plus**: ORMæ¡†æ¶å’Œå¤æ‚æŸ¥è¯¢å¤„ç†
- **MySQL 8.0+**: æ•°æ®åº“è®¾è®¡å’Œä¼˜åŒ–

#### **æ¶æ„å·¥å…·**
- **UMLå»ºæ¨¡**: ç±»å›¾ã€ERå›¾ã€åºåˆ—å›¾è®¾è®¡
- **APIè®¾è®¡**: RESTfulæ¥å£è®¾è®¡è§„èŒƒ
- **ç¼“å­˜æ¶æ„**: Redis+Caffeineå¤šçº§ç¼“å­˜è®¾è®¡
- **DevOps**: CI/CDæµç¨‹å’Œè‡ªåŠ¨åŒ–æ£€æŸ¥

---

## ğŸ› ï¸ æ“ä½œæ­¥éª¤

### **ç¬¬ä¸€æ­¥ï¼šåŸºç¡€å®ä½“åˆ†æ (1å°æ—¶)**

#### 1.1 è¯†åˆ«é¡¹ç›®ä¸­çš„åŸºç¡€å®ä½“
```bash
# æœç´¢æ‰€æœ‰åŸºç¡€å®ä½“
find . -name "*Entity.java" -exec grep -l "extends BaseEntity" {} \;

# åˆ†æåŸºç¡€å®ä½“çš„èŒè´£å’Œå­—æ®µ
grep -n "private.*" */BaseEntity.java
```

#### 1.2 è¯„ä¼°ç°æœ‰åŸºç¡€å®ä½“è®¾è®¡
**æ£€æŸ¥è¦ç‚¹**:
- âœ… åŸºç¡€å®ä½“æ˜¯å¦åŒ…å«é€šç”¨çš„ä¸šåŠ¡å­—æ®µ
- âœ… æ˜¯å¦éµå¾ªåˆç†çš„ç»§æ‰¿å±‚æ¬¡
- âœ… å­—æ®µå‘½åæ˜¯å¦è§„èŒƒç»Ÿä¸€
- âœ… æ˜¯å¦åŒ…å«å¿…è¦çš„å®¡è®¡å­—æ®µ

**ç¤ºä¾‹åŸºç¡€å®ä½“è¯„ä¼°**:
```java
// âœ… ä¼˜ç§€çš„åŸºç¡€å®ä½“è®¾è®¡
@Data
@EqualsAndHashCode(callSuper = true)
@TableName("t_area")
public class AreaEntity extends BaseEntity {
    @TableId("area_id")
    private Long areaId;

    @NotBlank
    private String areaCode;

    @NotBlank
    private String areaName;

    @NotNull
    private Integer areaType;

    private Long parentId;
    private String path;
    private Integer level;
    // åŸºç¡€åŒºåŸŸé€šç”¨å­—æ®µ
}
```

### **ç¬¬äºŒæ­¥ï¼šæ‰©å±•è¡¨æœºåˆ¶è®¾è®¡ (2å°æ—¶)**

#### 2.1 æ‰©å±•è¡¨è®¾è®¡æ¨¡å¼

**æ ‡å‡†æ‰©å±•è¡¨æ¨¡æ¿**:
```sql
-- æ‰©å±•è¡¨é€šç”¨æ¨¡æ¿
CREATE TABLE `t_{module}_ext` (
  `ext_id` BIGINT NOT NULL AUTO_INCREMENT COMMENT 'æ‰©å±•ID',
  `{module}_id` BIGINT NOT NULL COMMENT 'å…³è”{module}ID',

  -- ä¸šåŠ¡ç‰¹æœ‰å­—æ®µåŒºåŸŸ
  `{business_field1}` {field_type} COMMENT 'ä¸šåŠ¡å­—æ®µ1',
  `{business_field2}` {field_type} COMMENT 'ä¸šåŠ¡å­—æ®µ2',
  `{business_field3}` {field_type} COMMENT 'ä¸šåŠ¡å­—æ®µ3',

  -- æ ‡å‡†æ‰©å±•å­—æ®µ
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `create_user_id` BIGINT COMMENT 'åˆ›å»ºäººID',
  `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  `update_user_id` BIGINT COMMENT 'æ›´æ–°äººID',
  `deleted_flag` TINYINT(1) NOT NULL DEFAULT 0 COMMENT 'åˆ é™¤æ ‡è¯†',
  `version` INT NOT NULL DEFAULT 1 COMMENT 'ç‰ˆæœ¬å·(ä¹è§‚é”)',

  PRIMARY KEY (`ext_id`),
  UNIQUE KEY `uk_{module}_id` (`{module}_id`, `deleted_flag`),
  KEY `idx_{business_field1}` (`{business_field1}`, `deleted_flag`),
  KEY `idx_create_time` (`create_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='{module}æ‰©å±•è¡¨';
```

#### 2.2 æ‰©å±•è¡¨å‘½åè§„èŒƒ

**å‘½åè§„åˆ™**:
```sql
-- åŸºç¡€è¡¨: t_{business_domain}
-- æ‰©å±•è¡¨: t_{business_domain}_ext
-- å…³è”è¡¨: t_{domain1}_{domain2}

-- ç¤ºä¾‹:
t_area (åŸºç¡€åŒºåŸŸè¡¨)
t_area_ext (åŒºåŸŸæ‰©å±•è¡¨)
t_access_area_ext (é—¨ç¦åŒºåŸŸæ‰©å±•è¡¨)
t_consume_area_ext (æ¶ˆè´¹åŒºåŸŸæ‰©å±•è¡¨)
```

#### 2.3 æ‰©å±•è¡¨å­—æ®µè®¾è®¡åŸåˆ™

**å­—æ®µè®¾è®¡åŸåˆ™**:
- **ä¸šåŠ¡ç‰¹æœ‰**: æ‰©å±•è¡¨åªåŒ…å«ä¸šåŠ¡æ¨¡å—ç‰¹æœ‰çš„å­—æ®µ
- **JSONé…ç½®**: å¤æ‚é…ç½®ä½¿ç”¨JSONå­—æ®µå­˜å‚¨
- **ç±»å‹å®‰å…¨**: æ˜ç¡®å®šä¹‰å­—æ®µç±»å‹å’Œçº¦æŸ
- **ç´¢å¼•ä¼˜åŒ–**: ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•

**JSONå­—æ®µç¤ºä¾‹**:
```sql
-- å¤æ‚é…ç½®å­—æ®µç¤ºä¾‹
`time_restrictions` TEXT COMMENT 'æ—¶é—´é™åˆ¶é…ç½®(JSONæ ¼å¼)',
  -- ç¤ºä¾‹JSONç»“æ„:
  -- {
  --   "work_days": [1,2,3,4,5],
  --   "work_start": "09:00",
  --   "work_end": "18:00",
  --   "lunch_break": {"start": "12:00", "end": "13:00"}
  -- }

`alert_config` TEXT COMMENT 'å‘Šè­¦é…ç½®(JSONæ ¼å¼)',
  -- ç¤ºä¾‹JSONç»“æ„:
  -- {
  --   "temperature_threshold": 75.0,
  --   "offline_timeout": 300,
  --   "notification_methods": ["email", "sms", "push"]
  -- }
```

### **ç¬¬ä¸‰æ­¥ï¼šJavaå®ä½“å±‚å®ç° (2å°æ—¶)**

#### 3.1 æ‰©å±•è¡¨å®ä½“è®¾è®¡

**æ ‡å‡†æ‰©å±•å®ä½“æ¨¡æ¿**:
```java
/**
 * {Module}æ‰©å±•å®ä½“ç±»
 * <p>
 * æ‰©å±•è¡¨æœºåˆ¶å®ç°ï¼Œå­˜å‚¨{module}ç‰¹æœ‰çš„ä¸šåŠ¡å­—æ®µ
 * é€šè¿‡å…³è”{module}_idä¸åŸºç¡€å®ä½“å»ºç«‹å…³ç³»
 *
 * @author SmartAdmin Team
 * @since 2025-11-25
 */
@Data
@EqualsAndHashCode(callSuper = true)
@TableName("t_{module}_ext")
public class {Module}ExtensionEntity extends BaseEntity {

    /**
     * æ‰©å±•ID
     */
    @TableId(type = IdType.AUTO)
    private Long extId;

    /**
     * å…³è”{module}ID
     */
    @NotNull(message = "{module}IDä¸èƒ½ä¸ºç©º")
    private Long {moduleId};

    // ==================== ä¸šåŠ¡ç‰¹æœ‰å­—æ®µ ====================

    /**
     * ä¸šåŠ¡å­—æ®µ1
     */
    private {fieldType} {businessField1};

    /**
     * ä¸šåŠ¡å­—æ®µ2
     */
    private {fieldType} {businessField2};

    /**
     * ä¸šåŠ¡å­—æ®µ3 (JSONé…ç½®)
     */
    private String {configField};
}
```

#### 3.2 VOå¯¹è±¡è®¾è®¡

**ç»„åˆVOè®¾è®¡æ¨¡å¼**:
```java
/**
 * {Module}å®Œæ•´ä¿¡æ¯VO
 * <p>
 * ç»„åˆåŸºç¡€å®ä½“å’Œæ‰©å±•è¡¨ä¿¡æ¯
 */
@Data
@Builder
@NoArgsConstructor
@AllArgsConstructor
public class {Module}FullVO {

    /**
     * åŸºç¡€ä¿¡æ¯
     */
    private {Module}VO baseInfo;

    /**
     * æ‰©å±•ä¿¡æ¯
     */
    private {Module}ExtensionVO extensionInfo;

    /**
     * ç»„åˆå­—æ®µï¼ˆå¯é€‰ï¼‰
     */
    private String {combinedField};

    /**
     * åˆ›å»ºç»„åˆVO
     */
    public static {Module}FullVO create({Module}Entity entity, {Module}ExtensionEntity extension) {
        return {Module}FullVO.builder()
            .baseInfo(convertToVO(entity))
            .extensionInfo(convertToVO(extension))
            .{combinedFieldMethod}()
            .build();
    }
}
```

### **ç¬¬å››æ­¥ï¼šæœåŠ¡å±‚å®ç° (1.5å°æ—¶)**

#### 4.1 æ‰©å±•è¡¨æœåŠ¡è®¾è®¡

**æ ‡å‡†æ‰©å±•æœåŠ¡æ¨¡æ¿**:
```java
/**
 * {Module}æ‰©å±•æœåŠ¡
 * <p>
 * å¤„ç†{module}çš„æ‰©å±•è¡¨ä¸šåŠ¡é€»è¾‘
 * é‡‡ç”¨åŸºç¡€+æ‰©å±•çš„ç»„åˆè®¾è®¡æ¨¡å¼
 */
@Service
@Slf4j
public class {Module}ExtensionService {

    @Resource
    private {Module}Dao {module}Dao;

    @Resource
    private {Module}ExtensionDao {module}ExtensionDao;

    @Resource
    private {Module}CacheManager {module}CacheManager;

    /**
     * è·å–{module}å®Œæ•´ä¿¡æ¯
     *
     * @param {moduleId} {module}ID
     * @return å®Œæ•´ä¿¡æ¯VO
     */
    @Cacheable(value = "{module}:full", key = "#{{moduleId}}")
    public ResponseDTO<{Module}FullVO> getFullInfo(Long {moduleId}) {
        try {
            // 1. è·å–åŸºç¡€ä¿¡æ¯
            {Module}Entity entity = {module}Dao.selectById({moduleId});
            if (entity == null) {
                return ResponseDTO.error("{module}ä¸å­˜åœ¨");
            }

            // 2. è·å–æ‰©å±•ä¿¡æ¯
            {Module}ExtensionEntity extension = {module}ExtensionDao.selectBy{Module}Id({moduleId});

            // 3. ç»„è£…å®Œæ•´ä¿¡æ¯
            {Module}FullVO fullVO = {Module}FullVO.create(entity, extension);

            return ResponseDTO.ok(fullVO);

        } catch (Exception e) {
            log.error("è·å–{module}å®Œæ•´ä¿¡æ¯å¤±è´¥: {moduleId}", e);
            return ResponseDTO.error("è·å–ä¿¡æ¯å¤±è´¥: " + e.getMessage());
        }
    }

    /**
     * ä¿å­˜{module}å®Œæ•´ä¿¡æ¯
     *
     * @param dto å®Œæ•´ä¿¡æ¯DTO
     * @return ä¿å­˜ç»“æœ
     */
    @Transactional(rollbackFor = Exception.class)
    public ResponseDTO<Long> saveFullInfo({Module}FullDTO dto) {
        try {
            // 1. ä¿å­˜åŸºç¡€ä¿¡æ¯
            {Module}Entity entity = convertToEntity(dto.getBaseInfo());
            {module}Dao.insertOrUpdate(entity);

            // 2. ä¿å­˜æ‰©å±•ä¿¡æ¯
            if (dto.getExtensionInfo() != null) {
                {Module}ExtensionEntity extension = convertToExtensionEntity(dto.getExtensionInfo());
                extension.set{Module}Id(entity.get{Module}Id());
                {module}ExtensionDao.insertOrUpdate(extension);
            }

            // 3. æ¸…é™¤ç¼“å­˜
            {module}CacheManager.evictCache(entity.get{Module}Id());

            return ResponseDTO.ok(entity.get{Module}Id());

        } catch (Exception e) {
            log.error("ä¿å­˜{module}å®Œæ•´ä¿¡æ¯å¤±è´¥", e);
            throw new {Module}Exception("ä¿å­˜å¤±è´¥: " + e.getMessage());
        }
    }

    /**
     * æ‰¹é‡æŸ¥è¯¢æ‰©å±•ä¿¡æ¯
     *
     * @param {module}Ids {module}IDåˆ—è¡¨
     * @return æ‰©å±•ä¿¡æ¯Map
     */
    public Map<Long, {Module}ExtensionEntity> batchGetExtensions(List<Long> {module}Ids) {
        if ({module}Ids == null || {module}Ids.isEmpty()) {
            return Collections.emptyMap();
        }

        List<{Module}ExtensionEntity> extensions = {module}ExtensionDao.selectBy{Module}Ids({module}Ids);

        return extensions.stream()
            .collect(Collectors.toMap(
                {Module}ExtensionEntity::get{Module}Id,
                Function.identity()
            ));
    }
}
```

#### 4.2 DAOå±‚æ‰©å±•æŸ¥è¯¢

**æ‰©å±•è¡¨DAOè®¾è®¡**:
```java
/**
 * {Module}æ‰©å±•DAO
 * <p>
 * å¤„ç†æ‰©å±•è¡¨çš„å¤æ‚æŸ¥è¯¢æ“ä½œ
 */
@Mapper
public interface {Module}ExtensionDao extends BaseMapper<{Module}ExtensionEntity> {

    /**
     * æ ¹æ®{module}IDæŸ¥è¯¢æ‰©å±•ä¿¡æ¯
     *
     * @param {moduleId} {module}ID
     * @return æ‰©å±•å®ä½“
     */
    @Select("SELECT * FROM t_{module}_ext WHERE {module}_id = #{moduleId} AND deleted_flag = 0")
    {Module}ExtensionEntity selectBy{Module}Id(@Param("{moduleId}") Long {moduleId});

    /**
     * æ‰¹é‡æŸ¥è¯¢æ‰©å±•ä¿¡æ¯
     *
     * @param {module}Ids {module}IDåˆ—è¡¨
     * @return æ‰©å±•å®ä½“åˆ—è¡¨
     */
    @Select("<script>" +
            "SELECT * FROM t_{module}_ext " +
            "WHERE {module}_id IN " +
            "<foreach collection='{module}Ids' item='id' open='(' separator=',' close=')'>" +
            "#{id}" +
            "</foreach>" +
            "AND deleted_flag = 0" +
            "</script>")
    List<{Module}ExtensionEntity> selectBy{Module}Ids(@Param("{module}Ids") List<Long> {module}Ids);

    /**
     * å…³è”æŸ¥è¯¢å®Œæ•´ä¿¡æ¯
     *
     * @param {moduleId} {module}ID
     * @return å®Œæ•´ä¿¡æ¯Map
     */
    @Select("SELECT " +
            "b.* as base_, " +
            "e.* as ext_ " +
            "FROM t_{module} b " +
            "LEFT JOIN t_{module}_ext e ON b.{module}_id = e.{module}_id AND e.deleted_flag = 0 " +
            "WHERE b.{module}_id = #{moduleId} AND b.deleted_flag = 0")
    Map<String, Object> selectFullInfo(@Param("{moduleId}") Long {moduleId});
}
```

### **ç¬¬äº”æ­¥ï¼šç¼“å­˜å±‚è®¾è®¡ (1å°æ—¶)**

#### 5.1 æ‰©å±•è¡¨ç¼“å­˜ç­–ç•¥

**å¤šçº§ç¼“å­˜è®¾è®¡**:
```java
/**
 * {Module}æ‰©å±•ç¼“å­˜ç®¡ç†å™¨
 * <p>
 * é‡‡ç”¨L1æœ¬åœ°ç¼“å­˜ + L2åˆ†å¸ƒå¼ç¼“å­˜çš„ç»„åˆç­–ç•¥
 * æ”¯æŒåŸºç¡€ä¿¡æ¯å’Œæ‰©å±•ä¿¡æ¯çš„åˆ†åˆ«ç¼“å­˜
 */
@Component
@Slf4j
public class {Module}CacheManager extends BaseCacheManager {

    // ç¼“å­˜é”®æ¨¡æ¿
    private static final String CACHE_KEY_BASE = "{module}:base:{}";
    private static final String CACHE_KEY_EXT = "{module}:ext:{}";
    private static final String CACHE_KEY_FULL = "{module}:full:{}";

    // æœ¬åœ°ç¼“å­˜ (L1)
    private final Cache<String, {Module}Entity> baseCache;
    private final Cache<String, {Module}ExtensionEntity> extCache;

    // åˆ†å¸ƒå¼ç¼“å­˜ (L2)
    @Resource
    private UnifiedCacheService distributedCache;

    public {Module}CacheManager() {
        // é…ç½®æœ¬åœ°ç¼“å­˜ (Caffeine)
        this.baseCache = Caffeine.newBuilder()
            .maximumSize(1000)
            .expireAfterWrite(30, TimeUnit.MINUTES)
            .build();

        this.extCache = Caffeine.newBuilder()
            .maximumSize(1000)
            .expireAfterWrite(15, TimeUnit.MINUTES)
            .build();
    }

    /**
     * è·å–å®Œæ•´ä¿¡æ¯ (ç»„åˆç¼“å­˜ç­–ç•¥)
     */
    public {Module}FullVO getFullInfo(Long {moduleId}) {
        String cacheKey = String.format(CACHE_KEY_FULL, {moduleId});

        // L1ç¼“å­˜æŸ¥æ‰¾
        {Module}FullVO cached = ({Module}FullVO) distributedCache.get(cacheKey);
        if (cached != null) {
            return cached;
        }

        // L2ç¼“å­˜æŸ¥æ‰¾
        {Module}Entity baseEntity = baseCache.getIfPresent(String.format(CACHE_KEY_BASE, {moduleId}));
        {Module}ExtensionEntity extEntity = extCache.getIfPresent(String.format(CACHE_KEY_EXT, {moduleId}));

        if (baseEntity != null) {
            cached = {Module}FullVO.create(baseEntity, extEntity);

            // å†™å…¥L2ç¼“å­˜
            distributedCache.set(cacheKey, cached, 30);

            return cached;
        }

        return null;
    }

    /**
     * æ¸…é™¤ç›¸å…³ç¼“å­˜
     */
    public void evictCache(Long {moduleId}) {
        // æ¸…é™¤æœ¬åœ°ç¼“å­˜
        baseCache.invalidate(String.format(CACHE_KEY_BASE, {moduleId}));
        extCache.invalidate(String.format(CACHE_KEY_EXT, {moduleId}));

        // æ¸…é™¤åˆ†å¸ƒå¼ç¼“å­˜
        distributedCache.delete(String.format(CACHE_KEY_BASE, {moduleId}));
        distributedCache.delete(String.format(CACHE_KEY_EXT, {moduleId}));
        distributedCache.delete(String.format(CACHE_KEY_FULL, {moduleId}));

        log.debug("æ¸…é™¤{module}ç¼“å­˜: {}", {moduleId});
    }
}
```

### **ç¬¬å…­æ­¥ï¼šAPIå±‚è®¾è®¡ (0.5å°æ—¶)**

#### 6.1 ç»Ÿä¸€æ‰©å±•API

**æ‰©å±•è¡¨APIè®¾è®¡æ¨¡å¼**:
```java
/**
 * {Module}æ‰©å±•ä¿¡æ¯æ§åˆ¶å™¨
 * <p>
 * æä¾›æ‰©å±•è¡¨ç›¸å…³çš„APIæ¥å£
 * éµå¾ªRESTfulè®¾è®¡è§„èŒƒ
 */
@RestController
@RequestMapping("/api/{module}/extension")
@Tag(name = "{Module}æ‰©å±•ç®¡ç†", description = "{Module}æ‰©å±•ä¿¡æ¯ç®¡ç†ç›¸å…³æ¥å£")
@Validated
@Slf4j
public class {Module}ExtensionController {

    @Resource
    private {Module}ExtensionService {module}ExtensionService;

    /**
     * è·å–{module}å®Œæ•´ä¿¡æ¯
     *
     * @param {moduleId} {module}ID
     * @return å®Œæ•´ä¿¡æ¯
     */
    @GetMapping("/full/{{moduleId}}")
    @Operation(summary = "è·å–{module}å®Œæ•´ä¿¡æ¯", description = "è·å–{module}çš„åŸºç¡€ä¿¡æ¯å’Œæ‰©å±•ä¿¡æ¯")
    @SaCheckPermission("{module}:extension:query")
    public ResponseDTO<{Module}FullVO> getFullInfo(
            @Parameter(description = "{module}ID", required = true)
            @PathVariable Long {moduleId}) {

        return {module}ExtensionService.getFullInfo({moduleId});
    }

    /**
     * ä¿å­˜{module}å®Œæ•´ä¿¡æ¯
     *
     * @param dto å®Œæ•´ä¿¡æ¯DTO
     * @return ä¿å­˜ç»“æœ
     */
    @PostMapping("/full")
    @Operation(summary = "ä¿å­˜{module}å®Œæ•´ä¿¡æ¯", description = "ä¿å­˜{module}çš„åŸºç¡€ä¿¡æ¯å’Œæ‰©å±•ä¿¡æ¯")
    @SaCheckPermission("{module}:extension:save")
    public ResponseDTO<Long> saveFullInfo(@Valid @RequestBody {Module}FullDTO dto) {

        return {module}ExtensionService.saveFullInfo(dto);
    }

    /**
     * æ‰¹é‡è·å–æ‰©å±•ä¿¡æ¯
     *
     * @param {module}Ids {module}IDåˆ—è¡¨
     * @return æ‰©å±•ä¿¡æ¯åˆ—è¡¨
     */
    @PostMapping("/batch")
    @Operation(summary = "æ‰¹é‡è·å–æ‰©å±•ä¿¡æ¯", description = "æ ¹æ®{module}IDåˆ—è¡¨æ‰¹é‡è·å–æ‰©å±•ä¿¡æ¯")
    @SaCheckPermission("{module}:extension:query")
    public ResponseDTO<List<{Module}ExtensionVO>> batchGetExtensions(
            @Parameter(description = "{module}IDåˆ—è¡¨", required = true)
            @RequestBody @NotNull List<Long> {module}Ids) {

        Map<Long, {Module}ExtensionEntity> extensionMap =
            {module}ExtensionService.batchGetExtensions({module}Ids);

        List<{Module}ExtensionVO> result = {module}Ids.stream()
            .map(id -> convertToVO(extensionMap.get(id)))
            .collect(Collectors.toList());

        return ResponseDTO.ok(result);
    }
}
```

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### ğŸš¨ **å¿…é¡»é¿å…çš„è®¾è®¡é”™è¯¯**

#### 1. **é”™è¯¯ä½¿ç”¨ç»§æ‰¿ä»£æ›¿æ‰©å±•è¡¨**
```java
// âŒ é”™è¯¯ï¼šç›´æ¥ç»§æ‰¿åŸºç¡€å®ä½“é‡å¤å­—æ®µ
public class AccessAreaEntity extends BaseEntity {
    private Long areaId;           // é‡å¤AreaEntityçš„å­—æ®µ
    private String areaCode;       // é‡å¤AreaEntityçš„å­—æ®µ
    private String areaName;       // é‡å¤AreaEntityçš„å­—æ®µ
    private Integer accessLevel;  // é—¨ç¦ç‰¹æœ‰å­—æ®µ
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨æ‰©å±•è¡¨æœºåˆ¶
public class AreaEntity extends BaseEntity {
    private Long areaId;
    private String areaCode;
    private String areaName;
    // åŸºç¡€åŒºåŸŸå­—æ®µ
}

// æ‰©å±•è¡¨ t_access_area_ext å­˜å‚¨accessLevelç­‰é—¨ç¦ç‰¹æœ‰å­—æ®µ
```

#### 2. **æ‰©å±•è¡¨åŒ…å«åŸºç¡€å­—æ®µ**
```sql
-- âŒ é”™è¯¯ï¼šæ‰©å±•è¡¨åŒ…å«åŸºç¡€å­—æ®µ
CREATE TABLE `t_area_ext` (
  `ext_id` BIGINT NOT NULL AUTO_INCREMENT,
  `area_id` BIGINT NOT NULL,
  `area_code` VARCHAR(32),  -- é”™è¯¯ï¼šåŸºç¡€å­—æ®µ
  `area_name` VARCHAR(100), -- é”™è¯¯ï¼šåŸºç¡€å­—æ®µ
  `access_level` INT,        -- æ­£ç¡®ï¼šæ‰©å±•å­—æ®µ
  ...
);

-- âœ… æ­£ç¡®ï¼šæ‰©å±•è¡¨åªåŒ…å«æ‰©å±•å­—æ®µ
CREATE TABLE `t_area_ext` (
  `ext_id` BIGINT NOT NULL AUTO_INCREMENT,
  `area_id` BIGINT NOT NULL,
  `access_level` INT,        -- æ­£ç¡®ï¼šæ‰©å±•å­—æ®µ
  `access_mode` VARCHAR(50),  -- æ­£ç¡®ï¼šæ‰©å±•å­—æ®µ
  ...
);
```

#### 3. **ç¼ºä¹äº‹åŠ¡ä¸€è‡´æ€§ä¿è¯**
```java
// âŒ é”™è¯¯ï¼šç¼ºä¹äº‹åŠ¡ç®¡ç†
public ResponseDTO<Long> saveInfo({Module}FullDTO dto) {
    {Module}Entity entity = convertToEntity(dto.getBaseInfo());
    {module}Dao.insert(entity);  // å¯èƒ½æˆåŠŸ

    {Module}ExtensionEntity extension = convertToExtensionEntity(dto.getExtensionInfo());
    {module}ExtensionDao.insert(extension);  // å¯èƒ½å¤±è´¥ï¼Œä½†åŸºç¡€æ•°æ®å·²ä¿å­˜
}

// âœ… æ­£ç¡®ï¼šä½¿ç”¨äº‹åŠ¡ä¿è¯ä¸€è‡´æ€§
@Transactional(rollbackFor = Exception.class)
public ResponseDTO<Long> saveInfo({Module}FullDTO dto) {
    {Module}Entity entity = convertToEntity(dto.getBaseInfo());
    {module}Dao.insert(entity);

    {Module}ExtensionEntity extension = convertToExtensionEntity(dto.getExtensionInfo());
    {module}ExtensionDao.insert(extension);  // å¤±è´¥æ—¶æ•´ä¸ªäº‹åŠ¡å›æ»š
}
```

### ğŸ”’ **å®‰å…¨è¦æ±‚**

#### 1. **æ•°æ®è®¿é—®å®‰å…¨**
- æ‰€æœ‰æ‰©å±•è¡¨æŸ¥è¯¢å¿…é¡»åŒ…å« `deleted_flag = 0` æ¡ä»¶
- æ‰©å±•è¡¨æ›´æ–°æ“ä½œéœ€è¦ä¸¥æ ¼çš„æƒé™éªŒè¯
- æ•æ„Ÿé…ç½®å­—æ®µéœ€è¦åŠ å¯†å­˜å‚¨

#### 2. **ç¼“å­˜å®‰å…¨**
- åˆ†å¸ƒå¼ç¼“å­˜éœ€è¦è®¾ç½®åˆç†çš„è¿‡æœŸæ—¶é—´
- ç¼“å­˜é”®éœ€è¦é¿å…å†²çªå’Œé‡å¤
- æ•æ„Ÿæ•°æ®ä¸é€‚åˆæ”¾å…¥ç¼“å­˜

#### 3. **JSONå­—æ®µå®‰å…¨**
- JSONé…ç½®å­—æ®µéœ€è¦è¿›è¡Œæ ¼å¼éªŒè¯
- é˜²æ­¢JSONæ³¨å…¥æ”»å‡»
- é…ç½®å­—æ®µå¤§å°éœ€è¦é™åˆ¶

---

## ğŸ“Š è¯„ä¼°æ ‡å‡†

### âœ… **å®Œæˆæ ‡å‡†**

#### **æ¶æ„è®¾è®¡å®Œæˆåº¦ (100%)**
- [ ] åŸºç¡€å®ä½“è®¾è®¡åˆç†ï¼ŒèŒè´£æ¸…æ™°
- [ ] æ‰©å±•è¡¨æœºåˆ¶æ­£ç¡®å®ç°ï¼Œç¬¦åˆè®¾è®¡è§„èŒƒ
- [ ] æ•°æ®åº“è®¾è®¡éµå¾ªæ‰©å±•è¡¨æ¨¡å¼
- [ ] Javaå®ä½“å±‚æ­£ç¡®æ˜ å°„æ‰©å±•è¡¨å…³ç³»

#### **ä»£ç å®ç°è´¨é‡ (100%)**
- [ ] æœåŠ¡å±‚å®Œæ•´å®ç°åŸºç¡€+æ‰©å±•çš„ç»„åˆæ“ä½œ
- [ ] ç¼“å­˜å±‚æ­£ç¡®å¤„ç†æ‰©å±•ä¿¡æ¯çš„ç¼“å­˜ç­–ç•¥
- [ ] APIå±‚æä¾›å®Œæ•´çš„æ‰©å±•ä¿¡æ¯ç®¡ç†æ¥å£
- [ ] å¼‚å¸¸å¤„ç†å’Œäº‹åŠ¡ç®¡ç†å®Œå–„

#### **æ€§èƒ½ä¼˜åŒ–å®Œæˆåº¦ (90%)**
- [ ] æ‰©å±•è¡¨æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–ï¼ˆç´¢å¼•ã€æ‰¹é‡æŸ¥è¯¢ï¼‰
- [ ] ç¼“å­˜ç­–ç•¥åˆç†ï¼Œå‘½ä¸­ç‡é«˜
- [ ] æ•°æ®åº“è¿æ¥æ± é…ç½®åˆç†
- [ ] å¤§æ•°æ®é‡æ“ä½œä¼˜åŒ–

#### **ä»£ç è§„èŒƒç¬¦åˆåº¦ (100%)**
- [ ] å‘½åè§„èŒƒç»Ÿä¸€ï¼Œç¬¦åˆé¡¹ç›®æ ‡å‡†
- [ ] æ³¨é‡Šå®Œæ•´ï¼ŒåŒ…å«æ‰©å±•è¡¨è®¾è®¡è¯´æ˜
- [ ] ä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤
- [ ] éµå¾ªé¡¹ç›®ç¼–ç è§„èŒƒ

### ğŸ¯ **æˆåŠŸæ ‡å‡†**

#### **åŠŸèƒ½å®Œæ•´æ€§**
- **CRUDæ“ä½œ**: æ”¯æŒåŸºç¡€å’Œæ‰©å±•ä¿¡æ¯çš„å®Œæ•´CRUDæ“ä½œ
- **ç»„åˆæŸ¥è¯¢**: æ”¯æŒåŸºç¡€+æ‰©å±•ä¿¡æ¯çš„ç»„åˆæŸ¥è¯¢
- **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡æ‰©å±•ä¿¡æ¯æ“ä½œ
- **ç¼“å­˜æ”¯æŒ**: æ”¯æŒæ‰©å±•ä¿¡æ¯çš„å¤šçº§ç¼“å­˜

#### **æ€§èƒ½æŒ‡æ ‡**
- **æŸ¥è¯¢å“åº”**: å•æ¬¡å®Œæ•´ä¿¡æ¯æŸ¥è¯¢ P95 â‰¤ 100ms
- **æ‰¹é‡æŸ¥è¯¢**: 100æ¡æ‰©å±•ä¿¡æ¯æ‰¹é‡æŸ¥è¯¢ â‰¤ 500ms
- **ç¼“å­˜å‘½ä¸­**: æ‰©å±•ä¿¡æ¯ç¼“å­˜å‘½ä¸­ç‡ â‰¥ 85%
- **å¹¶å‘æ”¯æŒ**: æ”¯æŒè‡³å°‘ 100 QPS çš„å¹¶å‘è®¿é—®

#### **å¯ç»´æŠ¤æ€§**
- **ä»£ç å¤ç”¨**: æ‰©å±•è¡¨æœºåˆ¶ä»£ç å¤ç”¨ç‡ â‰¥ 80%
- **æ‰©å±•æ€§**: æ–°ä¸šåŠ¡æ¨¡å—åŸºäºæ‰©å±•è¡¨æœºåˆ¶å¼€å‘æ—¶é—´ â‰¤ 2å¤©
- **ä¸€è‡´æ€§**: æ‰€æœ‰æ‰©å±•è¡¨å®ç°éµå¾ªç»Ÿä¸€è§„èŒƒ
- **æ–‡æ¡£å®Œæ•´æ€§**: æ‰©å±•è¡¨è®¾è®¡æ–‡æ¡£å®Œæ•´åº¦ 100%

---

## ğŸ”— **ç›¸å…³æŠ€èƒ½å¼•ç”¨**

### **å‰ç½®æŠ€èƒ½**
- **database-design-specialist**: æ•°æ®åº“è®¾è®¡ä¸“å®¶ï¼ˆæ‰©å±•è¡¨ä¾èµ–æ•°æ®åº“è®¾è®¡èƒ½åŠ›ï¼‰
- **four-tier-architecture-guardian**: å››å±‚æ¶æ„å®ˆæŠ¤ä¸“å®¶ï¼ˆç¡®ä¿æ¶æ„ä¸€è‡´æ€§ï¼‰

### **åä½œæŠ€èƒ½**
- **code-quality-protector**: ä»£ç è´¨é‡å®ˆæŠ¤ä¸“å®¶ï¼ˆç¡®ä¿æ‰©å±•è¡¨ä»£ç è´¨é‡ï¼‰
- **business-module-developer**: ä¸šåŠ¡æ¨¡å—å¼€å‘ä¸“å®¶ï¼ˆæ‰©å±•è¡¨ä¸šåŠ¡é€»è¾‘å®ç°ï¼‰

### **åç»­æŠ€èƒ½**
- **automated-code-quality-checker**: è‡ªåŠ¨åŒ–ä»£ç è´¨é‡æ£€æŸ¥ä¸“å®¶ï¼ˆæ‰©å±•è¡¨è§„èŒƒè‡ªåŠ¨æ£€æŸ¥ï¼‰
- **tech-stack-unification-specialist**: æŠ€æœ¯æ ˆç»Ÿä¸€åŒ–ä¸“å®¶ï¼ˆç¡®ä¿æ‰©å±•è¡¨æœºåˆ¶æŠ€æœ¯æ ˆä¸€è‡´ï¼‰

---

## ğŸ’¡ **æœ€ä½³å®è·µ**

### **1. æ‰©å±•è¡¨å­—æ®µè®¾è®¡**
```sql
-- âœ… æ¨èï¼šä¸šåŠ¡å­—æ®µæ˜ç¡®åˆ†ç±»
CREATE TABLE `t_area_ext` (
  `area_id` BIGINT NOT NULL,
  -- æƒé™æ§åˆ¶å­—æ®µ
  `access_level` INT NOT NULL DEFAULT 1 COMMENT 'è®¿é—®çº§åˆ«',
  `access_mode` VARCHAR(50) COMMENT 'è®¿é—®æ¨¡å¼',
  -- è®¾å¤‡é…ç½®å­—æ®µ
  `device_count` INT NOT NULL DEFAULT 0 COMMENT 'å…³è”è®¾å¤‡æ•°é‡',
  `device_config` JSON COMMENT 'è®¾å¤‡é…ç½®',
  -- å®‰å…¨æ§åˆ¶å­—æ®µ
  `guard_required` TINYINT(1) DEFAULT 0 COMMENT 'æ˜¯å¦éœ€è¦å®‰ä¿',
  `emergency_access` TINYINT(1) DEFAULT 0 COMMENT 'ç´§æ€¥è®¿é—®æƒé™',
  -- é…ç½®å­—æ®µ
  `time_restrictions` TEXT COMMENT 'æ—¶é—´é™åˆ¶é…ç½®',
  `alert_config` TEXT COMMENT 'å‘Šè­¦é…ç½®',
  ...
);
```

### **2. æœåŠ¡å±‚ç»„åˆæ¨¡å¼**
```java
// âœ… æ¨èï¼šæœåŠ¡ç»„åˆæ¨¡å¼
@Service
public class AreaService {

    // åŸºç¡€æœåŠ¡
    @Resource private BaseAreaService baseAreaService;

    // æ‰©å±•æœåŠ¡
    @Resource private AreaExtensionService extensionService;

    // ç»„åˆæŸ¥è¯¢
    public AreaFullVO getFullArea(Long areaId) {
        AreaEntity base = baseAreaService.getById(areaId);
        AreaExtensionEntity ext = extensionService.getByAreaId(areaId);

        return AreaFullVO.builder()
            .baseInfo(convertToVO(base))
            .extensionInfo(convertToVO(ext))
            .build();
    }
}
```

### **3. ç¼“å­˜ç­–ç•¥ä¼˜åŒ–**
```java
// âœ… æ¨èï¼šåˆ†å±‚ç¼“å­˜ç­–ç•¥
@Component
public class AreaExtensionCacheManager {

    // L1æœ¬åœ°ç¼“å­˜ (çƒ­æ•°æ®)
    private final Cache<Long, AreaExtensionEntity> localCache;

    // L2åˆ†å¸ƒå¼ç¼“å­˜ (æ¸©æ•°æ®)
    @Resource private UnifiedCacheService distributedCache;

    public AreaExtensionEntity get(Long areaId) {
        // å…ˆæŸ¥æœ¬åœ°ç¼“å­˜
        AreaExtensionEntity cached = localCache.getIfPresent(areaId);
        if (cached != null) {
            return cached;
        }

        // å†æŸ¥åˆ†å¸ƒå¼ç¼“å­˜
        String key = "area:ext:" + areaId;
        cached = (AreaExtensionEntity) distributedCache.get(key);
        if (cached != null) {
            localCache.put(areaId, cached);
            return cached;
        }

        return null;
    }
}
```

### **4. APIè®¾è®¡è§„èŒƒ**
```java
// âœ… æ¨èï¼šRESTful APIè®¾è®¡
@RestController
@RequestMapping("/api/areas")
public class AreaController {

    // åŸºç¡€ä¿¡æ¯API
    @GetMapping("/{areaId}")
    public ResponseDTO<AreaVO> getArea(@PathVariable Long areaId) { }

    // æ‰©å±•ä¿¡æ¯API
    @GetMapping("/{areaId}/extension")
    public ResponseDTO<AreaExtensionVO> getExtension(@PathVariable Long areaId) { }

    // å®Œæ•´ä¿¡æ¯API
    @GetMapping("/{areaId}/full")
    public ResponseDTO<AreaFullVO> getFullInfo(@PathVariable Long areaId) { }

    // æ‰¹é‡æŸ¥è¯¢API
    @PostMapping("/batch/extensions")
    public ResponseDTO<List<AreaExtensionVO>> batchGetExtensions(@RequestBody List<Long> areaIds) { }
}
```

---

**ä½¿ç”¨æŒ‡å—**: å½“éœ€è¦è®¾è®¡æ–°ä¸šåŠ¡æ¨¡å—çš„æ¶æ„æ—¶ï¼Œè°ƒç”¨æ­¤æŠ€èƒ½ç¡®ä¿é‡‡ç”¨æ­£ç¡®çš„æ‰©å±•è¡¨æœºåˆ¶ã€‚å½“å‘ç°ç°æœ‰æ¨¡å—å­˜åœ¨æ¶æ„ä¸ä¸€è‡´é—®é¢˜æ—¶ï¼Œä½¿ç”¨æ­¤æŠ€èƒ½è¿›è¡Œè§„èŒƒåŒ–æ”¹é€ ã€‚