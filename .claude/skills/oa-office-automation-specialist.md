# OAåŠå…¬è‡ªåŠ¨åŒ–ä¸“å®¶ - Office Automation Specialist

**ğŸ¯ æŠ€èƒ½å®šä½**: ä¸“ç²¾äºä¼ä¸šçº§OAåŠå…¬è‡ªåŠ¨åŒ–ç³»ç»Ÿçš„è®¾è®¡ã€å¼€å‘å’Œè¿ç»´æŠ€æœ¯ä¸“å®¶

**âš¡ æŠ€èƒ½ç­‰çº§**: â˜…â˜…â˜… (é«˜çº§ä¸“å®¶)
**ğŸ¯ é€‚ç”¨åœºæ™¯**: æ™ºæ…§å›­åŒºOAç³»ç»Ÿã€ä¼ä¸šåŠå…¬è‡ªåŠ¨åŒ–ã€å·¥ä½œæµç®¡ç†ç³»ç»Ÿã€æ–‡æ¡£åä½œå¹³å°
**ğŸ“Š æŠ€èƒ½è¦†ç›–**: Office Automation | Workflow Management | Document Collaboration | Enterprise Integration

---

## ğŸ“‹ æŠ€èƒ½æ¦‚è¿°

### **æ ¸å¿ƒä¸“é•¿**
- **å·¥ä½œæµå¼•æ“**: ä¼ä¸šçº§å·¥ä½œæµç³»ç»Ÿè®¾è®¡ã€æµç¨‹å»ºæ¨¡ã€å®¡æ‰¹æµç¨‹ç®¡ç†
- **æ–‡æ¡£ç®¡ç†**: æ–‡æ¡£ç‰ˆæœ¬æ§åˆ¶ã€æƒé™ç®¡ç†ã€ååŒç¼–è¾‘ã€å…¨æ–‡æ£€ç´¢
- **æ¶ˆæ¯é€šçŸ¥**: å¤šæ¸ é“æ¶ˆæ¯æ¨é€ã€é‚®ä»¶é€šçŸ¥ã€å³æ—¶é€šè®¯é›†æˆ
- **ç³»ç»Ÿé›†æˆ**: ç¬¬ä¸‰æ–¹ç³»ç»Ÿå¯¹æ¥ã€æ•°æ®åŒæ­¥ã€ç»Ÿä¸€èº«ä»½è®¤è¯
- **ç§»åŠ¨åŠå…¬**: ç§»åŠ¨ç«¯OAåº”ç”¨ã€å®¡æ‰¹æµç¨‹ç§»åŠ¨åŒ–ã€å®æ—¶é€šçŸ¥

### **è§£å†³èƒ½åŠ›**
- **æµç¨‹è‡ªåŠ¨åŒ–**: å¤æ‚ä¸šåŠ¡æµç¨‹çš„è‡ªåŠ¨åŒ–è®¾è®¡å’Œå®ç°
- **æ–‡æ¡£ååŒ**: å¤šäººå®æ—¶åä½œç¼–è¾‘ã€ç‰ˆæœ¬æ§åˆ¶ã€æƒé™ç®¡ç†
- **å®¡æ‰¹ç®¡ç†**: å¤šçº§å®¡æ‰¹ã€æ¡ä»¶åˆ†æ”¯ã€ä¼šç­¾ã€å§”æ‰˜å®¡æ‰¹ç­‰å¤æ‚åœºæ™¯
- **æ•°æ®é›†æˆ**: ä¸HRã€è´¢åŠ¡ã€CRMç­‰ç³»ç»Ÿçš„æ•°æ®é›†æˆå’ŒåŒæ­¥
- **ç§»åŠ¨æ”¯æŒ**: å…¨åŠŸèƒ½ç§»åŠ¨ç«¯åº”ç”¨ï¼Œéšæ—¶éšåœ°åŠå…¬

---

## ğŸ› ï¸ æŠ€æœ¯èƒ½åŠ›çŸ©é˜µ

### **OAæŠ€æœ¯æ ˆ**
```
ğŸ”´ æ ¸å¿ƒæŠ€æœ¯ (ç²¾é€š)
â”œâ”€â”€ å·¥ä½œæµå¼•æ“: Activitiã€Camundaã€Flowable
â”œâ”€â”€ æ–‡æ¡£å¤„ç†: POIã€iTextã€PDFå¤„ç†ã€å›¾ç‰‡å¤„ç†
â”œâ”€â”€ æ¶ˆæ¯é˜Ÿåˆ—: RabbitMQã€RocketMQã€Kafka
â”œâ”€â”€ å®æ—¶é€šè®¯: WebSocketã€SSEã€ç§»åŠ¨æ¨é€
â”œâ”€â”€ å…¨æ–‡æ£€ç´¢: Elasticsearchã€Luceneã€ä¸­æ–‡åˆ†è¯

ğŸŸ¡ æ¶æ„è®¾è®¡ (ç†Ÿç»ƒ)
â”œâ”€â”€ å¾®æœåŠ¡æ¶æ„: æµç¨‹æœåŠ¡ã€æ–‡æ¡£æœåŠ¡ã€é€šçŸ¥æœåŠ¡
â”œâ”€â”€ æ•°æ®åº“è®¾è®¡: æµç¨‹å®šä¹‰ã€æ–‡æ¡£å…ƒæ•°æ®ã€å®¡æ‰¹è®°å½•
â”œâ”€â”€ ç¼“å­˜ç­–ç•¥: æµç¨‹å®ä¾‹ç¼“å­˜ã€ç”¨æˆ·æƒé™ç¼“å­˜
â”œâ”€â”€ å®‰å…¨è®¾è®¡: æ•°æ®åŠ å¯†ã€è®¿é—®æ§åˆ¶ã€å®¡è®¡æ—¥å¿—

ğŸŸ¢ å‰ç«¯æŠ€æœ¯ (æŒæ¡)
â”œâ”€â”€ åœ¨çº¿ç¼–è¾‘: TinyMCEã€CKEditorã€Office Online
â”œâ”€â”€ æ–‡æ¡£é¢„è§ˆ: PDF.jsã€Officeæ–‡æ¡£é¢„è§ˆ
â”œâ”€â”€ ç§»åŠ¨å¼€å‘: React Nativeã€Flutterã€å°ç¨‹åº
â””â”€â”€ å¯è§†åŒ–è®¾è®¡: æµç¨‹å›¾ç»˜åˆ¶ã€æ•°æ®å¯è§†åŒ–
```

### **ä¸šåŠ¡åœºæ™¯è¦†ç›–**
```
âœ… ä¼ä¸šå®¡æ‰¹æµç¨‹ (100+æµç¨‹ç±»å‹)
âœ… æ–‡æ¡£ç®¡ç†ç³»ç»Ÿ
âœ… ä¼šè®®ç®¡ç†å¹³å°
âœ… è€ƒå‹¤è¯·å‡ç®¡ç†
âœ… è´¹ç”¨æŠ¥é”€ç³»ç»Ÿ
âœ… åˆåŒç®¡ç†ç³»ç»Ÿ
```

---

## ğŸ¨ æ ¸å¿ƒä¸šåŠ¡æ¨¡å—

### **1. å·¥ä½œæµç®¡ç†**
```java
@RestController
@RequestMapping("/api/oa/workflow")
@Tag(name = "å·¥ä½œæµç®¡ç†", description = "å·¥ä½œæµå®šä¹‰å’Œå®ä¾‹ç®¡ç†")
@Slf4j
public class WorkflowController {

    @Resource
    private WorkflowDefinitionService definitionService;

    @Resource
    private WorkflowInstanceService instanceService;

    @PostMapping("/definition/deploy")
    @Operation(summary = "éƒ¨ç½²å·¥ä½œæµå®šä¹‰")
    @SaCheckPermission("oa:workflow:deploy")
    public ResponseDTO<String> deployDefinition(@RequestBody @Valid WorkflowDeployForm form) {
        log.info("éƒ¨ç½²å·¥ä½œæµå®šä¹‰: {}", form.getDefinitionName());

        try {
            // 1. éªŒè¯æµç¨‹å®šä¹‰
            WorkflowValidationResult validation = definitionService.validateDefinition(form);
            if (!validation.isValid()) {
                return ResponseDTO.error(UserErrorCode.PARAM_ERROR, validation.getErrorMessage());
            }

            // 2. éƒ¨ç½²æµç¨‹å®šä¹‰
            String deploymentId = definitionService.deployWorkflow(form);

            // 3. ç¼“å­˜æµç¨‹å®šä¹‰ä¿¡æ¯ï¼Œä½¿ç”¨ç¨³å®šæ•°æ®ç±»å‹
            cacheService.set(CacheModule.OA, "workflow",
                "definition:" + deploymentId,
                form,
                BusinessDataType.STABLE);

            return ResponseDTO.ok(deploymentId, "å·¥ä½œæµå®šä¹‰éƒ¨ç½²æˆåŠŸ");
        } catch (Exception e) {
            log.error("éƒ¨ç½²å·¥ä½œæµå®šä¹‰å¤±è´¥: {}", form.getDefinitionName(), e);
            return ResponseDTO.error(SystemErrorCode.SYSTEM_ERROR, "éƒ¨ç½²å¤±è´¥: " + e.getMessage());
        }
    }

    @PostMapping("/instance/start")
    @Operation(summary = "å¯åŠ¨å·¥ä½œæµå®ä¾‹")
    @SaCheckPermission("oa:workflow:start")
    public ResponseDTO<WorkflowInstanceVO> startInstance(@RequestBody @Valid WorkflowStartForm form) {
        log.info("å¯åŠ¨å·¥ä½œæµå®ä¾‹: processDefinitionKey={}, businessKey={}",
                 form.getProcessDefinitionKey(), form.getBusinessKey());

        try {
            WorkflowInstanceVO instance = instanceService.startWorkflow(form);

            // 4. å®æ—¶é€šçŸ¥ç›¸å…³ç”¨æˆ·
            notifyStakeholders(instance);

            // 5. ç¼“å­˜å®ä¾‹ä¿¡æ¯ï¼Œä½¿ç”¨å®æ—¶æ•°æ®ç±»å‹
            cacheService.set(CacheModule.OA, "workflow-instance",
                "instance:" + instance.getInstanceId(),
                instance,
                BusinessDataType.REALTIME);

            return ResponseDTO.ok(instance, "å·¥ä½œæµå®ä¾‹å¯åŠ¨æˆåŠŸ");
        } catch (Exception e) {
            log.error("å¯åŠ¨å·¥ä½œæµå®ä¾‹å¤±è´¥: {}", form.getProcessDefinitionKey(), e);
            return ResponseDTO.error(SystemErrorCode.SYSTEM_ERROR, "å¯åŠ¨å¤±è´¥: " + e.getMessage());
        }
    }

    @PostMapping("/task/complete")
    @Operation(summary = "å®Œæˆä»»åŠ¡")
    @SaCheckPermission("oa:workflow:complete")
    public ResponseDTO<String> completeTask(@RequestBody @Valid WorkflowTaskCompleteForm form) {
        log.info("å®Œæˆä»»åŠ¡: taskId={}, assignee={}", form.getTaskId(), form.getAssignee());

        try {
            // 1. éªŒè¯ä»»åŠ¡æƒé™
            if (!instanceService.canCompleteTask(form.getTaskId(), getCurrentUserId())) {
                return ResponseDTO.error(SystemErrorCode.PERMISSION_DENIED, "æ— æƒé™å®Œæˆä»»åŠ¡");
            }

            // 2. å®Œæˆä»»åŠ¡
            instanceService.completeTask(form);

            // 3. æ¸…é™¤ç›¸å…³ç¼“å­˜
            cacheService.delete(CacheModule.OA, "task", "detail:" + form.getTaskId());

            return ResponseDTO.ok("ä»»åŠ¡å®ŒæˆæˆåŠŸ");
        } catch (Exception e) {
            log.error("å®Œæˆä»»åŠ¡å¤±è´¥: taskId={}", form.getTaskId(), e);
            return ResponseDTO.error(SystemErrorCode.SYSTEM_ERROR, "å®Œæˆå¤±è´¥: " + e.getMessage());
        }
    }
}
```

### **2. æ–‡æ¡£ç®¡ç†ç³»ç»Ÿ**
```java
@Service
@Slf4j
public class DocumentService {

    @Resource
    private DocumentRepository documentRepository;

    @Resource
    private UnifiedCacheService cacheService;

    /**
     * æ–‡æ¡£ä¸Šä¼ å¤„ç†
     */
    public DocumentUploadResult uploadDocument(MultipartFile file, DocumentUploadForm form) {
        try {
            // 1. æ–‡ä»¶å®‰å…¨æ£€æŸ¥
            SecurityCheckResult securityResult = performSecurityCheck(file);
            if (!securityResult.isSafe()) {
                throw new DocumentException("æ–‡ä»¶å®‰å…¨æ£€æŸ¥å¤±è´¥: " + securityResult.getReason());
            }

            // 2. ç”Ÿæˆæ–‡æ¡£ä¿¡æ¯
            DocumentEntity document = DocumentEntity.builder()
                .documentId(generateDocumentId())
                .originalName(file.getOriginalFilename())
                .fileName(generateFileName(file.getOriginalFilename()))
                .fileSize(file.getSize())
                .mimeType(file.getContentType())
                .categoryId(form.getCategoryId())
                .creatorId(getCurrentUserId())
                .creatorName(getCurrentUserName())
                .departmentId(getCurrentUserDepartmentId())
                .uploadTime(LocalDateTime.now())
                .status(DocumentStatus.ACTIVE)
                .build();

            // 3. å­˜å‚¨æ–‡ä»¶
            String filePath = storageService.storeFile(file, document.getFileName());
            document.setFilePath(filePath);

            // 4. æå–æ–‡æ¡£å…ƒæ•°æ®
            extractDocumentMetadata(document);

            // 5. æƒé™è®¾ç½®
            setDocumentPermissions(document, form);

            // 6. ä¿å­˜æ–‡æ¡£ä¿¡æ¯
            documentRepository.save(document);

            // 7. å…¨æ–‡ç´¢å¼•
            searchService.indexDocument(document);

            // 8. ç¼“å­˜æ–‡æ¡£ä¿¡æ¯ï¼Œä½¿ç”¨æ­£å¸¸æ•°æ®ç±»å‹
            cacheService.set(CacheModule.OA, "document",
                "detail:" + document.getDocumentId(),
                document,
                BusinessDataType.NORMAL);

            log.info("æ–‡æ¡£ä¸Šä¼ æˆåŠŸ: documentId={}, fileName={}",
                     document.getDocumentId(), document.getOriginalName());

            return DocumentUploadResult.builder()
                .documentId(document.getDocumentId())
                .fileName(document.getOriginalName())
                .fileSize(document.getFileSize())
                .uploadTime(document.getUploadTime())
                .build();

        } catch (Exception e) {
            log.error("æ–‡æ¡£ä¸Šä¼ å¤±è´¥: fileName={}", file.getOriginalFilename(), e);
            throw new DocumentException("æ–‡æ¡£ä¸Šä¼ å¤±è´¥: " + e.getMessage());
        }
    }

    /**
     * æ–‡æ¡£ç‰ˆæœ¬ç®¡ç†
     */
    public DocumentVersionResult createNewVersion(String documentId, MultipartFile file, String versionNote) {
        try {
            // 1. è·å–å½“å‰æ–‡æ¡£
            DocumentEntity currentDocument = documentRepository.findById(documentId)
                .orElseThrow(() -> new DocumentException("æ–‡æ¡£ä¸å­˜åœ¨: " + documentId));

            // 2. åˆ›å»ºæ–°ç‰ˆæœ¬
            DocumentVersionEntity newVersion = DocumentVersionEntity.builder()
                .versionId(generateVersionId())
                .documentId(documentId)
                .versionNumber(currentDocument.getCurrentVersion() + 1)
                .fileName(generateVersionFileName(file.getOriginalFilename(), currentDocument.getCurrentVersion() + 1))
                .fileSize(file.getSize())
                .mimeType(file.getContentType())
                .uploaderId(getCurrentUserId())
                .uploaderName(getCurrentUserName())
                .uploadTime(LocalDateTime.now())
                .versionNote(versionNote)
                .build();

            // 3. å­˜å‚¨æ–°ç‰ˆæœ¬æ–‡ä»¶
            String versionFilePath = storageService.storeVersionFile(file, newVersion.getFileName());
            newVersion.setFilePath(versionFilePath);

            // 4. æ›´æ–°æ–‡æ¡£å½“å‰ç‰ˆæœ¬
            currentDocument.setCurrentVersion(newVersion.getVersionNumber());
            currentDocument.setLatestVersionId(newVersion.getVersionId());
            documentRepository.save(currentDocument);

            // 5. ä¿å­˜ç‰ˆæœ¬ä¿¡æ¯
            documentVersionRepository.save(newVersion);

            // 6. ç¼“å­˜æ›´æ–°ï¼Œä½¿ç”¨æ­£å¸¸æ•°æ®ç±»å‹
            cacheService.set(CacheModule.OA, "document",
                "detail:" + documentId,
                currentDocument,
                BusinessDataType.NORMAL);

            log.info("æ–‡æ¡£ç‰ˆæœ¬åˆ›å»ºæˆåŠŸ: documentId={}, version={}",
                     documentId, newVersion.getVersionNumber());

            return DocumentVersionResult.builder()
                .versionId(newVersion.getVersionId())
                .versionNumber(newVersion.getVersionNumber())
                .fileName(newVersion.getFileName())
                .build();

        } catch (Exception e) {
            log.error("æ–‡æ¡£ç‰ˆæœ¬åˆ›å»ºå¤±è´¥: documentId={}", documentId, e);
            throw new DocumentException("åˆ›å»ºæ–°ç‰ˆæœ¬å¤±è´¥: " + e.getMessage());
        }
    }

    /**
     * æ–‡æ¡£æƒé™æ£€æŸ¥
     */
    public boolean hasDocumentPermission(String documentId, DocumentPermission permission) {
        try {
            // 1. æ£€æŸ¥ç¼“å­˜
            String cacheKey = "permission:" + documentId + ":" + getCurrentUserId();
            Boolean cachedPermission = cacheService.get(CacheModule.OA, "permission", cacheKey, Boolean.class);
            if (cachedPermission != null) {
                return cachedPermission;
            }

            // 2. è·å–æ–‡æ¡£ä¿¡æ¯
            DocumentEntity document = getDocument(documentId);
            if (document == null) {
                return false;
            }

            // 3. æƒé™æ£€æŸ¥é€»è¾‘
            boolean hasPermission = checkDocumentPermissionLogic(document, permission);

            // 4. ç¼“å­˜æƒé™ç»“æœï¼Œä½¿ç”¨è¿‘å®æ—¶æ•°æ®ç±»å‹
            cacheService.set(CacheModule.OA, "permission",
                cacheKey,
                hasPermission,
                BusinessDataType.NEAR_REALTIME);

            return hasPermission;
        } catch (Exception e) {
            log.error("æ–‡æ¡£æƒé™æ£€æŸ¥å¤±è´¥: documentId={}", documentId, e);
            return false;
        }
    }
}
```

### **3. æ¶ˆæ¯é€šçŸ¥ç³»ç»Ÿ**
```java
@Service
@Slf4j
public class NotificationService {

    @Resource
    private EmailService emailService;

    @Resource
    private SmsService smsService;

    @Resource
    private WebSocketService webSocketService;

    @Resource
    private MobilePushService mobilePushService;

    /**
     * å¤šæ¸ é“æ¶ˆæ¯å‘é€
     */
    public NotificationResult sendMultiChannelNotification(NotificationMessage message) {
        try {
            NotificationResult result = NotificationResult.builder()
                .messageId(generateMessageId())
                .message(message)
                .build();

            // 1. ç¡®å®šæ¥æ”¶æ¸ é“
            List<NotificationChannel> channels = determineNotificationChannels(message);

            // 2. å¤šæ¸ é“å‘é€
            for (NotificationChannel channel : channels) {
                try {
                    switch (channel) {
                        case EMAIL:
                            sendEmailNotification(message);
                            result.addChannelResult(EMAIL, true);
                            break;
                        case SMS:
                            sendSmsNotification(message);
                            result.addChannelResult(SMS, true);
                            break;
                        case WEBSOCKET:
                            sendWebSocketNotification(message);
                            result.addChannelResult(WEBSOCKET, true);
                            break;
                        case MOBILE_PUSH:
                            sendMobilePushNotification(message);
                            result.addChannelResult(MOBILE_PUSH, true);
                            break;
                        default:
                            log.warn("ä¸æ”¯æŒçš„é€šçŸ¥æ¸ é“: {}", channel);
                    }
                } catch (Exception e) {
                    log.error("é€šçŸ¥å‘é€å¤±è´¥: channel={}, messageId={}", channel, message.getMessageId(), e);
                    result.addChannelResult(channel, false);
                }
            }

            // 3. è®°å½•å‘é€æ—¥å¿—
            logNotificationSent(message, result);

            // 4. ç¼“å­˜é€šçŸ¥çŠ¶æ€ï¼Œä½¿ç”¨å®æ—¶æ•°æ®ç±»å‹
            cacheService.set(CacheModule.OA, "notification",
                "status:" + result.getMessageId(),
                result,
                BusinessDataType.REALTIME);

            return result;
        } catch (Exception e) {
            log.error("å¤šæ¸ é“é€šçŸ¥å‘é€å¤±è´¥: messageId={}", message.getMessageId(), e);
            return NotificationResult.error("é€šçŸ¥å‘é€å¤±è´¥: " + e.getMessage());
        }
    }

    /**
     * å·¥ä½œæµä»»åŠ¡é€šçŸ¥
     */
    public void sendWorkflowTaskNotification(WorkflowTaskEvent event) {
        try {
            // 1. æ„å»ºé€šçŸ¥æ¶ˆæ¯
            NotificationMessage message = NotificationMessage.builder()
                .messageType(NotificationMessageType.WORKFLOW_TASK)
                .title("å¾…åŠä»»åŠ¡é€šçŸ¥")
                .content(buildTaskNotificationContent(event))
                .recipients(event.getAssignees())
                .priority(event.getPriority())
                .templateCode("WORKFLOW_TASK_TEMPLATE")
                .templateData(buildTemplateData(event))
                .build();

            // 2. æ·»åŠ å·¥ä½œæµç›¸å…³æ•°æ®
            message.addMetadata("taskId", event.getTaskId());
            message.addMetadata("instanceId", event.getInstanceId());
            message.addMetadata("processDefinitionKey", event.getProcessDefinitionKey());

            // 3. å‘é€é€šçŸ¥
            sendMultiChannelNotification(message);

            // 4. å‘é€å®æ—¶WebSocketé€šçŸ¥
            sendRealtimeTaskNotification(event);

            log.info("å·¥ä½œæµä»»åŠ¡é€šçŸ¥å‘é€æˆåŠŸ: taskId={}, recipients={}",
                     event.getTaskId(), event.getAssignees().size());

        } catch (Exception e) {
            log.error("å·¥ä½œæµä»»åŠ¡é€šçŸ¥å‘é€å¤±è´¥: taskId={}", event.getTaskId(), e);
        }
    }

    /**
     * æ–‡æ¡£åˆ†äº«é€šçŸ¥
     */
    public void sendDocumentShareNotification(DocumentShareEvent event) {
        try {
            NotificationMessage message = NotificationMessage.builder()
                .messageType(NotificationMessageType.DOCUMENT_SHARE)
                .title("æ–‡æ¡£åˆ†äº«é€šçŸ¥")
                .content(buildDocumentShareContent(event))
                .recipients(event.getShareTargets())
                .priority(NotificationPriority.NORMAL)
                .build();

            // æ·»åŠ æ–‡æ¡£ç›¸å…³ä¿¡æ¯
            message.addMetadata("documentId", event.getDocumentId());
            message.addMetadata("documentName", event.getDocumentName());
            message.addMetadata("shareType", event.getShareType().name());
            message.addMetadata("sharerId", event.getSharerId());
            message.addMetadata("sharerName", event.getSharerName());

            sendMultiChannelNotification(message);

        } catch (Exception e) {
            log.error("æ–‡æ¡£åˆ†äº«é€šçŸ¥å‘é€å¤±è´¥: documentId={}", event.getDocumentId(), e);
        }
    }

    /**
     * å®æ—¶WebSocketé€šçŸ¥
     */
    private void sendRealtimeNotification(NotificationMessage message) {
        try {
            for (String recipient : message.getRecipients()) {
                WebSocketMessage wsMessage = WebSocketMessage.builder()
                    .type(WebSocketMessageType.NOTIFICATION)
                    .recipient(recipient)
                    .data(message)
                    .timestamp(LocalDateTime.now())
                    .build();

                webSocketService.sendToUser(recipient, wsMessage);
            }
        } catch (Exception e) {
            log.error("å®æ—¶é€šçŸ¥å‘é€å¤±è´¥: recipients={}", message.getRecipients(), e);
        }
    }
}
```

### **4. ä¼šè®®ç®¡ç†ç³»ç»Ÿ**
```java
@Service
@Slf4j
public class MeetingService {

    @Resource
    private MeetingRepository meetingRepository;

    @Resource
    private MeetingRoomService roomService;

    /**
     * ä¼šè®®å®‰æ’
     */
    public MeetingScheduleResult scheduleMeeting(MeetingScheduleForm form) {
        try {
            // 1. æ£€æŸ¥ä¼šè®®å®¤å¯ç”¨æ€§
            List<MeetingRoomEntity> availableRooms = checkRoomAvailability(
                form.getRoomId(), form.getStartTime(), form.getEndTime());

            if (availableRooms.isEmpty()) {
                return MeetingScheduleResult.error("ä¼šè®®å®¤åœ¨æŒ‡å®šæ—¶é—´ä¸å¯ç”¨");
            }

            // 2. æ£€æŸ¥å‚ä¸è€…å¯ç”¨æ€§
            List<Long> unavailableParticipants = checkParticipantAvailability(
                form.getParticipants(), form.getStartTime(), form.getEndTime());

            if (!unavailableParticipants.isEmpty()) {
                return MeetingScheduleResult.conflict("ä»¥ä¸‹å‚ä¸è€…æ—¶é—´å†²çª", unavailableParticipants);
            }

            // 3. åˆ›å»ºä¼šè®®
            MeetingEntity meeting = MeetingEntity.builder()
                .meetingId(generateMeetingId())
                .title(form.getTitle())
                .description(form.getDescription())
                .organizerId(getCurrentUserId())
                .organizerName(getCurrentUserName())
                .roomId(form.getRoomId())
                .startTime(form.getStartTime())
                .endTime(form.getEndTime())
                .participants(form.getParticipants())
                .status(MeetingStatus.SCHEDULED)
                .createTime(LocalDateTime.now())
                .build();

            meetingRepository.save(meeting);

            // 4. é”å®šä¼šè®®å®¤
            roomService.lockRoom(form.getRoomId(), meeting.getMeetingId(),
                                 form.getStartTime(), form.getEndTime());

            // 5. å‘é€ä¼šè®®é€šçŸ¥
            sendMeetingNotifications(meeting);

            // 6. ç¼“å­˜ä¼šè®®ä¿¡æ¯ï¼Œä½¿ç”¨æ­£å¸¸æ•°æ®ç±»å‹
            cacheService.set(CacheModule.OA, "meeting",
                "detail:" + meeting.getMeetingId(),
                meeting,
                BusinessDataType.NORMAL);

            log.info("ä¼šè®®å®‰æ’æˆåŠŸ: meetingId={}, title={}",
                     meeting.getMeetingId(), meeting.getTitle());

            return MeetingScheduleResult.builder()
                .meetingId(meeting.getMeetingId())
                .roomId(form.getRoomId())
                .participantCount(meeting.getParticipants().size())
                .build();

        } catch (Exception e) {
            log.error("ä¼šè®®å®‰æ’å¤±è´¥: title={}", form.getTitle(), e);
            throw new MeetingException("ä¼šè®®å®‰æ’å¤±è´¥: " + e.getMessage());
        }
    }

    /**
     * ä¼šè®®ç­¾åˆ°
     */
    public MeetingCheckInResult checkInMeeting(String meetingId, Long participantId) {
        try {
            // 1. éªŒè¯ä¼šè®®å­˜åœ¨ä¸”æœ‰æ•ˆ
            MeetingEntity meeting = getMeeting(meetingId);
            if (meeting == null || meeting.getStatus() != MeetingStatus.SCHEDULED) {
                return MeetingCheckInResult.error("ä¼šè®®ä¸å­˜åœ¨æˆ–å·²ç»“æŸ");
            }

            // 2. æ£€æŸ¥æ˜¯å¦ä¸ºä¼šè®®å‚ä¸è€…
            if (!meeting.getParticipants().contains(participantId)) {
                return MeetingCheckInResult.error("æ‚¨ä¸æ˜¯è¯¥ä¼šè®®çš„å‚ä¸è€…");
            }

            // 3. æ£€æŸ¥ç­¾åˆ°æ—¶é—´
            LocalDateTime now = LocalDateTime.now();
            if (now.isBefore(meeting.getStartTime().minusMinutes(15))) {
                return MeetingCheckInResult.error("ä¼šè®®å¼€å§‹å‰15åˆ†é’Ÿå†…æ‰èƒ½ç­¾åˆ°");
            }

            if (now.isAfter(meeting.getEndTime())) {
                return MeetingCheckInResult.error("ä¼šè®®å·²ç»“æŸ");
            }

            // 4. åˆ›å»ºç­¾åˆ°è®°å½•
            MeetingCheckInEntity checkIn = MeetingCheckInEntity.builder()
                .checkInId(generateCheckInId())
                .meetingId(meetingId)
                .participantId(participantId)
                .checkInTime(now)
                .checkInLocation(getCurrentLocation())
                .build();

            meetingCheckInRepository.save(checkIn);

            // 5. æ›´æ–°å‚ä¼šçŠ¶æ€
            updateParticipantAttendance(meetingId, participantId, true);

            return MeetingCheckInResult.builder()
                .checkInId(checkIn.getCheckInId())
                .meetingTitle(meeting.getTitle())
                .checkInTime(checkIn.getCheckInTime())
                .build();

        } catch (Exception e) {
            log.error("ä¼šè®®ç­¾åˆ°å¤±è´¥: meetingId={}, participantId={}", meetingId, participantId, e);
            throw new MeetingException("ä¼šè®®ç­¾åˆ°å¤±è´¥: " + e.getMessage());
        }
    }
}
```

---

## ğŸ”§ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### **æ–‡æ¡£ç¼“å­˜ä¼˜åŒ–**
```java
@Configuration
public class DocumentCacheConfig {

    @Bean
    public DocumentCacheManager cacheManager() {
        return DocumentCacheManager.builder()
            .documentCacheDuration(Duration.ofHours(2))
            .permissionCacheDuration(Duration.ofMinutes(30))
            .searchCacheDuration(Duration.ofMinutes(10))
            .build();
    }
}
```

### **å¼‚æ­¥å¤„ç†ä¼˜åŒ–**
```java
@Service
@Slf4j
public class AsyncNotificationService {

    @Async("notificationExecutor")
    public CompletableFuture<Void> sendAsyncNotifications(List<NotificationMessage> messages) {
        return CompletableFuture.runAsync(() -> {
            for (NotificationMessage message : messages) {
                try {
                    notificationService.sendMultiChannelNotification(message);
                } catch (Exception e) {
                    log.error("å¼‚æ­¥é€šçŸ¥å‘é€å¤±è´¥: messageId={}", message.getMessageId(), e);
                }
            }
        });
    }
}
```

---

## ğŸ“Š å…³é”®æ€§èƒ½æŒ‡æ ‡

### **æ€§èƒ½ç›®æ ‡**
- **æ–‡æ¡£ä¸Šä¼ **: â‰¤ 10ç§’ (10MBä»¥å†…)
- **æµç¨‹å¯åŠ¨**: â‰¤ 3ç§’
- **ä»»åŠ¡å®Œæˆ**: â‰¤ 2ç§’
- **æ¶ˆæ¯æ¨é€**: â‰¤ 1ç§’
- **æœç´¢å“åº”**: â‰¤ 500ms

### **è´¨é‡æŒ‡æ ‡**
- **ç³»ç»Ÿå¯ç”¨æ€§**: 99.9%
- **æ•°æ®ä¸€è‡´æ€§**: 99.99%
- **æ¶ˆæ¯é€è¾¾ç‡**: 99%
- **å®¡æ‰¹é€šè¿‡ç‡**: ç¬¦åˆä¸šåŠ¡è§„åˆ™

---

## ğŸ“š æŠ€èƒ½åº”ç”¨æŒ‡å—

### **ä½¿ç”¨æ—¶æœº**
- **OAç³»ç»Ÿå»ºè®¾**: è®¾è®¡å’Œéƒ¨ç½²ä¼ä¸šçº§OAåŠå…¬è‡ªåŠ¨åŒ–ç³»ç»Ÿ
- **å·¥ä½œæµé›†æˆ**: ä¸ç°æœ‰ä¸šåŠ¡ç³»ç»Ÿé›†æˆå·¥ä½œæµåŠŸèƒ½
- **æ–‡æ¡£åä½œ**: æ„å»ºä¼ä¸šçº§æ–‡æ¡£ç®¡ç†å’Œåä½œå¹³å°
- **ç§»åŠ¨åŠå…¬**: å¼€å‘å…¨åŠŸèƒ½ç§»åŠ¨ç«¯åŠå…¬åº”ç”¨

### **è°ƒç”¨æ–¹å¼**
```bash
# OAç³»ç»Ÿè®¾è®¡
Skill("oa-office-automation-specialist")

# å·¥ä½œæµé…ç½®
Skill("oa-office-automation-specialist")

# æ–‡æ¡£ç®¡ç†
Skill("oa-office-automation-specialist")
```

### **é¢„æœŸç»“æœ**
- **å®Œæ•´OAç³»ç»Ÿ**: æ”¯æŒå·¥ä½œæµã€æ–‡æ¡£ã€ä¼šè®®ç­‰æ ¸å¿ƒOAåŠŸèƒ½
- **æ™ºèƒ½å·¥ä½œæµ**: çµæ´»é…ç½®å’Œæ‰§è¡Œçš„å·¥ä½œæµå¼•æ“
- **é«˜æ•ˆåä½œ**: å¤šäººå®æ—¶åä½œç¼–è¾‘å’Œç‰ˆæœ¬æ§åˆ¶
- **ç§»åŠ¨ä¼˜å…ˆ**: å…¨åŠŸèƒ½ç§»åŠ¨ç«¯æ”¯æŒå’Œå®æ—¶é€šçŸ¥

---

**æŒæ¡æ­¤æŠ€èƒ½ï¼Œæ‚¨å°†æˆä¸ºä¼ä¸šçº§OAåŠå…¬è‡ªåŠ¨åŒ–ç³»ç»Ÿçš„æŠ€æœ¯ä¸“å®¶ï¼Œèƒ½å¤Ÿè®¾è®¡å’Œå®ç°åŠŸèƒ½å®Œæ•´ã€æ€§èƒ½ä¼˜ç§€çš„åŠå…¬è‡ªåŠ¨åŒ–è§£å†³æ–¹æ¡ˆã€‚**
