# ============================================================================
# Druid Wall防火墙配置文件
# ============================================================================
# 版本: 1.0.0
# 创建时间: 2025-12-26
# 用途: 防止SQL注入，规范SQL语句
# ============================================================================

# ==================== 基础配置 ====================
# 是否允许执行多条SQL（批量操作）
wall.multiStatementAllow=true

# 是否允许SQL注释
wall.commentAllow=true

# ==================== DDL权限控制 ====================
# 允许CREATE操作（根据业务需求配置）
# 建议生产环境关闭，只允许在管理后台使用
wall.createTableAllow=false
wall.dropTableAllow=false
wall.alterTableAllow=false

# ==================== DML权限控制 ====================
# 允许SELECT操作
wall.selectAllow=true

# 允许INSERT操作
wall.insertAllow=true

# 允许UPDATE操作
wall.updateAllow=true

# 允许DELETE操作
wall.deleteAllow=true

# ==================== 高风险SQL控制 ====================
# 禁止truncate（生产环境推荐）
wall.truncateAllow=false

# 禁止create index（生产环境推荐）
wall.createIndexAllow=false

# 禁止drop index（生产环境推荐）
wall.dropIndexAllow=false

# ==================== 其他操作控制 ====================
# 允许事务控制语句
wall.commitAllow=true
wall.rollbackAllow=true

# 允许SET操作（用于设置会话变量）
wall.setAllow=true

# 允许SHOW操作
wall.showAllow=true

# ==================== SQL注入防护 ====================
# 检测SQL注入
wall.selectIntoAllow=false

# 禁止MySQL特定命令（根据需要配置）
# wall.mysqlAllow=false

# ==================== 条件表达式限制 ====================
# 禁止WHERE条件为永真（防止SQL注入）
# wall.conditionAndAlway=true
# wall.conditionAndOr=true

# ==================== 函数限制 ====================
# 允许的函数列表（根据业务需求配置）
# 白名单模式更安全
# wall.functionWhiteList=NOW,SYSDATE,CURRENT_TIMESTAMP,DATE_FORMAT

# 禁止的函数列表（黑名单模式）
# wall.functionBlackList=EVAL,EXEC,SLEEP

# ==================== 对象名称检查 ====================
# 表名最小长度（防止单字母表名等异常）
# wall.tableNameMaxLength=64

# 检查表名是否包含关键字
# wall.checkTableUpperCase=false

# ============================================================================
# 生产环境安全建议
# ============================================================================
#
# 1. 禁用DDL操作（CREATE/ALTER/DROP TABLE）
# 2. 禁用TRUNCATE操作
# 3. 禁用高危函数（SLEEP, EVAL, EXEC）
# 4. 限制批量SQL操作数量
# 5. 启用SQL语句日志记录
# 6. 定期审计Wall拦截日志
#
# ============================================================================
