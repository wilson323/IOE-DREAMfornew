<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>补贴管理 - 消费管理系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="../js/menu.js" defer></script>
    <link rel="stylesheet" href="../css/main.css">
    <style>
        .content-card {
            background: white;
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
            margin-bottom: var(--space-lg);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-lg);
        }

        .stat-card {
            text-align: center;
            padding: var(--space-xl);
            background: var(--gray-50);
            border-radius: var(--radius-lg);
        }

        .stat-value {
            font-size: var(--text-2xl);
            font-weight: 700;
            color: var(--gray-900);
        }

        .stat-label {
            color: var(--gray-600);
            font-size: var(--text-sm);
            margin-top: var(--space-xs);
        }

        .tab-nav {
            display: flex;
            gap: var(--space-md);
            border-bottom: 2px solid var(--gray-200);
            margin-bottom: var(--space-xl);
        }

        .tab-btn {
            padding: var(--space-md) var(--space-lg);
            background: none;
            border: none;
            border-bottom: 2px solid transparent;
            color: var(--gray-600);
            cursor: pointer;
            font-weight: 500;
            transition: all var(--transition);
            margin-bottom: -2px;
        }

        .tab-btn:hover {
            color: var(--primary-600);
        }

        .tab-btn.active {
            color: var(--primary-600);
            border-bottom-color: var(--primary-600);
        }

        .tab-badge {
            display: inline-block;
            margin-left: var(--space-xs);
            padding: 2px 8px;
            background: var(--error-light);
            color: var(--error);
            border-radius: var(--radius-full);
            font-size: var(--text-xs);
            font-weight: 600;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
        }

        .data-table th {
            background: var(--gray-50);
            padding: var(--space-md);
            text-align: left;
            font-weight: 600;
            color: var(--gray-700);
            font-size: var(--text-sm);
            border-bottom: 1px solid var(--gray-200);
        }

        .data-table td {
            padding: var(--space-md);
            border-bottom: 1px solid var(--gray-100);
            font-size: var(--text-sm);
        }

        .data-table tr:hover {
            background: var(--gray-50);
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--space-xs);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius);
            font-size: var(--text-xs);
            font-weight: 500;
        }

        .status-pending {
            background: var(--warning-light);
            color: var(--warning);
        }

        .status-approved {
            background: var(--success-light);
            color: var(--success);
        }

        .status-rejected {
            background: var(--error-light);
            color: var(--error);
        }

        .action-buttons {
            display: flex;
            gap: var(--space-xs);
        }

        .btn-small {
            padding: var(--space-xs) var(--space-sm);
            font-size: var(--text-xs);
        }

        .toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            flex-wrap: wrap;
            gap: var(--space-md);
        }

        .toolbar-left {
            display: flex;
            gap: var(--space-sm);
            align-items: center;
        }

        .toolbar-right {
            display: flex;
            gap: var(--space-sm);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- 侧边栏 -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <i class="fas fa-utensils fa-lg"></i>
                <div>
                    <div class="sidebar-title">消费管理系统</div>
                    <div class="sidebar-subtitle">Consumption Hub</div>
                </div>
            </div>
            <div class="sidebar-menu">
                <!-- 菜单将由 menu.js 自动生成 -->
            </div>
        </nav>

        <!-- 主内容区域 -->
        <main class="main-content">
            <!-- 顶部导航栏 -->
            <header class="header">
                <h1>补贴管理</h1>
                <div class="header-actions">
                    <button class="btn btn-outline">
                        <i class="fas fa-bell"></i>
                        通知
                    </button>
                    <div class="user-info">
                        <div>
                            <div style="font-weight: 600;">系统管理员</div>
                            <div style="font-size: 12px; color: var(--gray-500);">在线</div>
                        </div>
                        <div class="user-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                    </div>
                </div>
            </header>

            <!-- 主要内容 -->
            <div class="content">
                <!-- 补贴统计 -->
                <section class="content-card">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-value">¥28,500</div>
                            <div class="stat-label">本月发放</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">1,248</div>
                            <div class="stat-label">受益人数</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value">¥22.8</div>
                            <div class="stat-label">人均补贴</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-value" style="color: var(--warning);">45</div>
                            <div class="stat-label">待审批</div>
                        </div>
                    </div>
                </section>

                <!-- 补贴列表 -->
                <section class="content-card">
                    <!-- Tab导航 -->
                    <div class="tab-nav">
                        <button class="tab-btn active" onclick="switchTab('pending')">
                            待审批
                            <span class="tab-badge">45</span>
                        </button>
                        <button class="tab-btn" onclick="switchTab('approved')">
                            已审批
                        </button>
                        <button class="tab-btn" onclick="switchTab('all')">
                            全部记录
                        </button>
                    </div>

                    <!-- 工具栏 -->
                    <div class="toolbar">
                        <div class="toolbar-left">
                            <input type="checkbox" id="selectAll" onchange="toggleSelectAll()">
                            <label for="selectAll" style="cursor: pointer; user-select: none;">全选</label>
                            <button class="btn btn-sm btn-primary" onclick="batchApprove()" id="batchApproveBtn" disabled>
                                <i class="fas fa-check"></i>
                                批量通过
                            </button>
                            <button class="btn btn-sm btn-outline" onclick="batchReject()" id="batchRejectBtn" disabled>
                                <i class="fas fa-times"></i>
                                批量拒绝
                            </button>
                        </div>
                        <div class="toolbar-right">
                            <button class="btn btn-primary" onclick="addSubsidy()">
                                <i class="fas fa-plus"></i>
                                发放补贴
                            </button>
                            <button class="btn btn-outline">
                                <i class="fas fa-download"></i>
                                导出
                            </button>
                        </div>
                    </div>

                    <!-- 数据表格 -->
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th style="width: 40px;">
                                    <input type="checkbox" style="display: none;">
                                </th>
                                <th>补贴批次</th>
                                <th>补贴类型</th>
                                <th>发放人数</th>
                                <th>总金额</th>
                                <th>申请人</th>
                                <th>申请时间</th>
                                <th>审批状态</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="subsidyTableBody">
                            <!-- 待审批记录 -->
                            <tr>
                                <td><input type="checkbox" class="subsidy-checkbox" value="1"></td>
                                <td><strong>BT202401001</strong></td>
                                <td>餐补</td>
                                <td>156人</td>
                                <td><strong style="color: var(--primary-600);">¥3,120.00</strong></td>
                                <td>张三</td>
                                <td>2024-03-15 14:30</td>
                                <td>
                                    <span class="status-badge status-pending">
                                        <i class="fas fa-clock"></i>
                                        待审批
                                    </span>
                                </td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn btn-sm btn-primary" onclick="approveSubsidy(1)">
                                            <i class="fas fa-check"></i>
                                            通过
                                        </button>
                                        <button class="btn btn-sm btn-outline" onclick="rejectSubsidy(1)">
                                            <i class="fas fa-times"></i>
                                            拒绝
                                        </button>
                                        <button class="btn btn-sm btn-outline" onclick="viewDetail(1)">
                                            <i class="fas fa-eye"></i>
                                            详情
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" class="subsidy-checkbox" value="2"></td>
                                <td><strong>BT202401002</strong></td>
                                <td>交通补贴</td>
                                <td>89人</td>
                                <td><strong style="color: var(--primary-600);">¥2,670.00</strong></td>
                                <td>李四</td>
                                <td>2024-03-15 10:20</td>
                                <td>
                                    <span class="status-badge status-pending">
                                        <i class="fas fa-clock"></i>
                                        待审批
                                    </span>
                                </td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn btn-sm btn-primary" onclick="approveSubsidy(2)">
                                            <i class="fas fa-check"></i>
                                            通过
                                        </button>
                                        <button class="btn btn-sm btn-outline" onclick="rejectSubsidy(2)">
                                            <i class="fas fa-times"></i>
                                            拒绝
                                        </button>
                                        <button class="btn btn-sm btn-outline" onclick="viewDetail(2)">
                                            <i class="fas fa-eye"></i>
                                            详情
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td><input type="checkbox" class="subsidy-checkbox" value="3"></td>
                                <td><strong>BT202401003</strong></td>
                                <td>生活补贴</td>
                                <td>234人</td>
                                <td><strong style="color: var(--primary-600);">¥7,020.00</strong></td>
                                <td>王五</td>
                                <td>2024-03-14 16:45</td>
                                <td>
                                    <span class="status-badge status-pending">
                                        <i class="fas fa-clock"></i>
                                        待审批
                                    </span>
                                </td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn btn-sm btn-primary" onclick="approveSubsidy(3)">
                                            <i class="fas fa-check"></i>
                                            通过
                                        </button>
                                        <button class="btn btn-sm btn-outline" onclick="rejectSubsidy(3)">
                                            <i class="fas fa-times"></i>
                                            拒绝
                                        </button>
                                        <button class="btn btn-sm btn-outline" onclick="viewDetail(3)">
                                            <i class="fas fa-eye"></i>
                                            详情
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </section>
            </div>
        </main>
    </div>

    <script>
        // 页面初始化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('补贴管理页面加载完成');
            updateBatchButtons();
        });

        // 切换Tab
        function switchTab(tab) {
            // 更新Tab样式
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // 这里可以根据tab加载不同的数据
            console.log('切换到:', tab);
            // 实际应用中，这里应该调用API加载对应的数据
        }

        // 全选/取消全选
        function toggleSelectAll() {
            const selectAll = document.getElementById('selectAll');
            const checkboxes = document.querySelectorAll('.subsidy-checkbox');
            
            checkboxes.forEach(checkbox => {
                checkbox.checked = selectAll.checked;
            });
            
            updateBatchButtons();
        }

        // 更新批量操作按钮状态
        function updateBatchButtons() {
            const checkedBoxes = document.querySelectorAll('.subsidy-checkbox:checked');
            const batchApproveBtn = document.getElementById('batchApproveBtn');
            const batchRejectBtn = document.getElementById('batchRejectBtn');
            
            if (checkedBoxes.length > 0) {
                batchApproveBtn.disabled = false;
                batchRejectBtn.disabled = false;
            } else {
                batchApproveBtn.disabled = true;
                batchRejectBtn.disabled = true;
            }
        }

        // 监听复选框变化
        document.addEventListener('change', function(e) {
            if (e.target.classList.contains('subsidy-checkbox')) {
                updateBatchButtons();
            }
        });

        // 批量通过
        function batchApprove() {
            const checkedBoxes = Array.from(document.querySelectorAll('.subsidy-checkbox:checked'));
            const ids = checkedBoxes.map(cb => cb.value);
            
            if (confirm(`确定要通过选中的 ${ids.length} 条补贴申请吗？`)) {
                console.log('批量通过:', ids);
                alert('补贴已批准并开始发放！');
                // 实际应用中，这里应该调用API
                // 刷新列表
            }
        }

        // 批量拒绝
        function batchReject() {
            const checkedBoxes = Array.from(document.querySelectorAll('.subsidy-checkbox:checked'));
            const ids = checkedBoxes.map(cb => cb.value);
            
            if (confirm(`确定要拒绝选中的 ${ids.length} 条补贴申请吗？`)) {
                const reason = prompt('请输入拒绝原因：');
                if (reason) {
                    console.log('批量拒绝:', ids, '原因:', reason);
                    alert('补贴申请已拒绝！');
                    // 实际应用中，这里应该调用API
                }
            }
        }

        // 单个审批通过
        function approveSubsidy(id) {
            if (confirm('确定要通过这条补贴申请吗？')) {
                console.log('审批通过:', id);
                alert('补贴已批准并开始发放！');
                // 实际应用中，这里应该调用API
            }
        }

        // 单个审批拒绝
        function rejectSubsidy(id) {
            const reason = prompt('请输入拒绝原因：');
            if (reason) {
                console.log('审批拒绝:', id, '原因:', reason);
                alert('补贴申请已拒绝！');
                // 实际应用中，这里应该调用API
            }
        }

        // 查看详情
        function viewDetail(id) {
            console.log('查看详情:', id);
            alert('查看补贴详情功能开发中...');
            // 实际应用中，这里应该打开详情弹窗或跳转到详情页
        }

        // 发放补贴
        function addSubsidy() {
            console.log('发放补贴');
            alert('发放补贴功能开发中...');
            // 实际应用中，这里应该打开发放补贴的表单
        }
    </script>
</body>
</html>
