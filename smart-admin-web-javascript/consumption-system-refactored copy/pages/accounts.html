<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è´¦æˆ·ç±»åˆ«ç®¡ç† - æ¶ˆè´¹ç®¡ç†ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="../js/menu.js" defer></script>
    <link rel="stylesheet" href="../css/main.css">

    <style>
        /* é¡µé¢ç‰¹å®šæ ·å¼ */
        .accounts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-2xl);
        }

        .account-card {
            background: white;
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
            transition: all var(--transition);
            position: relative;
            overflow: hidden;
        }

        .account-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-500), var(--primary-600));
        }

        .account-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .account-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-md);
        }

        .account-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-md);
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: var(--text-lg);
            flex-shrink: 0;
        }

        .account-title {
            font-size: var(--text-base);
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 2px;
        }

        .account-code {
            color: var(--gray-500);
            font-size: var(--text-xs);
        }

        .account-stat {
            text-align: center;
            padding: var(--space-md);
            background: var(--gray-50);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-md);
        }

        .account-stat-value {
            font-size: var(--text-xl);
            font-weight: 700;
            color: var(--primary-600);
        }

        .account-stat-label {
            color: var(--gray-600);
            font-size: var(--text-xs);
            margin-top: var(--space-xs);
        }

        .account-actions {
            display: flex;
            gap: var(--space-xs);
        }

        .btn-sm {
            padding: var(--space-xs) var(--space-sm);
            font-size: var(--text-xs);
            flex: 1;
        }

        /* æŠ½å±‰æ ·å¼ */
        .drawer-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .drawer-overlay.show {
            display: block;
            opacity: 1;
        }

        .drawer {
            position: fixed;
            top: 0;
            right: -600px;
            width: 600px;
            max-width: 90vw;
            height: 100vh;
            background: white;
            box-shadow: var(--shadow-xl);
            z-index: 1001;
            display: flex;
            flex-direction: column;
            transition: right 0.3s ease;
        }

        .drawer.show {
            right: 0;
        }

        .drawer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-xl);
            border-bottom: 1px solid var(--gray-200);
            background: var(--gray-50);
        }

        .drawer-title {
            font-size: var(--text-xl);
            font-weight: 600;
            color: var(--gray-900);
        }

        .drawer-close {
            background: none;
            border: none;
            font-size: var(--text-xl);
            color: var(--gray-500);
            cursor: pointer;
            padding: var(--space-xs);
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-md);
            transition: all var(--transition);
        }

        .drawer-close:hover {
            background: var(--gray-200);
            color: var(--gray-900);
        }

        .drawer-body {
            flex: 1;
            overflow-y: auto;
            padding: var(--space-xl);
        }

        .drawer-footer {
            padding: var(--space-xl);
            border-top: 1px solid var(--gray-200);
            background: var(--gray-50);
            display: flex;
            gap: var(--space-sm);
            justify-content: flex-end;
        }

        .form-section {
            margin-bottom: var(--space-2xl);
            padding-bottom: var(--space-xl);
            border-bottom: 1px solid var(--gray-200);
        }

        .form-section:last-child {
            border-bottom: none;
        }

        .form-section-title {
            font-size: var(--text-lg);
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: var(--space-lg);
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .form-section-title i {
            color: var(--primary-500);
        }

        .form-group {
            margin-bottom: var(--space-lg);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
        }

        .form-label {
            display: block;
            margin-bottom: var(--space-xs);
            font-weight: 500;
            color: var(--gray-700);
            font-size: var(--text-sm);
        }

        .form-label .required {
            color: var(--error);
            margin-left: 2px;
        }

        .form-input, .form-select, .form-textarea {
            width: 100%;
            padding: var(--space-sm) var(--space-md);
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            transition: all var(--transition);
        }

        .form-textarea {
            min-height: 80px;
            resize: vertical;
        }

        .form-input:focus, .form-select:focus, .form-textarea:focus {
            outline: none;
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px var(--primary-100);
        }

        .form-hint {
            font-size: var(--text-xs);
            color: var(--gray-500);
            margin-top: var(--space-xs);
        }

        /* åŒºåŸŸé¤åˆ«é€‰æ‹© */
        .region-selector {
            border: 1px solid var(--gray-200);
            border-radius: var(--radius-lg);
            overflow: hidden;
        }

        .region-item {
            border-bottom: 1px solid var(--gray-200);
        }

        .region-item:last-child {
            border-bottom: none;
        }

        .region-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-md);
            cursor: pointer;
            transition: background var(--transition);
            background: var(--gray-50);
        }

        .region-header:hover {
            background: var(--gray-100);
        }

        .region-header-left {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            flex: 1;
        }

        .region-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .region-name {
            font-weight: 600;
            color: var(--gray-900);
            font-size: var(--text-base);
            flex: 1;
        }

        .region-count {
            font-size: var(--text-xs);
            color: var(--gray-500);
            margin-left: var(--space-xs);
        }

        .region-toggle {
            color: var(--gray-400);
            transition: transform var(--transition);
            margin-left: var(--space-sm);
        }

        .region-item.expanded .region-toggle {
            transform: rotate(180deg);
        }

        .sub-regions-list {
            display: none;
            background: white;
        }

        .region-item.expanded .sub-regions-list {
            display: block;
        }

        /* äºŒçº§ï¼šæ¶ˆè´¹åŒºåŸŸ/æ¡£å£ */
        .sub-region-item {
            border-bottom: 1px solid var(--gray-100);
        }

        .sub-region-item:last-child {
            border-bottom: none;
        }

        .sub-region-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-sm) var(--space-md) var(--space-sm) var(--space-xl);
            cursor: pointer;
            transition: background var(--transition);
        }

        .sub-region-header:hover {
            background: var(--gray-50);
        }

        .sub-region-header-left {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            flex: 1;
        }

        .sub-region-checkbox {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        .sub-region-name {
            font-weight: 500;
            color: var(--gray-800);
            font-size: var(--text-sm);
            flex: 1;
        }

        .sub-region-count {
            font-size: var(--text-xs);
            color: var(--gray-500);
            margin-left: var(--space-xs);
        }

        .sub-region-toggle {
            color: var(--gray-400);
            font-size: var(--text-xs);
            transition: transform var(--transition);
            margin-left: var(--space-sm);
        }

        .sub-region-item.expanded .sub-region-toggle {
            transform: rotate(180deg);
        }

        /* ä¸‰çº§ï¼šé¤åˆ« */
        .meals-list {
            display: none;
            padding: var(--space-sm) var(--space-md) var(--space-sm) calc(var(--space-xl) + var(--space-lg));
            background: var(--gray-50);
        }

        .sub-region-item.expanded .meals-list {
            display: block;
        }

        .meal-checkbox {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-xs) 0;
        }

        .meal-checkbox input[type="checkbox"] {
            width: 16px;
            height: 16px;
            cursor: pointer;
        }

        .meal-checkbox label {
            cursor: pointer;
            font-size: var(--text-sm);
            color: var(--gray-700);
        }

        .selected-meals {
            margin-top: var(--space-md);
            padding: var(--space-md);
            background: var(--gray-50);
            border-radius: var(--radius-md);
            min-height: 40px;
        }

        .meal-tag {
            display: inline-flex;
            align-items: center;
            gap: var(--space-xs);
            padding: var(--space-xs) var(--space-sm);
            background: var(--primary-100);
            color: var(--primary-700);
            border-radius: var(--radius);
            font-size: var(--text-xs);
            margin: var(--space-xs);
        }

        .meal-tag-remove {
            cursor: pointer;
            color: var(--primary-500);
        }

        .meal-tag-remove:hover {
            color: var(--primary-700);
        }

        .actions-bar {
            background: white;
            border-radius: var(--radius-xl);
            padding: var(--space-xl);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--gray-200);
            margin-bottom: var(--space-xl);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .actions-title {
            font-size: var(--text-lg);
            font-weight: 600;
            color: var(--gray-900);
        }

        @media (max-width: 768px) {
            .accounts-grid {
                grid-template-columns: 1fr;
            }

            .actions-bar {
                flex-direction: column;
                gap: var(--space-lg);
                align-items: stretch;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- ä¾§è¾¹æ  -->
        <nav class="sidebar">
            <div class="sidebar-header">
                <i class="fas fa-utensils fa-lg"></i>
                <div>
                    <div class="sidebar-title">æ¶ˆè´¹ç®¡ç†ç³»ç»Ÿ</div>
                    <div class="sidebar-subtitle">Consumption Hub</div>
                </div>
            </div>
            <div class="sidebar-menu">
                <!-- èœå•å°†ç”± menu.js è‡ªåŠ¨ç”Ÿæˆ -->
            </div>
        </nav>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="main-content">
            <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
            <header class="header">
                <h1>è´¦æˆ·ç±»åˆ«ç®¡ç†</h1>
                <div class="header-actions">
                    <button class="btn btn-outline">
                        <i class="fas fa-bell"></i>
                        é€šçŸ¥
                    </button>
                    <div class="user-info">
                        <div>
                            <div style="font-weight: 600;">ç³»ç»Ÿç®¡ç†å‘˜</div>
                            <div style="font-size: 12px; color: var(--gray-500);">åœ¨çº¿</div>
                        </div>
                        <div class="user-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                    </div>
                </div>
            </header>

            <!-- ä¸»è¦å†…å®¹ -->
            <div class="content">
                <!-- æ“ä½œæ  -->
                <section class="actions-bar">
                    <div>
                        <h2 class="actions-title">è´¦æˆ·ç±»åˆ«åˆ—è¡¨</h2>
                        <p style="color: var(--gray-600); margin-top: var(--space-xs);">å…± 5 ä¸ªè´¦æˆ·ç±»åˆ«</p>
                    </div>
                    <button class="btn btn-primary" onclick="openModal()">
                        <i class="fas fa-plus"></i>
                        æ–°å¢ç±»åˆ«
                    </button>
                </section>

                <!-- è´¦æˆ·ç±»åˆ«ç½‘æ ¼ -->
                <section class="accounts-grid">
                    <div class="account-card">
                        <div class="account-header">
                            <div>
                                <h3 class="account-title">å‘˜å·¥è´¦æˆ·</h3>
                                <div class="account-code">EMP001</div>
                            </div>
                            <div class="account-icon">
                                <i class="fas fa-user-tie"></i>
                            </div>
                        </div>
                        <div class="account-stat">
                            <div class="account-stat-value">1,248</div>
                            <div class="account-stat-label">ç”¨æˆ·æ•°é‡</div>
                        </div>
                        <div class="account-actions">
                            <button class="btn btn-secondary btn-sm" onclick="openModal('edit', 'å‘˜å·¥è´¦æˆ·', 'EMP001', 'fas fa-user-tie', '#3b82f6')">
                                <i class="fas fa-edit"></i>
                                ç¼–è¾‘
                            </button>
                        </div>
                    </div>

                    <div class="account-card">
                        <div class="account-header">
                            <div>
                                <h3 class="account-title">ä¸´æ—¶è´¦æˆ·</h3>
                                <div class="account-code">TEMP001</div>
                            </div>
                            <div class="account-icon" style="background: linear-gradient(135deg, var(--warning), #d97706);">
                                <i class="fas fa-user-clock"></i>
                            </div>
                        </div>
                        <div class="account-stat">
                            <div class="account-stat-value">86</div>
                            <div class="account-stat-label">ç”¨æˆ·æ•°é‡</div>
                        </div>
                        <div class="account-actions">
                            <button class="btn btn-secondary btn-sm" onclick="openModal('edit', 'ä¸´æ—¶è´¦æˆ·', 'TEMP001', 'fas fa-user-clock', '#f59e0b')">
                                <i class="fas fa-edit"></i>
                                ç¼–è¾‘
                            </button>
                        </div>
                    </div>

                    <div class="account-card">
                        <div class="account-header">
                            <div>
                                <h3 class="account-title">ç®¡ç†å‘˜è´¦æˆ·</h3>
                                <div class="account-code">ADMIN001</div>
                            </div>
                            <div class="account-icon" style="background: linear-gradient(135deg, var(--error), #dc2626);">
                                <i class="fas fa-user-shield"></i>
                            </div>
                        </div>
                        <div class="account-stat">
                            <div class="account-stat-value">12</div>
                            <div class="account-stat-label">ç”¨æˆ·æ•°é‡</div>
                        </div>
                        <div class="account-actions">
                            <button class="btn btn-secondary btn-sm" onclick="openModal('edit', 'ç®¡ç†å‘˜è´¦æˆ·', 'ADMIN001', 'fas fa-user-shield', '#ef4444')">
                                <i class="fas fa-edit"></i>
                                ç¼–è¾‘
                            </button>
                        </div>
                    </div>

                    <div class="account-card">
                        <div class="account-header">
                            <div>
                                <h3 class="account-title">è®¿å®¢è´¦æˆ·</h3>
                                <div class="account-code">VISITOR001</div>
                            </div>
                            <div class="account-icon" style="background: linear-gradient(135deg, var(--success), #16a34a);">
                                <i class="fas fa-user-tag"></i>
                            </div>
                        </div>
                        <div class="account-stat">
                            <div class="account-stat-value">245</div>
                            <div class="account-stat-label">ç”¨æˆ·æ•°é‡</div>
                        </div>
                        <div class="account-actions">
                            <button class="btn btn-secondary btn-sm" onclick="openModal('edit', 'è®¿å®¢è´¦æˆ·', 'VISITOR001', 'fas fa-user-tag', '#22c55e')">
                                <i class="fas fa-edit"></i>
                                ç¼–è¾‘
                            </button>
                        </div>
                    </div>

                    <div class="account-card">
                        <div class="account-header">
                            <div>
                                <h3 class="account-title">å­¦ç”Ÿè´¦æˆ·</h3>
                                <div class="account-code">STUDENT001</div>
                            </div>
                            <div class="account-icon" style="background: linear-gradient(135deg, var(--info), #2563eb);">
                                <i class="fas fa-graduation-cap"></i>
                            </div>
                        </div>
                        <div class="account-stat">
                            <div class="account-stat-value">3,856</div>
                            <div class="account-stat-label">ç”¨æˆ·æ•°é‡</div>
                        </div>
                        <div class="account-actions">
                            <button class="btn btn-secondary btn-sm" onclick="openModal('edit', 'å­¦ç”Ÿè´¦æˆ·', 'STUDENT001', 'fas fa-graduation-cap', '#3b82f6')">
                                <i class="fas fa-edit"></i>
                                ç¼–è¾‘
                            </button>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- é®ç½©å±‚ -->
    <div class="drawer-overlay" id="drawerOverlay" onclick="closeDrawer()"></div>

    <!-- å³ä¾§æŠ½å±‰ -->
    <div class="drawer" id="accountDrawer">
        <div class="drawer-header">
            <h3 class="drawer-title" id="drawerTitle">æ–°å¢è´¦æˆ·ç±»åˆ«</h3>
            <button class="drawer-close" onclick="closeDrawer()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="drawer-body">
            <form id="accountForm">
                <!-- åŸºæœ¬ä¿¡æ¯ -->
                <div class="form-section">
                    <h4 class="form-section-title">
                        <i class="fas fa-info-circle"></i>
                        åŸºæœ¬ä¿¡æ¯
                    </h4>
                    
                    <div class="form-group">
                        <label class="form-label">ç±»åˆ«åç§° <span class="required">*</span></label>
                        <input type="text" class="form-input" id="accountName" placeholder="ä¾‹å¦‚ï¼šå‘˜å·¥è´¦æˆ·" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">ç±»åˆ«ç¼–å· <span class="required">*</span></label>
                        <input type="text" class="form-input" id="accountCode" placeholder="ä¾‹å¦‚ï¼šEMP001" required>
                        <div class="form-hint">ç±»åˆ«ç¼–å·å¿…é¡»å”¯ä¸€ï¼Œå»ºè®®ä½¿ç”¨è‹±æ–‡å­—æ¯+æ•°å­—ç»„åˆ</div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">å›¾æ ‡é€‰æ‹© <span class="required">*</span></label>
                            <select class="form-select" id="accountIcon" required>
                                <option value="fas fa-user-tie">ç”¨æˆ·è¥¿è£…</option>
                                <option value="fas fa-user-clock">ç”¨æˆ·æ—¶é’Ÿ</option>
                                <option value="fas fa-user-shield">ç”¨æˆ·ç›¾ç‰Œ</option>
                                <option value="fas fa-user-tag">ç”¨æˆ·æ ‡ç­¾</option>
                                <option value="fas fa-graduation-cap">æ¯•ä¸šå¸½</option>
                                <option value="fas fa-user">æ™®é€šç”¨æˆ·</option>
                                <option value="fas fa-users">ç”¨æˆ·ç»„</option>
                                <option value="fas fa-user-cog">ç”¨æˆ·è®¾ç½®</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label class="form-label">å›¾æ ‡é¢œè‰² <span class="required">*</span></label>
                            <select class="form-select" id="accountColor" required>
                                <option value="#3b82f6">è“è‰²</option>
                                <option value="#22c55e">ç»¿è‰²</option>
                                <option value="#f59e0b">æ©™è‰²</option>
                                <option value="#ef4444">çº¢è‰²</option>
                                <option value="#8b5cf6">ç´«è‰²</option>
                                <option value="#06b6d4">é’è‰²</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">æè¿°è¯´æ˜</label>
                        <textarea class="form-textarea" id="accountDescription" placeholder="è¾“å…¥è¯¥ç±»åˆ«çš„æè¿°è¯´æ˜"></textarea>
                    </div>
                </div>

                <!-- æ¶ˆè´¹é™é¢ -->
                <div class="form-section">
                    <h4 class="form-section-title">
                        <i class="fas fa-wallet"></i>
                        æ¶ˆè´¹é™é¢è®¾ç½®
                    </h4>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">æ—¥æ¶ˆè´¹é™é¢</label>
                            <input type="number" class="form-input" id="dailyLimit" placeholder="0.00" step="0.01" min="0">
                            <div class="form-hint">å•ä½ï¼šå…ƒï¼Œ0 è¡¨ç¤ºä¸é™åˆ¶</div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">æœˆæ¶ˆè´¹é™é¢</label>
                            <input type="number" class="form-input" id="monthlyLimit" placeholder="0.00" step="0.01" min="0">
                            <div class="form-hint">å•ä½ï¼šå…ƒï¼Œ0 è¡¨ç¤ºä¸é™åˆ¶</div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">å•ç¬”æœ€å°é‡‘é¢</label>
                            <input type="number" class="form-input" id="minAmount" placeholder="0.00" step="0.01" min="0">
                            <div class="form-hint">å•ä½ï¼šå…ƒ</div>
                        </div>

                        <div class="form-group">
                            <label class="form-label">å•ç¬”æœ€å¤§é‡‘é¢</label>
                            <input type="number" class="form-input" id="maxAmount" placeholder="0.00" step="0.01" min="0">
                            <div class="form-hint">å•ä½ï¼šå…ƒï¼Œ0 è¡¨ç¤ºä¸é™åˆ¶</div>
                        </div>
                    </div>
                </div>

                <!-- åŒºåŸŸé¤åˆ«æƒé™ -->
                <div class="form-section">
                    <h4 class="form-section-title">
                        <i class="fas fa-map-marked-alt"></i>
                        åŒºåŸŸé¤åˆ«æƒé™
                    </h4>

                    <div class="form-group">
                        <label class="form-label">é€‰æ‹©å¯ç”¨åŒºåŸŸå’Œé¤åˆ«</label>
                        <div class="region-selector">
                            <!-- ç¬¬ä¸€é£Ÿå ‚ -->
                            <div class="region-item" data-region="canteen1">
                                <div class="region-header">
                                    <div class="region-header-left" onclick="toggleRegion(this)">
                                        <input type="checkbox" class="region-checkbox" onclick="event.stopPropagation(); toggleRegionAll(this)">
                                        <span class="region-name">ğŸ¢ ç¬¬ä¸€é£Ÿå ‚<span class="region-count" id="count-canteen1"></span></span>
                                    </div>
                                    <i class="fas fa-chevron-down region-toggle" onclick="toggleRegion(this)"></i>
                                </div>
                                <div class="sub-regions-list">
                                    <!-- ä¸€æ¥¼ä¸»é£ŸåŒº -->
                                    <div class="sub-region-item" data-sub-region="canteen1-floor1">
                                        <div class="sub-region-header">
                                            <div class="sub-region-header-left" onclick="toggleSubRegion(this)">
                                                <input type="checkbox" class="sub-region-checkbox" onclick="event.stopPropagation(); toggleSubRegionAll(this)">
                                                <span class="sub-region-name">ä¸€æ¥¼ä¸»é£ŸåŒº<span class="sub-region-count" id="count-canteen1-floor1"></span></span>
                                            </div>
                                            <i class="fas fa-chevron-down sub-region-toggle" onclick="toggleSubRegion(this)"></i>
                                        </div>
                                        <div class="meals-list">
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-c1-f1-breakfast" value="canteen1-floor1-breakfast" onchange="updateSelectedMeals()">
                                                <label for="meal-c1-f1-breakfast">æ—©é¤ (07:00-09:00)</label>
                                            </div>
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-c1-f1-lunch" value="canteen1-floor1-lunch" onchange="updateSelectedMeals()">
                                                <label for="meal-c1-f1-lunch">åˆé¤ (11:30-13:30)</label>
                                            </div>
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-c1-f1-dinner" value="canteen1-floor1-dinner" onchange="updateSelectedMeals()">
                                                <label for="meal-c1-f1-dinner">æ™šé¤ (17:00-19:00)</label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- äºŒæ¥¼é¢é£ŸåŒº -->
                                    <div class="sub-region-item" data-sub-region="canteen1-floor2">
                                        <div class="sub-region-header">
                                            <div class="sub-region-header-left" onclick="toggleSubRegion(this)">
                                                <input type="checkbox" class="sub-region-checkbox" onclick="event.stopPropagation(); toggleSubRegionAll(this)">
                                                <span class="sub-region-name">äºŒæ¥¼é¢é£ŸåŒº<span class="sub-region-count" id="count-canteen1-floor2"></span></span>
                                            </div>
                                            <i class="fas fa-chevron-down sub-region-toggle" onclick="toggleSubRegion(this)"></i>
                                        </div>
                                        <div class="meals-list">
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-c1-f2-breakfast" value="canteen1-floor2-breakfast" onchange="updateSelectedMeals()">
                                                <label for="meal-c1-f2-breakfast">æ—©é¤ (07:00-09:00)</label>
                                            </div>
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-c1-f2-lunch" value="canteen1-floor2-lunch" onchange="updateSelectedMeals()">
                                                <label for="meal-c1-f2-lunch">åˆé¤ (11:30-13:30)</label>
                                            </div>
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-c1-f2-dinner" value="canteen1-floor2-dinner" onchange="updateSelectedMeals()">
                                                <label for="meal-c1-f2-dinner">æ™šé¤ (17:00-19:00)</label>
                                            </div>
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-c1-f2-snack" value="canteen1-floor2-snack" onchange="updateSelectedMeals()">
                                                <label for="meal-c1-f2-snack">å¤œå®µ (20:00-22:00)</label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- ä¸‰æ¥¼å°åƒåŒº -->
                                    <div class="sub-region-item" data-sub-region="canteen1-floor3">
                                        <div class="sub-region-header">
                                            <div class="sub-region-header-left" onclick="toggleSubRegion(this)">
                                                <input type="checkbox" class="sub-region-checkbox" onclick="event.stopPropagation(); toggleSubRegionAll(this)">
                                                <span class="sub-region-name">ä¸‰æ¥¼å°åƒåŒº<span class="sub-region-count" id="count-canteen1-floor3"></span></span>
                                            </div>
                                            <i class="fas fa-chevron-down sub-region-toggle" onclick="toggleSubRegion(this)"></i>
                                        </div>
                                        <div class="meals-list">
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-c1-f3-lunch" value="canteen1-floor3-lunch" onchange="updateSelectedMeals()">
                                                <label for="meal-c1-f3-lunch">åˆé¤ (11:30-13:30)</label>
                                            </div>
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-c1-f3-dinner" value="canteen1-floor3-dinner" onchange="updateSelectedMeals()">
                                                <label for="meal-c1-f3-dinner">æ™šé¤ (17:00-19:00)</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- ç¬¬äºŒé£Ÿå ‚ -->
                            <div class="region-item" data-region="canteen2">
                                <div class="region-header">
                                    <div class="region-header-left" onclick="toggleRegion(this)">
                                        <input type="checkbox" class="region-checkbox" onclick="event.stopPropagation(); toggleRegionAll(this)">
                                        <span class="region-name">ğŸ¢ ç¬¬äºŒé£Ÿå ‚<span class="region-count" id="count-canteen2"></span></span>
                                    </div>
                                    <i class="fas fa-chevron-down region-toggle" onclick="toggleRegion(this)"></i>
                                </div>
                                <div class="sub-regions-list">
                                    <!-- ä¸€æ¥¼çª—å£åŒº -->
                                    <div class="sub-region-item" data-sub-region="canteen2-floor1">
                                        <div class="sub-region-header">
                                            <div class="sub-region-header-left" onclick="toggleSubRegion(this)">
                                                <input type="checkbox" class="sub-region-checkbox" onclick="event.stopPropagation(); toggleSubRegionAll(this)">
                                                <span class="sub-region-name">ä¸€æ¥¼çª—å£åŒº<span class="sub-region-count" id="count-canteen2-floor1"></span></span>
                                            </div>
                                            <i class="fas fa-chevron-down sub-region-toggle" onclick="toggleSubRegion(this)"></i>
                                        </div>
                                        <div class="meals-list">
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-c2-f1-breakfast" value="canteen2-floor1-breakfast" onchange="updateSelectedMeals()">
                                                <label for="meal-c2-f1-breakfast">æ—©é¤ (07:00-09:00)</label>
                                            </div>
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-c2-f1-lunch" value="canteen2-floor1-lunch" onchange="updateSelectedMeals()">
                                                <label for="meal-c2-f1-lunch">åˆé¤ (11:30-13:30)</label>
                                            </div>
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-c2-f1-dinner" value="canteen2-floor1-dinner" onchange="updateSelectedMeals()">
                                                <label for="meal-c2-f1-dinner">æ™šé¤ (17:00-19:00)</label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- äºŒæ¥¼è‡ªé€‰åŒº -->
                                    <div class="sub-region-item" data-sub-region="canteen2-floor2">
                                        <div class="sub-region-header">
                                            <div class="sub-region-header-left" onclick="toggleSubRegion(this)">
                                                <input type="checkbox" class="sub-region-checkbox" onclick="event.stopPropagation(); toggleSubRegionAll(this)">
                                                <span class="sub-region-name">äºŒæ¥¼è‡ªé€‰åŒº<span class="sub-region-count" id="count-canteen2-floor2"></span></span>
                                            </div>
                                            <i class="fas fa-chevron-down sub-region-toggle" onclick="toggleSubRegion(this)"></i>
                                        </div>
                                        <div class="meals-list">
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-c2-f2-lunch" value="canteen2-floor2-lunch" onchange="updateSelectedMeals()">
                                                <label for="meal-c2-f2-lunch">åˆé¤ (11:30-13:30)</label>
                                            </div>
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-c2-f2-dinner" value="canteen2-floor2-dinner" onchange="updateSelectedMeals()">
                                                <label for="meal-c2-f2-dinner">æ™šé¤ (17:00-19:00)</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- å‘˜å·¥é¤å… -->
                            <div class="region-item" data-region="restaurant">
                                <div class="region-header">
                                    <div class="region-header-left" onclick="toggleRegion(this)">
                                        <input type="checkbox" class="region-checkbox" onclick="event.stopPropagation(); toggleRegionAll(this)">
                                        <span class="region-name">ğŸ½ï¸ å‘˜å·¥é¤å…<span class="region-count" id="count-restaurant"></span></span>
                                    </div>
                                    <i class="fas fa-chevron-down region-toggle" onclick="toggleRegion(this)"></i>
                                </div>
                                <div class="sub-regions-list">
                                    <!-- VIPåŒ…é—´åŒº -->
                                    <div class="sub-region-item" data-sub-region="restaurant-vip">
                                        <div class="sub-region-header">
                                            <div class="sub-region-header-left" onclick="toggleSubRegion(this)">
                                                <input type="checkbox" class="sub-region-checkbox" onclick="event.stopPropagation(); toggleSubRegionAll(this)">
                                                <span class="sub-region-name">VIPåŒ…é—´åŒº<span class="sub-region-count" id="count-restaurant-vip"></span></span>
                                            </div>
                                            <i class="fas fa-chevron-down sub-region-toggle" onclick="toggleSubRegion(this)"></i>
                                        </div>
                                        <div class="meals-list">
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-r-vip-lunch" value="restaurant-vip-lunch" onchange="updateSelectedMeals()">
                                                <label for="meal-r-vip-lunch">åˆé¤ (11:30-13:30)</label>
                                            </div>
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-r-vip-dinner" value="restaurant-vip-dinner" onchange="updateSelectedMeals()">
                                                <label for="meal-r-vip-dinner">æ™šé¤ (17:00-19:00)</label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- è‡ªåŠ©é¤åŒº -->
                                    <div class="sub-region-item" data-sub-region="restaurant-buffet">
                                        <div class="sub-region-header">
                                            <div class="sub-region-header-left" onclick="toggleSubRegion(this)">
                                                <input type="checkbox" class="sub-region-checkbox" onclick="event.stopPropagation(); toggleSubRegionAll(this)">
                                                <span class="sub-region-name">è‡ªåŠ©é¤åŒº<span class="sub-region-count" id="count-restaurant-buffet"></span></span>
                                            </div>
                                            <i class="fas fa-chevron-down sub-region-toggle" onclick="toggleSubRegion(this)"></i>
                                        </div>
                                        <div class="meals-list">
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-r-buffet-lunch" value="restaurant-buffet-lunch" onchange="updateSelectedMeals()">
                                                <label for="meal-r-buffet-lunch">åˆé¤ (11:30-13:30)</label>
                                            </div>
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-r-buffet-dinner" value="restaurant-buffet-dinner" onchange="updateSelectedMeals()">
                                                <label for="meal-r-buffet-dinner">æ™šé¤ (17:00-19:00)</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- å’–å•¡å… -->
                            <div class="region-item" data-region="cafe">
                                <div class="region-header">
                                    <div class="region-header-left" onclick="toggleRegion(this)">
                                        <input type="checkbox" class="region-checkbox" onclick="event.stopPropagation(); toggleRegionAll(this)">
                                        <span class="region-name">â˜• å’–å•¡å…<span class="region-count" id="count-cafe"></span></span>
                                    </div>
                                    <i class="fas fa-chevron-down region-toggle" onclick="toggleRegion(this)"></i>
                                </div>
                                <div class="sub-regions-list">
                                    <!-- é¥®å“åŒº -->
                                    <div class="sub-region-item" data-sub-region="cafe-drink">
                                        <div class="sub-region-header">
                                            <div class="sub-region-header-left" onclick="toggleSubRegion(this)">
                                                <input type="checkbox" class="sub-region-checkbox" onclick="event.stopPropagation(); toggleSubRegionAll(this)">
                                                <span class="sub-region-name">é¥®å“åŒº<span class="sub-region-count" id="count-cafe-drink"></span></span>
                                            </div>
                                            <i class="fas fa-chevron-down sub-region-toggle" onclick="toggleSubRegion(this)"></i>
                                        </div>
                                        <div class="meals-list">
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-cafe-drink-all" value="cafe-drink-allday" onchange="updateSelectedMeals()">
                                                <label for="meal-cafe-drink-all">å…¨å¤© (08:00-20:00)</label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- ç®€é¤åŒº -->
                                    <div class="sub-region-item" data-sub-region="cafe-meal">
                                        <div class="sub-region-header">
                                            <div class="sub-region-header-left" onclick="toggleSubRegion(this)">
                                                <input type="checkbox" class="sub-region-checkbox" onclick="event.stopPropagation(); toggleSubRegionAll(this)">
                                                <span class="sub-region-name">ç®€é¤åŒº<span class="sub-region-count" id="count-cafe-meal"></span></span>
                                            </div>
                                            <i class="fas fa-chevron-down sub-region-toggle" onclick="toggleSubRegion(this)"></i>
                                        </div>
                                        <div class="meals-list">
                                            <div class="meal-checkbox">
                                                <input type="checkbox" id="meal-cafe-meal-all" value="cafe-meal-allday" onchange="updateSelectedMeals()">
                                                <label for="meal-cafe-meal-all">å…¨å¤© (08:00-20:00)</label>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="selected-meals" id="selectedMeals">
                            <div style="color: var(--gray-500); font-size: var(--text-xs);">å·²é€‰æ‹©çš„é¤åˆ«å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <div class="drawer-footer">
            <button type="button" class="btn btn-outline" onclick="closeDrawer()">å–æ¶ˆ</button>
            <button type="button" class="btn btn-primary" onclick="submitForm()">
                <i class="fas fa-check"></i>
                ä¿å­˜
            </button>
        </div>
    </div>

    <script>
        // å­˜å‚¨é€‰ä¸­çš„é¤åˆ«
        let selectedMealsData = new Set();

        // é¡µé¢åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('è´¦æˆ·ç±»åˆ«ç®¡ç†é¡µé¢åŠ è½½å®Œæˆ');
        });

        // æ‰“å¼€æŠ½å±‰
        function openModal(mode = 'add', name = '', code = '', icon = '', color = '') {
            const drawer = document.getElementById('accountDrawer');
            const overlay = document.getElementById('drawerOverlay');
            const drawerTitle = document.getElementById('drawerTitle');
            const form = document.getElementById('accountForm');
            
            if (mode === 'edit') {
                drawerTitle.textContent = 'ç¼–è¾‘è´¦æˆ·ç±»åˆ«';
                document.getElementById('accountName').value = name;
                document.getElementById('accountCode').value = code;
                document.getElementById('accountIcon').value = icon;
                document.getElementById('accountColor').value = color;
            } else {
                drawerTitle.textContent = 'æ–°å¢è´¦æˆ·ç±»åˆ«';
                form.reset();
                selectedMealsData.clear();
                updateSelectedMealsDisplay();
            }
            
            // å»¶è¿Ÿæ·»åŠ showç±»ä»¥è§¦å‘åŠ¨ç”»
            overlay.classList.add('show');
            setTimeout(() => {
                drawer.classList.add('show');
            }, 10);
        }

        // å…³é—­æŠ½å±‰
        function closeDrawer() {
            const drawer = document.getElementById('accountDrawer');
            const overlay = document.getElementById('drawerOverlay');
            
            drawer.classList.remove('show');
            setTimeout(() => {
                overlay.classList.remove('show');
            }, 300);
        }

        // åˆ‡æ¢ä¸€çº§åŒºåŸŸå±•å¼€/æ”¶èµ·
        function toggleRegion(element) {
            const regionItem = element.closest('.region-item');
            regionItem.classList.toggle('expanded');
        }

        // åˆ‡æ¢äºŒçº§åŒºåŸŸå±•å¼€/æ”¶èµ·
        function toggleSubRegion(element) {
            const subRegionItem = element.closest('.sub-region-item');
            subRegionItem.classList.toggle('expanded');
        }

        // ä¸€çº§åŒºåŸŸå…¨é€‰/å–æ¶ˆå…¨é€‰
        function toggleRegionAll(checkbox) {
            const regionItem = checkbox.closest('.region-item');
            const isChecked = checkbox.checked;
            
            // é€‰ä¸­/å–æ¶ˆè¯¥åŒºåŸŸä¸‹æ‰€æœ‰çš„äºŒçº§åŒºåŸŸå¤é€‰æ¡†
            const subRegionCheckboxes = regionItem.querySelectorAll('.sub-region-checkbox');
            subRegionCheckboxes.forEach(cb => {
                cb.checked = isChecked;
                cb.indeterminate = false;
            });
            
            // é€‰ä¸­/å–æ¶ˆè¯¥åŒºåŸŸä¸‹æ‰€æœ‰çš„é¤åˆ«å¤é€‰æ¡†
            const mealCheckboxes = regionItem.querySelectorAll('.meal-checkbox input[type="checkbox"]');
            mealCheckboxes.forEach(cb => {
                cb.checked = isChecked;
            });
            
            updateSelectedMeals();
        }

        // äºŒçº§åŒºåŸŸå…¨é€‰/å–æ¶ˆå…¨é€‰
        function toggleSubRegionAll(checkbox) {
            const subRegionItem = checkbox.closest('.sub-region-item');
            const isChecked = checkbox.checked;
            
            // é€‰ä¸­/å–æ¶ˆè¯¥äºŒçº§åŒºåŸŸä¸‹æ‰€æœ‰çš„é¤åˆ«å¤é€‰æ¡†
            const mealCheckboxes = subRegionItem.querySelectorAll('.meal-checkbox input[type="checkbox"]');
            mealCheckboxes.forEach(cb => {
                cb.checked = isChecked;
            });
            
            updateSelectedMeals();
        }

        // æ›´æ–°é€‰ä¸­çš„é¤åˆ«
        function updateSelectedMeals() {
            // è·å–æ‰€æœ‰é€‰ä¸­çš„checkbox
            const checkboxes = document.querySelectorAll('.meal-checkbox input[type="checkbox"]:checked');
            
            selectedMealsData.clear();
            checkboxes.forEach(checkbox => {
                const mealLabel = checkbox.nextElementSibling.textContent.trim();
                const subRegionName = checkbox.closest('.sub-region-item').querySelector('.sub-region-name').textContent.trim();
                const regionName = checkbox.closest('.region-item').querySelector('.region-name').textContent.trim();
                
                selectedMealsData.add({
                    value: checkbox.value,
                    label: `${regionName} > ${subRegionName} > ${mealLabel}`
                });
            });
            
            updateSelectedMealsDisplay();
            updateAllCheckboxStates();
            updateAllCounts();
        }

        // æ›´æ–°æ‰€æœ‰å¤é€‰æ¡†çŠ¶æ€ï¼ˆè‡ªåŠ¨æ˜¾ç¤ºåŠé€‰/å…¨é€‰çŠ¶æ€ï¼‰
        function updateAllCheckboxStates() {
            // æ›´æ–°æ‰€æœ‰äºŒçº§åŒºåŸŸå¤é€‰æ¡†çŠ¶æ€
            document.querySelectorAll('.sub-region-item').forEach(subRegionItem => {
                const subCheckbox = subRegionItem.querySelector('.sub-region-checkbox');
                const mealCheckboxes = subRegionItem.querySelectorAll('.meal-checkbox input[type="checkbox"]');
                const checkedCount = Array.from(mealCheckboxes).filter(cb => cb.checked).length;
                
                if (checkedCount === 0) {
                    subCheckbox.checked = false;
                    subCheckbox.indeterminate = false;
                } else if (checkedCount === mealCheckboxes.length) {
                    subCheckbox.checked = true;
                    subCheckbox.indeterminate = false;
                } else {
                    subCheckbox.checked = false;
                    subCheckbox.indeterminate = true;
                }
            });
            
            // æ›´æ–°æ‰€æœ‰ä¸€çº§åŒºåŸŸå¤é€‰æ¡†çŠ¶æ€
            document.querySelectorAll('.region-item').forEach(regionItem => {
                const regionCheckbox = regionItem.querySelector('.region-checkbox');
                const allMealCheckboxes = regionItem.querySelectorAll('.meal-checkbox input[type="checkbox"]');
                const checkedCount = Array.from(allMealCheckboxes).filter(cb => cb.checked).length;
                
                if (checkedCount === 0) {
                    regionCheckbox.checked = false;
                    regionCheckbox.indeterminate = false;
                } else if (checkedCount === allMealCheckboxes.length) {
                    regionCheckbox.checked = true;
                    regionCheckbox.indeterminate = false;
                } else {
                    regionCheckbox.checked = false;
                    regionCheckbox.indeterminate = true;
                }
            });
        }

        // æ›´æ–°æ‰€æœ‰è®¡æ•°å™¨
        function updateAllCounts() {
            // æ›´æ–°äºŒçº§åŒºåŸŸè®¡æ•°
            document.querySelectorAll('.sub-region-item').forEach(subRegionItem => {
                const subRegionId = subRegionItem.getAttribute('data-sub-region');
                const countSpan = document.getElementById(`count-${subRegionId}`);
                if (countSpan) {
                    const mealCheckboxes = subRegionItem.querySelectorAll('.meal-checkbox input[type="checkbox"]');
                    const checkedCount = Array.from(mealCheckboxes).filter(cb => cb.checked).length;
                    const totalCount = mealCheckboxes.length;
                    
                    if (checkedCount > 0) {
                        countSpan.textContent = ` (${checkedCount}/${totalCount})`;
                    } else {
                        countSpan.textContent = '';
                    }
                }
            });
            
            // æ›´æ–°ä¸€çº§åŒºåŸŸè®¡æ•°
            document.querySelectorAll('.region-item').forEach(regionItem => {
                const regionId = regionItem.getAttribute('data-region');
                const countSpan = document.getElementById(`count-${regionId}`);
                if (countSpan) {
                    const allMealCheckboxes = regionItem.querySelectorAll('.meal-checkbox input[type="checkbox"]');
                    const checkedCount = Array.from(allMealCheckboxes).filter(cb => cb.checked).length;
                    const totalCount = allMealCheckboxes.length;
                    
                    if (checkedCount > 0) {
                        countSpan.textContent = ` (${checkedCount}/${totalCount})`;
                    } else {
                        countSpan.textContent = '';
                    }
                }
            });
        }

        // æ˜¾ç¤ºå·²é€‰æ‹©çš„é¤åˆ«æ ‡ç­¾
        function updateSelectedMealsDisplay() {
            const container = document.getElementById('selectedMeals');
            
            if (selectedMealsData.size === 0) {
                container.innerHTML = '<div style="color: var(--gray-500); font-size: var(--text-xs);">å·²é€‰æ‹©çš„é¤åˆ«å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ</div>';
                return;
            }
            
            let html = '';
            selectedMealsData.forEach(meal => {
                html += `
                    <span class="meal-tag">
                        ${meal.label}
                        <i class="fas fa-times meal-tag-remove" onclick="removeMeal('${meal.value}')"></i>
                    </span>
                `;
            });
            
            container.innerHTML = html;
        }

        // ç§»é™¤é¤åˆ«æ ‡ç­¾
        function removeMeal(value) {
            const checkbox = document.querySelector(`input[value="${value}"]`);
            if (checkbox) {
                checkbox.checked = false;
                updateSelectedMeals();
            }
        }

        // æäº¤è¡¨å•
        function submitForm() {
            const form = document.getElementById('accountForm');
            
            // éªŒè¯å¿…å¡«é¡¹
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }
            
            // æ”¶é›†è¡¨å•æ•°æ®
            const formData = {
                name: document.getElementById('accountName').value,
                code: document.getElementById('accountCode').value,
                icon: document.getElementById('accountIcon').value,
                color: document.getElementById('accountColor').value,
                description: document.getElementById('accountDescription').value,
                dailyLimit: document.getElementById('dailyLimit').value || 0,
                monthlyLimit: document.getElementById('monthlyLimit').value || 0,
                minAmount: document.getElementById('minAmount').value || 0,
                maxAmount: document.getElementById('maxAmount').value || 0,
                meals: Array.from(selectedMealsData)
            };
            
            console.log('æäº¤è¡¨å•æ•°æ®:', formData);
            
            // æ„å»ºæç¤ºä¿¡æ¯
            let message = 'è´¦æˆ·ç±»åˆ«é…ç½®ï¼š\n\n';
            message += `ç±»åˆ«åç§°ï¼š${formData.name}\n`;
            message += `ç±»åˆ«ç¼–å·ï¼š${formData.code}\n`;
            message += `æ—¥æ¶ˆè´¹é™é¢ï¼šÂ¥${formData.dailyLimit}\n`;
            message += `æœˆæ¶ˆè´¹é™é¢ï¼šÂ¥${formData.monthlyLimit}\n`;
            message += `å•ç¬”é‡‘é¢èŒƒå›´ï¼šÂ¥${formData.minAmount} - Â¥${formData.maxAmount}\n`;
            message += `å¯ç”¨é¤åˆ«ï¼š${formData.meals.length} ä¸ª`;
            
            // è¿™é‡Œå¯ä»¥æ·»åŠ å®é™…çš„ä¿å­˜é€»è¾‘
            alert(message);
            
            closeDrawer();
        }

        // æŒ‰ESCé”®å…³é—­æŠ½å±‰
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                const drawer = document.getElementById('accountDrawer');
                if (drawer.classList.contains('show')) {
                    closeDrawer();
                }
            }
        });
    </script>
</body>
</html>