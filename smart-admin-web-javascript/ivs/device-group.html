<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>设备分组 - 智能视频监控系统</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../css/visitor-style.css">
</head>
<body class="bg-gray-50">
    <div class="p-6 h-full flex gap-6">
        <!-- 左侧分组列表 -->
        <div class="w-96 bg-white rounded-lg shadow-sm flex flex-col">
            <div class="p-4 border-b border-gray-200">
                <div class="flex items-center justify-between mb-3">
                    <h3 class="text-lg font-semibold text-gray-800">设备分组列表</h3>
                    <button onclick="refreshGroups()" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
                <div class="flex items-center space-x-2">
                    <input type="text" placeholder="搜索分组..." class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500">
                    <button onclick="searchGroups()" class="btn">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>

            <div class="flex-1 overflow-hidden flex flex-col">
                <!-- 工具栏 -->
                <div class="p-4 border-b border-gray-200 bg-gray-50">
                    <div class="flex space-x-2">
                        <button onclick="openAddGroupModal()" class="flex-1 btn btn-primary">
                            <i class="fas fa-plus mr-1"></i>新增分组
                        </button>
                        <button onclick="deleteSelectedGroups()" class="flex-1 btn btn-primary">
                            <i class="fas fa-trash mr-1"></i>删除分组
                        </button>
                    </div>
                </div>

                <!-- 分组树 -->
                <div class="flex-1 overflow-y-auto p-4">
                    <div class="space-y-2">
                        <!-- 分组根节点 -->
                        <div class="group-item">
                            <div class="flex items-center p-3 bg-gray-50 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-100" onclick="selectGroup('root')">
                                <input type="checkbox" class="mr-3" value="root">
                                <i class="fas fa-folder text-gray-600 mr-2"></i>
                                <span class="font-medium text-gray-800 flex-1">全部设备</span>
                                <span class="text-xs bg-gray-200 text-gray-700 px-2 py-1 rounded-full">158台</span>
                            </div>
                        </div>

                        <!-- 一级分组 -->
                        <div class="group-item">
                            <div class="flex items-center p-3 bg-gray-50 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-100" onclick="toggleGroup('office')">
                                <input type="checkbox" class="mr-3" value="office">
                                <i class="fas fa-chevron-right text-gray-500 mr-2 text-xs transition-transform" id="office-arrow"></i>
                                <i class="fas fa-folder text-gray-600 mr-2"></i>
                                <span class="font-medium text-gray-800 flex-1">办公区域</span>
                                <span class="text-xs bg-gray-200 text-gray-700 px-2 py-1 rounded-full">42台</span>
                            </div>
                            <!-- 子分组 -->
                            <div id="office-subgroups" class="hidden ml-8 mt-2 space-y-2">
                                <div class="flex items-center p-2 bg-gray-50 border border-gray-200 rounded cursor-pointer hover:bg-gray-100" onclick="selectGroup('office-1f')">
                                    <input type="checkbox" class="mr-3" value="office-1f">
                                    <i class="fas fa-folder text-gray-600 mr-2"></i>
                                    <span class="text-sm text-gray-700 flex-1">一楼</span>
                                    <span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full">15台</span>
                                </div>
                                <div class="flex items-center p-2 bg-gray-50 border border-gray-200 rounded cursor-pointer hover:bg-gray-100" onclick="selectGroup('office-2f')">
                                    <input type="checkbox" class="mr-3" value="office-2f">
                                    <i class="fas fa-folder text-gray-600 mr-2"></i>
                                    <span class="text-sm text-gray-700 flex-1">二楼</span>
                                    <span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full">18台</span>
                                </div>
                                <div class="flex items-center p-2 bg-gray-50 border border-gray-200 rounded cursor-pointer hover:bg-gray-100" onclick="selectGroup('office-3f')">
                                    <input type="checkbox" class="mr-3" value="office-3f">
                                    <i class="fas fa-folder text-gray-600 mr-2"></i>
                                    <span class="text-sm text-gray-700 flex-1">三楼</span>
                                    <span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full">9台</span>
                                </div>
                            </div>
                        </div>

                        <div class="group-item">
                            <div class="flex items-center p-3 bg-gray-50 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-100" onclick="toggleGroup('production')">
                                <input type="checkbox" class="mr-3" value="production">
                                <i class="fas fa-chevron-right text-gray-500 mr-2 text-xs transition-transform" id="production-arrow"></i>
                                <i class="fas fa-folder text-gray-600 mr-2"></i>
                                <span class="font-medium text-gray-800 flex-1">生产区域</span>
                                <span class="text-xs bg-gray-200 text-gray-700 px-2 py-1 rounded-full">38台</span>
                            </div>
                            <div id="production-subgroups" class="hidden ml-8 mt-2 space-y-2">
                                <div class="flex items-center p-2 bg-gray-50 border border-gray-200 rounded cursor-pointer hover:bg-gray-100" onclick="selectGroup('production-workshop')">
                                    <input type="checkbox" class="mr-3" value="production-workshop">
                                    <i class="fas fa-folder text-gray-600 mr-2"></i>
                                    <span class="text-sm text-gray-700 flex-1">车间</span>
                                    <span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full">22台</span>
                                </div>
                                <div class="flex items-center p-2 bg-gray-50 border border-gray-200 rounded cursor-pointer hover:bg-gray-100" onclick="selectGroup('production-warehouse')">
                                    <input type="checkbox" class="mr-3" value="production-warehouse">
                                    <i class="fas fa-folder text-gray-600 mr-2"></i>
                                    <span class="text-sm text-gray-700 flex-1">仓库</span>
                                    <span class="text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded-full">16台</span>
                                </div>
                            </div>
                        </div>

                        <div class="group-item">
                            <div class="flex items-center p-3 bg-gray-50 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-100" onclick="selectGroup('parking')">
                                <input type="checkbox" class="mr-3" value="parking">
                                <i class="fas fa-folder text-gray-600 mr-2"></i>
                                <span class="font-medium text-gray-800 flex-1">停车区域</span>
                                <span class="text-xs bg-gray-200 text-gray-700 px-2 py-1 rounded-full">28台</span>
                            </div>
                        </div>

                        <div class="group-item">
                            <div class="flex items-center p-3 bg-gray-50 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-100" onclick="selectGroup('public')">
                                <input type="checkbox" class="mr-3" value="public">
                                <i class="fas fa-folder text-gray-600 mr-2"></i>
                                <span class="font-medium text-gray-800 flex-1">公共区域</span>
                                <span class="text-xs bg-gray-200 text-gray-700 px-2 py-1 rounded-full">35台</span>
                            </div>
                        </div>

                        <div class="group-item">
                            <div class="flex items-center p-3 bg-gray-50 border border-gray-200 rounded-lg cursor-pointer hover:bg-gray-100" onclick="selectGroup('security')">
                                <input type="checkbox" class="mr-3" value="security">
                                <i class="fas fa-folder text-gray-600 mr-2"></i>
                                <span class="font-medium text-gray-800 flex-1">周界防范</span>
                                <span class="text-xs bg-gray-200 text-gray-700 px-2 py-1 rounded-full">15台</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 分组统计 -->
                <div class="p-4 border-t border-gray-200 bg-gray-50">
                    <div class="text-xs text-gray-600 space-y-1">
                        <div class="flex justify-between">
                            <span>分组总数:</span>
                            <span class="font-semibold">6个</span>
                        </div>
                        <div class="flex justify-between">
                            <span>设备总数:</span>
                            <span class="font-semibold">158台</span>
                        </div>
                        <div class="flex justify-between">
                            <span>在线设备:</span>
                            <span class="font-semibold text-gray-700">156台</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 右侧设备列表 -->
        <div class="flex-1 bg-white rounded-lg shadow-sm flex flex-col">
            <div class="p-4 border-b border-gray-200">
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="text-lg font-semibold text-gray-800" id="group-title">办公区域 - 一楼</h3>
                        <p class="text-sm text-gray-500">共 <span id="device-count">15</span> 台设备</p>
                    </div>
                    <div class="flex items-center space-x-3">
                        <input type="text" placeholder="搜索设备..." class="px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary-500 w-48">
                        <button onclick="moveToGroup()" class="btn btn-primary">
                            <i class="fas fa-exchange-alt mr-1"></i>移动到分组
                        </button>
                        <button onclick="removeFromGroup()" class="btn btn-primary">
                            <i class="fas fa-times mr-1"></i>移出分组
                        </button>
                        <button onclick="refreshDevices()" class="btn">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div class="flex-1 overflow-y-auto">
                <!-- 设备卡片列表 -->
                <div class="p-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4" id="device-cards">
                    <!-- 设备卡片1 -->
                    <div class="device-card border border-gray-200 rounded-lg p-4 hover:shadow-lg transition-shadow cursor-pointer">
                        <div class="flex items-start justify-between mb-3">
                            <div class="flex items-center">
                                <input type="checkbox" class="mr-3" value="CAM001">
                                <i class="fas fa-video text-gray-600 text-lg mr-2"></i>
                            </div>
                            <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                        </div>
                        <div class="mb-2">
                            <h4 class="font-semibold text-gray-800 text-sm">CAM001</h4>
                            <p class="text-xs text-gray-500">前门-入口</p>
                        </div>
                        <div class="text-xs text-gray-600 space-y-1">
                            <div class="flex justify-between">
                                <span>IP:</span>
                                <span>192.168.1.101</span>
                            </div>
                            <div class="flex justify-between">
                                <span>类型:</span>
                                <span>网络摄像机</span>
                            </div>
                            <div class="flex justify-between">
                                <span>厂商:</span>
                                <span>海康威视</span>
                            </div>
                            <div class="flex justify-between">
                                <span>状态:</span>
                                <span class="text-gray-700">在线</span>
                            </div>
                        </div>
                        <div class="mt-3 flex space-x-1">
                            <button onclick="previewDevice('CAM001')" class="flex-1 btn btn-sm">
                                <i class="fas fa-eye mr-1"></i>预览
                            </button>
                            <button onclick="configDevice('CAM001')" class="flex-1 btn btn-sm">
                                <i class="fas fa-cog mr-1"></i>配置
                            </button>
                        </div>
                    </div>

                    <!-- 设备卡片2 -->
                    <div class="device-card border border-gray-200 rounded-lg p-4 hover:shadow-lg transition-shadow cursor-pointer">
                        <div class="flex items-start justify-between mb-3">
                            <div class="flex items-center">
                                <input type="checkbox" class="mr-3" value="CAM002">
                                <i class="fas fa-video text-gray-600 text-lg mr-2"></i>
                            </div>
                            <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                        </div>
                        <div class="mb-2">
                            <h4 class="font-semibold text-gray-800 text-sm">CAM002</h4>
                            <p class="text-xs text-gray-500">大厅-中央</p>
                        </div>
                        <div class="text-xs text-gray-600 space-y-1">
                            <div class="flex justify-between">
                                <span>IP:</span>
                                <span>192.168.1.102</span>
                            </div>
                            <div class="flex justify-between">
                                <span>类型:</span>
                                <span>网络摄像机</span>
                            </div>
                            <div class="flex justify-between">
                                <span>厂商:</span>
                                <span>大华</span>
                            </div>
                            <div class="flex justify-between">
                                <span>状态:</span>
                                <span class="text-gray-700">在线</span>
                            </div>
                        </div>
                        <div class="mt-3 flex space-x-1">
                            <button onclick="previewDevice('CAM002')" class="flex-1 btn btn-sm">
                                <i class="fas fa-eye mr-1"></i>预览
                            </button>
                            <button onclick="configDevice('CAM002')" class="flex-1 btn btn-sm">
                                <i class="fas fa-cog mr-1"></i>配置
                            </button>
                        </div>
                    </div>

                    <!-- 设备卡片3 -->
                    <div class="device-card border border-gray-200 rounded-lg p-4 hover:shadow-lg transition-shadow cursor-pointer">
                        <div class="flex items-start justify-between mb-3">
                            <div class="flex items-center">
                                <input type="checkbox" class="mr-3" value="CAM003">
                                <i class="fas fa-video text-gray-600 text-lg mr-2"></i>
                            </div>
                            <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                        </div>
                        <div class="mb-2">
                            <h4 class="font-semibold text-gray-800 text-sm">CAM003</h4>
                            <p class="text-xs text-gray-500">走廊-东侧</p>
                        </div>
                        <div class="text-xs text-gray-600 space-y-1">
                            <div class="flex justify-between">
                                <span>IP:</span>
                                <span>192.168.1.103</span>
                            </div>
                            <div class="flex justify-between">
                                <span>类型:</span>
                                <span>网络摄像机</span>
                            </div>
                            <div class="flex justify-between">
                                <span>厂商:</span>
                                <span>宇视</span>
                            </div>
                            <div class="flex justify-between">
                                <span>状态:</span>
                                <span class="text-gray-700">在线</span>
                            </div>
                        </div>
                        <div class="mt-3 flex space-x-1">
                            <button onclick="previewDevice('CAM003')" class="flex-1 btn btn-sm">
                                <i class="fas fa-eye mr-1"></i>预览
                            </button>
                            <button onclick="configDevice('CAM003')" class="flex-1 btn btn-sm">
                                <i class="fas fa-cog mr-1"></i>配置
                            </button>
                        </div>
                    </div>

                    <!-- 设备卡片4 -->
                    <div class="device-card border border-gray-200 rounded-lg p-4 hover:shadow-lg transition-shadow cursor-pointer">
                        <div class="flex items-start justify-between mb-3">
                            <div class="flex items-center">
                                <input type="checkbox" class="mr-3" value="CAM004">
                                <i class="fas fa-video text-gray-600 text-lg mr-2"></i>
                            </div>
                            <span class="w-2 h-2 bg-red-500 rounded-full"></span>
                        </div>
                        <div class="mb-2">
                            <h4 class="font-semibold text-gray-800 text-sm">CAM004</h4>
                            <p class="text-xs text-gray-500">会议室-001</p>
                        </div>
                        <div class="text-xs text-gray-600 space-y-1">
                            <div class="flex justify-between">
                                <span>IP:</span>
                                <span>192.168.1.104</span>
                            </div>
                            <div class="flex justify-between">
                                <span>类型:</span>
                                <span>网络摄像机</span>
                            </div>
                            <div class="flex justify-between">
                                <span>厂商:</span>
                                <span>天地伟业</span>
                            </div>
                            <div class="flex justify-between">
                                <span>状态:</span>
                                <span class="text-gray-700">离线</span>
                            </div>
                        </div>
                        <div class="mt-3 flex space-x-1">
                            <button onclick="previewDevice('CAM004')" class="flex-1 btn btn-sm" disabled>
                                <i class="fas fa-eye mr-1"></i>预览
                            </button>
                            <button onclick="configDevice('CAM004')" class="flex-1 btn btn-sm">
                                <i class="fas fa-cog mr-1"></i>配置
                            </button>
                        </div>
                    </div>

                    <!-- 更多设备卡片... -->
                    <div class="device-card border border-gray-200 rounded-lg p-4 hover:shadow-lg transition-shadow cursor-pointer">
                        <div class="flex items-start justify-between mb-3">
                            <div class="flex items-center">
                                <input type="checkbox" class="mr-3" value="CAM005">
                                <i class="fas fa-video text-gray-600 text-lg mr-2"></i>
                            </div>
                            <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                        </div>
                        <div class="mb-2">
                            <h4 class="font-semibold text-gray-800 text-sm">CAM005</h4>
                            <p class="text-xs text-gray-500">电梯-前厅</p>
                        </div>
                        <div class="text-xs text-gray-600 space-y-1">
                            <div class="flex justify-between">
                                <span>IP:</span>
                                <span>192.168.1.105</span>
                            </div>
                            <div class="flex justify-between">
                                <span>类型:</span>
                                <span>网络摄像机</span>
                            </div>
                            <div class="flex justify-between">
                                <span>厂商:</span>
                                <span>海康威视</span>
                            </div>
                            <div class="flex justify-between">
                                <span>状态:</span>
                                <span class="text-gray-700">在线</span>
                            </div>
                        </div>
                        <div class="mt-3 flex space-x-1">
                            <button onclick="previewDevice('CAM005')" class="flex-1 btn btn-sm">
                                <i class="fas fa-eye mr-1"></i>预览
                            </button>
                            <button onclick="configDevice('CAM005')" class="flex-1 btn btn-sm">
                                <i class="fas fa-cog mr-1"></i>配置
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let selectedGroup = 'office-1f';
        let selectedDevices = new Set();

        // 切换分组展开/收起
        function toggleGroup(groupId) {
            const subgroup = document.getElementById(`${groupId}-subgroups`);
            const arrow = document.getElementById(`${groupId}-arrow`);

            if (subgroup && arrow) {
                if (subgroup.classList.contains('hidden')) {
                    subgroup.classList.remove('hidden');
                    arrow.style.transform = 'rotate(90deg)';
                    arrow.classList.remove('fa-chevron-right');
                    arrow.classList.add('fa-chevron-down');
                } else {
                    subgroup.classList.add('hidden');
                    arrow.style.transform = 'rotate(0deg)';
                    arrow.classList.remove('fa-chevron-down');
                    arrow.classList.add('fa-chevron-right');
                }
            }
        }

        // 选择分组
        function selectGroup(groupId) {
            // 更新选中状态
            selectedGroup = groupId;

            // 更新分组标题
            const groupTitles = {
                'root': '全部设备',
                'office': '办公区域',
                'office-1f': '办公区域 - 一楼',
                'office-2f': '办公区域 - 二楼',
                'office-3f': '办公区域 - 三楼',
                'production': '生产区域',
                'production-workshop': '生产区域 - 车间',
                'production-warehouse': '生产区域 - 仓库',
                'parking': '停车区域',
                'public': '公共区域',
                'security': '周界防范'
            };

            document.getElementById('group-title').textContent = groupTitles[groupId] || '未知分组';

            // 模拟加载该分组的设备
            loadGroupDevices(groupId);
        }

        // 加载分组设备
        function loadGroupDevices(groupId) {
            const deviceCount = {
                'root': 158,
                'office': 42,
                'office-1f': 15,
                'office-2f': 18,
                'office-3f': 9,
                'production': 38,
                'production-workshop': 22,
                'production-warehouse': 16,
                'parking': 28,
                'public': 35,
                'security': 15
            };

            document.getElementById('device-count').textContent = deviceCount[groupId] || 0;

            // 这里可以根据分组ID加载不同的设备
            showNotification(`已加载分组设备`, 'info');
        }

        // 打开新增分组模态框
        function openAddGroupModal() {
            if (window.parent && window.parent.openDrawer) {
                const content = `
                    <div class="space-y-4">
                        <div class="p-4 bg-gray-50 rounded-lg">
                            <h4 class="font-semibold text-gray-800 mb-4">新增设备分组</h4>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">分组名称 <span class="text-red-500">*</span></label>
                                    <input type="text" placeholder="请输入分组名称" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">上级分组</label>
                                    <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500">
                                        <option value="">根分组</option>
                                        <option value="office">办公区域</option>
                                        <option value="production">生产区域</option>
                                        <option value="parking">停车区域</option>
                                        <option value="public">公共区域</option>
                                        <option value="security">周界防范</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">分组描述</label>
                                    <textarea placeholder="请输入分组描述" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500" rows="3"></textarea>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">分组图标</label>
                                    <div class="flex space-x-2">
                                        <button type="button" class="p-3 border-2 border-gray-400 rounded-lg bg-gray-50">
                                            <i class="fas fa-building text-gray-600"></i>
                                        </button>
                                        <button type="button" class="p-3 border border-gray-300 rounded-lg hover:border-gray-400">
                                            <i class="fas fa-home text-gray-600"></i>
                                        </button>
                                        <button type="button" class="p-3 border border-gray-300 rounded-lg hover:border-gray-400">
                                            <i class="fas fa-industry text-gray-600"></i>
                                        </button>
                                        <button type="button" class="p-3 border border-gray-300 rounded-lg hover:border-gray-400">
                                            <i class="fas fa-car text-gray-600"></i>
                                        </button>
                                        <button type="button" class="p-3 border border-gray-300 rounded-lg hover:border-gray-400">
                                            <i class="fas fa-shield-alt text-gray-600"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex justify-end space-x-2">
                            <button onclick="window.parent.closeDrawer()" class="btn">取消</button>
                            <button onclick="saveGroup()" class="btn btn-primary">保存</button>
                        </div>
                    </div>
                `;
                window.parent.openDrawer('新增设备分组', content);
            }
        }

        // 保存分组
        function saveGroup() {
            showNotification('分组保存成功', 'success');
            if (window.parent && window.parent.closeDrawer) {
                window.parent.closeDrawer();
            }
        }

        // 删除选中的分组
        function deleteSelectedGroups() {
            const checkboxes = document.querySelectorAll('.group-item input[type="checkbox"]:checked');
            if (checkboxes.length === 0) {
                showNotification('请选择要删除的分组', 'warning');
                return;
            }

            if (confirm(`确定要删除选中的 ${checkboxes.length} 个分组吗？\n删除后分组下的设备将移动到根分组。`)) {
                showNotification(`成功删除 ${checkboxes.length} 个分组`, 'success');
            }
        }

        // 搜索分组
        function searchGroups() {
            showNotification('正在搜索分组...', 'info');
        }

        // 刷新分组列表
        function refreshGroups() {
            showNotification('分组列表已刷新', 'success');
        }

        // 移动到分组
        function moveToGroup() {
            const checkboxes = document.querySelectorAll('#device-cards input[type="checkbox"]:checked');
            if (checkboxes.length === 0) {
                showNotification('请选择要移动的设备', 'warning');
                return;
            }

            if (window.parent && window.parent.openDrawer) {
                const content = `
                    <div class="space-y-4">
                        <div class="p-4 bg-gray-50 rounded-lg">
                            <h4 class="font-semibold text-gray-800 mb-4">移动到分组</h4>
                            <div class="space-y-4">
                                <div>
                                    <p class="text-sm text-gray-700 mb-3">已选择 <span class="font-semibold text-gray-700">${checkboxes.length}</span> 台设备</p>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">目标分组</label>
                                    <select class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500">
                                        <option value="">请选择目标分组</option>
                                        <option value="root">全部设备</option>
                                        <option value="office">办公区域</option>
                                        <option value="office-1f">办公区域 - 一楼</option>
                                        <option value="office-2f">办公区域 - 二楼</option>
                                        <option value="office-3f">办公区域 - 三楼</option>
                                        <option value="production">生产区域</option>
                                        <option value="parking">停车区域</option>
                                        <option value="public">公共区域</option>
                                        <option value="security">周界防范</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="flex justify-end space-x-2">
                            <button onclick="window.parent.closeDrawer()" class="btn">取消</button>
                            <button onclick="confirmMove()" class="btn btn-primary">确认移动</button>
                        </div>
                    </div>
                `;
                window.parent.openDrawer('移动到分组', content);
            }
        }

        // 确认移动
        function confirmMove() {
            showNotification('设备已成功移动到新分组', 'success');
            if (window.parent && window.parent.closeDrawer) {
                window.parent.closeDrawer();
            }
        }

        // 移出分组
        function removeFromGroup() {
            const checkboxes = document.querySelectorAll('#device-cards input[type="checkbox"]:checked');
            if (checkboxes.length === 0) {
                showNotification('请选择要移出的设备', 'warning');
                return;
            }

            if (confirm(`确定要将选中的 ${checkboxes.length} 台设备移出当前分组吗？`)) {
                showNotification(`成功移出 ${checkboxes.length} 台设备`, 'success');
            }
        }

        // 刷新设备列表
        function refreshDevices() {
            showNotification('设备列表已刷新', 'success');
        }

        // 预览设备
        function previewDevice(deviceId) {
            showNotification(`正在预览设备: ${deviceId}`, 'info');
            // 这里可以打开视频预览窗口
        }

        // 配置设备
        function configDevice(deviceId) {
            showNotification(`打开设备配置: ${deviceId}`, 'info');
            // 这里可以打开设备配置页面
        }

        // 显示通知
        function showNotification(message, type = 'info') {
            if (window.parent && window.parent.showNotification) {
                window.parent.showNotification(message, type);
            }
        }

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 默认选中第一个分组
            selectGroup('office-1f');

            // 监听分组复选框变化
            document.querySelectorAll('.group-item input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', function(e) {
                    e.stopPropagation();
                });
            });

            // 监听设备卡片复选框变化
            document.querySelectorAll('#device-cards input[type="checkbox"]').forEach(checkbox => {
                checkbox.addEventListener('change', function(e) {
                    e.stopPropagation();
                    if (this.checked) {
                        selectedDevices.add(this.value);
                    } else {
                        selectedDevices.delete(this.value);
                    }
                });
            });
        });
    </script>
</body>
</html>