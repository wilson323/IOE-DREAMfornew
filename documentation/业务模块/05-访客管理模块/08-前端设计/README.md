# è®¿å®¢ç®¡ç†æ¨¡å— - å‰ç«¯è®¾è®¡

## 1. ç§»åŠ¨ç«¯è®¾è®¡æ¦‚è¿°

åŸºäºç°æœ‰ç§»åŠ¨ç«¯ä»£ç åˆ†æï¼ˆ`smart-app/src/pages/visitor/`ï¼‰ï¼Œè®¿å®¢ç®¡ç†æ¨¡å—çš„ç§»åŠ¨ç«¯è®¾è®¡éµå¾ª IOE-DREAM æ™ºæ…§å›­åŒºä¸€å¡é€šç®¡ç†å¹³å°çš„ç»Ÿä¸€è§„èŒƒã€‚

### 1.1 è®¾è®¡åŸåˆ™

- **åœºæ™¯é©±åŠ¨**: ç§»åŠ¨ç«¯èšç„¦è®¿å®¢é«˜é¢‘ä½¿ç”¨åœºæ™¯ï¼Œéå…¨åŠŸèƒ½å¤åˆ»
- **ç®€æ´é«˜æ•ˆ**: ç•Œé¢ç®€æ´ï¼Œæ“ä½œæµç¨‹æœ€çŸ­åŒ–
- **ç¦»çº¿æ”¯æŒ**: å…³é”®åŠŸèƒ½æ”¯æŒç¦»çº¿æ“ä½œ
- **å®‰å…¨ä¼˜å…ˆ**: æ•æ„Ÿæ“ä½œéœ€äºŒæ¬¡ç¡®è®¤

## 2. æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Vue 3.x | 3.4+ | æ ¸å¿ƒæ¡†æ¶ |
| Uni-app | 3.0+ | è·¨å¹³å°å¼€å‘ |
| Pinia | 2.x | çŠ¶æ€ç®¡ç† |
| uni-ui | 1.5+ | UIç»„ä»¶åº“ |
| dayjs | 1.11+ | æ—¥æœŸå¤„ç† |

## 3. ç§»åŠ¨ç«¯åŠŸèƒ½èŒƒå›´

### 3.1 ç§»åŠ¨ç«¯å®ç°åŠŸèƒ½ï¼ˆåŸºäºä¸šåŠ¡åœºæ™¯ï¼‰

| åŠŸèƒ½æ¨¡å— | ç§»åŠ¨ç«¯å®ç° | ä¸šåŠ¡åœºæ™¯è¯´æ˜ |
|---------|-----------|-------------|
| è®¿å®¢é¦–é¡µ | âœ… | è®¿å®¢å…¥å£ï¼Œç»Ÿè®¡æ¦‚è§ˆ |
| æˆ‘çš„é¢„çº¦ | âœ… | æŸ¥çœ‹/å–æ¶ˆé¢„çº¦è®°å½• |
| åˆ›å»ºé¢„çº¦ | âœ… | è®¿å®¢è‡ªåŠ©é¢„çº¦ |
| æ‰«ç ç­¾åˆ° | âœ… | å‰å°å¿«é€Ÿç­¾åˆ° |
| è®¿å®¢äºŒç»´ç  | âœ… | é€šè¡Œå‡­è¯å±•ç¤º |
| è®¿é—®è®°å½• | âœ… | å†å²è®¿é—®æŸ¥è¯¢ |
| èº«ä»½éªŒè¯ | âœ… | èº«ä»½è¯+æ‰‹æœºå·éªŒè¯ |
| é¢„çº¦è¯¦æƒ… | âœ… | é¢„çº¦ä¿¡æ¯æŸ¥çœ‹ |

### 3.2 ä»…PCç«¯å®ç°åŠŸèƒ½

| åŠŸèƒ½æ¨¡å— | åŸå› è¯´æ˜ |
|---------|---------|
| è®¿å®¢å®¡æ‰¹ | éœ€è¦å¤æ‚å®¡æ‰¹æµç¨‹ï¼Œé€‚åˆPCæ“ä½œ |
| é»‘åå•ç®¡ç† | ç®¡ç†ç±»åŠŸèƒ½ï¼Œæ“ä½œé¢‘æ¬¡ä½ |
| ç»Ÿè®¡æŠ¥è¡¨ | å›¾è¡¨å±•ç¤ºï¼ŒPCä½“éªŒæ›´ä½³ |
| ç³»ç»Ÿé…ç½® | ç®¡ç†å‘˜ä¸“ç”¨ï¼Œå®‰å…¨è€ƒè™‘ |
| æ‰¹é‡å¯¼å…¥ | æ–‡ä»¶æ“ä½œï¼ŒPCæ›´ä¾¿æ· |
| ç‰©æµç®¡ç† | æ¶‰åŠå¤šè¡¨å•ï¼ŒPCæ•ˆç‡é«˜ |

## 4. æ ¸å¿ƒé¡µé¢è®¾è®¡

### 4.1 è®¿å®¢é¦–é¡µ (`visitor/index.vue`)

**é¡µé¢ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         çŠ¶æ€æ  + å¯¼èˆªæ           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚     è®¿å®¢ç»Ÿè®¡å¡ç‰‡         â”‚   â”‚
â”‚  â”‚  ä»Šæ—¥é¢„çº¦ | å¾…ç­¾åˆ° | å·²å®Œæˆâ”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¿«æ·æ“ä½œåŒºåŸŸ                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”  â”‚
â”‚  â”‚é¢„çº¦ â”‚ â”‚ç­¾åˆ° â”‚ â”‚äºŒç»´ç â”‚ â”‚è®°å½• â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è¿‘æœŸé¢„çº¦åˆ—è¡¨                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ é¢„çº¦å¡ç‰‡1                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ é¢„çº¦å¡ç‰‡2                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒåŠŸèƒ½**:
- è®¿å®¢ç»Ÿè®¡å±•ç¤ºï¼ˆä»Šæ—¥é¢„çº¦æ•°ã€å¾…ç­¾åˆ°æ•°ã€å·²å®Œæˆæ•°ï¼‰
- å¿«æ·æ“ä½œå…¥å£ï¼ˆæˆ‘çš„é¢„çº¦ã€æ‰«ç ç­¾åˆ°ã€äºŒç»´ç ã€è®¿é—®è®°å½•ï¼‰
- è¿‘æœŸé¢„çº¦åˆ—è¡¨ï¼ˆæœ€è¿‘5æ¡ï¼‰

### 4.2 æˆ‘çš„é¢„çº¦é¡µé¢ (`visitor/appointment.vue`)

**é¡µé¢ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å¯¼èˆªæ ï¼šæˆ‘çš„é¢„çº¦         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ ‡ç­¾é¡µï¼šå…¨éƒ¨ | å¾…å®¡æ‰¹ | å·²æ‰¹å‡†   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é¢„çº¦åˆ—è¡¨                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ è®¿å®¢å§“å        [çŠ¶æ€æ ‡ç­¾] â”‚   â”‚
â”‚  â”‚ è¢«è®¿äººï¼šxxx               â”‚   â”‚
â”‚  â”‚ é¢„çº¦æ—¶é—´ï¼šxx-xx xx:xx     â”‚   â”‚
â”‚  â”‚ æ¥è®¿äº‹ç”±ï¼šxxx             â”‚   â”‚
â”‚  â”‚ [å–æ¶ˆé¢„çº¦]                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚            [+] åˆ›å»ºé¢„çº¦          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒåŠŸèƒ½**:
- æ ‡ç­¾é¡µç­›é€‰ï¼ˆå…¨éƒ¨/å¾…å®¡æ‰¹/å·²æ‰¹å‡†ï¼‰
- é¢„çº¦åˆ—è¡¨å±•ç¤º
- å–æ¶ˆé¢„çº¦æ“ä½œ
- åˆ›å»ºæ–°é¢„çº¦å…¥å£

### 4.3 æ‰«ç ç­¾åˆ°é¡µé¢ (`visitor/checkin.vue`)

**é¡µé¢ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         å¯¼èˆªæ ï¼šè®¿å®¢ç­¾åˆ°         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ‰«ç åŒºåŸŸ                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         ğŸ“±              â”‚   â”‚
â”‚  â”‚   è¯·æ‰«æè®¿å®¢äºŒç»´ç         â”‚   â”‚
â”‚  â”‚      [å¼€å§‹æ‰«ç ]          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”€â”€â”€ æˆ– â”€â”€â”€           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ [äºŒç»´ç å†…å®¹è¾“å…¥æ¡†] [éªŒè¯] â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  èº«ä»½è¯éªŒè¯åŒºåŸŸ                  â”‚
â”‚  èº«ä»½è¯å·ï¼š[____________]       â”‚
â”‚  æ‰‹æœºå·ï¼š  [____________]       â”‚
â”‚  [èº«ä»½è¯éªŒè¯]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ ¸å¿ƒåŠŸèƒ½**:
- äºŒç»´ç æ‰«æç­¾åˆ°
- æ‰‹åŠ¨è¾“å…¥äºŒç»´ç éªŒè¯
- èº«ä»½è¯+æ‰‹æœºå·éªŒè¯
- éªŒè¯ç»“æœå¼¹çª—å±•ç¤º

## 5. APIæ¥å£è®¾è®¡

### 5.1 æ¥å£å‰ç¼€
```
/api/v1/mobile/visitor/
```

### 5.2 æ ¸å¿ƒæ¥å£åˆ—è¡¨

| æ¨¡å— | æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|------|
| **é¢„çº¦ç®¡ç†** | `/appointment` | POST | åˆ›å»ºé¢„çº¦ |
| | `/appointment/{id}/cancel` | PUT | å–æ¶ˆé¢„çº¦ |
| | `/my-appointments` | GET | æˆ‘çš„é¢„çº¦åˆ—è¡¨ |
| | `/appointment/{id}` | GET | é¢„çº¦è¯¦æƒ… |
| **ç­¾åˆ°ç­¾é€€** | `/checkin/qrcode` | POST | äºŒç»´ç ç­¾åˆ° |
| | `/checkout/{id}` | POST | è®¿å®¢ç­¾é€€ |
| | `/checkin/status/{id}` | GET | ç­¾åˆ°çŠ¶æ€ |
| **ä½ç½®è¿½è¸ª** | `/location/{id}` | GET | è®¿å®¢ä½ç½® |
| | `/location/{id}` | PUT | æ›´æ–°ä½ç½® |
| **è½¦è¯ç®¡ç†** | `/vehicle-permit/{id}` | GET | è·å–è½¦è¯ |
| | `/vehicle-permit/{id}` | POST | ç”Ÿæˆè½¦è¯ |
| **è®°å½•æŸ¥è¯¢** | `/access-records/{id}` | GET | é€šè¡Œè®°å½• |
| | `/history/{visitorId}` | GET | è®¿é—®å†å² |
| **å·¥å…·æ¥å£** | `/validate` | POST | èº«ä»½éªŒè¯ |
| | `/visitee/{userId}` | GET | è¢«è®¿äººä¿¡æ¯ |
| | `/areas` | GET | è®¿é—®åŒºåŸŸåˆ—è¡¨ |
| | `/appointment-types` | GET | é¢„çº¦ç±»å‹ |
| **OCRè¯†åˆ«** | `/ocr/idcard` | POST | èº«ä»½è¯OCR |
| **ç»Ÿè®¡** | `/statistics/{userId}` | GET | ä¸ªäººç»Ÿè®¡ |

### 5.3 æ¥å£å“åº”æ ¼å¼

```json
{
  "code": 200,
  "success": true,
  "message": "æ“ä½œæˆåŠŸ",
  "data": { ... },
  "timestamp": 1702800000000
}
```

## 6. çŠ¶æ€ç®¡ç†

### 6.1 Pinia Store ç»“æ„

```javascript
// store/modules/visitor.js
export const useVisitorStore = defineStore('visitor', {
  state: () => ({
    appointments: [],      // é¢„çº¦åˆ—è¡¨
    currentAppointment: null, // å½“å‰é¢„çº¦
    statistics: {          // ç»Ÿè®¡æ•°æ®
      todayCount: 0,
      pendingCount: 0,
      completedCount: 0
    },
    visitorInfo: null      // è®¿å®¢ä¿¡æ¯
  }),
  
  actions: {
    async loadAppointments() { ... },
    async createAppointment(data) { ... },
    async cancelAppointment(id) { ... },
    async checkIn(qrCode) { ... }
  }
})
```

## 7. äº¤äº’è§„èŒƒ

### 7.1 åŠ è½½çŠ¶æ€
- åˆ—è¡¨åŠ è½½ï¼šéª¨æ¶å±
- æŒ‰é’®æ“ä½œï¼šæŒ‰é’®ç¦ç”¨ + æ–‡å­—å˜æ›´ï¼ˆå¦‚"éªŒè¯ä¸­..."ï¼‰
- é¡µé¢åˆ‡æ¢ï¼šç»Ÿä¸€è¿‡æ¸¡åŠ¨ç”»

### 7.2 é”™è¯¯å¤„ç†
- ç½‘ç»œé”™è¯¯ï¼šToastæç¤º + é‡è¯•æŒ‰é’®
- ä¸šåŠ¡é”™è¯¯ï¼šModalå¼¹çª—è¯´æ˜
- è¡¨å•é”™è¯¯ï¼šè¾“å…¥æ¡†ä¸‹æ–¹çº¢è‰²æç¤º

### 7.3 æˆåŠŸåé¦ˆ
- æ“ä½œæˆåŠŸï¼šToastæç¤ºï¼ˆ2ç§’è‡ªåŠ¨æ¶ˆå¤±ï¼‰
- é‡è¦æ“ä½œï¼šModalç¡®è®¤å¼¹çª—

## 8. æ ·å¼è§„èŒƒ

### 8.1 é¢œè‰²ä½“ç³»
```scss
// ä¸»é¢˜è‰²
$primary-color: #1890ff;
$primary-gradient: linear-gradient(135deg, #1890ff 0%, #096dd9 100%);

// çŠ¶æ€è‰²
$success-color: #52c41a;
$warning-color: #faad14;
$error-color: #ff4d4f;

// æ–‡å­—è‰²
$text-primary: rgba(0, 0, 0, 0.85);
$text-secondary: rgba(0, 0, 0, 0.65);
$text-disabled: rgba(0, 0, 0, 0.25);
```

### 8.2 é—´è·è§„èŒƒ
```scss
$spacing-xs: 8rpx;
$spacing-sm: 16rpx;
$spacing-md: 24rpx;
$spacing-lg: 32rpx;
$spacing-xl: 48rpx;
```

### 8.3 åœ†è§’è§„èŒƒ
```scss
$border-radius-sm: 8rpx;
$border-radius-md: 16rpx;
$border-radius-lg: 24rpx;
$border-radius-round: 50%;
```

## 9. é¡µé¢è·¯ç”±é…ç½®

```json
// pages.json
{
  "pages": [
    {
      "path": "pages/visitor/index",
      "style": { "navigationBarTitleText": "è®¿å®¢ç®¡ç†" }
    },
    {
      "path": "pages/visitor/appointment",
      "style": { "navigationBarTitleText": "æˆ‘çš„é¢„çº¦" }
    },
    {
      "path": "pages/visitor/create-appointment",
      "style": { "navigationBarTitleText": "åˆ›å»ºé¢„çº¦" }
    },
    {
      "path": "pages/visitor/appointment-detail",
      "style": { "navigationBarTitleText": "é¢„çº¦è¯¦æƒ…" }
    },
    {
      "path": "pages/visitor/checkin",
      "style": { "navigationBarTitleText": "è®¿å®¢ç­¾åˆ°" }
    },
    {
      "path": "pages/visitor/qrcode",
      "style": { "navigationBarTitleText": "è®¿å®¢äºŒç»´ç " }
    },
    {
      "path": "pages/visitor/records",
      "style": { "navigationBarTitleText": "è®¿é—®è®°å½•" }
    }
  ]
}
```

## 10. æ–‡æ¡£ç‰ˆæœ¬

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|------|------|---------|
| v1.0.0 | 2025-12-17 | åˆå§‹ç‰ˆæœ¬ï¼ŒåŸºäºç°æœ‰ä»£ç åˆ†æ |
