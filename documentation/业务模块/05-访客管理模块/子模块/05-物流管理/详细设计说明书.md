# 物流管理子模块 - 详细设计说明书

> **版本**: v1.0.0  
> **更新日期**: 2025-01-30

## 1. 模块概述

物流管理子模块负责访客携带物品的登记、暂存、领取等全流程管理。

## 2. 类结构设计

### 2.1 实体类 (LogisticsEntity)

| 字段 | 类型 | 说明 |
|------|------|------|
| logisticsNo | String | 物流编号 |
| registrationId | Long | 登记ID |
| visitorId | Long | 访客ID |
| itemName | String | 物品名称 |
| itemType | String | 物品类型 |
| itemCount | Integer | 物品数量 |
| itemImage | String | 物品照片 |
| storageLocation | String | 存放位置 |
| depositTime | LocalDateTime | 寄存时间 |
| pickupTime | LocalDateTime | 领取时间 |
| status | String | 状态 |

### 2.2 Manager层核心方法

- depositItem: 物品寄存
- pickupItem: 物品领取
- getDepositedItems: 获取寄存物品列表
- checkOverdueItems: 检查超期物品

## 3. 数据库详细设计

### 3.1 物流登记表 (vis_logistics)

| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | BIGINT | 主键 |
| logistics_no | VARCHAR(32) | 物流编号 |
| registration_id | BIGINT | 登记ID |
| visitor_id | BIGINT | 访客ID |
| item_name | VARCHAR(100) | 物品名称 |
| item_type | VARCHAR(50) | 物品类型 |
| item_count | INT | 物品数量 |
| item_image | VARCHAR(500) | 物品照片 |
| storage_location | VARCHAR(100) | 存放位置 |
| deposit_time | DATETIME | 寄存时间 |
| pickup_time | DATETIME | 领取时间 |
| status | VARCHAR(20) | 状态 |
| operator_id | BIGINT | 操作人ID |
| remark | VARCHAR(500) | 备注 |

## 4. 接口详细设计

### 4.1 物品寄存
- **URL**: POST /api/v1/visitor/logistics/deposit
- **请求参数**: registrationId, itemName, itemType, itemCount, itemImage
- **响应**: logisticsNo, storageLocation

### 4.2 物品领取
- **URL**: POST /api/v1/visitor/logistics/pickup
- **请求参数**: logisticsNo
- **响应**: success

### 4.3 查询寄存物品
- **URL**: GET /api/v1/visitor/logistics/list
- **请求参数**: registrationId
- **响应**: 物品列表

## 5. 业务规则

| 规则 | 说明 |
|------|------|
| 寄存时机 | 签到时登记 |
| 领取时机 | 签出前必须领取 |
| 超期处理 | 超过7天转交保安室 |
| 贵重物品 | 需额外登记确认 |

## 6. 错误码定义

| 错误码 | 说明 |
|--------|------|
| VIS_LOG_001 | 物流记录不存在 |
| VIS_LOG_002 | 物品已领取 |
| VIS_LOG_003 | 存放位置已满 |

