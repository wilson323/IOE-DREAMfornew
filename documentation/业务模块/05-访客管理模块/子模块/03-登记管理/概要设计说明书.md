# 登记管理子模块 - 概要设计说明书

> **版本**: v1.0.0  
> **更新日期**: 2025-01-30

## 1. 系统架构

### 1.1 模块定位

登记管理是访客到达后的核心处理模块，负责签到签出、凭证管理和在场监控。

### 1.2 架构图

```
┌─────────────────────────────────────────────────┐
│                  登记管理模块                     │
├─────────────────────────────────────────────────┤
│  Controller层                                    │
│  ├── RegistrationController (登记管理)           │
│  └── OnsiteController (在场监控)                 │
├─────────────────────────────────────────────────┤
│  Service层                                       │
│  ├── RegistrationService                        │
│  └── OnsiteMonitorService                       │
├─────────────────────────────────────────────────┤
│  Manager层                                       │
│  ├── RegistrationManager                        │
│  ├── CredentialManager                          │
│  └── OnsiteAlertManager                         │
├─────────────────────────────────────────────────┤
│  DAO层                                          │
│  ├── RegistrationDao                            │
│  └── VisitorCardDao                             │
└─────────────────────────────────────────────────┘
```

## 2. 模块设计

### 2.1 核心模块

| 模块 | 职责 |
|------|------|
| 签到管理 | 预约访客签到、临时访客登记 |
| 签出管理 | 主动签出、自动签出、强制签出 |
| 凭证管理 | 访客卡发放/回收、二维码生成 |
| 在场监控 | 实时监控、超时预警、区域分布 |

### 2.2 模块依赖

- 预约管理：获取预约信息
- 身份验证：人脸识别验证
- 门禁系统：临时权限下发
- 通知服务：发送通知

## 3. 数据库概念模型

### 3.1 ER图

```
┌─────────────┐     ┌─────────────┐
│   预约信息   │────<│   登记信息   │
└─────────────┘     └──────┬──────┘
                          │
                          │ 1:1
                          ▼
                   ┌─────────────┐
                   │   访客卡    │
                   └─────────────┘
```

## 4. 技术选型

| 技术 | 选型 | 说明 |
|------|------|------|
| 人脸识别 | 虹软/商汤 | 人脸比对 |
| 二维码 | ZXing | 动态二维码 |
| 实时监控 | WebSocket | 在场状态推送 |
| 定时任务 | XXL-JOB | 超时检测 |

## 5. 接口概览

| 接口 | 方法 | 说明 |
|------|------|------|
| /registration/checkIn | POST | 访客签到 |
| /registration/checkOut | POST | 访客签出 |
| /registration/walkIn | POST | 临时登记 |
| /registration/onsite | GET | 在场访客 |
| /registration/overtime | GET | 超时访客 |

