# æ¶ˆè´¹ç®¡ç†æ¨¡å— - ç§»åŠ¨ç«¯å®Œæ•´å®ç°æ€»ç»“

> **ç‰ˆæœ¬**: v1.0.0
> **åˆ›å»ºæ—¥æœŸ**: 2025-12-24
> **çŠ¶æ€**: åˆ†æå®Œæˆï¼Œå¾…å®æ–½

---

## ğŸ“Š æ‰§è¡Œæ‘˜è¦

### å½“å‰çŠ¶æ€

| æ¨¡å— | å®Œæˆåº¦ | è¯´æ˜ |
|------|--------|------|
| **é¡µé¢å®ç°** | 82% (9/11) | ç¼ºå°‘2ä¸ªæ ¸å¿ƒé¡µé¢ |
| **APIå®ç°** | 78% | æ ¸å¿ƒAPIå®Œæˆï¼Œå¢å¼ºAPIå¾…è¡¥å…… |
| **åç«¯å®ç°** | 95% | äº¤æ˜“æ ¸å¿ƒå®Œæˆï¼Œç®¡ç†åŠŸèƒ½å¾…è¡¥å…… |
| **åŠŸèƒ½å®Œæ•´æ€§** | 78% | åŸºç¡€åŠŸèƒ½å®Œæˆï¼Œé«˜çº§åŠŸèƒ½å¾…è¡¥å…… |

### æ ¸å¿ƒå‘ç°

âœ… **å·²å®Œæˆ**:
- äº¤æ˜“åŠŸèƒ½ï¼ˆæ‰«ç ã€NFCã€äººè„¸ã€å¿«é€Ÿæ¶ˆè´¹ï¼‰
- è´¦æˆ·ç®¡ç†ï¼ˆä½™é¢ã€è¯¦æƒ…ã€çŠ¶æ€ï¼‰
- äº¤æ˜“è®°å½•æŸ¥è¯¢
- æ¶ˆè´¹ç»Ÿè®¡åˆ†æ
- ç¦»çº¿æ•°æ®åŒæ­¥

âŒ **æ ¸å¿ƒç¼ºå¤±**:
- è¡¥è´´æŸ¥è¯¢æ¨¡å—ï¼ˆå®Œæ•´æ¨¡å—ï¼‰
- å¡ç‰‡ç®¡ç†æ¨¡å—ï¼ˆå®Œæ•´æ¨¡å—ï¼‰
- å……å€¼æ”¯ä»˜å®Œå–„ï¼ˆå¾®ä¿¡/æ”¯ä»˜å®é›†æˆï¼‰
- é€€æ¬¾åŠŸèƒ½ï¼ˆå®Œæ•´æµç¨‹ï¼‰
- åœ¨çº¿è®¢é¤æ¨¡å—ï¼ˆå®Œæ•´æ¨¡å—ï¼‰

---

## ğŸ¯ å®æ–½ä¼˜å…ˆçº§

### P0çº§ï¼ˆç«‹å³æ‰§è¡Œï¼‰- æ— 

âœ… **æ‰€æœ‰P0çº§åŠŸèƒ½å·²å®ç°**

### P1çº§ï¼ˆ2-3å‘¨å†…å®Œæˆï¼‰- 5é¡¹

1. **è¡¥è´´æŸ¥è¯¢æ¨¡å—** (1å‘¨)
   - è¡¥è´´ä½™é¢æŸ¥è¯¢
   - è¡¥è´´å‘æ”¾è®°å½•
   - è¡¥è´´ä½¿ç”¨æ˜ç»†
   - è¡¥è´´åˆ°æœŸæé†’

2. **å¡ç‰‡ç®¡ç†æ¨¡å—** (1å‘¨)
   - å¡ç‰‡æŒ‚å¤±ç”³è¯·
   - å¡ç‰‡è§£æŒ‚æ“ä½œ
   - å¡ç‰‡çŠ¶æ€æŸ¥è¯¢
   - æ“ä½œå†å²è®°å½•

3. **å……å€¼åŠŸèƒ½å®Œå–„** (3-5å¤©)
   - å¾®ä¿¡æ”¯ä»˜é›†æˆ
   - æ”¯ä»˜å®æ”¯ä»˜é›†æˆ
   - æ”¯ä»˜ç»“æœå›è°ƒ
   - è®¢å•çŠ¶æ€è·Ÿè¸ª

4. **é€€æ¬¾åŠŸèƒ½** (1å‘¨)
   - é€€æ¬¾ç”³è¯·æ¥å£
   - é€€æ¬¾å®¡æ ¸æµç¨‹
   - é€€æ¬¾è®°å½•æŸ¥è¯¢
   - é€€æ¬¾çŠ¶æ€è·Ÿè¸ª

5. **åœ¨çº¿è®¢é¤æ¨¡å—** (1.5å‘¨)
   - èœå“æµè§ˆ
   - è®¢é¤ä¸‹å•
   - è®¢é¤è®°å½•
   - è®¢é¤å–æ¶ˆ

### P2çº§ï¼ˆ4-6å‘¨å†…å®Œæˆï¼‰- 3é¡¹

1. æ¶ˆè´¹è¶‹åŠ¿åˆ†æ
2. æ™ºèƒ½æ¨èç³»ç»Ÿ
3. æ¶ˆæ¯é€šçŸ¥æ¨é€

---

## ğŸ“ æ–‡ä»¶ç»“æ„

### åç«¯æ–‡ä»¶ç»“æ„

```
microservices/ioedream-consume-service/src/main/java/net/lab1024/sa/consume/
â”œâ”€â”€ controller/
â”‚   â”œâ”€â”€ ConsumeMobileController.java              âœ… å·²æœ‰
â”‚   â”œâ”€â”€ ConsumeSubsidyMobileController.java       âŒ æ–°å¢ - è¡¥è´´ç®¡ç†
â”‚   â”œâ”€â”€ ConsumeCardMobileController.java          âŒ æ–°å¢ - å¡ç‰‡ç®¡ç†
â”‚   â”œâ”€â”€ ConsumeRechargeMobileController.java      âŒ æ–°å¢ - å……å€¼ç®¡ç†
â”‚   â”œâ”€â”€ ConsumeRefundMobileController.java        âŒ æ–°å¢ - é€€æ¬¾ç®¡ç†
â”‚   â””â”€â”€ ConsumeOrderingMobileController.java      âŒ æ–°å¢ - è®¢é¤ç®¡ç†
â”œâ”€â”€ service/
â”‚   â”œâ”€â”€ ConsumeMobileService.java                 âœ… å·²æœ‰
â”‚   â”œâ”€â”€ ConsumeSubsidyService.java                âŒ æ–°å¢
â”‚   â”œâ”€â”€ ConsumeCardService.java                   âŒ æ–°å¢
â”‚   â”œâ”€â”€ ConsumeRechargeService.java               âŒ æ–°å¢
â”‚   â”œâ”€â”€ ConsumeRefundService.java                 âŒ æ–°å¢
â”‚   â””â”€â”€ ConsumeOrderingService.java               âŒ æ–°å¢
â”œâ”€â”€ manager/
â”‚   â””â”€â”€ (ç›¸åº”Managerç±»)
â”œâ”€â”€ dao/
â”‚   â””â”€â”€ (ç›¸åº”DAOç±»)
â””â”€â”€ domain/
    â”œâ”€â”€ vo/
    â”‚   â”œâ”€â”€ ConsumeSubsidyBalanceVO.java          âŒ æ–°å¢
    â”‚   â”œâ”€â”€ ConsumeSubsidyRecordVO.java           âŒ æ–°å¢
    â”‚   â”œâ”€â”€ ConsumeSubsidyUsageVO.java            âŒ æ–°å¢
    â”‚   â”œâ”€â”€ ConsumeCardStatusVO.java              âŒ æ–°å¢
    â”‚   â””â”€â”€ ...
    â””â”€â”€ form/
        â”œâ”€â”€ ConsumeSubsidyQueryForm.java          âŒ æ–°å¢
        â”œâ”€â”€ ConsumeCardLossForm.java              âŒ æ–°å¢
        â””â”€â”€ ...
```

### å‰ç«¯æ–‡ä»¶ç»“æ„

```
smart-app/src/
â”œâ”€â”€ api/business/consume/
â”‚   â”œâ”€â”€ consume-api.js                            âœ… å·²æœ‰
â”‚   â”œâ”€â”€ subsidy-api.js                            âŒ æ–°å¢ - è¡¥è´´API
â”‚   â”œâ”€â”€ card-api.js                               âŒ æ–°å¢ - å¡ç‰‡API
â”‚   â”œâ”€â”€ recharge-api.js                           âŒ æ–°å¢ - å……å€¼API
â”‚   â”œâ”€â”€ refund-api.js                             âŒ æ–°å¢ - é€€æ¬¾API
â”‚   â””â”€â”€ ordering-api.js                           âŒ æ–°å¢ - è®¢é¤API
â””â”€â”€ pages/consume/
    â”œâ”€â”€ index.vue                                  âœ… å·²æœ‰
    â”œâ”€â”€ account.vue                                âœ… å·²æœ‰
    â”œâ”€â”€ qrcode.vue                                 âœ… å·²æœ‰
    â”œâ”€â”€ payment.vue                                âœ… å·²æœ‰
    â”œâ”€â”€ recharge.vue                               âœ… å·²æœ‰
    â”œâ”€â”€ record.vue                                 âœ… å·²æœ‰
    â”œâ”€â”€ refund.vue                                 âœ… å·²æœ‰
    â”œâ”€â”€ statistics.vue                             âœ… å·²æœ‰
    â”œâ”€â”€ transaction.vue                            âœ… å·²æœ‰
    â”œâ”€â”€ subsidy.vue                                âŒ æ–°å¢ - è¡¥è´´æŸ¥è¯¢
    â”œâ”€â”€ card-manage.vue                            âŒ æ–°å¢ - å¡ç‰‡ç®¡ç†
    â”œâ”€â”€ ordering.vue                               âŒ æ–°å¢ - åœ¨çº¿è®¢é¤
    â”œâ”€â”€ order-history.vue                          âŒ æ–°å¢ - è®¢é¤è®°å½•
    â””â”€â”€ analysis.vue                               âŒ æ–°å¢ - æ¶ˆè´¹åˆ†æ
```

---

## ğŸ”Œ APIæ¥å£æ¸…å•

### è¡¥è´´ç®¡ç†æ¥å£ï¼ˆæ–°å¢ï¼‰

```java
GET  /api/v1/consume/mobile/subsidy/balance/{userId}
     â†’ è·å–è¡¥è´´ä½™é¢

GET  /api/v1/consume/mobile/subsidy/records/{userId}
     â†’ è·å–è¡¥è´´å‘æ”¾è®°å½•

GET  /api/v1/consume/mobile/subsidy/detail/{subsidyId}
     â†’ è·å–è¡¥è´´è¯¦æƒ…

GET  /api/v1/consume/mobile/subsidy/usage/{userId}
     â†’ è·å–è¡¥è´´ä½¿ç”¨æ˜ç»†
```

### å¡ç‰‡ç®¡ç†æ¥å£ï¼ˆæ–°å¢ï¼‰

```java
POST /api/v1/consume/mobile/card/loss
     â†’ å¡ç‰‡æŒ‚å¤±

POST /api/v1/consume/mobile/card/unlock
     â†’ å¡ç‰‡è§£æŒ‚

GET  /api/v1/consume/mobile/card/status/{userId}
     â†’ è·å–å¡ç‰‡çŠ¶æ€

GET  /api/v1/consume/mobile/card/history/{userId}
     â†’ è·å–å¡ç‰‡æ“ä½œå†å²
```

### å……å€¼ç®¡ç†æ¥å£ï¼ˆæ–°å¢ï¼‰

```java
POST /api/v1/consume/mobile/recharge/create
     â†’ åˆ›å»ºå……å€¼è®¢å•

POST /api/v1/consume/mobile/recharge/pay
     â†’ å¤„ç†æ”¯ä»˜

GET  /api/v1/consume/mobile/recharge/result/{orderId}
     â†’ æŸ¥è¯¢æ”¯ä»˜ç»“æœ

POST /api/v1/consume/mobile/recharge/callback
     â†’ æ”¯ä»˜å›è°ƒ
```

### é€€æ¬¾ç®¡ç†æ¥å£ï¼ˆæ–°å¢ï¼‰

```java
POST /api/v1/consume/mobile/refund/apply
     â†’ ç”³è¯·é€€æ¬¾

GET  /api/v1/consume/mobile/refund/records/{userId}
     â†’ è·å–é€€æ¬¾è®°å½•

GET  /api/v1/consume/mobile/refund/status/{refundId}
     â†’ æŸ¥è¯¢é€€æ¬¾çŠ¶æ€

POST /api/v1/consume/mobile/refund/cancel/{refundId}
     â†’ å–æ¶ˆé€€æ¬¾
```

### è®¢é¤ç®¡ç†æ¥å£ï¼ˆæ–°å¢ï¼‰

```java
GET  /api/v1/consume/mobile/ordering/dishes
     â†’ è·å–èœå“åˆ—è¡¨

GET  /api/v1/consume/mobile/ordering/dish/{dishId}
     â†’ è·å–èœå“è¯¦æƒ…

POST /api/v1/consume/mobile/ordering/create
     â†’ åˆ›å»ºè®¢é¤è®¢å•

GET  /api/v1/consume/mobile/ordering/orders/{userId}
     â†’ è·å–è®¢é¤è®°å½•

POST /api/v1/consume/mobile/ordering/cancel/{orderId}
     â†’ å–æ¶ˆè®¢é¤

GET  /api/v1/consume/mobile/ordering/verify/{orderId}
     â†’ æ ¸é”€è®¢é¤
```

---

## ğŸ“ å¼€å‘è§„èŒƒé€ŸæŸ¥

### åç«¯è§„èŒƒ

```java
// âœ… æ­£ç¡®çš„ç±»æ³¨è§£
@RestController
@RequestMapping("/api/v1/consume/mobile")
@Tag(name = "ç§»åŠ¨ç«¯XXç®¡ç†", description = "ç§»åŠ¨ç«¯XXæ¥å£")
@Slf4j
public class XxxController {
    @Resource
    private XxxService xxxService;
}

// âœ… æ­£ç¡®çš„æ–¹æ³•å®ç°
@Operation(summary = "æ¥å£åç§°", description = "æ¥å£æè¿°")
@PostMapping("/xxx")
public ResponseDTO<XxxVO> xxxMethod(@Valid @RequestBody XxxForm form) {
    log.info("[æ¨¡å—å] æ“ä½œæè¿°: param1={}, param2={}", form.getParam1(), form.getParam2());
    try {
        XxxVO result = xxxService.xxxMethod(form);
        log.info("[æ¨¡å—å] æ“ä½œæˆåŠŸ: result={}", result);
        return ResponseDTO.ok(result);
    } catch (BusinessException e) {
        log.warn("[æ¨¡å—å] ä¸šåŠ¡å¼‚å¸¸: error={}", e.getMessage());
        throw e;
    } catch (Exception e) {
        log.error("[æ¨¡å—å] ç³»ç»Ÿå¼‚å¸¸: error={}", e.getMessage(), e);
        throw new SystemException("ERROR_CODE", "æ“ä½œå¤±è´¥", e);
    }
}

// âœ… Serviceæ¥å£è¿”å›ç±»å‹
public interface XxxService {
    XxxVO xxxMethod(XxxForm form);              // ç›´æ¥è¿”å›VO
    PageResult<XxxVO> pageQuery(XxxQueryForm);  // ç›´æ¥è¿”å›PageResult
    void xxxUpdate(XxxUpdateForm form);         // voidè¿”å›ç±»å‹
}
```

### å‰ç«¯è§„èŒƒ

```javascript
// âœ… APIå°è£…
export const xxxApi = {
  xxxMethod: (param1, param2) => getRequest('/api/v1/consume/mobile/xxx', {
    param1,
    param2
  }),

  xxxPost: (data) => postRequest('/api/v1/consume/mobile/xxx', data)
}

// âœ… é¡µé¢ç»„ä»¶ç»“æ„
<script setup>
import { ref, onMounted } from 'vue'
import { useUserStore } from '@/store/modules/system/user.js'
import { xxxApi } from '@/api/business/consume/xxx-api.js'

// å“åº”å¼æ•°æ®
const userStore = useUserStore()
const dataList = ref([])

// é¡µé¢ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  loadData()
})

// æ•°æ®åŠ è½½
const loadData = async () => {
  try {
    const userId = userStore.employeeId
    const result = await xxxApi.getData(userId)
    if (result.success && result.data) {
      dataList.value = result.data
    }
  } catch (error) {
    console.error('åŠ è½½æ•°æ®å¤±è´¥:', error)
    uni.showToast({ title: 'åŠ è½½å¤±è´¥', icon: 'none' })
  }
}
</script>
```

---

## âœ… éªŒæ”¶æ£€æŸ¥æ¸…å•

### åŠŸèƒ½éªŒæ”¶

- [ ] è¡¥è´´æŸ¥è¯¢
  - [ ] ä½™é¢æ˜¾ç¤ºæ­£ç¡®
  - [ ] å‘æ”¾è®°å½•å®Œæ•´
  - [ ] ä½¿ç”¨æ˜ç»†å‡†ç¡®
  - [ ] åˆ°æœŸæé†’åŠŸèƒ½

- [ ] å¡ç‰‡ç®¡ç†
  - [ ] æŒ‚å¤±åŠŸèƒ½æ­£å¸¸
  - [ ] è§£æŒ‚åŠŸèƒ½æ­£å¸¸
  - [ ] çŠ¶æ€æŸ¥è¯¢å‡†ç¡®
  - [ ] å†å²è®°å½•å®Œæ•´

- [ ] å……å€¼åŠŸèƒ½
  - [ ] å¾®ä¿¡æ”¯ä»˜æ­£å¸¸
  - [ ] æ”¯ä»˜å®æ”¯ä»˜æ­£å¸¸
  - [ ] æ”¯ä»˜å›è°ƒå¤„ç†æ­£ç¡®
  - [ ] è®¢å•çŠ¶æ€æ›´æ–°åŠæ—¶

- [ ] é€€æ¬¾åŠŸèƒ½
  - [ ] é€€æ¬¾ç”³è¯·æ­£å¸¸
  - [ ] å®¡æ ¸æµç¨‹å®Œæ•´
  - [ ] é€€æ¬¾è®°å½•æŸ¥è¯¢
  - [ ] é€€æ¬¾çŠ¶æ€è·Ÿè¸ª

- [ ] è®¢é¤åŠŸèƒ½
  - [ ] èœå“å±•ç¤ºæ­£å¸¸
  - [ ] è®¢é¤ä¸‹å•æˆåŠŸ
  - [ ] è®¢é¤è®°å½•å®Œæ•´
  - [ ] å–æ¶ˆè®¢é¤åŠŸèƒ½

### æŠ€æœ¯éªŒæ”¶

- [ ] ä»£ç è§„èŒƒ
  - [ ] ä½¿ç”¨@Slf4jæ³¨è§£
  - [ ] ä½¿ç”¨@Resourceæ³¨è§£
  - [ ] éµå¾ªå››å±‚æ¶æ„
  - [ ] æ—¥å¿—æ ¼å¼ç»Ÿä¸€

- [ ] APIæ–‡æ¡£
  - [ ] Swaggeræ³¨è§£å®Œæ•´
  - [ ] æ¥å£å‚æ•°è¯´æ˜
  - [ ] å“åº”ç¤ºä¾‹
  - [ ] é”™è¯¯ç è¯´æ˜

- [ ] æµ‹è¯•è¦†ç›–
  - [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡>80%
  - [ ] é›†æˆæµ‹è¯•é€šè¿‡
  - [ ] APIæµ‹è¯•é€šè¿‡
  - [ ] æ€§èƒ½æµ‹è¯•è¾¾æ ‡

### æ€§èƒ½éªŒæ”¶

- [ ] å“åº”æ—¶é—´
  - [ ] ä½™é¢æŸ¥è¯¢ < 1ç§’
  - [ ] åˆ—è¡¨åŠ è½½ < 2ç§’
  - [ ] æ”¯ä»˜å¤„ç† < 3ç§’
  - [ ] é¡µé¢é¦–å± < 2ç§’

- [ ] å¹¶å‘èƒ½åŠ›
  - [ ] æ”¯æŒ100 TPS
  - [ ] æ•°æ®åº“è¿æ¥æ± æ­£å¸¸
  - [ ] æ— å†…å­˜æ³„æ¼
  - [ ] CPUä½¿ç”¨ç‡åˆç†

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### å¼€å‘å›¢é˜Ÿ

- **åç«¯å¼€å‘**: è´Ÿè´£Controllerã€Serviceã€Managerã€DAOå±‚å¼€å‘
- **å‰ç«¯å¼€å‘**: è´Ÿè´£Vueé¡µé¢ã€APIå°è£…ã€çŠ¶æ€ç®¡ç†
- **æµ‹è¯•å›¢é˜Ÿ**: è´Ÿè´£å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€æ€§èƒ½æµ‹è¯•
- **æ¶æ„å›¢é˜Ÿ**: è´Ÿè´£æŠ€æœ¯è¯„å®¡ã€ä»£ç å®¡æŸ¥ã€è§„èŒƒåˆ¶å®š

### å…³é”®æ–‡æ¡£

- **ä¸šåŠ¡éœ€æ±‚**: `documentation/ä¸šåŠ¡æ¨¡å—/04-æ¶ˆè´¹ç®¡ç†æ¨¡å—/01-åŠŸèƒ½è¯´æ˜/README.md`
- **ç§»åŠ¨ç«¯è®¾è®¡**: `documentation/ä¸šåŠ¡æ¨¡å—/04-æ¶ˆè´¹ç®¡ç†æ¨¡å—/09-ç§»åŠ¨ç«¯è®¾è®¡/`
- **APIæ¥å£è®¾è®¡**: `documentation/ä¸šåŠ¡æ¨¡å—/04-æ¶ˆè´¹ç®¡ç†æ¨¡å—/05-APIæ¥å£è®¾è®¡/README.md`
- **å¼€å‘è§„èŒƒ**: `CLAUDE.md`

---

**ğŸ“ æ–‡æ¡£ç»´æŠ¤**: IOE-DREAMæ¶æ„å›¢é˜Ÿ | 2025-12-24
