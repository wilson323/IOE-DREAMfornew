# æ¶ˆè´¹æ¨¡å—å‰ç«¯å®ç°è®¡åˆ’ä¸å¼€å‘è§„èŒƒ

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯

- **åˆ›å»ºæ—¶é—´**: 2025-12-24
- **ç‰ˆæœ¬**: v1.0.0
- **ç›®çš„**: æ¶ˆè´¹æ¨¡å—å‰ç«¯å®Œæ•´å®ç°è®¡åˆ’
- **ç›®æ ‡**: ä¼ä¸šçº§å®Œæ•´å®ç°ï¼Œç¡®ä¿å…¨å±€ä¸€è‡´æ€§ï¼Œé¿å…å†—ä½™

---

## ğŸ¯ ä¸€ã€åŠŸèƒ½æ¸…å•å¯¹ç…§è¡¨

### 1.1 å·²å®ç°åŠŸèƒ½ âœ…

| æ¨¡å— | åŠŸèƒ½ | çŠ¶æ€ | æ–‡ä»¶è·¯å¾„ | è¯´æ˜ |
|------|------|------|----------|------|
| **è´¦æˆ·ç®¡ç†** | è´¦æˆ·åˆ—è¡¨ | âœ… å®Œæ•´ | `account/account-list.vue` | æœç´¢ã€ç­›é€‰ã€åˆ†é¡µ |
| **è´¦æˆ·ç®¡ç†** | è´¦æˆ·CRUD | âœ… å®Œæ•´ | `account/components/AccountFormModal.vue` | æ–°å¢ã€ç¼–è¾‘ã€åˆ é™¤ |
| **è´¦æˆ·ç®¡ç†** | è´¦æˆ·å†»ç»“/è§£å†» | âœ… å®Œæ•´ | `account/account-list.vue` | çŠ¶æ€ç®¡ç† |
| **è´¦æˆ·ç®¡ç†** | ä½™é¢æ“ä½œ | âœ… å®Œæ•´ | `account/components/BalanceOperationModal.vue` | å……å€¼ã€æ‰£æ¬¾ã€å†»ç»“ |
| **è´¦æˆ·ç®¡ç†** | æ‰¹é‡å¯¼å…¥ | âœ… å®Œæ•´ | `account/components/ImportModal.vue` | Excelå¯¼å…¥ |
| **è´¦æˆ·ç®¡ç†** | æ¶ˆè´¹è®°å½•è·³è½¬ | âœ… å®Œæ•´ | `account/account-list.vue` | è·³è½¬åˆ°äº¤æ˜“è®°å½• |
| **Dashboard** | ç»Ÿè®¡å¡ç‰‡ | âœ… å®Œæ•´ | `consumption/dashboard/index.vue` | è¥ä¸šé¢ã€è®¢å•æ•°ç­‰ |
| **Dashboard** | å¿«é€Ÿæ“ä½œ | âœ… å®Œæ•´ | `consumption/dashboard/index.vue` | å¸¸ç”¨åŠŸèƒ½å…¥å£ |
| **Dashboard** | æ´»åŠ¨åŠ¨æ€ | âœ… å®Œæ•´ | `consumption/dashboard/components/activity-feed.vue` | æœ€è¿‘æ´»åŠ¨åˆ—è¡¨ |
| **é¤åˆ«åˆ†ç±»** | åŸºç¡€åˆ—è¡¨ | âš ï¸ Mock | `meal-category/meal-category-list.vue` | ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ® |
| **å•†å“ç®¡ç†** | å•†å“åˆ—è¡¨ | âš ï¸ éƒ¨åˆ† | `product/product-list.vue` | ç¼ºå°‘æ–°å¢/ç¼–è¾‘è¡¨å• |

### 1.2 ç¼ºå¤±åŠŸèƒ½ âŒ

| æ¨¡å— | åŠŸèƒ½ | ä¼˜å…ˆçº§ | ä¸šåŠ¡é‡è¦æ€§ | è¯´æ˜ |
|------|------|--------|-----------|------|
| **åŒºåŸŸç®¡ç†** | åŒºåŸŸåˆ—è¡¨ | P0 | æ ¸å¿ƒåŸºç¡€ | ç®¡ç†æ¶ˆè´¹åŒºåŸŸ |
| **åŒºåŸŸç®¡ç†** | manage_modeé…ç½® | P0 | æ ¸å¿ƒåŸºç¡€ | é¤åˆ«åˆ¶/è¶…å¸‚åˆ¶/æ··åˆ |
| **åŒºåŸŸç®¡ç†** | fixed_value_configé…ç½® | P0 | æ ¸å¿ƒåŸºç¡€ | åŒºåŸŸçº§å®šé¢é…ç½® |
| **è´¦æˆ·ç±»åˆ«** | è´¦æˆ·ç±»åˆ«åˆ—è¡¨ | P0 | æ ¸å¿ƒåŸºç¡€ | å‘˜å·¥/å­¦ç”Ÿ/è®¿å®¢ç­‰ |
| **è´¦æˆ·ç±»åˆ«** | mode_configé…ç½® | P0 | æ ¸å¿ƒåŸºç¡€ | 6ç§æ¶ˆè´¹æ¨¡å¼JSONé…ç½® |
| **è´¦æˆ·ç±»åˆ«** | area_configé…ç½® | P0 | æ ¸å¿ƒåŸºç¡€ | åŒºåŸŸæƒé™JSONé…ç½® |
| **è´¦æˆ·ç±»åˆ«** | account_level_fixed | P0 | æ ¸å¿ƒåŸºç¡€ | è´¦æˆ·çº§å®šé¢é…ç½® |
| **JSONç¼–è¾‘å™¨** | mode_configç¼–è¾‘å™¨ | P0 | æ ¸å¿ƒç»„ä»¶ | 6ç§æ¨¡å¼é…ç½® |
| **JSONç¼–è¾‘å™¨** | area_configç¼–è¾‘å™¨ | P0 | æ ¸å¿ƒç»„ä»¶ | åŒºåŸŸæƒé™é…ç½® |
| **JSONç¼–è¾‘å™¨** | fixed_value_configç¼–è¾‘å™¨ | P0 | æ ¸å¿ƒç»„ä»¶ | å®šé¢é…ç½® |
| **è¡¥è´´ç®¡ç†** | è¡¥è´´å‘æ”¾ | P1 | é‡è¦åŠŸèƒ½ | æ‰¹é‡å‘æ”¾è¡¥è´´ |
| **è¡¥è´´ç®¡ç†** | è¡¥è´´è®°å½• | P1 | é‡è¦åŠŸèƒ½ | å‘æ”¾å†å²æŸ¥è¯¢ |
| **äº¤æ˜“è®°å½•** | äº¤æ˜“è¯¦æƒ… | P1 | é‡è¦åŠŸèƒ½ | å®Œæ•´äº¤æ˜“ä¿¡æ¯ |
| **äº¤æ˜“è®°å½•** | SAGAçŠ¶æ€å±•ç¤º | P1 | é‡è¦åŠŸèƒ½ | äº‹åŠ¡æ‰§è¡ŒçŠ¶æ€ |
| **è®¾å¤‡ç®¡ç†** | æ¶ˆè´¹æ¨¡å¼ç»‘å®š | P1 | é‡è¦åŠŸèƒ½ | è®¾å¤‡-æ¨¡å¼å…³è” |
| **è®¾å¤‡ç®¡ç†** | è®¾å¤‡çŠ¶æ€ç›‘æ§ | P1 | é‡è¦åŠŸèƒ½ | åœ¨çº¿/ç¦»çº¿çŠ¶æ€ |
| **æŠ¥è¡¨ç»Ÿè®¡** | é”€å”®æŠ¥è¡¨ | P2 | ç»Ÿè®¡åˆ†æ | é”€å”®æ•°æ®ç»Ÿè®¡ |
| **æŠ¥è¡¨ç»Ÿè®¡** | åŒºåŸŸåˆ†æ | P2 | ç»Ÿè®¡åˆ†æ | åŒºåŸŸæ¶ˆè´¹åˆ†æ |
| **è€ƒå‹¤æ¶ˆè´¹** | è€ƒå‹¤æ ‡è¯† | P2 | ç‰¹è‰²åŠŸèƒ½ | is_attendance_consume |
| **å¤šé’±åŒ…** | é’±åŒ…å±•ç¤º | P1 | é‡è¦åŠŸèƒ½ | è¡¥è´´é’±åŒ…+ç°é‡‘é’±åŒ… |
| **å¤šé’±åŒ…** | æ‰£æ¬¾ä¼˜å…ˆçº§ | P1 | é‡è¦åŠŸèƒ½ | å…ˆè¡¥åç°è§„åˆ™å±•ç¤º |

---

## ğŸ—ï¸ äºŒã€è¯¦ç»†å®æ–½è®¡åˆ’

### é˜¶æ®µä¸€ï¼šæ ¸å¿ƒåŸºç¡€æ¨¡å—ï¼ˆP0çº§ï¼‰- 1-2å‘¨

#### 1.1 åŒºåŸŸç®¡ç†æ¨¡å—

**æ–‡ä»¶ç»“æ„**:
```
consumption/region/
â”œâ”€â”€ region-list.vue          # åŒºåŸŸåˆ—è¡¨
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ RegionFormModal.vue      # åŒºåŸŸè¡¨å•å¼¹çª—
â”‚   â””â”€â”€ FixedValueConfig.vue     # å®šé¢é…ç½®ç»„ä»¶
â””â”€â”€ index.vue
```

**æ ¸å¿ƒåŠŸèƒ½**:
- åŒºåŸŸCRUDæ“ä½œ
- **manage_modeé…ç½®**: é¤åˆ«åˆ¶(1)/è¶…å¸‚åˆ¶(2)/æ··åˆ(3)
- **fixed_value_configé…ç½®**: JSONæ ¼å¼å®šé¢é…ç½®
- åŒºåŸŸä¸è®¾å¤‡å…³è”ç®¡ç†
- åŒºåŸŸæƒé™éªŒè¯æµ‹è¯•å·¥å…·

**æ•°æ®ç»“æ„**:
```javascript
// åŒºåŸŸå®ä½“
{
  areaId: Long,
  areaName: String,
  areaType: Integer,
  manageMode: Integer,        // 1-é¤åˆ«åˆ¶ 2-è¶…å¸‚åˆ¶ 3-æ··åˆ
  fixedValueConfig: JSON,     // å®šé¢é…ç½®
  status: Integer,
  createTime: DateTime
}

// fixed_value_config ç¤ºä¾‹
{
  "BREAKFAST": 1000,    // æ—©é¤10å…ƒ
  "LUNCH": 2000,        // åˆé¤20å…ƒ
  "DINNER": 1500,       // æ™šé¤15å…ƒ
  "SNACK": 500          // é›¶é£Ÿ5å…ƒ
}
```

**APIæ¥å£**:
```javascript
// consume-api.js æ–°å¢
{
  // åŒºåŸŸç®¡ç†
  getAreaList: (params) => getRequest('/api/consume/area/list', params),
  getAreaById: (areaId) => getRequest(`/api/consume/area/${areaId}`),
  createArea: (data) => postRequest('/api/consume/area/create', data),
  updateArea: (data) => putRequest('/api/consume/area/update', data),
  deleteArea: (areaId) => deleteRequest(`/api/consume/area/${areaId}`),

  // å®šé¢é…ç½®
  updateFixedValueConfig: (areaId, config) =>
    putRequest('/api/consume/area/fixedValueConfig', { areaId, config })
}
```

#### 1.2 è´¦æˆ·ç±»åˆ«ç®¡ç†æ¨¡å—

**æ–‡ä»¶ç»“æ„**:
```
account/account-kind/
â”œâ”€â”€ account-kind-list.vue           # è´¦æˆ·ç±»åˆ«åˆ—è¡¨
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ AccountKindFormModal.vue        # ç±»åˆ«è¡¨å•å¼¹çª—
â”‚   â”œâ”€â”€ ModeConfigEditor.vue            # æ¶ˆè´¹æ¨¡å¼é…ç½®ç¼–è¾‘å™¨ â­
â”‚   â”œâ”€â”€ AreaConfigEditor.vue            # åŒºåŸŸæƒé™é…ç½®ç¼–è¾‘å™¨ â­
â”‚   â””â”€â”€ AccountLevelFixedEditor.vue     # è´¦æˆ·çº§å®šé¢ç¼–è¾‘å™¨
â””â”€â”€ index.vue
```

**æ ¸å¿ƒåŠŸèƒ½**:
- è´¦æˆ·ç±»åˆ«CRUDæ“ä½œ
- **mode_configé…ç½®**: 6ç§æ¶ˆè´¹æ¨¡å¼é…ç½®
- **area_configé…ç½®**: åŒºåŸŸæƒé™é…ç½®
- **account_level_fixedé…ç½®**: è´¦æˆ·çº§å®šé¢
- ç±»åˆ«ä¸é¤åˆ«å…³è”ç®¡ç†

**æ•°æ®ç»“æ„**:
```javascript
// è´¦æˆ·ç±»åˆ«å®ä½“
{
  accountKindId: Long,
  kindName: String,
  kindCode: String,
  modeConfig: JSON,          // æ¶ˆè´¹æ¨¡å¼é…ç½® â­
  areaConfig: JSON,          // åŒºåŸŸæƒé™é…ç½® â­
  accountLevelFixed: JSON,   // è´¦æˆ·çº§å®šé¢
  defaultQuota: BigDecimal,
  priority: Integer,
  status: Integer
}
```

**mode_config ç»“æ„ç¤ºä¾‹**:
```json
{
  "FIXED_AMOUNT": {
    "enabled": true,
    "subType": "SECTION",
    "values": [
      {
        "key": "breakfast",
        "name": "æ—©é¤",
        "amount": 1000,
        "time": "06:00-09:00",
        "mealTypes": ["BREAKFAST"]
      },
      {
        "key": "lunch",
        "name": "åˆé¤",
        "amount": 2000,
        "time": "11:00-13:00",
        "mealTypes": ["LUNCH"]
      }
    ]
  },
  "FREE_AMOUNT": {
    "enabled": false
  },
  "METERED": {
    "enabled": false,
    "subType": "TIMING"
  },
  "PRODUCT": {
    "enabled": true,
    "allowOverdraw": false
  },
  "ORDER": {
    "enabled": false
  },
  "INTELLIGENCE": {
    "enabled": false
  }
}
```

**area_config ç»“æ„ç¤ºä¾‹**:
```json
{
  "areas": [
    {
      "areaId": 1,
      "areaName": "ç¬¬ä¸€é£Ÿå ‚",
      "includeSubAreas": true
    },
    {
      "areaId": 5,
      "areaName": "ç¬¬äºŒé£Ÿå ‚",
      "includeSubAreas": false
    }
  ],
  "allAreasAllowed": false
}
```

**account_level_fixed ç»“æ„ç¤ºä¾‹**:
```json
{
  "enabled": true,
  "priority": 1,  // 1-æœ€é«˜ä¼˜å…ˆçº§
  "values": [
    {
      "mealType": "BREAKFAST",
      "amount": 1200  // è¦†ç›–åŒºåŸŸé…ç½®çš„1000
    },
    {
      "mealType": "LUNCH",
      "amount": 2500  // è¦†ç›–åŒºåŸŸé…ç½®çš„2000
    }
  ]
}
```

**APIæ¥å£**:
```javascript
// consume-api.js æ–°å¢
{
  // è´¦æˆ·ç±»åˆ«ç®¡ç†
  getAccountKindList: (params) => getRequest('/api/consume/accountKind/list', params),
  getAccountKindById: (kindId) => getRequest(`/api/consume/accountKind/${kindId}`),
  createAccountKind: (data) => postRequest('/api/consume/accountKind/create', data),
  updateAccountKind: (data) => putRequest('/api/consume/accountKind/update', data),
  deleteAccountKind: (kindId) => deleteRequest(`/api/consume/accountKind/${kindId}`),

  // é…ç½®ç®¡ç†
  updateModeConfig: (kindId, config) =>
    putRequest('/api/consume/accountKind/modeConfig', { kindId, config }),
  updateAreaConfig: (kindId, config) =>
    putRequest('/api/consume/accountKind/areaConfig', { kindId, config }),
  updateAccountLevelFixed: (kindId, config) =>
    putRequest('/api/consume/accountKind/accountLevelFixed', { kindId, config })
}
```

#### 1.3 JSONé…ç½®ç¼–è¾‘å™¨ç»„ä»¶ï¼ˆæ ¸å¿ƒå¤ç”¨ç»„ä»¶ï¼‰

**æ–‡ä»¶ä½ç½®**:
```
src/components/business/consume/json-editor/
â”œâ”€â”€ ModeConfigEditor.vue       # æ¶ˆè´¹æ¨¡å¼é…ç½®ç¼–è¾‘å™¨
â”œâ”€â”€ AreaConfigEditor.vue        # åŒºåŸŸæƒé™é…ç½®ç¼–è¾‘å™¨
â”œâ”€â”€ FixedValueConfigEditor.vue  # å®šé¢é…ç½®ç¼–è¾‘å™¨
â””â”€â”€ JsonBaseEditor.vue          # JSONåŸºç¡€ç¼–è¾‘å™¨
```

**ModeConfigEditor.vue æ ¸å¿ƒåŠŸèƒ½**:
- 6ç§æ¶ˆè´¹æ¨¡å¼Tabåˆ‡æ¢
- æ¯ç§æ¨¡å¼çš„ä¸“å±é…ç½®è¡¨å•
- JSONå®æ—¶é¢„è§ˆ
- é…ç½®éªŒè¯å’Œé”™è¯¯æç¤º
- é…ç½®æ¨¡æ¿é€‰æ‹©

**é…ç½®ç•Œé¢è®¾è®¡**:
```vue
<template>
  <a-tabs v-model:activeKey="activeMode">
    <!-- å›ºå®šé‡‘é¢æ¨¡å¼ -->
    <a-tab-pane key="FIXED_AMOUNT" tab="å›ºå®šé‡‘é¢æ¨¡å¼">
      <a-form>
        <a-form-item label="å¯ç”¨">
          <a-switch v-model:checked="config.FIXED_AMOUNT.enabled" />
        </a-form-item>
        <a-form-item label="å­ç±»å‹">
          <a-radio-group v-model:value="config.FIXED_AMOUNT.subType">
            <a-radio value="SIMPLE">ç®€å•æ¨¡å¼</a-radio>
            <a-radio value="KEY_VALUE">é”®å€¼å¯¹æ¨¡å¼</a-radio>
            <a-radio value="SECTION">åˆ†æ®µæ¨¡å¼</a-radio>
          </a-radio-group>
        </a-form-item>

        <!-- åˆ†æ®µé…ç½® -->
        <div v-if="config.FIXED_AMOUNT.subType === 'SECTION'">
          <a-button @click="addSection">æ·»åŠ æ—¶é—´æ®µ</a-button>
          <a-list :data-source="config.FIXED_AMOUNT.values">
            <template #renderItem="{ item, index }">
              <a-list-item>
                <a-space direction="vertical" style="width: 100%">
                  <a-input v-model:value="item.key" placeholder="é”®å€¼" />
                  <a-input v-model:value="item.name" placeholder="åç§°" />
                  <a-input-number v-model:value="item.amount" placeholder="é‡‘é¢(åˆ†)" />
                  <a-time-range v-model:value="item.timeRange" />
                  <a-select
                    mode="multiple"
                    v-model:value="item.mealTypes"
                    placeholder="é€‰æ‹©é¤åˆ«"
                  >
                    <a-select-option value="BREAKFAST">æ—©é¤</a-select-option>
                    <a-select-option value="LUNCH">åˆé¤</a-select-option>
                    <a-select-option value="DINNER">æ™šé¤</a-select-option>
                    <a-select-option value="SNACK">é›¶é£Ÿ</a-select-option>
                  </a-select>
                  <a-button danger @click="removeSection(index)">åˆ é™¤</a-button>
                </a-space>
              </a-list-item>
            </template>
          </a-list>
        </div>
      </a-form>
    </a-tab-pane>

    <!-- è‡ªç”±é‡‘é¢æ¨¡å¼ -->
    <a-tab-pane key="FREE_AMOUNT" tab="è‡ªç”±é‡‘é¢æ¨¡å¼">
      <a-form>
        <a-form-item label="å¯ç”¨">
          <a-switch v-model:checked="config.FREE_AMOUNT.enabled" />
        </a-form-item>
        <a-form-item label="å•æ¬¡é™é¢">
          <a-input-number v-model:value="config.FREE_AMOUNT.maxAmount" />
        </a-form-item>
        <a-form-item label="æ¯æ—¥é™é¢">
          <a-input-number v-model:value="config.FREE_AMOUNT.dailyLimit" />
        </a-form-item>
      </a-form>
    </a-tab-pane>

    <!-- å…¶ä»–æ¨¡å¼... -->
  </a-tabs>

  <!-- JSONé¢„è§ˆ -->
  <a-card title="JSONé…ç½®é¢„è§ˆ">
    <pre>{{ JSON.stringify(config, null, 2) }}</pre>
  </a-card>
</template>
```

**AreaConfigEditor.vue æ ¸å¿ƒåŠŸèƒ½**:
- åŒºåŸŸé€‰æ‹©æ ‘å½¢ç»„ä»¶
- æ˜¯å¦åŒ…å«å­åŒºåŸŸé€‰é¡¹
- å…¨éƒ¨åŒºåŸŸå…è®¸å¼€å…³
- JSONå®æ—¶é¢„è§ˆ

**é…ç½®ç•Œé¢è®¾è®¡**:
```vue
<template>
  <a-form>
    <a-form-item label="å…è®¸å…¨éƒ¨åŒºåŸŸ">
      <a-switch
        v-model:checked="config.allAreasAllowed"
        @change="handleAllAreasChange"
      />
    </a-form-item>

    <a-form-item
      v-if="!config.allAreasAllowed"
      label="å…è®¸åŒºåŸŸ"
    >
      <a-tree-select
        v-model:value="selectedAreas"
        multiple
        tree-checkable
        :tree-data="areaTreeData"
        placeholder="é€‰æ‹©å…è®¸æ¶ˆè´¹çš„åŒºåŸŸ"
      >
        <template #title="{ title, key }">
          <span>{{ title }}</span>
          <a-checkbox
            v-if="!isLeaf(key)"
            :checked="isIncludeSubAreas(key)"
            @click.stop="toggleIncludeSubAreas(key)"
          >
            åŒ…å«å­åŒºåŸŸ
          </a-checkbox>
        </template>
      </a-tree-select>
    </a-form-item>
  </a-form>

  <!-- JSONé¢„è§ˆ -->
  <a-card title="åŒºåŸŸæƒé™é…ç½®">
    <pre>{{ JSON.stringify(config, null, 2) }}</pre>
  </a-card>
</template>
```

### é˜¶æ®µäºŒï¼šé‡è¦åŠŸèƒ½æ¨¡å—ï¼ˆP1çº§ï¼‰- 1-2å‘¨

#### 2.1 è¡¥è´´ç®¡ç†å¢å¼º

**æ–‡ä»¶ç»“æ„**:
```
subsidy/
â”œâ”€â”€ subsidy-list.vue           # è¡¥è´´åˆ—è¡¨
â”œâ”€â”€ subsidy-distribute.vue     # è¡¥è´´å‘æ”¾
â”œâ”€â”€ subsidy-record.vue         # å‘æ”¾è®°å½•
â””â”€â”€ components/
    â”œâ”€â”€ DistributeModal.vue        # å‘æ”¾å¼¹çª—
    â”œâ”€â”€ EmployeeSelector.vue       # å‘˜å·¥é€‰æ‹©å™¨
    â””â”€â”€ AccountKindSelector.vue    # è´¦æˆ·ç±»åˆ«é€‰æ‹©å™¨
```

**æ ¸å¿ƒåŠŸèƒ½**:
- æ‰¹é‡è¡¥è´´å‘æ”¾
- æŒ‰è´¦æˆ·ç±»åˆ«å‘æ”¾
- æŒ‰éƒ¨é—¨å‘æ”¾
- è‡ªå®šä¹‰ç­›é€‰å‘æ”¾
- å‘æ”¾è®°å½•æŸ¥è¯¢
- å‘æ”¾å¤±è´¥é‡è¯•

**æ•°æ®ç»“æ„**:
```javascript
// è¡¥è´´å‘æ”¾è¯·æ±‚
{
  distributeType: String,      // EMPLOYEE/DEPARTMENT/KIND/CUSTOM
  employeeIds: Array<Long>,
  departmentIds: Array<Long>,
  accountKindIds: Array<Long>,
  subsidyAmount: BigDecimal,
  subsidyType: Integer,        // 1-è¡¥è´´é’±åŒ… 2-ç°é‡‘é’±åŒ…
  remark: String
}
```

#### 2.2 äº¤æ˜“è®°å½•å¢å¼º

**æ–‡ä»¶ç»“æ„**:
```
transaction/
â”œâ”€â”€ index.vue                  # äº¤æ˜“åˆ—è¡¨
â”œâ”€â”€ transaction-detail.vue     # äº¤æ˜“è¯¦æƒ…
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ TransactionDetailModal.vue  # è¯¦æƒ…å¼¹çª—
â”‚   â”œâ”€â”€ SagaFlowViewer.vue          # SAGAæµç¨‹æŸ¥çœ‹å™¨
â”‚   â””â”€â”€ WalletFlowViewer.vue        # é’±åŒ…æµè½¬æŸ¥çœ‹å™¨
â””â”€â”€ filters/
    â”œâ”€â”€ sagaStatusFilter.vue        # SAGAçŠ¶æ€ç­›é€‰
    â””â”€â”€ walletFlowFilter.vue        # é’±åŒ…æµè½¬ç­›é€‰
```

**æ ¸å¿ƒåŠŸèƒ½**:
- äº¤æ˜“è®°å½•å®Œæ•´æŸ¥è¯¢
- äº¤æ˜“è¯¦æƒ…å±•ç¤º
- SAGAæ‰§è¡ŒçŠ¶æ€å±•ç¤º
- å¤šé’±åŒ…æµè½¬å±•ç¤º
- è¡¥å¿äº¤æ˜“è®°å½•
- äº¤æ˜“å¤±è´¥é‡è¯•

**SAGAæµç¨‹å±•ç¤º**:
```vue
<template>
  <a-steps :current="sagaStep" direction="vertical">
    <a-step title="1.éªŒè¯è®¾å¤‡" :description="stepDescriptions[0]" />
    <a-step title="2.è¯†åˆ«ç”¨æˆ·" :description="stepDescriptions[1]" />
    <a-step title="3.æ‰§è¡Œæ‰£æ¬¾" :description="stepDescriptions[2]" />
    <a-step title="4.è®°å½•äº¤æ˜“" :description="stepDescriptions[3]" />
    <a-step title="5.è®¾å¤‡å“åº”" :description="stepDescriptions[4]" />
  </a-steps>

  <!-- è¡¥å¿æµç¨‹ -->
  <a-alert
    v-if="hasCompensation"
    type="warning"
    message="è¡¥å¿æ‰§è¡Œ"
    description="äº¤æ˜“å¤±è´¥ï¼Œæ­£åœ¨æ‰§è¡Œè¡¥å¿æµç¨‹"
  />
</template>
```

**å¤šé’±åŒ…æµè½¬å±•ç¤º**:
```vue
<template>
  <a-card title="é’±åŒ…æµè½¬è¯¦æƒ…">
    <a-descriptions bordered>
      <a-descriptions-item label="è¡¥è´´é’±åŒ…">
        <a-space direction="vertical">
          <span>æœŸåˆ: Â¥{{ walletFlow.subsidyBefore }}</span>
          <span type="danger">-Â¥{{ walletFlow.subsidyDeduct }}</span>
          <span>æœŸæœ«: Â¥{{ walletFlow.subsidyAfter }}</span>
        </a-space>
      </a-descriptions-item>
      <a-descriptions-item label="ç°é‡‘é’±åŒ…">
        <a-space direction="vertical">
          <span>æœŸåˆ: Â¥{{ walletFlow.cashBefore }}</span>
          <span type="danger">-Â¥{{ walletFlow.cashDeduct }}</span>
          <span>æœŸæœ«: Â¥{{ walletFlow.cashAfter }}</span>
        </a-space>
      </a-descriptions-item>
      <a-descriptions-item label="æ‰£æ¬¾ä¼˜å…ˆçº§">
        å…ˆè¡¥è´´é’±åŒ…ï¼Œåç°é‡‘é’±åŒ…
      </a-descriptions-item>
    </a-descriptions>
  </a-card>
</template>
```

#### 2.3 è®¾å¤‡ç®¡ç†å¢å¼º

**æ–‡ä»¶ç»“æ„**:
```
device/
â”œâ”€â”€ device-list.vue            # è®¾å¤‡åˆ—è¡¨
â”œâ”€â”€ device-detail.vue          # è®¾å¤‡è¯¦æƒ…
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ DeviceModeBindModal.vue     # è®¾å¤‡æ¨¡å¼ç»‘å®šå¼¹çª—
â”‚   â”œâ”€â”€ DeviceStatusMonitor.vue     # è®¾å¤‡çŠ¶æ€ç›‘æ§
â”‚   â””â”€â”€ DeviceConfigEditor.vue      # è®¾å¤‡é…ç½®ç¼–è¾‘å™¨
```

**æ ¸å¿ƒåŠŸèƒ½**:
- è®¾å¤‡ä¸æ¶ˆè´¹æ¨¡å¼ç»‘å®š
- è®¾å¤‡çŠ¶æ€å®æ—¶ç›‘æ§
- è®¾å¤‡é…ç½®ç®¡ç†
- è®¾å¤‡ç¦»çº¿è®°å½•
- è®¾å¤‡æ•…éšœå‘Šè­¦

**è®¾å¤‡æ¨¡å¼ç»‘å®šç•Œé¢**:
```vue
<template>
  <a-modal title="ç»‘å®šæ¶ˆè´¹æ¨¡å¼" v-model:visible="visible">
    <a-form>
      <a-form-item label="è®¾å¤‡åç§°">
        <a-input v-model:value="device.deviceName" disabled />
      </a-form-item>

      <a-form-item label="ç»‘å®šçš„æ¶ˆè´¹æ¨¡å¼">
        <a-checkbox-group v-model:value="selectedModes">
          <a-checkbox value="FIXED_AMOUNT">å›ºå®šé‡‘é¢</a-checkbox>
          <a-checkbox value="FREE_AMOUNT">è‡ªç”±é‡‘é¢</a-checkbox>
          <a-checkbox value="METERED">è®¡é‡è®¡è´¹</a-checkbox>
          <a-checkbox value="PRODUCT">å•†å“æ¨¡å¼</a-checkbox>
          <a-checkbox value="ORDER">è®¢é¤æ¨¡å¼</a-checkbox>
          <a-checkbox value="INTELLIGENCE">æ™ºèƒ½æ¨¡å¼</a-checkbox>
        </a-checkbox-group>
      </a-form-item>

      <a-form-item
        v-if="selectedModes.includes('FIXED_AMOUNT')"
        label="é»˜è®¤é‡‘é¢"
      >
        <a-input-number v-model:value="device.defaultAmount" />
      </a-form-item>
    </a-form>
  </a-modal>
</template>
```

### é˜¶æ®µä¸‰ï¼šç»Ÿè®¡åˆ†ææ¨¡å—ï¼ˆP2çº§ï¼‰- 1å‘¨

#### 3.1 æŠ¥è¡¨ç»Ÿè®¡å¢å¼º

**æ–‡ä»¶ç»“æ„**:
```
report/
â”œâ”€â”€ index.vue                  # æŠ¥è¡¨é¦–é¡µ
â”œâ”€â”€ sales-report.vue           # é”€å”®æŠ¥è¡¨
â”œâ”€â”€ area-analysis.vue          # åŒºåŸŸåˆ†æ
â”œâ”€â”€ account-analysis.vue       # è´¦æˆ·åˆ†æ
â””â”€â”€ components/
    â”œâ”€â”€ DateRangePicker.vue         # æ—¥æœŸèŒƒå›´é€‰æ‹©å™¨
    â”œâ”€â”€ ChartRenderer.vue           # å›¾è¡¨æ¸²æŸ“å™¨
    â””â”€â”€ ExportButton.vue            # å¯¼å‡ºæŒ‰é’®
```

**æ ¸å¿ƒåŠŸèƒ½**:
- é”€å”®æ•°æ®ç»Ÿè®¡
- åŒºåŸŸæ¶ˆè´¹åˆ†æ
- è´¦æˆ·æ¶ˆè´¹æ’è¡Œ
- é¤åˆ«æ¶ˆè´¹åˆ†æ
- æ—¶æ®µæ¶ˆè´¹åˆ†æ
- æŠ¥è¡¨å¯¼å‡º

---

## ğŸ“ ä¸‰ã€å¼€å‘è§„èŒƒä¸æ³¨æ„äº‹é¡¹

### 3.1 ç¼–ç è§„èŒƒ

#### 3.1.1 Vue 3 Composition APIè§„èŒƒ

```javascript
// âœ… æ­£ç¡®çš„<script setup>å†™æ³•
<script setup>
import { ref, reactive, computed, onMounted } from 'vue';
import { message } from 'ant-design-vue';

// 1. æ•°æ®å®šä¹‰
const loading = ref(false);
const tableData = ref([]);
const searchForm = reactive({
  keyword: '',
  status: undefined
});

// 2. è®¡ç®—å±æ€§
const filteredData = computed(() => {
  return tableData.value.filter(item =>
    item.name.includes(searchForm.keyword)
  );
});

// 3. æ–¹æ³•å®šä¹‰
const fetchData = async () => {
  loading.value = true;
  try {
    const res = await consumeApi.getList(searchForm);
    if (res.code === 200) {
      tableData.value = res.data;
    }
  } catch (error) {
    message.error('åŠ è½½æ•°æ®å¤±è´¥');
  } finally {
    loading.value = false;
  }
};

// 4. ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  fetchData();
});
</script>
```

#### 3.1.2 å‘½åè§„èŒƒ

```javascript
// æ–‡ä»¶å‘½å
// âœ… å°å†™kebab-case
region-list.vue
account-kind-form-modal.vue
mode-config-editor.vue

// ç»„ä»¶å‘½å
// âœ… PascalCase
<script>
import RegionList from './region-list.vue';
import AccountKindFormModal from './components/AccountKindFormModal.vue';
</script>

// å˜é‡å‘½å
// âœ… camelCase
const tableData = ref([]);
const searchForm = reactive({});
const isLoading = ref(false);

// å¸¸é‡å‘½å
// âœ… UPPER_SNAKE_CASE
const DEFAULT_PAGE_SIZE = 20;
const MAX_UPLOAD_SIZE = 10 * 1024 * 1024;

// APIæ–¹æ³•å‘½å
// âœ… åŠ¨è¯+åè¯
const fetchData = () => {};
const handleSubmit = () => {};
const handleDelete = () => {};
const handleExport = () => {};
```

#### 3.1.3 æ³¨é‡Šè§„èŒƒ

```vue
<template>
  <!-- åŒºåŸŸåˆ—è¡¨é¡µé¢ -->
  <div class="region-list">
    <!-- æœç´¢ç­›é€‰åŒºåŸŸ -->
    <a-card>
    </a-card>

    <!-- è¡¨æ ¼åŒºåŸŸ -->
    <a-table>
    </a-table>
  </div>
</template>

<script setup>
/**
 * åŒºåŸŸç®¡ç†é¡µé¢
 *
 * åŠŸèƒ½ï¼š
 * 1. åŒºåŸŸCRUDæ“ä½œ
 * 2. manage_modeé…ç½®ï¼ˆé¤åˆ«åˆ¶/è¶…å¸‚åˆ¶/æ··åˆï¼‰
 * 3. fixed_value_configé…ç½®ï¼ˆå®šé¢é…ç½®ï¼‰
 *
 * @author IOE-DREAM Team
 * @date 2025-12-24
 */

import { ref, onMounted } from 'vue';

// ==================== æ•°æ®å®šä¹‰ ====================

/**
 * è¡¨æ ¼æ•°æ®
 */
const tableData = ref([]);

/**
 * åŠ è½½çŠ¶æ€
 */
const loading = ref(false);

// ==================== æ–¹æ³•å®šä¹‰ ====================

/**
 * æŸ¥è¯¢åŒºåŸŸåˆ—è¡¨
 *
 * @param {Object} params - æŸ¥è¯¢å‚æ•°
 * @returns {Promise<void>}
 */
const fetchData = async (params) => {
  // å®ç°...
};

// ==================== ç”Ÿå‘½å‘¨æœŸ ====================

/**
 * ç»„ä»¶æŒ‚è½½æ—¶æŸ¥è¯¢æ•°æ®
 */
onMounted(() => {
  fetchData();
});
</script>
```

### 3.2 ç»„ä»¶è®¾è®¡åŸåˆ™

#### 3.2.1 å•ä¸€èŒè´£åŸåˆ™

```javascript
// âœ… å¥½çš„è®¾è®¡ - æ¯ä¸ªç»„ä»¶åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½
ModeConfigEditor.vue    // åªè´Ÿè´£mode_configç¼–è¾‘
AreaConfigEditor.vue     // åªè´Ÿè´£area_configç¼–è¾‘
FixedValueConfigEditor.vue  // åªè´Ÿè´£fixed_value_configç¼–è¾‘

// âŒ åçš„è®¾è®¡ - ä¸€ä¸ªç»„ä»¶è´Ÿè´£æ‰€æœ‰é…ç½®
AllConfigEditor.vue      // è´Ÿè´£æ‰€æœ‰é…ç½®ç¼–è¾‘
```

#### 3.2.2 Propsè§„èŒƒ

```javascript
// âœ… æ˜ç¡®çš„propså®šä¹‰
const props = defineProps({
  modelValue: {
    type: Object,
    required: true,
    default: () => ({})
  },
  readonly: {
    type: Boolean,
    default: false
  },
  mode: {
    type: String,
    validator: (value) => {
      return ['edit', 'view', 'add'].includes(value);
    }
  }
});

// âœ… ä½¿ç”¨props
const config = computed({
  get: () => props.modelValue,
  set: (value) => emit('update:modelValue', value)
});
```

#### 3.2.3 Emitsè§„èŒƒ

```javascript
// âœ… æ˜ç¡®çš„emitså®šä¹‰
const emit = defineEmits([
  'update:modelValue',
  'change',
  'submit',
  'cancel'
]);

// âœ… ä½¿ç”¨emits
const handleSubmit = () => {
  // éªŒè¯
  if (!validate()) {
    return;
  }

  // è§¦å‘æäº¤äº‹ä»¶
  emit('submit', config.value);

  // å…³é—­å¼¹çª—
  emit('update:modelValue', false);
};
```

### 3.3 çŠ¶æ€ç®¡ç†è§„èŒƒ

#### 3.3.1 æœ¬åœ°çŠ¶æ€

```javascript
// âœ… ä¼˜å…ˆä½¿ç”¨æœ¬åœ°çŠ¶æ€
const tableData = ref([]);
const loading = ref(false);
const pagination = reactive({
  current: 1,
  pageSize: 20,
  total: 0
});
```

#### 3.3.2 å…¨å±€çŠ¶æ€ï¼ˆå¿…è¦æ—¶ä½¿ç”¨ï¼‰

```javascript
// stores/consume-store.js
import { defineStore } from 'pinia';

export const useConsumeStore = defineStore('consume', {
  state: () => ({
    currentArea: null,
    currentAccountKind: null,
    deviceModes: []
  }),

  actions: {
    setCurrentArea(area) {
      this.currentArea = area;
    },

    async fetchDeviceModes() {
      const res = await consumeApi.getDeviceModes();
      this.deviceModes = res.data;
    }
  }
});
```

### 3.4 APIè°ƒç”¨è§„èŒƒ

#### 3.4.1 ç»Ÿä¸€é”™è¯¯å¤„ç†

```javascript
// utils/api-helper.js
export const apiHelper = {
  /**
   * åŒ…è£…APIè°ƒç”¨ï¼Œç»Ÿä¸€å¤„ç†é”™è¯¯
   *
   * @param {Promise} apiCall - APIè°ƒç”¨Promise
   * @param {Object} options - é…ç½®é€‰é¡¹
   * @returns {Promise<any>}
   */
  async call(apiCall, options = {}) {
    const {
      successMsg = 'æ“ä½œæˆåŠŸ',
      errorMsg = 'æ“ä½œå¤±è´¥',
      showSuccessMsg = true,
      showErrorMsg = true,
      onSuccess = null,
      onError = null
    } = options;

    try {
      const res = await apiCall;

      if (res.code === 200) {
        if (showSuccessMsg) {
          message.success(successMsg);
        }
        if (onSuccess) {
          onSuccess(res.data);
        }
        return res.data;
      } else {
        throw new Error(res.message || errorMsg);
      }
    } catch (error) {
      if (showErrorMsg) {
        message.error(error.message || errorMsg);
      }
      if (onError) {
        onError(error);
      }
      throw error;
    }
  }
};

// ä½¿ç”¨ç¤ºä¾‹
const handleDelete = async (record) => {
  await apiHelper.call(
    consumeApi.deleteArea(record.areaId),
    {
      successMsg: 'åˆ é™¤æˆåŠŸ',
      errorMsg: 'åˆ é™¤å¤±è´¥',
      onSuccess: () => {
        fetchData();
      }
    }
  );
};
```

#### 3.4.2 å–æ¶ˆé‡å¤è¯·æ±‚

```javascript
// utils/request-cache.js
const pendingRequests = new Map();

export const cancelDuplicateRequest = (config) => {
  const requestKey = `${config.method}:${config.url}`;

  if (pendingRequests.has(requestKey)) {
    pendingRequests.get(requestKey).cancel('å–æ¶ˆé‡å¤è¯·æ±‚');
  }

  const source = axios.CancelToken.source();
  config.cancelToken = source.token;
  pendingRequests.set(requestKey, source);
};

axios.interceptors.request.use((config) => {
  cancelDuplicateRequest(config);
  return config;
});

axios.interceptors.response.use((response) => {
  const requestKey = `${response.config.method}:${response.config.url}`;
  pendingRequests.delete(requestKey);
  return response;
});
```

### 3.5 æ€§èƒ½ä¼˜åŒ–è§„èŒƒ

#### 3.5.1 åˆ—è¡¨è™šæ‹Ÿæ»šåŠ¨

```vue
<template>
  <!-- å¤§æ•°æ®é‡åˆ—è¡¨ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨ -->
  <a-virtual-list
    :data-source="tableData"
    :height="600"
    :item-key="key"
  >
    <template #item="{ item }">
      <div class="list-item">
        {{ item.name }}
      </div>
    </template>
  </a-virtual-list>
</template>
```

#### 3.5.2 é˜²æŠ–ä¸èŠ‚æµ

```javascript
import { debounce, throttle } from 'lodash-es';

// æœç´¢è¾“å…¥é˜²æŠ–
const handleSearch = debounce((value) => {
  fetchData({ keyword: value });
}, 500);

// æ»šåŠ¨åŠ è½½èŠ‚æµ
const handleScroll = throttle(() => {
  loadMoreData();
}, 200);
```

#### 3.5.3 æ‡’åŠ è½½

```vue
<script setup>
// è·¯ç”±æ‡’åŠ è½½
const RegionList = () => import('./region/region-list.vue');
const AccountKindList = () => import('./account/account-kind/account-kind-list.vue');

// ç»„ä»¶æ‡’åŠ è½½
const HeavyComponent = defineAsyncComponent(() =>
  import('./components/HeavyComponent.vue')
);
</script>
```

---

## ğŸ¨ å››ã€ç»„ä»¶æ¶æ„è®¾è®¡

### 4.1 å…¬å…±ç»„ä»¶åº“

```
src/components/business/consume/
â”œâ”€â”€ json-editor/              # JSONé…ç½®ç¼–è¾‘å™¨ç»„ä»¶åº“
â”‚   â”œâ”€â”€ JsonBaseEditor.vue         # åŸºç¡€JSONç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ ModeConfigEditor.vue       # æ¶ˆè´¹æ¨¡å¼é…ç½®ç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ AreaConfigEditor.vue       # åŒºåŸŸæƒé™é…ç½®ç¼–è¾‘å™¨
â”‚   â”œâ”€â”€ FixedValueConfigEditor.vue # å®šé¢é…ç½®ç¼–è¾‘å™¨
â”‚   â””â”€â”€ index.js                   # ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ selectors/               # é€‰æ‹©å™¨ç»„ä»¶åº“
â”‚   â”œâ”€â”€ AreaSelector.vue           # åŒºåŸŸé€‰æ‹©å™¨
â”‚   â”œâ”€â”€ AccountKindSelector.vue    # è´¦æˆ·ç±»åˆ«é€‰æ‹©å™¨
â”‚   â”œâ”€â”€ DeviceSelector.vue         # è®¾å¤‡é€‰æ‹©å™¨
â”‚   â””â”€â”€ MealCategorySelector.vue   # é¤åˆ«é€‰æ‹©å™¨
â”œâ”€â”€ display/                  # å±•ç¤ºç»„ä»¶åº“
â”‚   â”œâ”€â”€ WalletFlowDisplay.vue      # é’±åŒ…æµè½¬å±•ç¤º
â”‚   â”œâ”€â”€ SagaStepDisplay.vue        # SAGAæ­¥éª¤å±•ç¤º
â”‚   â”œâ”€â”€ ModeTag.vue                # æ¶ˆè´¹æ¨¡å¼æ ‡ç­¾
â”‚   â””â”€â”€ ManageModeTag.vue          # ç®¡ç†æ¨¡å¼æ ‡ç­¾
â””â”€â”€ modals/                   # å¼¹çª—ç»„ä»¶åº“
    â”œâ”€â”€ RegionFormModal.vue        # åŒºåŸŸè¡¨å•å¼¹çª—
    â”œâ”€â”€ AccountKindFormModal.vue   # è´¦æˆ·ç±»åˆ«è¡¨å•å¼¹çª—
    â””â”€â”€ DistributeModal.vue        # è¡¥è´´å‘æ”¾å¼¹çª—
```

### 4.2 ç»„ä»¶é€šä¿¡æ¨¡å¼

```javascript
// çˆ¶å­ç»„ä»¶é€šä¿¡
// çˆ¶ç»„ä»¶
<template>
  <ChildComponent
    v-model:value="value"
    :data="data"
    @change="handleChange"
  />
</template>

// å­ç»„ä»¶
<script setup>
const props = defineProps(['value', 'data']);
const emit = defineEmits(['update:value', 'change']);

const handleChange = (newValue) => {
  emit('update:value', newValue);
  emit('change', newValue);
};
</script>

// å…„å¼Ÿç»„ä»¶é€šä¿¡ï¼ˆä½¿ç”¨äº‹ä»¶æ€»çº¿ï¼‰
import { useEventBus } from '/@/composables/useEventBus';

const eventBus = useEventBus();

// ç»„ä»¶A - å‘é€äº‹ä»¶
eventBus.emit('area-changed', newArea);

// ç»„ä»¶B - ç›‘å¬äº‹ä»¶
eventBus.on('area-changed', (area) => {
  console.log('åŒºåŸŸå·²æ›´æ”¹', area);
});
```

---

## ğŸ“Š äº”ã€æ•°æ®æµè®¾è®¡

### 5.1 å•å‘æ•°æ®æµ

```
ç”¨æˆ·æ“ä½œ â†’ è§¦å‘äº‹ä»¶ â†’ è°ƒç”¨API â†’ æ›´æ–°çŠ¶æ€ â†’ é‡æ–°æ¸²æŸ“
    â†“           â†“         â†“        â†“         â†“
  ç‚¹å‡»æŒ‰é’®   @click  consumeApi  ref.value  template
```

### 5.2 è¡¨å•æ•°æ®æµ

```
è¡¨å•è¾“å…¥ â†’ v-modelåŒå‘ç»‘å®š â†’ æœ¬åœ°çŠ¶æ€ â†’ æäº¤ â†’ APIè°ƒç”¨ â†’ å“åº”å¤„ç†
    â†“            â†“              â†“        â†“       â†“         â†“
  input     reactive    formData  submit  postRequest  message
```

### 5.3 åˆ—è¡¨æ•°æ®æµ

```
ç»„ä»¶æŒ‚è½½ â†’ æŸ¥è¯¢å‚æ•°æ„å»º â†’ APIè°ƒç”¨ â†’ å“åº”å¤„ç† â†’ æ•°æ®è½¬æ¢ â†’ åˆ—è¡¨æ¸²æŸ“
    â†“           â†“            â†“        â†“         â†“         â†“
 onMounted  searchForm  getList   res.data  map/transform  v-for
```

---

## ğŸ”Œ å…­ã€APIé›†æˆç­–ç•¥

### 6.1 APIç»Ÿä¸€ç®¡ç†

```javascript
// src/api/business/consume/consume-api.js
export const consumeApi = {
  // åŒºåŸŸç®¡ç†
  area: {
    list: (params) => getRequest('/api/consume/area/list', params),
    getById: (areaId) => getRequest(`/api/consume/area/${areaId}`),
    create: (data) => postRequest('/api/consume/area/create', data),
    update: (data) => putRequest('/api/consume/area/update', data),
    delete: (areaId) => deleteRequest(`/api/consume/area/${areaId}`)
  },

  // è´¦æˆ·ç±»åˆ«ç®¡ç†
  accountKind: {
    list: (params) => getRequest('/api/consume/accountKind/list', params),
    getById: (kindId) => getRequest(`/api/consume/accountKind/${kindId}`),
    create: (data) => postRequest('/api/consume/accountKind/create', data),
    update: (data) => putRequest('/api/consume/accountKind/update', data),
    delete: (kindId) => deleteRequest(`/api/consume/accountKind/${kindId}`)
  },

  // ... å…¶ä»–æ¨¡å—
};
```

### 6.2 è¯·æ±‚æ‹¦æˆªå™¨

```javascript
// src/lib/axios/request.js
import { getToken } from '/@/utils/auth';

// è¯·æ±‚æ‹¦æˆª
axios.interceptors.request.use(
  (config) => {
    // æ·»åŠ token
    const token = getToken();
    if (token) {
      config.headers.Authorization = `Bearer ${token}`;
    }

    // æ·»åŠ æ—¶é—´æˆ³
    config.headers['X-Request-Time'] = Date.now();

    return config;
  },
  (error) => {
    return Promise.reject(error);
  }
);

// å“åº”æ‹¦æˆª
axios.interceptors.response.use(
  (response) => {
    const res = response.data;

    // ä¸šåŠ¡æˆåŠŸ
    if (res.code === 200) {
      return res;
    }

    // ä¸šåŠ¡å¤±è´¥
    message.error(res.message || 'è¯·æ±‚å¤±è´¥');
    return Promise.reject(new Error(res.message || 'è¯·æ±‚å¤±è´¥'));
  },
  (error) => {
    // HTTPé”™è¯¯
    if (error.response) {
      switch (error.response.status) {
        case 401:
          message.error('æœªæˆæƒï¼Œè¯·é‡æ–°ç™»å½•');
          // è·³è½¬ç™»å½•é¡µ
          break;
        case 403:
          message.error('æ‹’ç»è®¿é—®');
          break;
        case 500:
          message.error('æœåŠ¡å™¨é”™è¯¯');
          break;
        default:
          message.error(error.response.data.message || 'è¯·æ±‚å¤±è´¥');
      }
    } else {
      message.error('ç½‘ç»œé”™è¯¯');
    }

    return Promise.reject(error);
  }
);
```

---

## ğŸ§ª ä¸ƒã€æµ‹è¯•ç­–ç•¥

### 7.1 å•å…ƒæµ‹è¯•

```javascript
// ModeConfigEditor.spec.js
import { mount } from '@vue/test-utils';
import { describe, it, expect } from 'vitest';
import ModeConfigEditor from './ModeConfigEditor.vue';

describe('ModeConfigEditor', () => {
  it('åº”è¯¥æ­£ç¡®åˆå§‹åŒ–é…ç½®', () => {
    const wrapper = mount(ModeConfigEditor, {
      props: {
        modelValue: {}
      }
    });

    expect(wrapper.vm.config).toBeDefined();
    expect(wrapper.vm.config.FIXED_AMOUNT).toBeDefined();
  });

  it('åº”è¯¥åˆ‡æ¢æ¨¡å¼å­ç±»å‹', async () => {
    const wrapper = mount(ModeConfigEditor, {
      props: {
        modelValue: {}
      }
    });

    wrapper.vm.config.FIXED_AMOUNT.subType = 'KEY_VALUE';
    await wrapper.vm.$nextTick();

    expect(wrapper.vm.config.FIXED_AMOUNT.subType).toBe('KEY_VALUE');
  });
});
```

### 7.2 é›†æˆæµ‹è¯•

```javascript
// region-list.spec.js
import { mount } from '@vue/test-utils';
import { describe, it, expect, vi } from 'vitest';
import RegionList from './region-list.vue';
import * as consumeApi from '/@/api/business/consume/consume-api';

vi.mock('/@/api/business/consume/consume-api');

describe('RegionList', () => {
  it('åº”è¯¥æ­£ç¡®åŠ è½½åŒºåŸŸåˆ—è¡¨', async () => {
    const mockData = {
      code: 200,
      data: [
        { areaId: 1, areaName: 'ç¬¬ä¸€é£Ÿå ‚', manageMode: 1 }
      ]
    };

    consumeApi.getAreaList.mockResolvedValue(mockData);

    const wrapper = mount(RegionList);
    await wrapper.vm.$nextTick();

    expect(wrapper.vm.tableData).toHaveLength(1);
    expect(wrapper.vm.tableData[0].areaName).toBe('ç¬¬ä¸€é£Ÿå ‚');
  });
});
```

---

## ğŸ“‹ å…«ã€å¼€å‘æ£€æŸ¥æ¸…å•

### 8.1 ä»£ç æäº¤å‰æ£€æŸ¥

- [ ] ä»£ç ç¬¦åˆESLintè§„èŒƒ
- [ ] ç»„ä»¶å‘½åè§„èŒƒ
- [ ] Propså®šä¹‰å®Œæ•´
- [ ] Emitså®šä¹‰å®Œæ•´
- [ ] æ³¨é‡Šå®Œæ•´æ¸…æ™°
- [ ] æ— console.logè°ƒè¯•ä»£ç 
- [ ] æ— ç¡¬ç¼–ç å¸¸é‡
- [ ] APIé”™è¯¯å¤„ç†å®Œæ•´
- [ ] åŠ è½½çŠ¶æ€æ­£ç¡®
- [ ] ç©ºçŠ¶æ€å¤„ç†

### 8.2 åŠŸèƒ½å®Œæ•´æ€§æ£€æŸ¥

- [ ] CRUDæ“ä½œå®Œæ•´
- [ ] è¡¨å•éªŒè¯å®Œæ•´
- [ ] é”™è¯¯æç¤ºå‹å¥½
- [ ] æƒé™æ§åˆ¶æ­£ç¡®
- [ ] åˆ†é¡µåŠŸèƒ½æ­£å¸¸
- [ ] æœç´¢åŠŸèƒ½æ­£å¸¸
- [ ] å¯¼å‡ºåŠŸèƒ½æ­£å¸¸
- [ ] å“åº”å¼å¸ƒå±€æ­£å¸¸
- [ ] ç§»åŠ¨ç«¯é€‚é…æ­£å¸¸
- [ ] æµè§ˆå™¨å…¼å®¹æ€§æ­£å¸¸

### 8.3 æ€§èƒ½æ£€æŸ¥

- [ ] æ— å†…å­˜æ³„æ¼
- [ ] æ— é‡å¤è¯·æ±‚
- [ ] å›¾ç‰‡æ‡’åŠ è½½
- [ ] åˆ—è¡¨è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¤§æ•°æ®é‡ï¼‰
- [ ] é˜²æŠ–èŠ‚æµä½¿ç”¨
- [ ] ç»„ä»¶æ‡’åŠ è½½
- [ ] è·¯ç”±æ‡’åŠ è½½

---

## ğŸš€ ä¹ã€éƒ¨ç½²ä¸ä¸Šçº¿

### 9.1 æ„å»ºé…ç½®

```javascript
// vite.config.js
export default defineConfig({
  build: {
    // ç”Ÿäº§ç¯å¢ƒç§»é™¤console
    terserOptions: {
      compress: {
        drop_console: true,
        drop_debugger: true
      }
    },

    // ä»£ç åˆ†å‰²
    rollupOptions: {
      output: {
        manualChunks: {
          'ant-design-vue': ['ant-design-vue'],
          'vue-vendor': ['vue', 'vue-router', 'pinia'],
          'echarts': ['echarts']
        }
      }
    }
  }
});
```

### 9.2 ç¯å¢ƒå˜é‡

```bash
# .env.production
VITE_APP_TITLE=IOE-DREAMæ¶ˆè´¹ç®¡ç†ç³»ç»Ÿ
VITE_APP_API_BASE_URL=https://api.example.com
VITE_APP_UPLOAD_URL=https://upload.example.com
```

---

## ğŸ“š åã€ç›¸å…³æ–‡æ¡£

- [æ¶ˆè´¹æ¨¡å—æ€»ä½“è®¾è®¡](./00-æ¶ˆè´¹å¾®æœåŠ¡æ€»ä½“è®¾è®¡æ–‡æ¡£.md)
- [åŠŸèƒ½è¯´æ˜](./01-åŠŸèƒ½è¯´æ˜/README.md)
- [ç•Œé¢åŸå‹è®¾è®¡](./08-å‰ç«¯è®¾è®¡/ç•Œé¢åŸå‹è®¾è®¡.md)
- [åŒºåŸŸç®¡ç†æ¨¡å—è®¾è®¡](./01-åŒºåŸŸç®¡ç†æ¨¡å—é‡æ„è®¾è®¡.md)
- [é¤åˆ«åˆ†ç±»ä½“ç³»è®¾è®¡](./02-é¤åˆ«åˆ†ç±»ä½“ç³»é‡æ„è®¾è®¡.md)
- [è´¦æˆ·ç±»åˆ«ä¸æ¶ˆè´¹æ¨¡å¼è®¾è®¡](./03-è´¦æˆ·ç±»åˆ«ä¸æ¶ˆè´¹æ¨¡å¼è®¾è®¡.md)
- [æ¶ˆè´¹å¤„ç†æµç¨‹è®¾è®¡](./06-æ¶ˆè´¹å¤„ç†æµç¨‹é‡æ„è®¾è®¡.md)
- [å……å€¼é€€æ¬¾æµç¨‹è®¾è®¡](./08-å……å€¼é€€æ¬¾æµç¨‹é‡æ„è®¾è®¡.md)

---

## âœ… åä¸€ã€éªŒæ”¶æ ‡å‡†

### 11.1 åŠŸèƒ½éªŒæ”¶

- âœ… æ‰€æœ‰P0çº§åŠŸèƒ½å®Œæ•´å®ç°
- âœ… æ‰€æœ‰P1çº§åŠŸèƒ½å®Œæ•´å®ç°
- âœ… æ ¸å¿ƒæµç¨‹å¯å®Œæ•´èµ°é€š
- âœ… å¼‚å¸¸åœºæ™¯å¤„ç†å®Œå–„
- âœ… ç”¨æˆ·ä½“éªŒæµç•…

### 11.2 ä»£ç è´¨é‡éªŒæ”¶

- âœ… ä»£ç ç¬¦åˆè§„èŒƒ
- âœ… å•å…ƒæµ‹è¯•è¦†ç›–ç‡â‰¥80%
- âœ… æ— æ˜æ˜¾æ€§èƒ½é—®é¢˜
- âœ… æ— å®‰å…¨æ¼æ´
- âœ… æµè§ˆå™¨å…¼å®¹æ€§è‰¯å¥½

### 11.3 æ–‡æ¡£éªŒæ”¶

- âœ… APIæ–‡æ¡£å®Œæ•´
- âœ… ç»„ä»¶æ–‡æ¡£å®Œæ•´
- âœ… éƒ¨ç½²æ–‡æ¡£å®Œæ•´
- âœ… ç”¨æˆ·æ‰‹å†Œå®Œæ•´

---

**ğŸ“ æ–‡æ¡£ç»´æŠ¤**: æœ¬æ–‡æ¡£éšé¡¹ç›®è¿›å±•æŒç»­æ›´æ–°
**ğŸ‘¥ è´Ÿè´£äºº**: IOE-DREAMå‰ç«¯å›¢é˜Ÿ
**ğŸ“… æœ€åæ›´æ–°**: 2025-12-24
