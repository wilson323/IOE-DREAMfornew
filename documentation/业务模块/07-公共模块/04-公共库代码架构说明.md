# IOE-DREAM å…¬å…±åº“ä»£ç æ¶æ„è¯´æ˜

> **ç‰ˆæœ¬**: v1.0.0  
> **åˆ›å»ºæ—¥æœŸ**: 2025-12-17  
> **é€‚ç”¨èŒƒå›´**: microservices-common åŠç›¸å…³å…¬å…±åº“æ¨¡å—

---

## ğŸ“‹ æ¦‚è¿°

IOE-DREAM å…¬å…±åº“é‡‡ç”¨èšåˆæ¨¡å—è®¾è®¡ï¼Œè¢«æ‰€æœ‰ä¸šåŠ¡å¾®æœåŠ¡ä¾èµ–ï¼Œæä¾›ç»Ÿä¸€çš„åŸºç¡€èƒ½åŠ›æ”¯æ’‘ã€‚

---

## ğŸ“ å…¬å…±åº“æ¨¡å—ç»“æ„ï¼ˆå®é™…ç›®å½•ï¼‰

```
microservices/
â”œâ”€â”€ microservices-common/            # ä¸šåŠ¡å…¬å…±ç»„ä»¶ï¼ˆEntity/DAO/Managerï¼‰
â”œâ”€â”€ microservices-common-core/       # æ ¸å¿ƒå·¥å…·ç±»ï¼ˆResponseDTO/PageResult/BaseEntityï¼‰
â”œâ”€â”€ microservices-common-data/       # æ•°æ®è®¿é—®å±‚
â”œâ”€â”€ microservices-common-cache/      # ç¼“å­˜ç»„ä»¶
â”œâ”€â”€ microservices-common-business/   # ä¸šåŠ¡å…¬å…±ç»„ä»¶æ‰©å±•
â”œâ”€â”€ microservices-common-monitor/    # ç›‘æ§ç»„ä»¶
â”œâ”€â”€ microservices-common-permission/ # æƒé™ç»„ä»¶
â”œâ”€â”€ microservices-common-security/   # å®‰å…¨ç»„ä»¶
â”œâ”€â”€ microservices-common-workflow/   # å·¥ä½œæµç»„ä»¶
â””â”€â”€ microservices-common-export/     # å¯¼å‡ºç»„ä»¶
```

---

## ğŸ”§ å„æ¨¡å—èŒè´£

### 1. microservices-common (ä¸šåŠ¡å…¬å…±ç»„ä»¶)

**èŒè´£**: è·¨å¾®æœåŠ¡å…±äº«çš„ä¸šåŠ¡å®ä½“ã€DAOã€Manager

**å®é™…ç›®å½•ç»“æ„**:
```
net.lab1024.sa.common/
â”œâ”€â”€ access/entity/           # é—¨ç¦å…¬å…±å®ä½“
â”‚   â”œâ”€â”€ AccessPermissionApplyEntity.java
â”‚   â””â”€â”€ AccessRecordEntity.java
â”œâ”€â”€ attendance/entity/       # è€ƒå‹¤å…¬å…±å®ä½“
â”‚   â”œâ”€â”€ AttendanceRecordEntity.java
â”‚   â”œâ”€â”€ WorkShiftEntity.java
â”‚   â””â”€â”€ ...
â”œâ”€â”€ audit/                   # å®¡è®¡æ—¥å¿—
â”‚   â”œâ”€â”€ dao/AuditLogDao.java
â”‚   â””â”€â”€ entity/AuditLogEntity.java
â”œâ”€â”€ auth/                    # è®¤è¯ç›¸å…³
â”œâ”€â”€ cache/                   # ç¼“å­˜æœåŠ¡
â”‚   â”œâ”€â”€ SpringCacheServiceImpl.java
â”‚   â””â”€â”€ UnifiedCacheManager.java
â”œâ”€â”€ consume/entity/          # æ¶ˆè´¹å…¬å…±å®ä½“
â”‚   â”œâ”€â”€ AccountEntity.java
â”‚   â”œâ”€â”€ ConsumeRecordEntity.java
â”‚   â””â”€â”€ PaymentRefundRecordEntity.java
â”œâ”€â”€ organization/            # ç»„ç»‡æ¶æ„
â”‚   â”œâ”€â”€ entity/AreaEntity.java
â”‚   â”œâ”€â”€ entity/DeviceEntity.java
â”‚   â””â”€â”€ manager/AreaDeviceManager.java
â”œâ”€â”€ rbac/                    # æƒé™ç›¸å…³
â”‚   â”œâ”€â”€ dao/RoleDao.java
â”‚   â””â”€â”€ entity/RoleEntity.java
â”œâ”€â”€ video/                   # è§†é¢‘å…¬å…±ç»„ä»¶
â”‚   â”œâ”€â”€ dao/VideoMonitorDao.java
â”‚   â”œâ”€â”€ entity/VideoDeviceEntity.java
â”‚   â””â”€â”€ manager/VideoMonitorManager.java
â””â”€â”€ visitor/entity/          # è®¿å®¢å…¬å…±å®ä½“
    â”œâ”€â”€ VisitorEntity.java
    â””â”€â”€ VisitorAppointmentEntity.java
```

### 2. microservices-common-core (æ ¸å¿ƒå·¥å…·)

**èŒè´£**: æä¾›æœ€åŸºç¡€çš„å·¥å…·ç±»å’Œé…ç½®

**å®é™…ç›®å½•ç»“æ„**:
```
net.lab1024.sa.common/
â”œâ”€â”€ config/                  # é…ç½®ç±»
â”‚   â”œâ”€â”€ JacksonConfiguration.java
â”‚   â”œâ”€â”€ UnifiedThreadPoolConfiguration.java
â”‚   â””â”€â”€ properties/IoeDreamGatewayProperties.java
â”œâ”€â”€ constant/SystemConstants.java
â”œâ”€â”€ controller/SupportBaseController.java
â”œâ”€â”€ domain/                  # é€šç”¨é¢†åŸŸå¯¹è±¡
â”‚   â”œâ”€â”€ PageParam.java
â”‚   â”œâ”€â”€ PageResult.java
â”‚   â”œâ”€â”€ CursorPageParam.java
â”‚   â””â”€â”€ form/BaseQueryForm.java
â”œâ”€â”€ dto/ResponseDTO.java     # ç»Ÿä¸€å“åº”æ ¼å¼
â”œâ”€â”€ entity/BaseEntity.java   # å®ä½“åŸºç±»
â”œâ”€â”€ exception/               # å¼‚å¸¸å®šä¹‰
â”‚   â”œâ”€â”€ BusinessException.java
â”‚   â”œâ”€â”€ ParamException.java
â”‚   â””â”€â”€ SystemException.java
â”œâ”€â”€ gateway/                 # ç½‘å…³å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ GatewayServiceClient.java
â”‚   â””â”€â”€ DirectServiceClient.java
â”œâ”€â”€ util/                    # å·¥å…·ç±»
â”‚   â”œâ”€â”€ JsonUtil.java
â”‚   â”œâ”€â”€ AESUtil.java
â”‚   â””â”€â”€ DataMaskUtil.java
â””â”€â”€ workflow/constant/       # å·¥ä½œæµå¸¸é‡
    â””â”€â”€ BusinessTypeEnum.java
```

### 3. microservices-common-data (æ•°æ®è®¿é—®)

**èŒè´£**: æ•°æ®åº“è®¿é—®ç›¸å…³é…ç½®å’Œç»„ä»¶

**æ ¸å¿ƒåŠŸèƒ½**:
- MyBatis-Plus é…ç½®
- Druid æ•°æ®æºé…ç½®
- åˆ†é¡µæ’ä»¶é…ç½®
- SQL å®¡è®¡æ—¥å¿—
- å¤šæ•°æ®æºæ”¯æŒ

### 4. microservices-common-cache (ç¼“å­˜ç»„ä»¶)

**èŒè´£**: å¤šçº§ç¼“å­˜ç®¡ç†

**æ ¸å¿ƒåŠŸèƒ½**:
- Redis ç¼“å­˜é…ç½®
- Caffeine æœ¬åœ°ç¼“å­˜
- ç¼“å­˜æ³¨è§£å¢å¼º
- ç¼“å­˜ç©¿é€/é›ªå´©é˜²æŠ¤

### 5. microservices-common-business (ä¸šåŠ¡å…¬å…±)

**èŒè´£**: ä¸šåŠ¡å±‚å…¬å…±ç»„ä»¶

**å®é™…ç›®å½•ç»“æ„**:
```
net.lab1024.sa.common/
â”œâ”€â”€ cache/
â”‚   â”œâ”€â”€ CacheNamespace.java
â”‚   â”œâ”€â”€ CacheService.java
â”‚   â””â”€â”€ LightCacheConfiguration.java
â”œâ”€â”€ dict/
â”‚   â”œâ”€â”€ dao/DictDataDao.java, DictTypeDao.java
â”‚   â”œâ”€â”€ entity/DictDataEntity.java, DictTypeEntity.java
â”‚   â””â”€â”€ manager/DictManager.java
â”œâ”€â”€ menu/
â”‚   â”œâ”€â”€ dao/MenuDao.java, RoleMenuDao.java
â”‚   â”œâ”€â”€ entity/MenuEntity.java, RoleMenuEntity.java
â”‚   â””â”€â”€ manager/MenuManager.java
â”œâ”€â”€ notification/
â”‚   â”œâ”€â”€ dao/NotificationConfigDao.java
â”‚   â”œâ”€â”€ entity/NotificationConfigEntity.java
â”‚   â””â”€â”€ manager/NotificationConfigManager.java
â”œâ”€â”€ organization/
â”‚   â”œâ”€â”€ dao/AreaDao.java, DeviceDao.java
â”‚   â”œâ”€â”€ entity/AreaEntity.java, DeviceEntity.java
â”‚   â””â”€â”€ manager/AreaManager.java, DevicePermissionManager.java
â”œâ”€â”€ preference/
â”‚   â””â”€â”€ manager/UserPreferenceManager.java
â”œâ”€â”€ scheduler/
â”‚   â””â”€â”€ entity/ScheduledJobEntity.java
â”œâ”€â”€ system/
â”‚   â”œâ”€â”€ dao/SystemConfigDao.java, SystemDictDao.java
â”‚   â”œâ”€â”€ entity/SystemConfigEntity.java
â”‚   â”œâ”€â”€ employee/
â”‚   â”‚   â”œâ”€â”€ entity/EmployeeEntity.java
â”‚   â”‚   â””â”€â”€ manager/EmployeeManager.java
â”‚   â””â”€â”€ manager/ConfigManager.java
â”œâ”€â”€ theme/
â”‚   â””â”€â”€ manager/ThemeTemplateManager.java
â””â”€â”€ workflow/
    â”œâ”€â”€ dao/ApprovalConfigDao.java
    â”œâ”€â”€ entity/ApprovalConfigEntity.java
    â”œâ”€â”€ executor/NodeExecutor.java
    â””â”€â”€ manager/WorkflowApprovalManager.java
```

### 6. microservices-common-monitor (ç›‘æ§ç»„ä»¶)

**èŒè´£**: ç³»ç»Ÿç›‘æ§å’Œå¯è§‚æµ‹æ€§

**å®é™…ç›®å½•ç»“æ„**:
```
net.lab1024.sa.common/
â”œâ”€â”€ config/
â”‚   â””â”€â”€ MonitorBeanAutoConfiguration.java
â”œâ”€â”€ monitor/
â”‚   â”œâ”€â”€ dao/
â”‚   â”‚   â”œâ”€â”€ AlertDao.java
â”‚   â”‚   â”œâ”€â”€ AlertRuleDao.java
â”‚   â”‚   â”œâ”€â”€ NotificationDao.java
â”‚   â”‚   â”œâ”€â”€ SystemLogDao.java
â”‚   â”‚   â””â”€â”€ SystemMonitorDao.java
â”‚   â”œâ”€â”€ domain/
â”‚   â”‚   â”œâ”€â”€ entity/AlertEntity.java
â”‚   â”‚   â”œâ”€â”€ entity/AlertRuleEntity.java
â”‚   â”‚   â”œâ”€â”€ entity/SystemMonitorEntity.java
â”‚   â”‚   â””â”€â”€ vo/SystemHealthVO.java
â”‚   â”œâ”€â”€ manager/
â”‚   â”‚   â”œâ”€â”€ DruidConnectionPoolMonitor.java
â”‚   â”‚   â”œâ”€â”€ HealthCheckManager.java
â”‚   â”‚   â”œâ”€â”€ LogManagementManager.java
â”‚   â”‚   â”œâ”€â”€ NotificationManager.java
â”‚   â”‚   â”œâ”€â”€ PerformanceMonitorManager.java
â”‚   â”‚   â””â”€â”€ SystemMonitorManager.java
â”‚   â””â”€â”€ service/
â”‚       â”œâ”€â”€ AlertService.java
â”‚       â”œâ”€â”€ MonitorService.java
â”‚       â””â”€â”€ SystemHealthService.java
â”œâ”€â”€ monitoring/
â”‚   â”œâ”€â”€ AlertManager.java
â”‚   â”œâ”€â”€ AlertNotificationDispatcher.java
â”‚   â”œâ”€â”€ EnterpriseMonitoringManager.java
â”‚   â””â”€â”€ MonitoringConfiguration.java
â”œâ”€â”€ performance/
â”‚   â”œâ”€â”€ JvmPerformanceManager.java
â”‚   â””â”€â”€ model/JvmPerformanceOverview.java
â””â”€â”€ tracing/
    â”œâ”€â”€ TraceIdMdcFilter.java
    â””â”€â”€ TracingConfiguration.java
```

### 7. microservices-common-permission (æƒé™ç»„ä»¶)

**èŒè´£**: ç»Ÿä¸€æƒé™ç®¡ç†

**å®é™…ç›®å½•ç»“æ„**:
```
net.lab1024.sa.common.permission/
â”œâ”€â”€ alert/
â”‚   â””â”€â”€ PermissionAlertManager.java
â”œâ”€â”€ annotation/
â”‚   â””â”€â”€ PermissionCheck.java              # æƒé™æ£€æŸ¥æ³¨è§£
â”œâ”€â”€ aspect/
â”‚   â”œâ”€â”€ PermissionCheckAspect.java        # æƒé™æ£€æŸ¥åˆ‡é¢
â”‚   â”œâ”€â”€ PermissionParameterResolver.java
â”‚   â””â”€â”€ PermissionResultHandler.java
â”œâ”€â”€ audit/
â”‚   â”œâ”€â”€ PermissionAuditAspect.java
â”‚   â”œâ”€â”€ PermissionAuditConfig.java
â”‚   â”œâ”€â”€ PermissionAuditDTO.java
â”‚   â””â”€â”€ PermissionAuditLogger.java
â”œâ”€â”€ config/
â”‚   â””â”€â”€ UnifiedPermissionConfigManager.java
â”œâ”€â”€ domain/
â”‚   â”œâ”€â”€ dto/PermissionValidationResult.java
â”‚   â”œâ”€â”€ entity/PermissionEntity.java
â”‚   â”œâ”€â”€ enums/LogicOperator.java
â”‚   â””â”€â”€ vo/UserPermissionVO.java
â”œâ”€â”€ manager/
â”‚   â”œâ”€â”€ PermissionAuditManager.java
â”‚   â”œâ”€â”€ PermissionCacheManager.java
â”‚   â”œâ”€â”€ PermissionValidationManager.java
â”‚   â””â”€â”€ impl/PermissionCacheManagerImpl.java
â”œâ”€â”€ monitor/
â”‚   â””â”€â”€ PermissionPerformanceMonitor.java
â”œâ”€â”€ optimize/
â”‚   â”œâ”€â”€ PermissionOptimizationConfig.java
â”‚   â””â”€â”€ PermissionPerformanceOptimizer.java
â””â”€â”€ service/
    â”œâ”€â”€ PermissionDataService.java
    â”œâ”€â”€ UnifiedPermissionService.java
    â””â”€â”€ impl/
        â”œâ”€â”€ PermissionDataServiceImpl.java
        â””â”€â”€ UnifiedPermissionServiceImpl.java
```

### 8. microservices-common-security (å®‰å…¨ç»„ä»¶)

**èŒè´£**: å®‰å…¨é…ç½®å’Œè®¤è¯

**æ ¸å¿ƒåŠŸèƒ½**:
- Sa-Token é›†æˆé…ç½®
- æ¥å£åŠ è§£å¯†
- æ•æ„Ÿæ•°æ®è„±æ•
- XSS é˜²æŠ¤
- CSRF é˜²æŠ¤

### 9. microservices-common-workflow (å·¥ä½œæµç»„ä»¶)

**èŒè´£**: å·¥ä½œæµåŸºç¡€ç»„ä»¶

**æ ¸å¿ƒåŠŸèƒ½**:
- æµç¨‹å®šä¹‰æ¥å£
- å®¡æ‰¹èŠ‚ç‚¹æŠ½è±¡
- æµç¨‹çŠ¶æ€ç®¡ç†
- ä¸ OA æ¨¡å—é›†æˆ

### 10. microservices-common-export (å¯¼å‡ºç»„ä»¶)

**èŒè´£**: æ•°æ®å¯¼å‡ºåŠŸèƒ½

**æ ¸å¿ƒåŠŸèƒ½**:
- Excel å¯¼å‡º (EasyExcel)
- PDF å¯¼å‡º
- å¼‚æ­¥å¯¼å‡ºä»»åŠ¡
- å¤§æ•°æ®é‡åˆ†æ‰¹å¯¼å‡º

---

## ğŸ›ï¸ æ¶æ„è§„èŒƒ

### å››å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Controllerå±‚ - åœ¨å¾®æœåŠ¡ä¸­å®ç°                        â”‚
â”‚  - HTTPè¯·æ±‚å¤„ç†ã€å‚æ•°éªŒè¯ã€æƒé™æ§åˆ¶                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Serviceå±‚ - åœ¨å¾®æœåŠ¡ä¸­å®ç°                          â”‚
â”‚  - æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ã€äº‹åŠ¡ç®¡ç†                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Managerå±‚ - å¯åœ¨å…¬å…±åº“ä¸­å®šä¹‰æŠ½è±¡                     â”‚
â”‚  - æµç¨‹ç¼–æ’ã€ç¼“å­˜ç®¡ç†ã€ç¬¬ä¸‰æ–¹é›†æˆ                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  DAOå±‚ - å¯åœ¨å…¬å…±åº“ä¸­å®šä¹‰æ¥å£                         â”‚
â”‚  - æ•°æ®åº“CRUDæ“ä½œã€ç»§æ‰¿BaseMapper                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç¼–ç è§„èŒƒ

```java
// âœ… æ­£ç¡® - ä½¿ç”¨ @Resource æ³¨å…¥
@Resource
private UserDao userDao;

// âœ… æ­£ç¡® - ä½¿ç”¨ @Mapper + Dao åç¼€
@Mapper
public interface UserDao extends BaseMapper<UserEntity> { }

// âœ… æ­£ç¡® - ä½¿ç”¨ jakarta.* åŒ…
import jakarta.annotation.Resource;
import jakarta.validation.Valid;

// âŒ ç¦æ­¢ - @Autowired, @Repository, javax.*
```

---

## ğŸ“¦ ä¾èµ–å…³ç³»

```mermaid
graph TD
    A[microservices-common] --> B[microservices-common-core]
    A --> C[microservices-common-data]
    A --> D[microservices-common-cache]
    A --> E[microservices-common-business]
    
    E --> B
    E --> C
    
    F[microservices-common-permission] --> B
    G[microservices-common-monitor] --> B
    H[microservices-common-security] --> B
    
    I[ä¸šåŠ¡å¾®æœåŠ¡] --> A
    I --> F
    I --> G
    I --> H
```

---

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹

### ä¸šåŠ¡å¾®æœåŠ¡å¼•å…¥å…¬å…±åº“

```xml
<dependency>
    <groupId>net.lab1024.sa</groupId>
    <artifactId>microservices-common</artifactId>
    <version>${project.version}</version>
</dependency>

<dependency>
    <groupId>net.lab1024.sa</groupId>
    <artifactId>microservices-common-permission</artifactId>
    <version>${project.version}</version>
</dependency>
```

### ä½¿ç”¨ç»Ÿä¸€å“åº”æ ¼å¼

```java
@GetMapping("/{id}")
public ResponseDTO<UserVO> getById(@PathVariable Long id) {
    return ResponseDTO.ok(userService.getById(id));
}

@GetMapping("/page")
public ResponseDTO<PageResult<UserVO>> page(@Valid UserQueryForm form) {
    return ResponseDTO.ok(userService.queryPage(form));
}
```

### ä½¿ç”¨æƒé™æ³¨è§£

```java
@RequiresPermission("user:list")
@GetMapping("/list")
public ResponseDTO<List<UserVO>> list() {
    return ResponseDTO.ok(userService.list());
}
```

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å…¬å…±åº“ä¸åŒ…å« @Service å®ç°** - ä»…å®šä¹‰æ¥å£å’ŒæŠ½è±¡ç±»
2. **å…¬å…±åº“ä¸åŒ…å« @RestController** - ä»…æä¾›åŸºç¡€èƒ½åŠ›
3. **å…¬å…±åº“ä¸ç›´æ¥ä¾èµ– spring-boot-starter-web** - ç”±å¾®æœåŠ¡å¼•å…¥
4. **Manager å±‚åœ¨å…¬å…±åº“ä¸­ä¸ä½¿ç”¨ Spring æ³¨è§£** - ç”±å¾®æœåŠ¡é…ç½®ç±»æ³¨å†Œ

---

**ğŸ“ æ–‡æ¡£ç»´æŠ¤**
- **åˆ›å»ºäºº**: IOE-DREAMæ¶æ„å›¢é˜Ÿ
- **æœ€åæ›´æ–°**: 2025-12-17
