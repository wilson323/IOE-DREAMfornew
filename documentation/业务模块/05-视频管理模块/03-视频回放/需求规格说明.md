# 视频回放模块 - 需求规格说明

## 功能需求

### FR-PB-001: 录像检索
| 项目 | 描述 |
|------|------|
| 需求ID | FR-PB-001 |
| 优先级 | P0 |
| 前置条件 | 用户已登录，权限>=Level 2 |
| 操作步骤 | 1.选择设备 2.选择时间范围 3.执行检索 4.显示结果 |
| 后置结果 | 返回时间范围内的录像列表 |

### FR-PB-002: 录像播放
| 项目 | 描述 |
|------|------|
| 需求ID | FR-PB-002 |
| 优先级 | P0 |
| 前置条件 | 已检索到录像，权限>=Level 2 |
| 操作步骤 | 1.选择录像 2.请求播放 3.加载流 4.开始播放 |
| 后置结果 | 播放器正常播放录像 |

### FR-PB-003: 播放控制
| 项目 | 描述 |
|------|------|
| 需求ID | FR-PB-003 |
| 优先级 | P0 |
| 前置条件 | 录像正在播放 |
| 操作步骤 | 暂停/播放/快进/快退/跳转 |
| 后置结果 | 播放状态按操作变更 |

### FR-PB-004: 录像下载
| 项目 | 描述 |
|------|------|
| 需求ID | FR-PB-004 |
| 优先级 | P1 |
| 前置条件 | 用户已登录，权限>=Level 3 |
| 操作步骤 | 1.选择录像/时间段 2.发起下载 3.后台处理 4.完成通知 |
| 后置结果 | 录像文件下载到本地 |

### FR-PB-005: 时间轴显示
| 项目 | 描述 |
|------|------|
| 需求ID | FR-PB-005 |
| 优先级 | P1 |
| 前置条件 | 已检索录像 |
| 操作步骤 | 1.加载时间轴数据 2.渲染时间轴 3.标记有录像时段 |
| 后置结果 | 可视化显示录像分布 |

### FR-PB-006: 智能检索
| 项目 | 描述 |
|------|------|
| 需求ID | FR-PB-006 |
| 优先级 | P2 |
| 前置条件 | 用户已登录，权限>=Level 3，有分析数据 |
| 操作步骤 | 1.选择检索类型(人脸/车牌) 2.输入条件 3.检索 |
| 后置结果 | 返回包含目标的录像片段 |

---

## 非功能需求

### NFR-PB-001: 性能要求
| 指标 | 要求 |
|------|------|
| 录像检索响应 | < 2秒 |
| 起播时间 | < 3秒 |
| 进度跳转响应 | < 2秒 |
| 下载速度 | ≥ 10MB/s |
| 支持倍速 | 1/8x ~ 16x |

### NFR-PB-002: 可靠性要求
| 指标 | 要求 |
|------|------|
| 播放稳定性 | 连续播放无卡顿 |
| 下载完整性 | 文件校验通过 |
| 断点续传 | 支持 |

### NFR-PB-003: 安全性要求
| 要求 | 描述 |
|------|------|
| 权限控制 | 下载需Level 3以上 |
| 操作审计 | 记录下载操作日志 |
| 水印 | 下载视频可选添加水印 |

---

## 验收标准

### AC-PB-001: 检索功能验收
- [ ] 按设备+时间检索录像正常
- [ ] 检索响应时间<2秒
- [ ] 无录像时正确提示
- [ ] 多设备同时检索正常

### AC-PB-002: 播放功能验收
- [ ] 起播时间<3秒
- [ ] 暂停/播放控制正常
- [ ] 快进/快退(2x/4x/8x/16x)正常
- [ ] 进度条拖拽跳转正常

### AC-PB-003: 时间轴验收
- [ ] 时间轴正确显示录像分布
- [ ] 点击时间轴跳转播放正常
- [ ] 缩放时间轴正常
- [ ] 事件标记正确显示

### AC-PB-004: 下载功能验收
- [ ] 录像下载完整无损
- [ ] 下载进度显示正确
- [ ] 断点续传正常
- [ ] 大文件下载稳定
