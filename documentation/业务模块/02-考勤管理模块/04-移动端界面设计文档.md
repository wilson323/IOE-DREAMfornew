# 考勤管理模块 - 移动端界面设计文档

## 1. 概述

本文档定义了IOE-DREAM智慧园区安防综合管理平台中考勤管理模块移动端的界面设计方案，基于UniApp框架，支持iOS、Android、H5等多端运行。

### 1.1 设计原则

- **简洁易用**: 界面简洁明了，操作便捷高效
- **响应式设计**: 适配不同屏幕尺寸
- **用户友好**: 提供清晰的操作指引和反馈
- **性能优先**: 快速加载，流畅交互

### 1.2 技术栈

- **框架**: UniApp 3.0
- **UI组件**: uni-ui 1.5+
- **状态管理**: Pinia 2.0+
- **HTTP请求**: uni.request
- **存储**: uni.setStorageSync/getStorageSync
- **定位服务**: uni.getLocation

---

## 2. 整体架构

### 2.1 页面结构

```
pages/
├── login/                    # 登录页面
├── home/                     # 首页/仪表盘
├── attendance/                # 考勤模块
│   ├── punch/                # 打卡页面
│   ├── calendar/             # 考勤日历
│   ├── records/              # 考勤记录
│   ├── statistics/           # 考勤统计
│   └── exception/            # 异常申请
├── profile/                  # 个人中心
└── settings/                 # 设置页面
```

### 2.2 导航结构

```json
{
  "tabBar": {
    "color": "#999999",
    "selectedColor": "#007AFF",
    "backgroundColor": "#FFFFFF",
    "borderStyle": "white",
    "list": [
      {
        "pagePath": "pages/home/index",
        "text": "首页",
        "iconPath": "static/tabbar/home.png",
        "selectedIconPath": "static/tabbar/home-active.png"
      },
      {
        "pagePath": "pages/attendance/punch/index",
        "text": "打卡",
        "iconPath": "static/tabbar/punch.png",
        "selectedIconPath": "static/tabbar/punch-active.png"
      },
      {
        "pagePath": "pages/attendance/records/index",
        "text": "记录",
        "iconPath": "static/tabbar/records.png",
        "selectedIconPath": "static/tabbar/records-active.png"
      },
      {
        "pagePath": "pages/profile/index",
        "text": "我的",
        "iconPath": "static/tabbar/profile.png",
        "selectedIconPath": "static/tabbar/profile-active.png"
      }
    ]
  }
}
```

---

## 3. 首页设计

### 3.1 页面布局

首页采用卡片式布局，展示用户今日考勤状态和快捷操作入口。

### 3.2 页面组件

#### 3.2.1 用户信息卡片

```vue
<template>
  <view class="user-card">
    <view class="user-info">
      <image class="avatar" :src="userInfo.avatar" mode="aspectFill" />
      <view class="user-details">
        <text class="username">{{ userInfo.name }}</text>
        <text class="department">{{ userInfo.department }}</text>
        <text class="employee-no">工号：{{ userInfo.employeeNo }}</text>
      </view>
    </view>
    <view class="today-status">
      <text class="status-text">今日考勤：{{ todayStatus }}</text>
      <text class="work-time">工作时长：{{ workDuration }}</text>
    </view>
  </view>
</template>
```

#### 3.2.2 今日考勤状态卡片

```vue
<template>
  <view class="today-card">
    <view class="card-header">
      <text class="title">今日考勤</text>
      <text class="date">{{ currentDate }}</text>
    </view>
    <view class="punch-status">
      <view class="punch-item">
        <text class="punch-label">上班打卡</text>
        <text class="punch-time">{{ clockInTime || '未打卡' }}</text>
        <text class="punch-status" :class="{ 'punched': hasClockIn }">
          {{ hasClockIn ? '已打卡' : '未打卡' }}
        </text>
      </view>
      <view class="punch-item">
        <text class="punch-label">下班打卡</text>
        <text class="punch-time">{{ clockOutTime || '未打卡' }}</text>
        <text class="punch-status" :class="{ 'punched': hasClockOut }">
          {{ hasClockOut ? '已打卡' : '未打卡' }}
        </text>
      </view>
    </view>
    <view class="shift-info">
      <text class="shift-name">班次：{{ shiftName }}</text>
      <text class="work-time">工作时间：{{ workTime }}</text>
    </view>
  </view>
</template>
```

#### 3.2.3 快捷操作入口

```vue
<template>
  <view class="quick-actions">
    <view class="action-grid">
      <view class="action-item" @click="navigateTo('/pages/attendance/punch/index')">
        <uni-icons type="camera" size="32" color="#007AFF" />
        <text class="action-text">立即打卡</text>
      </view>
      <view class="action-item" @click="navigateTo('/pages/attendance/exception/index')">
        <uni-icons type="compose" size="32" color="#FF9500" />
        <text class="action-text">异常申请</text>
      </view>
      <view class="action-item" @click="navigateTo('/pages/attendance/records/index')">
        <uni-icons type="list" size="32" color="#34C759" />
        <text class="action-text">考勤记录</text>
      </view>
      <view class="action-item" @click="navigateTo('/pages/attendance/calendar/index')">
        <uni-icons type="calendar" size="32" color="#AF52DE" />
        <text class="action-text">排班日历</text>
      </view>
    </view>
  </view>
</template>
```

---

## 4. 打卡页面设计

### 4.1 页面功能

- **位置验证**: GPS定位验证是否在有效考勤范围内
- **拍照验证**: 支持人脸识别拍照打卡
- **实时时钟**: 显示当前时间
- **打卡类型**: 区分上班/下班打卡

### 4.2 界面布局

```vue
<template>
  <view class="punch-page">
    <!-- 顶部信息 -->
    <view class="punch-header">
      <text class="current-time">{{ currentTime }}</text>
      <text class="current-date">{{ currentDate }}</text>
      <text class="week-day">{{ weekDay }}</text>
    </view>

    <!-- 打卡类型选择 -->
    <view class="punch-type-selector">
      <view
        class="type-item"
        :class="{ active: punchType === 'CHECK_IN' }"
        @click="switchPunchType('CHECK_IN')"
      >
        <uni-icons type="right" size="20" />
        <text class="type-text">上班打卡</text>
      </view>
      <view
        class="type-item"
        :class="{ active: punchType === 'CHECK_OUT' }"
        @click="switchPunchType('CHECK_OUT')"
      >
        <uni-icons type="left" size="20" />
        <text class="type-text">下班打卡</text>
      </view>
    </view>

    <!-- 位置信息 -->
    <view class="location-info">
      <uni-icons type="location" size="16" color="#999" />
      <text class="location-text">{{ location || '正在获取位置...' }}</text>
    </view>

    <!-- 状态指示器 -->
    <view class="status-indicator">
      <view class="status-dot" :class="{ success: locationValid, error: !locationValid }"></view>
      <text class="status-text">{{ statusText }}</text>
    </view>

    <!-- 打卡按钮 -->
    <view class="punch-button-container">
      <button
        class="punch-button"
        :class="{
          disabled: !canPunch,
          'punch-in': punchType === 'CHECK_IN',
          'punch-out': punchType === 'CHECK_OUT'
        }
        @click="handlePunch"
      >
        <uni-icons :type="punchType === 'CHECK_IN' ? 'right' : 'left'" size="24" />
        <text class="button-text">{{ punchButtonText }}</text>
      </button>
    </view>

    <!-- 最近打卡记录 -->
    <view class="recent-records">
      <view class="section-title">
        <text class="title">最近打卡记录</text>
        <text class="more" @click="viewAllRecords">查看全部</text>
      </view>
      <view class="record-list">
        <view class="record-item" v-for="record in recentRecords" :key="record.id">
          <view class="record-time">{{ record.punchTime }}</view>
          <view class="record-info">
            <text class="record-type">{{ record.punchTypeText }}</text>
            <text class="record-location">{{ record.location }}</text>
          </view>
          <view class="record-status" :class="record.status">{{ record.statusText }}</view>
        </view>
      </view>
    </view>
  </view>
</template>
```

### 4.3 关键功能实现

#### 4.3.1 位置验证

```javascript
// 获取当前位置
const getCurrentLocation = () => {
  uni.getLocation({
    type: 'wgs84',
    altitude: false,
    success: (res) => {
      const { latitude, longitude } = res;
      verifyLocationRange(latitude, longitude);
    },
    fail: (err) => {
      console.error('获取位置失败:', err);
      showToast('获取位置失败，请检查定位权限');
    }
  });
};

// 验证考勤范围
const verifyLocationRange = (latitude, longitude) => {
  // 考勤点位置和有效半径
  const attendancePoint = getCurrentAttendancePoint();
  const distance = calculateDistance(latitude, longitude, attendancePoint.latitude, attendancePoint.longitude);

  if (distance <= attendancePoint.radius) {
    setLocationValid(true);
    setStatusText('在考勤范围内');
  } else {
    setLocationValid(false);
    setStatusText(`距离考勤点${Math.round(distance)}米，不在有效范围`);
  }
};
```

#### 4.3.2 人脸识别拍照

```javascript
// 拍照打卡
const takePhotoForPunch = () => {
  uni.chooseImage({
    count: 1,
    sourceType: ['camera'],
    success: (res) => {
      const tempFilePaths = res.tempFilePaths;
      uploadFacePhoto(tempFilePaths[0]);
    },
    fail: (err) => {
      showToast('拍照失败');
    }
  });
};

// 上传人脸照片进行验证
const uploadFacePhoto = (filePath) => {
  uni.uploadFile({
    url: '/api/v1/attendance/face/verify',
    filePath: filePath,
    name: 'facePhoto',
    header: {
      'Authorization': 'Bearer ' + getToken()
    },
    success: (uploadRes) => {
      const result = JSON.parse(uploadRes.data);
      if (result.code === 200 && result.data.matched) {
        completePunch(filePath);
      } else {
        showToast('人脸验证失败，请重试');
      }
    },
    fail: (err) => {
      console.error('上传失败:', err);
      showToast('上传失败，请检查网络');
    }
  });
};
```

---

## 5. 考勤记录页面

### 5.1 页面功能

- **记录列表**: 分页展示考勤记录
- **筛选功能**: 按日期、类型、状态筛选
- **详情查看**: 查看打卡详情
- **统计图表**: 可视化考勤数据

### 5.2 界面布局

```vue
<template>
  <view class="records-page">
    <!-- 筛选栏 -->
    <view class="filter-bar">
      <view class="filter-item">
        <picker @change="onDateChange" mode="date" :value="filterDate">
          <view class="picker-item">
            <text>{{ filterDateText }}</text>
            <uni-icons type="down" size="14" />
          </view>
        </picker>
      </view>
      <view class="filter-item">
        <picker @change="onTypeChange" :range="typeOptions" range-key="text">
          <view class="picker-item">
            <text>{{ currentType.text }}</text>
            <uni-icons type="down" size="14" />
          </view>
        </picker>
      </view>
    </view>

    <!-- 统计卡片 -->
    <view class="stats-cards">
      <view class="stat-card">
        <text class="stat-value">{{ statistics.totalDays }}</text>
        <text class="stat-label">应出勤天数</text>
      </view>
      <view class="stat-card">
        <text class="stat-value">{{ statistics.actualDays }}</text>
        <text class="stat-label">实际出勤天数</text>
      </view>
      <view class="stat-card">
        <text class="stat-value">{{ statistics.lateCount }}</text>
        <text class="stat-label">迟到次数</text>
      </view>
    </view>

    <!-- 记录列表 -->
    <scroll-view
      class="records-scroll"
      scroll-y
      @scrolltolower="loadMore"
      :style="{ height: scrollHeight }"
    >
      <view class="record-list">
        <view
          class="record-item"
          v-for="record in recordsList"
          :key="record.id"
          @click="viewRecordDetail(record)"
        >
          <view class="record-header">
            <text class="record-date">{{ record.attendanceDate }}</text>
            <text class="record-status" :class="record.attendanceStatus">
              {{ record.statusText }}
            </text>
          </view>
          <view class="record-content">
            <view class="record-row">
              <text class="label">上班打卡：</text>
              <text class="value">{{ record.clockInTime || '未打卡' }}</text>
            </view>
            <view class="record-row">
              <text class="label">下班打卡：</text>
              <text class="value">{{ record.clockOutTime || '未打卡' }}</text>
            </view>
            <view class="record-row">
              <text class="label">工作时长：</text>
              <text class="value">{{ record.workDuration }}小时</text>
            </view>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>
</template>
```

---

## 6. 异常申请页面

### 6.1 页面功能

- **申请类型选择**: 请假、补签、加班等
- **表单填写**: 根据类型显示不同表单字段
- **附件上传**: 支持拍照、选择文件上传
- **申请进度**: 查看申请状态和审批进度

### 6.2 界面布局

```vue
<template>
  <view class="exception-page">
    <!-- 申请类型选择 -->
    <view class="type-selector">
      <view class="type-grid">
        <view
          class="type-item"
          v-for="type in exceptionTypes"
          :key="type.value"
          :class="{ active: currentType === type.value }"
          @click="selectExceptionType(type.value)"
        >
          <uni-icons :type="type.icon" size="24" :color="type.color" />
          <text class="type-text">{{ type.text }}</text>
        </view>
      </view>
    </view>

    <!-- 申请表单 -->
    <view class="application-form">
      <!-- 请假申请表单 -->
      <view v-if="currentType === 'LEAVE'" class="leave-form">
        <view class="form-item">
          <text class="form-label">请假类型</text>
          <picker @change="onLeaveTypeChange" :range="leaveTypes" range-key="text">
            <view class="picker-input">
              <text>{{ selectedLeaveType.text || '请选择' }}</text>
              <uni-icons type="down" size="14" />
            </view>
          </picker>
        </view>

        <view class="form-item">
          <text class="form-label">请假时间</text>
          <view class="date-range">
            <picker
              mode="date"
              :value="startDate"
              @change="onStartDateChange"
            >
              <view class="date-picker">
                <text>{{ startDate || '开始日期' }}</text>
              </view>
            </picker>
            <text class="date-separator">至</text>
            <picker
              mode="date"
              :value="endDate"
              @change="onEndDateChange"
            >
              <view class="date-picker">
                <text>{{ endDate || '结束日期' }}</text>
              </view>
            </picker>
          </view>
        </view>

        <view class="form-item">
          <text class="form-label">请假事由</text>
          <textarea
            class="form-textarea"
            v-model="application.reason"
            placeholder="请输入请假事由"
            maxlength="200"
          />
        </view>

        <view class="form-item">
          <text class="form-label">附件上传</text>
          <view class="upload-section">
            <view class="upload-btn" @click="chooseImage">
              <uni-icons type="camera" size="32" color="#007AFF" />
              <text class="upload-text">拍照</text>
            </view>
            <view class="upload-btn" @click="chooseFile">
              <uni-icons type="folder" size="32" color="#007AFF" />
              <text class="upload-text">选择文件</text>
            </view>
          </view>
        </view>
      </view>

      <!-- 加班申请表单 -->
      <view v-else-if="currentType === 'OVERTIME'" class="overtime-form">
        <view class="form-item">
          <text class="form-label">加班类型</text>
          <picker @change="onOvertimeTypeChange" :range="overtimeTypes">
            <view class="picker-input">
              <text>{{ selectedOvertimeType.text || '请选择' }}</text>
              <uni-icons type="down" size="14" />
            </view>
          </picker>
        </view>
        <!-- ... 其他加班表单字段 -->
      </view>

      <!-- 补签申请表单 -->
      <view v-else-if="currentType === 'SUPPLEMENT'" class="supplement-form">
        <!-- ... 补签表单字段 -->
      </view>

      <!-- 提交按钮 -->
      <view class="submit-section">
        <button
          class="submit-btn"
          :disabled="!canSubmit"
          @click="submitApplication"
        >
          提交申请
        </button>
      </view>
    </view>

    <!-- 申请历史 -->
    <view class="application-history">
      <view class="section-title">
        <text class="title">申请历史</text>
        <text class="more" @click="viewAllApplications">查看全部</text>
      </view>
      <view class="history-list">
        <view
          class="history-item"
          v-for="app in applicationHistory"
          :key="app.id"
          @click="viewApplicationDetail(app)"
        >
          <view class="app-info">
            <text class="app-type">{{ app.applicationTypeText }}</text>
            <text class="app-date">{{ app.createTime }}</text>
          </view>
          <view class="app-status">
            <text class="status-text" :class="app.approvalStatus">
              {{ app.statusText }}
            </text>
            <text class="process-info" v-if="app.currentApprover">
              当前审批人：{{ app.currentApprover }}
            </text>
          </view>
        </view>
      </view>
    </view>
  </view>
</template>
```

### 6.3 表单验证

```javascript
// 表单验证规则
const formRules = {
  leaveType: {
    required: true,
    message: '请选择请假类型'
  },
  startDate: {
    required: true,
    message: '请选择开始日期'
  },
  endDate: {
    required: true,
    message: '请选择结束日期'
  },
  reason: {
    required: true,
    message: '请输入请假事由',
    minLength: 5,
    maxLength: 200
  }
};

// 验证方法
const validateForm = () => {
  // 根据当前申请类型进行验证
  const rules = getFormRules(currentType);

  for (const field in rules) {
    const rule = rules[field];
    const value = application[field];

    if (rule.required && !value) {
      showToast(rule.message);
      return false;
    }

    if (rule.minLength && value.length < rule.minLength) {
      showToast(`最少输入${rule.minLength}个字符`);
      return false;
    }

    if (rule.maxLength && value.length > rule.maxLength) {
      showToast(`最多输入${rule.maxLength}个字符`);
      return false;
    }
  }

  // 验证日期逻辑
  if (startDate && endDate && new Date(startDate) > new Date(endDate)) {
    showToast('结束日期不能早于开始日期');
    return false;
  }

  return true;
};
```

---

## 7. 统计分析页面

### 7.1 图表展示

使用uCharts或ECharts展示考勤统计数据。

```vue
<template>
  <view class="statistics-page">
    <!-- 月份选择 -->
    <view class="month-selector">
      <picker @change="onMonthChange" mode="date" fields="month" :value="selectedMonth">
        <view class="month-picker">
          <text>{{ selectedMonthText }}</text>
          <uni-icons type="down" size="14" />
        </view>
      </picker>
    </view>

    <!-- 统计卡片 -->
    <view class="stats-summary">
      <view class="summary-item">
        <text class="summary-value">{{ monthlyStats.workDays }}</text>
        <text class="summary-label">出勤天数</text>
        <text class="summary-change">{{ monthlyStats.changeWorkDays > 0 ? '+' : '' }}{{ monthlyStats.changeWorkDays }}</text>
      </view>
      <view class="summary-item">
        <text class="summary-value">{{ monthlyStats.attendanceRate }}%</text>
        <text class="summary-label">出勤率</text>
        <text class="summary-change">{{ monthlyStats.changeRate > 0 ? '+' : '' }}{{ monthlyStats.changeRate }}%</text>
      </view>
    </view>

    <!-- 考勤状态饼图 -->
    <view class="chart-container">
      <view class="chart-title">考勤状态分布</view>
      <canvas
        canvas-id="statusPieChart"
        class="chart-canvas"
      ></canvas>
    </view>

    <!-- 每日考勤趋势图 -->
    <view class="chart-container">
      <view class="chart-title">每日考勤趋势</view>
      <canvas
        canvas-id="dailyTrendChart"
        class="chart-canvas"
      ></canvas>
    </view>

    <!-- 异常统计 -->
    <view class="abnormal-stats">
      <view class="section-title">
        <text class="title">异常统计</text>
      </view>
      <view class="stats-list">
        <view class="stats-item" v-for="stat in abnormalStats" :key="stat.type">
          <view class="stat-icon">
            <uni-icons :type="stat.icon" :size="20" :color="stat.color" />
          </view>
          <view class="stat-info">
            <text class="stat-count">{{ stat.count }}</text>
            <text class="stat-name">{{ stat.name }}</text>
          </view>
        </view>
      </view>
    </view>
  </view>
</template>
```

### 7.2 图表数据生成

```javascript
// 生成饼图数据
const generatePieChartData = () => {
  return {
    series: [{
      name: '考勤状态',
      data: [
        { value: statistics.normal, name: '正常' },
        { value: statistics.late, name: '迟到' },
        { value: statistics.early, name: '早退' },
        { value: statistics.absent, name: '旷工' },
        { value: statistics.leave, name: '请假' }
      ]
    }]
  };
};

// 生成趋势图数据
const generateTrendChartData = () => {
  const dates = [];
  const normalCounts = [];
  const lateCounts = [];

  // 生成当月日期数组
  for (let i = 1; i <= daysInMonth; i++) {
    const date = new Date(year, month - 1, i);
    dates.push(`${month}/${i}`);

    // 模拟当日数据
    normalCounts.push(Math.floor(Math.random() * 10) + 15);
    lateCounts.push(Math.floor(Math.random() * 5));
  }

  return {
    categories: dates,
    series: [
      {
        name: '正常',
        data: normalCounts,
        type: 'line'
      },
      {
        name: '迟到',
        data: lateCounts,
        type: 'line'
      }
    ]
  };
};
```

---

## 8. 个人中心页面

### 8.1 页面功能

- **个人信息**: 展示员工基本信息
- **考勤统计**: 个人考勤数据统计
- **设置管理**: 系统设置和偏好配置

### 8.2 界面布局

```vue
<template>
  <view class="profile-page">
    <!-- 个人信息 -->
    <view class="profile-header">
      <view class="avatar-section" @click="changeAvatar">
        <image class="avatar" :src="userInfo.avatar" mode="aspectFill" />
        <view class="edit-icon">
          <uni-icons type="camera" size="20" color="#fff" />
        </view>
      </view>
      <view class="user-details">
        <text class="username">{{ userInfo.name }}</text>
        <text class="employee-no">工号：{{ userInfo.employeeNo }}</text>
        <text class="department">{{ userInfo.department }}</text>
        <text class="position">{{ userInfo.position }}</text>
      </view>
    </view>

    <!-- 个人统计 -->
    <view class="profile-stats">
      <view class="stats-card">
        <text class="stat-number">{{ personalStats.monthAttendanceDays }}</text>
        <text class="stat-label">本月出勤</text>
      </view>
      <view class="stats-card">
        <text class="stat-number">{{ personalStats.totalOvertimeHours }}</text>
        <text class="stat-label">加班时长</text>
      </view>
      <view class="stats-card">
        <text class="stat-number">{{ personalStats.leaveBalance }}</text>
        <text class="stat-label">剩余假期</text>
      </view>
    </view>

    <!-- 功能菜单 -->
    <view class="menu-list">
      <view class="menu-item" @click="navigateTo('/pages/profile/personal-info')">
        <view class="menu-icon">
          <uni-icons type="person" size="20" color="#666" />
        </view>
        <text class="menu-text">个人信息</text>
        <uni-icons type="right" size="16" color="#ccc" />
      </view>

      <view class="menu-item" @click="navigateTo('/pages/profile/face-recognition')">
        <view class="menu-icon">
          <uni-icons type="camera-filled" size="20" color="#666" />
        </view>
        <text class="menu-text">人脸识别</text>
        <uni-icons type="right" size="16" color="#ccc" />
      </view>

      <view class="menu-item" @click="navigateTo('/pages/profile/notification-settings')">
        <view class="menu-icon">
          <uni-icons type="notification" size="20" color="#666" />
        </view>
        <text class="menu-text">通知设置</text>
        <uni-icons type="right" size="16" color="#ccc" />
      </view>

      <view class="menu-item" @click="navigateTo('/pages/profile/privacy-settings')">
        <view class="menu-icon">
          <uni-icons type="locked" size="20" color="#666" />
        </view>
        <text class="menu-text">隐私设置</text>
        <uni-icons type="right" size="16" color="#ccc" />
      </view>

      <view class="menu-item" @click="navigateTo('/pages/profile/about')">
        <view class="menu-icon">
          <uni-icons type="info" size="20" color="#666" />
        </view>
        <text class="menu-text">关于我们</text>
        <uni-icons type="right" size="16" color="#ccc" />
      </view>

      <view class="menu-item" @click="logout">
        <view class="menu-icon">
          <uni-icons type="gear" size="20" color="#666" />
        </view>
        <text class="menu-text">退出登录</text>
        <uni-icons type="right" size="16" color="#ccc" />
      </view>
    </view>
  </view>
</template>
```

---

## 9. 通用组件设计

### 9.1 加载状态组件

```vue
<template>
  <view class="loading-container" v-if="show">
    <view class="loading-content">
      <uni-load-more
        :status="status"
        :icon-size="iconSize"
        :content-text="text"
      />
    </view>
  </view>
</template>
```

### 9.2 提示组件

```vue
<template>
  <uni-popup
    ref="popup"
    type="center"
    :mask-click="false"
    :animation="true"
  >
    <view class="popup-content">
      <view class="popup-icon">
        <uni-icons :type="iconType" :size="40" :color="iconColor" />
      </view>
      <view class="popup-title">{{ title }}</view>
      <view class="popup-message">{{ message }}</view>
      <view class="popup-actions">
        <button
          class="popup-btn cancel"
          @click="handleCancel"
        >
          {{ cancelText }}
        </button>
        <button
          class="popup-btn confirm"
          @click="handleConfirm"
        >
          {{ confirmText }}
        </button>
      </view>
    </view>
  </uni-popup>
</template>
```

### 9.3 日期时间选择组件

```vue
<template>
  <view class="datetime-picker">
    <view class="picker-input" @click="showPicker">
      <text class="picker-text">{{ displayValue }}</text>
      <uni-icons type="calendar" size="16" color="#666" />
    </view>

    <uni-popup
      ref="datePopup"
      type="bottom"
      :mask-click="false"
    >
      <view class="date-picker-popup">
        <view class="popup-header">
          <text class="popup-title">{{ title }}</text>
          <button class="cancel-btn" @click="cancelPicker">取消</button>
          <button class="confirm-btn" @click="confirmPicker">确定</button>
        </view>
        <picker-view
          class="picker-view"
          :indicator-style="indicatorStyle"
          mode="date"
          :value="currentDate"
          @change="onDateChange"
          @cancel="cancelPicker"
        />
      </view>
    </uni-popup>
  </view>
</template>
```

---

## 10. 性能优化

### 10.1 页面加载优化

- **预加载**: 关键页面预加载
- **懒加载**: 非关键页面懒加载
- **缓存策略**: 合理使用缓存减少请求

### 10.2 数据请求优化

- **请求合并**: 合并多个小请求
- **分页加载**: 大数据量分页处理
- **请求缓存**: 缓存频繁请求的数据

### 10.3 图片优化

- **图片压缩**: 压缩上传图片大小
- **懒加载**: 图片懒加载
- **CDN加速**: 使用CDN加速静态资源

---

## 11. 错误处理

### 11.1 网络错误处理

```javascript
const handleNetworkError = (error) => {
  console.error('网络请求失败:', error);

  let message = '网络连接失败';
  if (error.errMsg) {
    message = getErrorMessage(error.errMsg);
  }

  showToast(message);

  // 重试机制
  if (error.statusCode >= 500 && retryCount < 3) {
    setTimeout(() => {
      retryRequest();
    }, 2000 * retryCount);
  }
};
```

### 11.2 权限错误处理

```javascript
const handleAuthError = (error) => {
  if (error.statusCode === 401) {
    // 清除本地token
    uni.removeStorageSync('token');

    // 跳转到登录页
    uni.reLaunch({
      url: '/pages/login/index'
    });

    showToast('登录已过期，请重新登录');
  } else if (error.statusCode === 403) {
    showToast('权限不足，无法访问该功能');
  }
};
```

---

## 12. 测试策略

### 12.1 功能测试

- **打卡功能测试**: 正常/异常场景测试
- **申请流程测试**: 各类型申请完整流程
- **数据同步测试**: 前后端数据一致性

### 12.2 兼容性测试

- **设备兼容性**: 不同品牌设备测试
- **系统兼容性**: 不同操作系统版本测试
- **浏览器兼容性**: H5在不同浏览器中测试

### 12.3 性能测试

- **启动速度**: 应用冷启动和热启动速度
- **内存占用**: 应用内存使用情况
- **电池消耗**: 长时间使用电池消耗

---

## 13. 发布更新

### 13.1 版本管理

- **版本号规范**: 采用语义化版本号
- **更新日志**: 记录每个版本的更新内容
- **更新机制**: 支持热更新和强制更新

### 13.2 打包配置

- **打包脚本**: 配置不同平台的打包脚本
- **资源优化**: 优化图片和代码体积
- **环境区分**: 区分开发、测试、生产环境

### 13.3 应用商店发布

- **应用商店**: 各大应用商店发布流程
- **审核准备**: 应用审核材料准备
- **发布策略**: 发布时机和渠道选择

---

*本文档由IOE-DREAM团队维护，如有疑问请联系技术支持。*