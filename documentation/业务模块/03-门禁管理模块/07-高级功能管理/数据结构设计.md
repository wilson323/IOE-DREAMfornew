# é«˜çº§åŠŸèƒ½ç®¡ç† - æ•°æ®ç»“æ„è®¾è®¡

> **ç‰ˆæœ¬**: v1.0.0  
> **åˆ›å»ºæ—¥æœŸ**: 2025-12-17

---

## ğŸ“Š ERå›¾

```mermaid
erDiagram
    ANTI_PASSBACK_RULE ||--o{ ANTI_PASSBACK_LOG : generates
    ANTI_PASSBACK_RULE ||--o| ACCESS_AREA : applies_to
    
    ANTI_PASSBACK_RULE {
        bigint id PK
        bigint area_id FK
        string rule_type
        int timeout_minutes
        int enabled
        datetime create_time
    }
    
    ANTI_PASSBACK_LOG {
        bigint id PK
        bigint rule_id FK
        bigint user_id
        string violation_type
        datetime violation_time
        bigint device_id
    }
    
    AREA_CAPACITY {
        bigint id PK
        bigint area_id FK
        int max_capacity
        int current_count
        datetime update_time
    }
    
    LINKAGE_CONFIG {
        bigint id PK
        string trigger_event
        string target_system
        string target_action
        json parameters
        int enabled
    }
```

---

## ğŸ“‹ è¡¨ç»“æ„è®¾è®¡

### t_anti_passback_rule (åæ½œå›è§„åˆ™è¡¨)

| å­—æ®µ | ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|------|------|------|------|
| id | BIGINT | PK | ä¸»é”® |
| area_id | BIGINT | FK, NOT NULL | åŒºåŸŸID |
| rule_type | VARCHAR(30) | NOT NULL | è§„åˆ™ç±»å‹ |
| timeout_minutes | INT | DEFAULT 0 | è¶…æ—¶æ—¶é—´(åˆ†é’Ÿ) |
| enabled | TINYINT | DEFAULT 1 | æ˜¯å¦å¯ç”¨ |
| create_time | DATETIME | NOT NULL | åˆ›å»ºæ—¶é—´ |

### t_area_capacity (åŒºåŸŸå®¹é‡è¡¨)

| å­—æ®µ | ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|------|------|------|------|
| id | BIGINT | PK | ä¸»é”® |
| area_id | BIGINT | FK, UNIQUE | åŒºåŸŸID |
| max_capacity | INT | NOT NULL | æœ€å¤§å®¹é‡ |
| current_count | INT | DEFAULT 0 | å½“å‰äººæ•° |
| update_time | DATETIME | NOT NULL | æ›´æ–°æ—¶é—´ |

---

**ğŸ“ æ–‡æ¡£ç»´æŠ¤**: IOE-DREAMæ¶æ„å›¢é˜Ÿ | 2025-12-17
