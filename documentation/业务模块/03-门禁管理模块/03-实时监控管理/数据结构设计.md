# å®æ—¶ç›‘æ§ç®¡ç† - æ•°æ®ç»“æ„è®¾è®¡

> **ç‰ˆæœ¬**: v1.0.0  
> **åˆ›å»ºæ—¥æœŸ**: 2025-12-17

---

## ğŸ“Š ERå›¾

```mermaid
erDiagram
    ACCESS_DEVICE ||--o{ MONITOR_ALERT : triggers
    MONITOR_ALERT ||--o{ ALERT_HANDLER : handled_by
    ACCESS_DEVICE ||--o{ DEVICE_STATUS_LOG : logs
    
    MONITOR_ALERT {
        bigint id PK
        bigint device_id FK
        string alert_type
        string severity
        string message
        datetime trigger_time
        int status
        bigint handler_id FK
        datetime handle_time
    }
    
    ALERT_HANDLER {
        bigint id PK
        bigint alert_id FK
        bigint user_id
        string action
        string comment
        datetime action_time
    }
    
    DEVICE_STATUS_LOG {
        bigint id PK
        bigint device_id FK
        string status
        datetime change_time
        string reason
    }
```

---

## ğŸ“‹ è¡¨ç»“æ„è®¾è®¡

### t_monitor_alert (å‘Šè­¦è®°å½•è¡¨)

| å­—æ®µ | ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|------|------|------|------|
| id | BIGINT | PK | ä¸»é”® |
| device_id | BIGINT | FK, NOT NULL | è®¾å¤‡ID |
| alert_type | VARCHAR(50) | NOT NULL | å‘Šè­¦ç±»å‹ |
| severity | VARCHAR(20) | NOT NULL | ä¸¥é‡çº§åˆ« |
| message | VARCHAR(500) | - | å‘Šè­¦æ¶ˆæ¯ |
| trigger_time | DATETIME | NOT NULL | è§¦å‘æ—¶é—´ |
| status | TINYINT | DEFAULT 0 | 0å¾…å¤„ç†/1å·²å¤„ç†/2å·²å…³é—­ |
| handler_id | BIGINT | FK | å¤„ç†äººID |
| handle_time | DATETIME | - | å¤„ç†æ—¶é—´ |
| resolution | VARCHAR(500) | - | å¤„ç†è¯´æ˜ |

### t_device_status_log (çŠ¶æ€æ—¥å¿—è¡¨)

| å­—æ®µ | ç±»å‹ | çº¦æŸ | è¯´æ˜ |
|------|------|------|------|
| id | BIGINT | PK | ä¸»é”® |
| device_id | BIGINT | FK, NOT NULL | è®¾å¤‡ID |
| status | VARCHAR(20) | NOT NULL | çŠ¶æ€ |
| change_time | DATETIME | NOT NULL | å˜æ›´æ—¶é—´ |
| reason | VARCHAR(200) | - | å˜æ›´åŸå›  |

---

## ğŸ”‘ ç´¢å¼•è®¾è®¡

```sql
-- å‘Šè­¦è¡¨ç´¢å¼•
CREATE INDEX idx_alert_device ON t_monitor_alert(device_id);
CREATE INDEX idx_alert_time ON t_monitor_alert(trigger_time);
CREATE INDEX idx_alert_status ON t_monitor_alert(status);

-- çŠ¶æ€æ—¥å¿—ç´¢å¼•
CREATE INDEX idx_status_device ON t_device_status_log(device_id);
CREATE INDEX idx_status_time ON t_device_status_log(change_time);
```

---

**ğŸ“ æ–‡æ¡£ç»´æŠ¤**: IOE-DREAMæ¶æ„å›¢é˜Ÿ | 2025-12-17
