# 01-é—¨ç¦è®¾å¤‡ç®¡ç† - æ•°æ®ç»“æ„è®¾è®¡

> **æ¨¡å—ç¼–å·**: 01
> **æ¨¡å—åç§°**: é—¨ç¦è®¾å¤‡ç®¡ç†
> **æ–‡æ¡£ç±»å‹**: æ•°æ®ç»“æ„è®¾è®¡ER
> **åˆ›å»ºæ—¥æœŸ**: 2025-12-17
> **æŠ€æœ¯è§„èŒƒ**: IOE-DREAMå…¨å±€æ¶æ„è§„èŒƒ

---

## ğŸ“‹ æ•°æ®åº“è®¾è®¡æ¦‚è¿°

æœ¬æ–‡æ¡£åŸºäºIOE-DREAMå…¨å±€æ•°æ®åº“æ¶æ„è§„èŒƒï¼Œè®¾è®¡é—¨ç¦è®¾å¤‡ç®¡ç†æ¨¡å—çš„æ•°æ®ç»“æ„ã€‚éµå¾ªä»¥ä¸‹è®¾è®¡åŸåˆ™ï¼š

### è®¾è®¡åŸåˆ™

1. **ç»Ÿä¸€è§„èŒƒ**: éµå¾ªIOE-DREAMç»Ÿä¸€æ•°æ®åº“å‘½åè§„èŒƒ
2. **å››å±‚æ¶æ„**: æ”¯æŒController â†’ Service â†’ Manager â†’ DAOåˆ†å±‚
3. **æ€§èƒ½ä¼˜åŒ–**: åˆç†è®¾è®¡ç´¢å¼•ï¼Œæ”¯æŒé«˜å¹¶å‘è®¿é—®
4. **æ‰©å±•æ€§**: æ”¯æŒæ°´å¹³æ‰©å±•å’Œæ•°æ®åˆ†åŒº
5. **æ•°æ®å®‰å…¨**: æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨ï¼Œå®¡è®¡æ—¥å¿—å®Œæ•´

### æŠ€æœ¯æ ˆ

- **æ•°æ®åº“**: MySQL 8.0
- **ORMæ¡†æ¶**: MyBatis-Plus 3.5.15
- **è¿æ¥æ± **: Druid
- **ç¼“å­˜**: Rediså¤šçº§ç¼“å­˜
- **æ•°æ®è¿ç§»**: Flyway

---

## ğŸ—„ï¸ æ•°æ®åº“è¡¨ç»“æ„è®¾è®¡

### 1. è®¾å¤‡åŸºç¡€ä¿¡æ¯è¡¨ (t_access_device)

é—¨ç¦è®¾å¤‡çš„åŸºç¡€ä¿¡æ¯è¡¨ï¼Œå­˜å‚¨è®¾å¤‡çš„æ ¸å¿ƒå±æ€§ã€‚

```sql
CREATE TABLE t_access_device (
    -- ä¸»é”®å­—æ®µ
    device_id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'è®¾å¤‡ID',

    -- è®¾å¤‡åŸºæœ¬ä¿¡æ¯
    device_code VARCHAR(64) NOT NULL UNIQUE COMMENT 'è®¾å¤‡ç¼–ç ',
    device_name VARCHAR(100) NOT NULL COMMENT 'è®¾å¤‡åç§°',
    device_type TINYINT NOT NULL COMMENT 'è®¾å¤‡ç±»å‹: 1-é—¨ç¦æ§åˆ¶å™¨ 2-è¯»å¡å™¨ 3-ç”Ÿç‰©è¯†åˆ«è®¾å¤‡ 4-é—¨é” 5-æ‘„åƒå¤´',
    device_subtype TINYINT DEFAULT NULL COMMENT 'è®¾å¤‡å­ç±»å‹',
    manufacturer VARCHAR(50) DEFAULT NULL COMMENT 'ç”Ÿäº§å‚å•†',
    model VARCHAR(50) DEFAULT NULL COMMENT 'è®¾å¤‡å‹å·',
    serial_number VARCHAR(100) DEFAULT NULL COMMENT 'åºåˆ—å·',

    -- ä½ç½®ä¿¡æ¯
    area_id BIGINT NOT NULL COMMENT 'æ‰€å±åŒºåŸŸID',
    location_detail VARCHAR(200) DEFAULT NULL COMMENT 'è¯¦ç»†ä½ç½®',
    install_position VARCHAR(100) DEFAULT NULL COMMENT 'å®‰è£…ä½ç½®',
    floor_number INT DEFAULT NULL COMMENT 'æ¥¼å±‚å·',
    room_number VARCHAR(50) DEFAULT NULL COMMENT 'æˆ¿é—´å·',

    -- ç½‘ç»œé…ç½®
    ip_address VARCHAR(45) DEFAULT NULL COMMENT 'IPåœ°å€',
    port INT DEFAULT 8080 COMMENT 'ç«¯å£å·',
    protocol_type TINYINT DEFAULT 1 COMMENT 'åè®®ç±»å‹: 1-TCP 2-HTTP 3-WebSocket 4-MQTT',
    network_status TINYINT DEFAULT 0 COMMENT 'ç½‘ç»œçŠ¶æ€: 0-æœªçŸ¥ 1-æ­£å¸¸ 2-å¼‚å¸¸',

    -- çŠ¶æ€ä¿¡æ¯
    device_status TINYINT DEFAULT 1 COMMENT 'è®¾å¤‡çŠ¶æ€: 0-åœç”¨ 1-æ­£å¸¸ 2-æ•…éšœ 3-ç»´æŠ¤ 4-ç¦»çº¿',
    online_status TINYINT DEFAULT 0 COMMENT 'åœ¨çº¿çŠ¶æ€: 0-ç¦»çº¿ 1-åœ¨çº¿',
    last_online_time DATETIME DEFAULT NULL COMMENT 'æœ€ååœ¨çº¿æ—¶é—´',

    -- ç®¡ç†ä¿¡æ¯
    responsible_user_id BIGINT DEFAULT NULL COMMENT 'è´Ÿè´£äººID',
    responsible_dept_id BIGINT DEFAULT NULL COMMENT 'è´Ÿè´£éƒ¨é—¨ID',
    install_date DATE DEFAULT NULL COMMENT 'å®‰è£…æ—¥æœŸ',
    warranty_expire_date DATE DEFAULT NULL COMMENT 'ä¿ä¿®åˆ°æœŸæ—¥',

    -- æŠ€æœ¯å‚æ•°
    max_users INT DEFAULT 0 COMMENT 'æœ€å¤§ç”¨æˆ·æ•°',
    max_records INT DEFAULT 0 COMMENT 'æœ€å¤§è®°å½•æ•°',
    power_supply TINYINT DEFAULT 1 COMMENT 'ä¾›ç”µæ–¹å¼: 1-å¸‚ç”µ 2-ç”µæ±  3-åŒä¾›ç”µ',
    working_temperature_min INT DEFAULT NULL COMMENT 'æœ€ä½å·¥ä½œæ¸©åº¦',
    working_temperature_max INT DEFAULT NULL COMMENT 'æœ€é«˜å·¥ä½œæ¸©åº¦',
    working_humidity_min INT DEFAULT NULL COMMENT 'æœ€ä½å·¥ä½œæ¹¿åº¦',
    working_humidity_max INT DEFAULT NULL COMMENT 'æœ€é«˜å·¥ä½œæ¹¿åº¦',

    -- åŠŸèƒ½ç‰¹æ€§
    support_card TINYINT DEFAULT 1 COMMENT 'æ”¯æŒå¡ç‰‡: 0-å¦ 1-æ˜¯',
    support_password TINYINT DEFAULT 0 COMMENT 'æ”¯æŒå¯†ç : 0-å¦ 1-æ˜¯',
    support_face TINYINT DEFAULT 0 COMMENT 'æ”¯æŒäººè„¸: 0-å¦ 1-æ˜¯',
    support_fingerprint TINYINT DEFAULT 0 COMMENT 'æ”¯æŒæŒ‡çº¹: 0-å¦ 1-æ˜¯',
    support_palm TINYINT DEFAULT 0 COMMENT 'æ”¯æŒæŒçº¹: 0-å¦ 1-æ˜¯',
    support_iris TINYINT DEFAULT 0 COMMENT 'æ”¯æŒè™¹è†œ: 0-å¦ 1-æ˜¯',
    support_voice TINYINT DEFAULT 0 COMMENT 'æ”¯æŒå£°çº¹: 0-å¦ 1-æ˜¯',

    -- å®‰å…¨é…ç½®
    encryption_enabled TINYINT DEFAULT 1 COMMENT 'å¯ç”¨åŠ å¯†: 0-å¦ 1-æ˜¯',
    anti_passback_enabled TINYINT DEFAULT 0 COMMENT 'å¯ç”¨åæ½œå›: 0-å¦ 1-æ˜¯',
    duress_alarm_enabled TINYINT DEFAULT 0 COMMENT 'å¯ç”¨èƒè¿«æŠ¥è­¦: 0-å¦ 1-æ˜¯',
    tamper_alarm_enabled TINYINT DEFAULT 1 COMMENT 'å¯ç”¨é˜²æ‹†æŠ¥è­¦: 0-å¦ 1-æ˜¯',

    -- å®¡è®¡å­—æ®µ
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    create_user_id BIGINT DEFAULT NULL COMMENT 'åˆ›å»ºäººID',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    update_user_id BIGINT DEFAULT NULL COMMENT 'æ›´æ–°äººID',
    deleted_flag TINYINT DEFAULT 0 COMMENT 'åˆ é™¤æ ‡å¿—: 0-æ­£å¸¸ 1-åˆ é™¤',
    version INT DEFAULT 0 COMMENT 'ä¹è§‚é”ç‰ˆæœ¬å·',

    -- ç´¢å¼•
    INDEX idx_device_code (device_code),
    INDEX idx_device_type (device_type),
    INDEX idx_area_id (area_id),
    INDEX idx_device_status (device_status),
    INDEX idx_online_status (online_status),
    INDEX idx_responsible_user (responsible_user_id),
    INDEX idx_last_online_time (last_online_time),
    INDEX idx_create_time (create_time),

    -- å¤–é”®çº¦æŸ
    FOREIGN KEY (area_id) REFERENCES t_area(area_id),
    FOREIGN KEY (responsible_user_id) REFERENCES t_user(user_id),
    FOREIGN KEY (responsible_dept_id) REFERENCES t_department(department_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='é—¨ç¦è®¾å¤‡åŸºç¡€ä¿¡æ¯è¡¨';
```

### 2. è®¾å¤‡ç½‘ç»œé…ç½®è¡¨ (t_access_device_network)

å­˜å‚¨è®¾å¤‡çš„ç½‘ç»œé…ç½®å’Œè¿æ¥å‚æ•°ã€‚

```sql
CREATE TABLE t_access_device_network (
    -- ä¸»é”®å­—æ®µ
    config_id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'é…ç½®ID',
    device_id BIGINT NOT NULL COMMENT 'è®¾å¤‡ID',

    -- ç½‘ç»œåŸºç¡€é…ç½®
    ip_address VARCHAR(45) NOT NULL COMMENT 'IPåœ°å€',
    subnet_mask VARCHAR(45) DEFAULT NULL COMMENT 'å­ç½‘æ©ç ',
    gateway VARCHAR(45) DEFAULT NULL COMMENT 'ç½‘å…³',
    dns_server VARCHAR(45) DEFAULT NULL COMMENT 'DNSæœåŠ¡å™¨',
    port INT DEFAULT 8080 COMMENT 'ç«¯å£å·',

    -- åè®®é…ç½®
    protocol_type TINYINT DEFAULT 1 COMMENT 'åè®®ç±»å‹: 1-TCP 2-HTTP 3-WebSocket 4-MQTT',
    connection_timeout INT DEFAULT 30 COMMENT 'è¿æ¥è¶…æ—¶(ç§’)',
    read_timeout INT DEFAULT 60 COMMENT 'è¯»å–è¶…æ—¶(ç§’)',
    heartbeat_interval INT DEFAULT 60 COMMENT 'å¿ƒè·³é—´éš”(ç§’)',
    retry_count INT DEFAULT 3 COMMENT 'é‡è¯•æ¬¡æ•°',

    -- è®¤è¯é…ç½®
    auth_type TINYINT DEFAULT 0 COMMENT 'è®¤è¯ç±»å‹: 0-æ— è®¤è¯ 1-ç”¨æˆ·åå¯†ç  2-è¯ä¹¦',
    auth_username VARCHAR(100) DEFAULT NULL COMMENT 'è®¤è¯ç”¨æˆ·å',
    auth_password_encrypted VARCHAR(500) DEFAULT NULL COMMENT 'åŠ å¯†çš„è®¤è¯å¯†ç ',
    certificate_path VARCHAR(500) DEFAULT NULL COMMENT 'è¯ä¹¦è·¯å¾„',
    private_key_path VARCHAR(500) DEFAULT NULL COMMENT 'ç§é’¥è·¯å¾„',

    -- SSL/TLSé…ç½®
    ssl_enabled TINYINT DEFAULT 0 COMMENT 'å¯ç”¨SSL: 0-å¦ 1-æ˜¯',
    ssl_version VARCHAR(20) DEFAULT NULL COMMENT 'SSLç‰ˆæœ¬',
    trust_store_path VARCHAR(500) DEFAULT NULL COMMENT 'ä¿¡ä»»åº“è·¯å¾„',
    verify_hostname TINYINT DEFAULT 1 COMMENT 'éªŒè¯ä¸»æœºå: 0-å¦ 1-æ˜¯',

    -- é«˜çº§é…ç½®
    connection_pool_size INT DEFAULT 5 COMMENT 'è¿æ¥æ± å¤§å°',
    max_message_size INT DEFAULT 10240 COMMENT 'æœ€å¤§æ¶ˆæ¯å¤§å°(KB)',
    compression_enabled TINYINT DEFAULT 0 COMMENT 'å¯ç”¨å‹ç¼©: 0-å¦ 1-æ˜¯',

    -- å®¡è®¡å­—æ®µ
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    create_user_id BIGINT DEFAULT NULL COMMENT 'åˆ›å»ºäººID',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    update_user_id BIGINT DEFAULT NULL COMMENT 'æ›´æ–°äººID',
    deleted_flag TINYINT DEFAULT 0 COMMENT 'åˆ é™¤æ ‡å¿—: 0-æ­£å¸¸ 1-åˆ é™¤',
    version INT DEFAULT 0 COMMENT 'ä¹è§‚é”ç‰ˆæœ¬å·',

    -- ç´¢å¼•
    UNIQUE INDEX uk_device_network (device_id, deleted_flag),
    INDEX idx_ip_address (ip_address),
    INDEX idx_protocol_type (protocol_type),

    -- å¤–é”®çº¦æŸ
    FOREIGN KEY (device_id) REFERENCES t_access_device(device_id),
    FOREIGN KEY (create_user_id) REFERENCES t_user(user_id),
    FOREIGN KEY (update_user_id) REFERENCES t_user(user_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='é—¨ç¦è®¾å¤‡ç½‘ç»œé…ç½®è¡¨';
```

### 3. è®¾å¤‡åŠŸèƒ½é…ç½®è¡¨ (t_access_device_function)

å­˜å‚¨è®¾å¤‡çš„åŠŸèƒ½å‚æ•°é…ç½®ã€‚

```sql
CREATE TABLE t_access_device_function (
    -- ä¸»é”®å­—æ®µ
    config_id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'é…ç½®ID',
    device_id BIGINT NOT NULL COMMENT 'è®¾å¤‡ID',

    -- é—¨æ§é…ç½®
    door_open_time INT DEFAULT 3 COMMENT 'å¼€é—¨æ—¶é—´(ç§’)',
    door_close_time INT DEFAULT 2 COMMENT 'å…³é—¨æ—¶é—´(ç§’)',
    auto_lock_enabled TINYINT DEFAULT 1 COMMENT 'è‡ªåŠ¨ä¸Šé”: 0-å¦ 1-æ˜¯',
    force_open_enabled TINYINT DEFAULT 0 COMMENT 'å¼ºåˆ¶å¼€é—¨: 0-å¦ 1-æ˜¯',

    -- è®¤è¯é…ç½®
    card_enabled TINYINT DEFAULT 1 COMMENT 'å¡ç‰‡è®¤è¯: 0-å¦ 1-æ˜¯',
    password_enabled TINYINT DEFAULT 0 COMMENT 'å¯†ç è®¤è¯: 0-å¦ 1-æ˜¯',
    face_enabled TINYINT DEFAULT 0 COMMENT 'äººè„¸è®¤è¯: 0-å¦ 1-æ˜¯',
    fingerprint_enabled TINYINT DEFAULT 0 COMMENT 'æŒ‡çº¹è®¤è¯: 0-å¦ 1æ˜¯',
    multi_factor_required TINYINT DEFAULT 0 COMMENT 'å¤šå› å­è®¤è¯: 0-å¦ 1-æ˜¯',
    min_auth_factors INT DEFAULT 1 COMMENT 'æœ€å°‘è®¤è¯å› å­æ•°',

    -- æ–¹å‘é…ç½®
    entry_allowed TINYINT DEFAULT 1 COMMENT 'å…è®¸è¿›å…¥: 0-å¦ 1-æ˜¯',
    exit_allowed TINYINT DEFAULT 1 COMMENT 'å…è®¸é€€å‡º: 0-å¦ 1-æ˜¯',
    dual_direction_enabled TINYINT DEFAULT 0 COMMENT 'åŒå‘é€šè¡Œ: 0-å¦ 1-æ˜¯',

    -- å®‰å…¨é…ç½®
    password_retry_limit INT DEFAULT 3 COMMENT 'å¯†ç é‡è¯•é™åˆ¶',
    lock_time INT DEFAULT 300 COMMENT 'é”å®šæ—¶é—´(ç§’)',
    anti_passback_enabled TINYINT DEFAULT 0 COMMENT 'åæ½œå›: 0-å¦ 1-æ˜¯',
    duress_code VARCHAR(20) DEFAULT NULL COMMENT 'èƒè¿«ç ',
    tamper_alarm_enabled TINYINT DEFAULT 1 COMMENT 'é˜²æ‹†æŠ¥è­¦: 0-å¦ 1-æ˜¯',

    -- æ—¶é—´é…ç½®
    work_start_time TIME DEFAULT '08:00:00' COMMENT 'å·¥ä½œå¼€å§‹æ—¶é—´',
    work_end_time TIME DEFAULT '18:00:00' COMMENT 'å·¥ä½œç»“æŸæ—¶é—´',
    holiday_enabled TINYINT DEFAULT 1 COMMENT 'èŠ‚å‡æ—¥æ§åˆ¶: 0-å¦ 1-æ˜¯',
    weekend_enabled TINYINT DEFAULT 1 COMMENT 'å‘¨æœ«æ§åˆ¶: 0-å¦ 1-æ˜¯',

    -- æŠ¥è­¦é…ç½®
    alarm_enabled TINYINT DEFAULT 1 COMMENT 'å¯ç”¨æŠ¥è­¦: 0-å¦ 1-æ˜¯',
    alarm_types VARCHAR(100) DEFAULT NULL COMMENT 'æŠ¥è­¦ç±»å‹(é€—å·åˆ†éš”)',
    alarm_notification_enabled TINYINT DEFAULT 1 COMMENT 'æŠ¥è­¦é€šçŸ¥: 0-å¦ 1-æ˜¯',

    -- æ‰©å±•é…ç½®(JSONæ ¼å¼)
    extended_config JSON DEFAULT NULL COMMENT 'æ‰©å±•é…ç½®',

    -- å®¡è®¡å­—æ®µ
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    create_user_id BIGINT DEFAULT NULL COMMENT 'åˆ›å»ºäººID',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    update_user_id BIGINT DEFAULT NULL COMMENT 'æ›´æ–°äººID',
    deleted_flag TINYINT DEFAULT 0 COMMENT 'åˆ é™¤æ ‡å¿—: 0-æ­£å¸¸ 1-åˆ é™¤',
    version INT DEFAULT 0 COMMENT 'ä¹è§‚é”ç‰ˆæœ¬å·',

    -- ç´¢å¼•
    UNIQUE INDEX uk_device_function (device_id, deleted_flag),
    INDEX idx_card_enabled (card_enabled),
    INDEX idx_anti_passback (anti_passback_enabled),
    INDEX idx_alarm_enabled (alarm_enabled),

    -- å¤–é”®çº¦æŸ
    FOREIGN KEY (device_id) REFERENCES t_access_device(device_id),
    FOREIGN KEY (create_user_id) REFERENCES t_user(user_id),
    FOREIGN KEY (update_user_id) REFERENCES t_user(user_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='é—¨ç¦è®¾å¤‡åŠŸèƒ½é…ç½®è¡¨';
```

### 4. è®¾å¤‡çŠ¶æ€ç›‘æ§è¡¨ (t_access_device_monitor)

å­˜å‚¨è®¾å¤‡çš„å®æ—¶ç›‘æ§æ•°æ®ã€‚

```sql
CREATE TABLE t_access_device_monitor (
    -- ä¸»é”®å­—æ®µ
    monitor_id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'ç›‘æ§è®°å½•ID',
    device_id BIGINT NOT NULL COMMENT 'è®¾å¤‡ID',

    -- çŠ¶æ€ä¿¡æ¯
    online_status TINYINT NOT NULL COMMENT 'åœ¨çº¿çŠ¶æ€: 0-ç¦»çº¿ 1-åœ¨çº¿',
    device_status TINYINT NOT NULL COMMENT 'è®¾å¤‡çŠ¶æ€: 0-åœç”¨ 1-æ­£å¸¸ 2-æ•…éšœ 3-ç»´æŠ¤ 4-ç¦»çº¿',
    network_status TINYINT NOT NULL COMMENT 'ç½‘ç»œçŠ¶æ€: 0-æœªçŸ¥ 1-æ­£å¸¸ 2-å¼‚å¸¸',

    -- æ€§èƒ½æŒ‡æ ‡
    cpu_usage DECIMAL(5,2) DEFAULT 0.00 COMMENT 'CPUä½¿ç”¨ç‡(%)',
    memory_usage DECIMAL(5,2) DEFAULT 0.00 COMMENT 'å†…å­˜ä½¿ç”¨ç‡(%)',
    disk_usage DECIMAL(5,2) DEFAULT 0.00 COMMENT 'ç£ç›˜ä½¿ç”¨ç‡(%)',
    temperature DECIMAL(5,2) DEFAULT 0.00 COMMENT 'è®¾å¤‡æ¸©åº¦(Â°C)',
    power_voltage DECIMAL(6,2) DEFAULT 0.00 COMMENT 'ç”µæºç”µå‹(V)',

    -- ç½‘ç»œæŒ‡æ ‡
    response_time INT DEFAULT 0 COMMENT 'å“åº”æ—¶é—´(æ¯«ç§’)',
    network_quality TINYINT DEFAULT 0 COMMENT 'ç½‘ç»œè´¨é‡: 0-å·® 1-ä¸€èˆ¬ 2-è‰¯å¥½ 3-ä¼˜ç§€',
    packet_loss_rate DECIMAL(5,2) DEFAULT 0.00 COMMENT 'ä¸¢åŒ…ç‡(%)',
    bandwidth_usage DECIMAL(8,2) DEFAULT 0.00 COMMENT 'å¸¦å®½ä½¿ç”¨(KB/s)',

    -- ä¸šåŠ¡æŒ‡æ ‡
    today_access_count INT DEFAULT 0 COMMENT 'ä»Šæ—¥é€šè¡Œæ¬¡æ•°',
    today_error_count INT DEFAULT 0 COMMENT 'ä»Šæ—¥é”™è¯¯æ¬¡æ•°',
    total_access_count BIGINT DEFAULT 0 COMMENT 'æ€»é€šè¡Œæ¬¡æ•°',
    total_error_count BIGINT DEFAULT 0 COMMENT 'æ€»é”™è¯¯æ¬¡æ•°',
    last_access_time DATETIME DEFAULT NULL COMMENT 'æœ€åé€šè¡Œæ—¶é—´',
    last_error_time DATETIME DEFAULT NULL COMMENT 'æœ€åé”™è¯¯æ—¶é—´',

    -- å¥åº·è¯„åˆ†
    health_score TINYINT DEFAULT 100 COMMENT 'å¥åº·è¯„åˆ†(0-100)',
    health_level TINYINT DEFAULT 1 COMMENT 'å¥åº·ç­‰çº§: 1-ä¼˜ç§€ 2-è‰¯å¥½ 3-ä¸€èˆ¬ 4-è­¦å‘Š 5-æ•…éšœ',

    -- æ—¶é—´æˆ³
    monitor_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'ç›‘æ§æ—¶é—´',
    heartbeat_time DATETIME DEFAULT NULL COMMENT 'å¿ƒè·³æ—¶é—´',

    -- ç´¢å¼•
    INDEX idx_device_id (device_id),
    INDEX idx_monitor_time (monitor_time),
    INDEX idx_online_status (online_status),
    INDEX idx_device_status (device_status),
    INDEX idx_health_level (health_level),
    INDEX idx_heartbeat_time (heartbeat_time),

    -- å¤–é”®çº¦æŸ
    FOREIGN KEY (device_id) REFERENCES t_access_device(device_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='é—¨ç¦è®¾å¤‡çŠ¶æ€ç›‘æ§è¡¨';
```

### 5. è®¾å¤‡äº‹ä»¶è®°å½•è¡¨ (t_access_device_event)

å­˜å‚¨è®¾å¤‡çš„äº‹ä»¶æ—¥å¿—å’ŒæŠ¥è­¦ä¿¡æ¯ã€‚

```sql
CREATE TABLE t_access_device_event (
    -- ä¸»é”®å­—æ®µ
    event_id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'äº‹ä»¶ID',
    device_id BIGINT NOT NULL COMMENT 'è®¾å¤‡ID',

    -- äº‹ä»¶åŸºæœ¬ä¿¡æ¯
    event_type TINYINT NOT NULL COMMENT 'äº‹ä»¶ç±»å‹: 1-é€šè¡Œäº‹ä»¶ 2-æŠ¥è­¦äº‹ä»¶ 3-æ•…éšœäº‹ä»¶ 4-ç»´æŠ¤äº‹ä»¶ 5-é…ç½®äº‹ä»¶',
    event_category TINYINT NOT NULL COMMENT 'äº‹ä»¶åˆ†ç±»',
    event_level TINYINT DEFAULT 1 COMMENT 'äº‹ä»¶çº§åˆ«: 1-ä¿¡æ¯ 2-è­¦å‘Š 3-é”™è¯¯ 4-ä¸¥é‡',
    event_code VARCHAR(20) DEFAULT NULL COMMENT 'äº‹ä»¶ä»£ç ',
    event_title VARCHAR(200) NOT NULL COMMENT 'äº‹ä»¶æ ‡é¢˜',
    event_description TEXT DEFAULT NULL COMMENT 'äº‹ä»¶æè¿°',

    -- å…³è”ä¿¡æ¯
    user_id BIGINT DEFAULT NULL COMMENT 'å…³è”ç”¨æˆ·ID',
    user_name VARCHAR(100) DEFAULT NULL COMMENT 'ç”¨æˆ·å§“å',
    card_number VARCHAR(50) DEFAULT NULL COMMENT 'å¡å·',
    verify_type TINYINT DEFAULT NULL COMMENT 'éªŒè¯ç±»å‹: 1-å¡ç‰‡ 2-å¯†ç  3-äººè„¸ 4-æŒ‡çº¹ 5-æŒçº¹ 6-è™¹è†œ 7-å£°çº¹',

    -- å¤„ç†ä¿¡æ¯
    process_status TINYINT DEFAULT 0 COMMENT 'å¤„ç†çŠ¶æ€: 0-æœªå¤„ç† 1-å¤„ç†ä¸­ 2-å·²å¤„ç† 3-å·²å¿½ç•¥',
    process_user_id BIGINT DEFAULT NULL COMMENT 'å¤„ç†äººID',
    process_time DATETIME DEFAULT NULL COMMENT 'å¤„ç†æ—¶é—´',
    process_remark TEXT DEFAULT NULL COMMENT 'å¤„ç†å¤‡æ³¨',

    -- æ—¶é—´ä¿¡æ¯
    event_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'äº‹ä»¶æ—¶é—´',
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',

    -- æ‰©å±•å­—æ®µ
    extended_data JSON DEFAULT NULL COMMENT 'æ‰©å±•æ•°æ®',

    -- ç´¢å¼•
    INDEX idx_device_id (device_id),
    INDEX idx_event_type (event_type),
    INDEX idx_event_level (event_level),
    INDEX idx_process_status (process_status),
    INDEX idx_event_time (event_time),
    INDEX idx_user_id (user_id),
    INDEX idx_verify_type (verify_type),

    -- å¤–é”®çº¦æŸ
    FOREIGN KEY (device_id) REFERENCES t_access_device(device_id),
    FOREIGN KEY (user_id) REFERENCES t_user(user_id),
    FOREIGN KEY (process_user_id) REFERENCES t_user(user_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='é—¨ç¦è®¾å¤‡äº‹ä»¶è®°å½•è¡¨';
```

### 6. è®¾å¤‡ç»´æŠ¤è®°å½•è¡¨ (t_access_device_maintenance)

å­˜å‚¨è®¾å¤‡çš„ç»´æŠ¤ä¿å…»è®°å½•ã€‚

```sql
CREATE TABLE t_access_device_maintenance (
    -- ä¸»é”®å­—æ®µ
    maintenance_id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'ç»´æŠ¤è®°å½•ID',
    device_id BIGINT NOT NULL COMMENT 'è®¾å¤‡ID',

    -- ç»´æŠ¤åŸºæœ¬ä¿¡æ¯
    maintenance_type TINYINT NOT NULL COMMENT 'ç»´æŠ¤ç±»å‹: 1-å®šæœŸæ£€æŸ¥ 2-é¢„é˜²æ€§ç»´æŠ¤ 3-æ•…éšœç»´ä¿® 4-æ¸…æ´ä¿å…» 5-éƒ¨ä»¶æ›´æ¢',
    maintenance_reason VARCHAR(500) DEFAULT NULL COMMENT 'ç»´æŠ¤åŸå› ',
    maintenance_description TEXT DEFAULT NULL COMMENT 'ç»´æŠ¤æè¿°',

    -- è®¡åˆ’ä¿¡æ¯
    planned_time DATETIME DEFAULT NULL COMMENT 'è®¡åˆ’æ—¶é—´',
    planned_duration INT DEFAULT NULL COMMENT 'è®¡åˆ’æ—¶é•¿(åˆ†é’Ÿ)',
    maintenance_priority TINYINT DEFAULT 2 COMMENT 'ç»´æŠ¤ä¼˜å…ˆçº§: 1-ç´§æ€¥ 2-ä¸€èˆ¬ 3-ä½',

    -- æ‰§è¡Œä¿¡æ¯
    actual_start_time DATETIME DEFAULT NULL COMMENT 'å®é™…å¼€å§‹æ—¶é—´',
    actual_end_time DATETIME DEFAULT NULL COMMENT 'å®é™…ç»“æŸæ—¶é—´',
    actual_duration INT DEFAULT NULL COMMENT 'å®é™…æ—¶é•¿(åˆ†é’Ÿ)',
    maintenance_user_id BIGINT DEFAULT NULL COMMENT 'ç»´æŠ¤äººå‘˜ID',
    maintenance_user_name VARCHAR(100) DEFAULT NULL COMMENT 'ç»´æŠ¤äººå‘˜å§“å',

    -- ç»“æœä¿¡æ¯
    maintenance_result TINYINT DEFAULT 0 COMMENT 'ç»´æŠ¤ç»“æœ: 0-æœªå®Œæˆ 1-æˆåŠŸ 2-éƒ¨åˆ†æˆåŠŸ 3-å¤±è´¥',
    maintenance_cost DECIMAL(10,2) DEFAULT 0.00 COMMENT 'ç»´æŠ¤è´¹ç”¨',
    replaced_parts TEXT DEFAULT NULL COMMENT 'æ›´æ¢éƒ¨ä»¶',
    next_maintenance_time DATETIME DEFAULT NULL COMMENT 'ä¸‹æ¬¡ç»´æŠ¤æ—¶é—´',

    -- éªŒæ”¶ä¿¡æ¯
    acceptance_user_id BIGINT DEFAULT NULL COMMENT 'éªŒæ”¶äººID',
    acceptance_time DATETIME DEFAULT NULL COMMENT 'éªŒæ”¶æ—¶é—´',
    acceptance_result TINYINT DEFAULT 0 COMMENT 'éªŒæ”¶ç»“æœ: 0-æœªéªŒæ”¶ 1-é€šè¿‡ 2-ä¸é€šè¿‡',
    acceptance_remark TEXT DEFAULT NULL COMMENT 'éªŒæ”¶å¤‡æ³¨',

    -- å®¡è®¡å­—æ®µ
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    create_user_id BIGINT DEFAULT NULL COMMENT 'åˆ›å»ºäººID',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    update_user_id BIGINT DEFAULT NULL COMMENT 'æ›´æ–°äººID',
    deleted_flag TINYINT DEFAULT 0 COMMENT 'åˆ é™¤æ ‡å¿—: 0-æ­£å¸¸ 1-åˆ é™¤',
    version INT DEFAULT 0 COMMENT 'ä¹è§‚é”ç‰ˆæœ¬å·',

    -- ç´¢å¼•
    INDEX idx_device_id (device_id),
    INDEX idx_maintenance_type (maintenance_type),
    INDEX idx_planned_time (planned_time),
    INDEX idx_maintenance_result (maintenance_result),
    INDEX idx_maintenance_user (maintenance_user_id),
    INDEX idx_acceptance_result (acceptance_result),

    -- å¤–é”®çº¦æŸ
    FOREIGN KEY (device_id) REFERENCES t_access_device(device_id),
    FOREIGN KEY (maintenance_user_id) REFERENCES t_user(user_id),
    FOREIGN KEY (acceptance_user_id) REFERENCES t_user(user_id),
    FOREIGN KEY (create_user_id) REFERENCES t_user(user_id),
    FOREIGN KEY (update_user_id) REFERENCES t_user(user_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='é—¨ç¦è®¾å¤‡ç»´æŠ¤è®°å½•è¡¨';
```

### 7. è®¾å¤‡å›ºä»¶ç®¡ç†è¡¨ (t_access_device_firmware)

å­˜å‚¨è®¾å¤‡å›ºä»¶ç‰ˆæœ¬å’Œå‡çº§è®°å½•ã€‚

```sql
CREATE TABLE t_access_device_firmware (
    -- ä¸»é”®å­—æ®µ
    firmware_id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'å›ºä»¶ID',
    device_id BIGINT NOT NULL COMMENT 'è®¾å¤‡ID',

    -- å›ºä»¶ä¿¡æ¯
    firmware_version VARCHAR(50) NOT NULL COMMENT 'å›ºä»¶ç‰ˆæœ¬',
    firmware_type TINYINT DEFAULT 1 COMMENT 'å›ºä»¶ç±»å‹: 1-ä¸»å›ºä»¶ 2-è¾…åŠ©å›ºä»¶ 3-é…ç½®å›ºä»¶',
    firmware_size BIGINT DEFAULT 0 COMMENT 'å›ºä»¶å¤§å°(å­—èŠ‚)',
    firmware_checksum VARCHAR(64) DEFAULT NULL COMMENT 'å›ºä»¶æ ¡éªŒå’Œ',
    firmware_path VARCHAR(500) DEFAULT NULL COMMENT 'å›ºä»¶æ–‡ä»¶è·¯å¾„',

    -- ç‰ˆæœ¬ä¿¡æ¯
    release_version VARCHAR(50) DEFAULT NULL COMMENT 'å‘å¸ƒç‰ˆæœ¬',
    release_date DATE DEFAULT NULL COMMENT 'å‘å¸ƒæ—¥æœŸ',
    release_notes TEXT DEFAULT NULL COMMENT 'å‘å¸ƒè¯´æ˜',

    -- å‡çº§ä¿¡æ¯
    upgrade_type TINYINT DEFAULT 1 COMMENT 'å‡çº§ç±»å‹: 1-æ‰‹åŠ¨å‡çº§ 2-è‡ªåŠ¨å‡çº§ 3-å¼ºåˆ¶å‡çº§',
    upgrade_status TINYINT DEFAULT 0 COMMENT 'å‡çº§çŠ¶æ€: 0-æœªå‡çº§ 1-å‡çº§ä¸­ 2-å‡çº§æˆåŠŸ 3-å‡çº§å¤±è´¥',
    upgrade_progress INT DEFAULT 0 COMMENT 'å‡çº§è¿›åº¦(0-100)',
    upgrade_start_time DATETIME DEFAULT NULL COMMENT 'å‡çº§å¼€å§‹æ—¶é—´',
    upgrade_end_time DATETIME DEFAULT NULL COMMENT 'å‡çº§ç»“æŸæ—¶é—´',

    -- æ“ä½œä¿¡æ¯
    operator_id BIGINT DEFAULT NULL COMMENT 'æ“ä½œäººID',
    operator_name VARCHAR(100) DEFAULT NULL COMMENT 'æ“ä½œäººå§“å',
    backup_before_upgrade TINYINT DEFAULT 1 COMMENT 'å‡çº§å‰å¤‡ä»½: 0-å¦ 1-æ˜¯',
    backup_path VARCHAR(500) DEFAULT NULL COMMENT 'å¤‡ä»½æ–‡ä»¶è·¯å¾„',

    -- ç»“æœä¿¡æ¯
    upgrade_result TINYINT DEFAULT 0 COMMENT 'å‡çº§ç»“æœ: 0-æœªçŸ¥ 1-æˆåŠŸ 2-å¤±è´¥ 3-éƒ¨åˆ†æˆåŠŸ',
    error_code VARCHAR(50) DEFAULT NULL COMMENT 'é”™è¯¯ä»£ç ',
    error_message TEXT DEFAULT NULL COMMENT 'é”™è¯¯ä¿¡æ¯',
    rollback_version VARCHAR(50) DEFAULT NULL COMMENT 'å›æ»šç‰ˆæœ¬',

    -- å®¡è®¡å­—æ®µ
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    deleted_flag TINYINT DEFAULT 0 COMMENT 'åˆ é™¤æ ‡å¿—: 0-æ­£å¸¸ 1-åˆ é™¤',
    version INT DEFAULT 0 COMMENT 'ä¹è§‚é”ç‰ˆæœ¬å·',

    -- ç´¢å¼•
    INDEX idx_device_id (device_id),
    INDEX idx_firmware_version (firmware_version),
    INDEX idx_upgrade_status (upgrade_status),
    INDEX idx_operator_id (operator_id),
    INDEX idx_create_time (create_time),

    -- å¤–é”®çº¦æŸ
    FOREIGN KEY (device_id) REFERENCES t_access_device(device_id),
    FOREIGN KEY (operator_id) REFERENCES t_user(user_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='é—¨ç¦è®¾å¤‡å›ºä»¶ç®¡ç†è¡¨';
```

### 8. è®¾å¤‡é…ç½®æ¨¡æ¿è¡¨ (t_access_device_template)

å­˜å‚¨è®¾å¤‡é…ç½®æ¨¡æ¿ï¼Œæ”¯æŒæ‰¹é‡é…ç½®ã€‚

```sql
CREATE TABLE t_access_device_template (
    -- ä¸»é”®å­—æ®µ
    template_id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'æ¨¡æ¿ID',

    -- æ¨¡æ¿åŸºæœ¬ä¿¡æ¯
    template_name VARCHAR(100) NOT NULL COMMENT 'æ¨¡æ¿åç§°',
    template_code VARCHAR(64) NOT NULL UNIQUE COMMENT 'æ¨¡æ¿ç¼–ç ',
    template_type TINYINT NOT NULL COMMENT 'æ¨¡æ¿ç±»å‹: 1-è®¾å¤‡æ¨¡æ¿ 2-ç½‘ç»œæ¨¡æ¿ 3-åŠŸèƒ½æ¨¡æ¿',
    device_type TINYINT DEFAULT NULL COMMENT 'é€‚ç”¨è®¾å¤‡ç±»å‹',
    template_description TEXT DEFAULT NULL COMMENT 'æ¨¡æ¿æè¿°',

    -- æ¨¡æ¿é…ç½®(JSONæ ¼å¼)
    network_config JSON DEFAULT NULL COMMENT 'ç½‘ç»œé…ç½®',
    function_config JSON DEFAULT NULL COMMENT 'åŠŸèƒ½é…ç½®',
    security_config JSON DEFAULT NULL COMMENT 'å®‰å…¨é…ç½®',
    extended_config JSON DEFAULT NULL COMMENT 'æ‰©å±•é…ç½®',

    -- ä½¿ç”¨ç»Ÿè®¡
    usage_count INT DEFAULT 0 COMMENT 'ä½¿ç”¨æ¬¡æ•°',
    last_used_time DATETIME DEFAULT NULL COMMENT 'æœ€åä½¿ç”¨æ—¶é—´',

    -- çŠ¶æ€ä¿¡æ¯
    template_status TINYINT DEFAULT 1 COMMENT 'æ¨¡æ¿çŠ¶æ€: 0-åœç”¨ 1-å¯ç”¨',
    is_default TINYINT DEFAULT 0 COMMENT 'æ˜¯å¦é»˜è®¤æ¨¡æ¿: 0-å¦ 1-æ˜¯',

    -- å®¡è®¡å­—æ®µ
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    create_user_id BIGINT DEFAULT NULL COMMENT 'åˆ›å»ºäººID',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
    update_user_id BIGINT DEFAULT NULL COMMENT 'æ›´æ–°äººID',
    deleted_flag TINYINT DEFAULT 0 COMMENT 'åˆ é™¤æ ‡å¿—: 0-æ­£å¸¸ 1-åˆ é™¤',
    version INT DEFAULT 0 COMMENT 'ä¹è§‚é”ç‰ˆæœ¬å·',

    -- ç´¢å¼•
    INDEX idx_template_code (template_code),
    INDEX idx_template_type (template_type),
    INDEX idx_device_type (device_type),
    INDEX idx_template_status (template_status),
    INDEX idx_is_default (is_default),

    -- å¤–é”®çº¦æŸ
    FOREIGN KEY (create_user_id) REFERENCES t_user(user_id),
    FOREIGN KEY (update_user_id) REFERENCES t_user(user_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='é—¨ç¦è®¾å¤‡é…ç½®æ¨¡æ¿è¡¨';
```

### 9. è®¾å¤‡ç»Ÿè®¡æ•°æ®è¡¨ (t_access_device_statistics)

å­˜å‚¨è®¾å¤‡ä½¿ç”¨ç»Ÿè®¡å’Œåˆ†ææ•°æ®ã€‚

```sql
CREATE TABLE t_access_device_statistics (
    -- ä¸»é”®å­—æ®µ
    statistics_id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'ç»Ÿè®¡ID',
    device_id BIGINT NOT NULL COMMENT 'è®¾å¤‡ID',

    -- ç»Ÿè®¡ç»´åº¦
    statistics_date DATE NOT NULL COMMENT 'ç»Ÿè®¡æ—¥æœŸ',
    statistics_type TINYINT NOT NULL COMMENT 'ç»Ÿè®¡ç±»å‹: 1-æ—¥ç»Ÿè®¡ 2-å‘¨ç»Ÿè®¡ 3-æœˆç»Ÿè®¡ 4-å¹´ç»Ÿè®¡',
    statistics_period VARCHAR(20) NOT NULL COMMENT 'ç»Ÿè®¡å‘¨æœŸ',

    -- é€šè¡Œç»Ÿè®¡
    total_access_count INT DEFAULT 0 COMMENT 'æ€»é€šè¡Œæ¬¡æ•°',
    successful_access_count INT DEFAULT 0 COMMENT 'æˆåŠŸé€šè¡Œæ¬¡æ•°',
    failed_access_count INT DEFAULT 0 COMMENT 'å¤±è´¥é€šè¡Œæ¬¡æ•°',
    access_success_rate DECIMAL(5,2) DEFAULT 0.00 COMMENT 'é€šè¡ŒæˆåŠŸç‡(%)',

    -- æ—¶é—´æ®µç»Ÿè®¡
    peak_hour_access_count INT DEFAULT 0 COMMENT 'é«˜å³°æ—¶æ®µé€šè¡Œæ¬¡æ•°',
    off_peak_hour_access_count INT DEFAULT 0 COMMENT 'éé«˜å³°æ—¶æ®µé€šè¡Œæ¬¡æ•°',
    night_access_count INT DEFAULT 0 COMMENT 'å¤œé—´é€šè¡Œæ¬¡æ•°',

    -- ç”¨æˆ·ç±»å‹ç»Ÿè®¡
    staff_access_count INT DEFAULT 0 COMMENT 'å‘˜å·¥é€šè¡Œæ¬¡æ•°',
    visitor_access_count INT DEFAULT 0 COMMENT 'è®¿å®¢é€šè¡Œæ¬¡æ•°',
    contractor_access_count INT DEFAULT 0 COMMENT 'æ‰¿åŒ…å•†é€šè¡Œæ¬¡æ•°',

    -- è®¤è¯æ–¹å¼ç»Ÿè®¡
    card_access_count INT DEFAULT 0 COMMENT 'å¡ç‰‡è®¤è¯æ¬¡æ•°',
    face_access_count INT DEFAULT 0 COMMENT 'äººè„¸è®¤è¯æ¬¡æ•°',
    fingerprint_access_count INT DEFAULT 0 COMMENT 'æŒ‡çº¹è®¤è¯æ¬¡æ•°',
    password_access_count INT DEFAULT 0 COMMENT 'å¯†ç è®¤è¯æ¬¡æ•°',

    -- å¼‚å¸¸ç»Ÿè®¡
    alarm_count INT DEFAULT 0 COMMENT 'æŠ¥è­¦æ¬¡æ•°',
    error_count INT DEFAULT 0 COMMENT 'é”™è¯¯æ¬¡æ•°',
    offline_duration INT DEFAULT 0 COMMENT 'ç¦»çº¿æ—¶é•¿(åˆ†é’Ÿ)',
    maintenance_duration INT DEFAULT 0 COMMENT 'ç»´æŠ¤æ—¶é•¿(åˆ†é’Ÿ)',

    -- æ€§èƒ½ç»Ÿè®¡
    avg_response_time INT DEFAULT 0 COMMENT 'å¹³å‡å“åº”æ—¶é—´(æ¯«ç§’)',
    max_response_time INT DEFAULT 0 COMMENT 'æœ€å¤§å“åº”æ—¶é—´(æ¯«ç§’)',
    avg_cpu_usage DECIMAL(5,2) DEFAULT 0.00 COMMENT 'å¹³å‡CPUä½¿ç”¨ç‡(%)',
    avg_memory_usage DECIMAL(5,2) DEFAULT 0.00 COMMENT 'å¹³å‡å†…å­˜ä½¿ç”¨ç‡(%)',

    -- åˆ›å»ºæ—¶é—´
    create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
    update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',

    -- å”¯ä¸€ç´¢å¼•
    UNIQUE INDEX uk_device_statistics (device_id, statistics_date, statistics_type),

    -- æ™®é€šç´¢å¼•
    INDEX idx_statistics_date (statistics_date),
    INDEX idx_statistics_type (statistics_type),
    INDEX idx_total_access_count (total_access_count),

    -- å¤–é”®çº¦æŸ
    FOREIGN KEY (device_id) REFERENCES t_access_device(device_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='é—¨ç¦è®¾å¤‡ç»Ÿè®¡æ•°æ®è¡¨';
```

---

## ğŸ”— æ•°æ®åº“å…³ç³»å›¾ (ERå›¾)

### å®ä½“å…³ç³»å›¾

```mermaid
erDiagram
    t_access_device ||--o{ t_access_device_network : "é…ç½®"
    t_access_device ||--o{ t_access_device_function : "é…ç½®"
    t_access_device ||--o{ t_access_device_monitor : "ç›‘æ§"
    t_access_device ||--o{ t_access_device_event : "äº‹ä»¶"
    t_access_device ||--o{ t_access_device_maintenance : "ç»´æŠ¤"
    t_access_device ||--o{ t_access_device_firmware : "å›ºä»¶"
    t_access_device ||--o{ t_access_device_statistics : "ç»Ÿè®¡"

    t_access_device }o--|| t_area : "æ‰€å±åŒºåŸŸ"
    t_access_device }o--|| t_user : "è´Ÿè´£äºº"
    t_access_device }o--|| t_department : "è´Ÿè´£éƒ¨é—¨"

    t_access_device_event }o--|| t_user : "å…³è”ç”¨æˆ·"
    t_access_device_event }o--|| t_user : "å¤„ç†äºº"

    t_access_device_maintenance }o--|| t_user : "ç»´æŠ¤äººå‘˜"
    t_access_device_maintenance }o--|| t_user : "éªŒæ”¶äºº"

    t_access_device_firmware }o--|| t_user : "æ“ä½œäºº"

    t_access_device_template ||--o{ t_user : "åˆ›å»ºäºº"
    t_access_device_template ||--o{ t_user : "æ›´æ–°äºº"

    t_access_device {
        bigint device_id PK
        varchar device_code UK
        varchar device_name
        tinyint device_type
        bigint area_id FK
        tinyint device_status
        tinyint online_status
        varchar ip_address
        int port
        tinyint protocol_type
        bigint responsible_user_id FK
        datetime create_time
        datetime update_time
        tinyint deleted_flag
        int version
    }

    t_access_device_network {
        bigint config_id PK
        bigint device_id FK
        varchar ip_address
        int port
        tinyint protocol_type
        varchar auth_username
        varchar auth_password_encrypted
        tinyint ssl_enabled
        datetime create_time
        tinyint deleted_flag
    }

    t_access_device_function {
        bigint config_id PK
        bigint device_id FK
        int door_open_time
        int door_close_time
        tinyint card_enabled
        tinyint face_enabled
        tinyint anti_passback_enabled
        int password_retry_limit
        json extended_config
        datetime create_time
        tinyint deleted_flag
    }

    t_access_device_monitor {
        bigint monitor_id PK
        bigint device_id FK
        tinyint online_status
        tinyint device_status
        decimal cpu_usage
        decimal memory_usage
        decimal temperature
        int response_time
        int today_access_count
        tinyint health_score
        datetime monitor_time
    }

    t_access_device_event {
        bigint event_id PK
        bigint device_id FK
        tinyint event_type
        tinyint event_level
        varchar event_title
        bigint user_id FK
        tinyint verify_type
        tinyint process_status
        datetime event_time
    }

    t_access_device_maintenance {
        bigint maintenance_id PK
        bigint device_id FK
        tinyint maintenance_type
        datetime planned_time
        datetime actual_start_time
        bigint maintenance_user_id FK
        tinyint maintenance_result
        decimal maintenance_cost
        datetime acceptance_time
        datetime create_time
        tinyint deleted_flag
    }

    t_access_device_firmware {
        bigint firmware_id PK
        bigint device_id FK
        varchar firmware_version
        bigint firmware_size
        tinyint upgrade_status
        datetime upgrade_start_time
        bigint operator_id FK
        tinyint upgrade_result
        datetime create_time
    }

    t_access_device_template {
        bigint template_id PK
        varchar template_name
        varchar template_code UK
        tinyint template_type
        json network_config
        json function_config
        int usage_count
        tinyint template_status
        datetime create_time
        tinyint deleted_flag
    }

    t_access_device_statistics {
        bigint statistics_id PK
        bigint device_id FK
        date statistics_date
        tinyint statistics_type
        int total_access_count
        int successful_access_count
        int failed_access_count
        decimal access_success_rate
        int peak_hour_access_count
        int alarm_count
        int error_count
        datetime create_time
    }
```

---

## ğŸ“Š æ•°æ®åº“è®¾è®¡è§„èŒƒ

### å‘½åè§„èŒƒ

| å¯¹è±¡ç±»å‹ | å‘½åè§„èŒƒ | ç¤ºä¾‹ |
|---------|---------|------|
| è¡¨å | t_access_æ¨¡å—_åŠŸèƒ½ | t_access_device |
| ä¸»é”® | id_åŠŸèƒ½ | device_id |
| å¤–é”® | å¼•ç”¨è¡¨å_id | user_id |
| ç´¢å¼• | idx_å­—æ®µå | idx_device_type |
| å”¯ä¸€ç´¢å¼• | uk_å­—æ®µå | uk_device_code |

### å­—æ®µè§„èŒƒ

| å­—æ®µç±»å‹ | å‘½åè§„èŒƒ | è¯´æ˜ |
|---------|---------|------|
| ä¸»é”®å­—æ®µ | id_åŠŸèƒ½ | è‡ªå¢BIGINT |
| çŠ¶æ€å­—æ®µ | status/level | ä½¿ç”¨TINYINTå­˜å‚¨æšä¸¾ |
| æ—¶é—´å­—æ®µ | time/date | ä½¿ç”¨DATETIME/DATE |
| é‡‘é¢å­—æ®µ | amount/price | ä½¿ç”¨DECIMAL |
| JSONå­—æ®µ | config/data | ä½¿ç”¨JSONç±»å‹ |
| åŠ å¯†å­—æ®µ | encrypted | æ ‡è¯†åŠ å¯†å­˜å‚¨ |

### ç´¢å¼•è®¾è®¡åŸåˆ™

1. **ä¸»é”®ç´¢å¼•**: æ‰€æœ‰è¡¨å¿…é¡»åŒ…å«è‡ªå¢ä¸»é”®
2. **å¤–é”®ç´¢å¼•**: æ‰€æœ‰å¤–é”®å­—æ®µå¿…é¡»åˆ›å»ºç´¢å¼•
3. **æŸ¥è¯¢ç´¢å¼•**: æ ¹æ®æŸ¥è¯¢é¢‘ç‡åˆ›å»ºå¤åˆç´¢å¼•
4. **å”¯ä¸€ç´¢å¼•**: ä¿è¯ä¸šåŠ¡æ•°æ®å”¯ä¸€æ€§
5. **åˆ†åŒºç´¢å¼•**: å¤§è¡¨æŒ‰æ—¶é—´åˆ†åŒº

---

## âš¡ æ€§èƒ½ä¼˜åŒ–è®¾è®¡

### ç´¢å¼•ä¼˜åŒ–

```sql
-- å¤åˆç´¢å¼•è®¾è®¡ç¤ºä¾‹
CREATE INDEX idx_device_status_area ON t_access_device(device_status, area_id);
CREATE INDEX idx_event_device_time ON t_access_device_event(device_id, event_time);
CREATE INDEX idx_monitor_device_time ON t_access_device_monitor(device_id, monitor_time);
```

### åˆ†åŒºè®¾è®¡

```sql
-- äº‹ä»¶è¡¨æŒ‰æœˆåˆ†åŒº
ALTER TABLE t_access_device_event
PARTITION BY RANGE (MONTH(event_time)) (
    PARTITION p202501 VALUES LESS THAN ('2025-02-01'),
    PARTITION p202502 VALUES LESS THAN ('2025-03-01'),
    PARTITION p202503 VALUES LESS THAN ('2025-04-01'),
    -- ...
    PARTITION pmax VALUES LESS THAN MAXVALUE
);
```

### ç¼“å­˜ç­–ç•¥

```java
// è®¾å¤‡ä¿¡æ¯ç¼“å­˜
@Cacheable(value = "device:info", key = "#deviceId", unless = "#result == null")
public AccessDeviceEntity getDeviceInfo(Long deviceId) {
    return deviceDao.selectById(deviceId);
}

// è®¾å¤‡çŠ¶æ€ç¼“å­˜
@Cacheable(value = "device:status", key = "#deviceId", unless = "#result == null")
public DeviceStatusVO getDeviceStatus(Long deviceId) {
    return deviceStatusMapper.selectByDeviceId(deviceId);
}
```

---

## ğŸ”’ æ•°æ®å®‰å…¨è®¾è®¡

### æ•æ„Ÿæ•°æ®åŠ å¯†

```sql
-- å¯†ç å­—æ®µåŠ å¯†å­˜å‚¨
auth_password_encrypted VARCHAR(500) COMMENT 'AES-256åŠ å¯†çš„è®¤è¯å¯†ç ',

-- é…ç½®æ•æ„Ÿä¿¡æ¯åŠ å¯†
extended_config JSON COMMENT 'æ•æ„Ÿé…ç½®æ•°æ®åŠ å¯†å­˜å‚¨'
```

### è®¿é—®æ§åˆ¶

```sql
-- è¡Œçº§å®‰å…¨ç­–ç•¥
CREATE POLICY device_access_policy ON t_access_device
FOR ALL TO access_app_user
USING (area_id IN (
    SELECT area_id FROM t_user_area_permission WHERE user_id = current_user_id()
));
```

### å®¡è®¡æ—¥å¿—

```sql
-- å®¡è®¡å­—æ®µè®¾è®¡
create_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
create_user_id BIGINT DEFAULT NULL COMMENT 'åˆ›å»ºäººID',
update_time DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
update_user_id BIGINT DEFAULT NULL COMMENT 'æ›´æ–°äººID',
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [åŠŸèƒ½è¯´æ˜](./åŠŸèƒ½è¯´æ˜.md)
- [ç”¨æˆ·æ•…äº‹](./ç”¨æˆ·æ•…äº‹.md)
- [ä¸šåŠ¡æµç¨‹å›¾](./ä¸šåŠ¡æµç¨‹å›¾.md)
- [APIæ¥å£è®¾è®¡](./APIæ¥å£è®¾è®¡.md)
- [éªŒæ”¶æµ‹è¯•ç”¨ä¾‹](./éªŒæ”¶æµ‹è¯•ç”¨ä¾‹.md)

---

**ğŸ“ æ–‡æ¡£ä¿¡æ¯**
- **åˆ›å»ºäºº**: é—¨ç¦è®¾å¤‡ç®¡ç†æ¨¡å—ç»„
- **å®¡æ ¸äºº**: æ•°æ®åº“æ¶æ„å¸ˆ
- **æœ€åæ›´æ–°**: 2025-12-17
- **ç‰ˆæœ¬**: v1.0.0