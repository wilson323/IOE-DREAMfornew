# é—¨ç¦æ¨¡å—å‰ç«¯ç•Œé¢è®¾è®¡æ–‡æ¡£

## æ–‡æ¡£ä¿¡æ¯
- **é¡¹ç›®åç§°**: IOE-DREAMæ™ºæ…§å›­åŒºå®‰é˜²ç»¼åˆç®¡ç†å¹³å°
- **æ¨¡å—åç§°**: é—¨ç¦ç®¡ç†æ¨¡å—
- **æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
- **åˆ›å»ºæ—¥æœŸ**: 2025-12-16
- **æ›´æ–°æ—¥æœŸ**: 2025-12-16
- **æ–‡æ¡£ç±»å‹**: å‰ç«¯ç•Œé¢è®¾è®¡æ–‡æ¡£

---

## 1. è®¾è®¡æ¦‚è¿°

### 1.1 è®¾è®¡åŸåˆ™
- **ç”¨æˆ·å‹å¥½**: ç®€æ´ç›´è§‚çš„æ“ä½œç•Œé¢ï¼Œé™ä½å­¦ä¹ æˆæœ¬
- **å“åº”å¼è®¾è®¡**: æ”¯æŒPCã€å¹³æ¿ã€æ‰‹æœºå¤šç«¯é€‚é…
- **å®æ—¶ç›‘æ§**: é—¨ç¦çŠ¶æ€å®æ—¶å±•ç¤ºï¼Œå¼‚å¸¸åŠæ—¶æé†’
- **æƒé™æ§åˆ¶**: åŸºäºç”¨æˆ·è§’è‰²çš„ç•Œé¢åŠŸèƒ½å±•ç¤º
- **æ•°æ®å¯è§†åŒ–**: å›¾è¡¨å±•ç¤ºé—¨ç¦ç»Ÿè®¡æ•°æ®

### 1.2 æŠ€æœ¯æ ˆ
- **å‰ç«¯æ¡†æ¶**: Vue 3.4 + Composition API
- **UIç»„ä»¶åº“**: Ant Design Vue 4.x
- **æ„å»ºå·¥å…·**: Vite 5.x
- **çŠ¶æ€ç®¡ç†**: Pinia 2.x
- **è·¯ç”±ç®¡ç†**: Vue Router 4.x
- **HTTPå®¢æˆ·ç«¯**: Axios 1.6.x
- **å›¾è¡¨ç»„ä»¶**: ECharts 5.4.x
- **WebSocket**: Socket.io-client
- **æ ·å¼é¢„å¤„ç†**: Sass/SCSS

### 1.3 æµè§ˆå™¨å…¼å®¹æ€§
| æµè§ˆå™¨ | æœ€ä½ç‰ˆæœ¬ | æ¨èç‰ˆæœ¬ |
|--------|----------|----------|
| Chrome | 88+ | æœ€æ–°ç‰ˆ |
| Firefox | 78+ | æœ€æ–°ç‰ˆ |
| Safari | 14+ | æœ€æ–°ç‰ˆ |
| Edge | 88+ | æœ€æ–°ç‰ˆ |

---

## 2. æ•´ä½“å¸ƒå±€è®¾è®¡

### 2.1 ä¸»æ¡†æ¶å¸ƒå±€
```vue
<template>
  <a-layout class="access-control-layout">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <a-layout-header class="layout-header">
      <AppHeader />
    </a-layout-header>

    <!-- ä¾§è¾¹å¯¼èˆªæ  -->
    <a-layout-sider
      v-model:collapsed="collapsed"
      :trigger="null"
      collapsible
      theme="light"
      class="layout-sider"
    >
      <AccessSideMenu :collapsed="collapsed" />
    </a-layout-sider>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <a-layout class="layout-content">
      <!-- é¢åŒ…å±‘å¯¼èˆª -->
      <a-layout-header class="content-header">
        <AppBreadcrumb />
        <UserActions />
      </a-layout-header>

      <!-- é¡µé¢å†…å®¹ -->
      <a-layout-content class="main-content">
        <router-view />
      </a-layout-content>
    </a-layout>

    <!-- å®æ—¶ç›‘æ§æµ®çª— -->
    <RealTimeMonitor v-if="showMonitor" />
  </a-layout>
</template>
```

### 2.2 è‰²å½©è§„èŒƒ
```scss
// ä¸»è‰²è°ƒ
$primary-color: #1890ff;
$primary-color-hover: #40a9ff;
$primary-color-active: #096dd9;

// çŠ¶æ€è‰²å½©
$success-color: #52c41a;  // æ­£å¸¸é€šè¡Œ
$warning-color: #faad14;  // å‘Šè­¦çŠ¶æ€
$error-color: #ff4d4f;    // å¼‚å¸¸çŠ¶æ€
$info-color: #1890ff;     // ä¿¡æ¯æç¤º

// èƒŒæ™¯è‰²
$bg-color: #f0f2f5;
$card-bg: #ffffff;
$sidebar-bg: #ffffff;

// æ–‡å­—è‰²
$text-primary: #262626;
$text-secondary: #595959;
$text-disabled: #bfbfbf;
```

### 2.3 å­—ä½“è§„èŒƒ
```scss
// å­—ä½“å¤§å°
$font-size-xs: 12px;
$font-size-sm: 14px;
$font-size-base: 16px;
$font-size-lg: 18px;
$font-size-xl: 20px;
$font-size-xxl: 24px;

// å­—ä½“æƒé‡
$font-weight-normal: 400;
$font-weight-medium: 500;
$font-weight-semibold: 600;
$font-weight-bold: 700;

// è¡Œé«˜
$line-height-base: 1.5;
$line-height-sm: 1.2;
$line-height-lg: 1.8;
```

---

## 3. æ ¸å¿ƒé¡µé¢è®¾è®¡

### 3.1 é—¨ç¦æ€»è§ˆé¡µé¢

#### 3.1.1 é¡µé¢å¸ƒå±€
```vue
<template>
  <div class="access-overview">
    <!-- ç»Ÿè®¡å¡ç‰‡ -->
    <a-row :gutter="24" class="stats-cards">
      <a-col :span="6" v-for="stat in statistics" :key="stat.key">
        <a-card class="stat-card">
          <a-statistic
            :title="stat.title"
            :value="stat.value"
            :precision="stat.precision"
            :suffix="stat.suffix"
            :value-style="{ color: stat.color }"
          >
            <template #prefix>
              <component :is="stat.icon" />
            </template>
          </a-statistic>
        </a-card>
      </a-col>
    </a-row>

    <!-- å®æ—¶ç›‘æ§åŒºåŸŸ -->
    <a-row :gutter="24" class="monitor-section">
      <a-col :span="16">
        <a-card title="å®æ—¶é—¨ç¦çŠ¶æ€" class="monitor-card">
          <DeviceMap :devices="devices" @device-click="handleDeviceClick" />
        </a-card>
      </a-col>
      <a-col :span="8">
        <a-card title="ä»Šæ—¥é€šè¡Œç»Ÿè®¡" class="chart-card">
          <AccessTrendChart :data="trendData" />
        </a-card>
      </a-col>
    </a-row>

    <!-- æœ€è¿‘é€šè¡Œè®°å½• -->
    <a-card title="æœ€è¿‘é€šè¡Œè®°å½•" class="recent-records">
      <AccessRecordTable
        :records="recentRecords"
        :loading="recordsLoading"
        @view-detail="handleViewDetail"
      />
    </a-card>
  </div>
</template>
```

#### 3.1.2 ç»Ÿè®¡å¡ç‰‡è®¾è®¡
```vue
<template>
  <div class="stat-card">
    <div class="stat-icon">
      <component :is="icon" :style="{ color: iconColor }" />
    </div>
    <div class="stat-content">
      <div class="stat-value">{{ formatValue(value) }}</div>
      <div class="stat-title">{{ title }}</div>
      <div class="stat-trend" v-if="trend">
        <ArrowUpOutlined v-if="trend > 0" class="trend-up" />
        <ArrowDownOutlined v-else class="trend-down" />
        <span>{{ Math.abs(trend) }}%</span>
      </div>
    </div>
  </div>
</template>

<style lang="scss" scoped>
.stat-card {
  .stat-icon {
    font-size: 32px;
    margin-bottom: 16px;
  }

  .stat-value {
    font-size: 28px;
    font-weight: 700;
    color: $text-primary;
    margin-bottom: 8px;
  }

  .stat-title {
    font-size: $font-size-sm;
    color: $text-secondary;
    margin-bottom: 8px;
  }

  .stat-trend {
    display: flex;
    align-items: center;
    font-size: $font-size-xs;

    .trend-up {
      color: $success-color;
      margin-right: 4px;
    }

    .trend-down {
      color: $error-color;
      margin-right: 4px;
    }
  }
}
</style>
```

### 3.2 è®¾å¤‡ç®¡ç†é¡µé¢

#### 3.2.1 è®¾å¤‡åˆ—è¡¨é¡µé¢
```vue
<template>
  <div class="device-management">
    <!-- æœç´¢å’Œæ“ä½œæ  -->
    <a-card class="search-card">
      <a-row :gutter="16" align="middle">
        <a-col :flex="1">
          <a-input-search
            v-model:value="searchKeyword"
            placeholder="æœç´¢è®¾å¤‡åç§°ã€è®¾å¤‡ç¼–å·"
            allow-clear
            @search="handleSearch"
          />
        </a-col>
        <a-col>
          <a-space>
            <a-button @click="handleExport">
              <ExportOutlined /> å¯¼å‡º
            </a-button>
            <a-button type="primary" @click="showAddModal = true">
              <PlusOutlined /> æ·»åŠ è®¾å¤‡
            </a-button>
          </a-space>
        </a-col>
      </a-row>

      <!-- é«˜çº§æœç´¢ -->
      <div class="advanced-search" v-show="showAdvanced">
        <a-form layout="inline" :model="searchForm">
          <a-form-item label="è®¾å¤‡ç±»å‹">
            <a-select
              v-model:value="searchForm.deviceType"
              placeholder="è¯·é€‰æ‹©è®¾å¤‡ç±»å‹"
              allow-clear
              style="width: 180px"
            >
              <a-select-option
                v-for="type in deviceTypes"
                :key="type.value"
                :value="type.value"
              >
                {{ type.label }}
              </a-select-option>
            </a-select>
          </a-form-item>

          <a-form-item label="è®¾å¤‡çŠ¶æ€">
            <a-select
              v-model:value="searchForm.status"
              placeholder="è¯·é€‰æ‹©è®¾å¤‡çŠ¶æ€"
              allow-clear
              style="width: 120px"
            >
              <a-select-option value="1">åœ¨çº¿</a-select-option>
              <a-select-option value="0">ç¦»çº¿</a-select-option>
              <a-select-option value="2">æ•…éšœ</a-select-option>
              <a-select-option value="3">ç»´æŠ¤</a-select-option>
            </a-select>
          </a-form-item>

          <a-form-item label="æ‰€å±åŒºåŸŸ">
            <a-tree-select
              v-model:value="searchForm.areaId"
              placeholder="è¯·é€‰æ‹©æ‰€å±åŒºåŸŸ"
              allow-clear
              style="width: 200px"
              :tree-data="areaTreeData"
            />
          </a-form-item>
        </a-form>
      </div>
    </a-card>

    <!-- è®¾å¤‡åˆ—è¡¨ -->
    <a-card class="device-list">
      <a-table
        :columns="columns"
        :data-source="deviceList"
        :loading="loading"
        :pagination="pagination"
        :row-selection="{ selectedRowKeys: selectedRowKeys, onChange: onSelectChange }"
        @change="handleTableChange"
      >
        <!-- è®¾å¤‡çŠ¶æ€ -->
        <template #status="{ record }">
          <a-tag :color="getStatusColor(record.status)">
            {{ getStatusText(record.status) }}
          </a-tag>
        </template>

        <!-- è®¾å¤‡ç±»å‹ -->
        <template #deviceType="{ record }">
          <a-icon :component="getDeviceIcon(record.deviceType)" />
          {{ getDeviceTypeText(record.deviceType) }}
        </template>

        <!-- æ“ä½œåˆ— -->
        <template #action="{ record }">
          <a-space>
            <a-button type="link" size="small" @click="handleView(record)">
              æŸ¥çœ‹
            </a-button>
            <a-button type="link" size="small" @click="handleEdit(record)">
              ç¼–è¾‘
            </a-button>
            <a-button type="link" size="small" @click="handleControl(record)">
              æ§åˆ¶
            </a-button>
            <a-dropdown>
              <a-button type="link" size="small">
                æ›´å¤š <DownOutlined />
              </a-button>
              <template #overlay>
                <a-menu>
                  <a-menu-item @click="handleSyncConfig(record)">
                    åŒæ­¥é…ç½®
                  </a-menu-item>
                  <a-menu-item @click="handleViewLogs(record)">
                    æŸ¥çœ‹æ—¥å¿—
                  </a-menu-item>
                  <a-menu-divider />
                  <a-menu-item
                    danger
                    @click="handleDelete(record)"
                  >
                    åˆ é™¤
                  </a-menu-item>
                </a-menu>
              </template>
            </a-dropdown>
          </a-space>
        </template>
      </a-table>
    </a-card>

    <!-- æ·»åŠ è®¾å¤‡å¼¹çª— -->
    <AddDeviceModal
      v-model:visible="showAddModal"
      @success="handleAddSuccess"
    />

    <!-- è®¾å¤‡æ§åˆ¶å¼¹çª— -->
    <DeviceControlModal
      v-model:visible="showControlModal"
      :device="selectedDevice"
      @success="handleControlSuccess"
    />
  </div>
</template>
```

#### 3.2.2 è®¾å¤‡è¯¦æƒ…é¡µé¢
```vue
<template>
  <div class="device-detail">
    <a-page-header
      :title="deviceInfo.deviceName"
      :sub-title="deviceInfo.deviceCode"
      @back="handleBack"
    >
      <template #extra>
        <a-space>
          <a-button @click="handleEdit">ç¼–è¾‘è®¾å¤‡</a-button>
          <a-button type="primary" @click="handleControl">
            è®¾å¤‡æ§åˆ¶
          </a-button>
        </a-space>
      </template>
    </a-page-header>

    <!-- è®¾å¤‡ä¿¡æ¯å¡ç‰‡ -->
    <a-row :gutter="24">
      <!-- åŸºæœ¬ä¿¡æ¯ -->
      <a-col :span="8">
        <a-card title="åŸºæœ¬ä¿¡æ¯" class="info-card">
          <a-descriptions :column="1" bordered>
            <a-descriptions-item label="è®¾å¤‡ç¼–å·">
              {{ deviceInfo.deviceCode }}
            </a-descriptions-item>
            <a-descriptions-item label="è®¾å¤‡ç±»å‹">
              <a-tag>{{ getDeviceTypeText(deviceInfo.deviceType) }}</a-tag>
            </a-descriptions-item>
            <a-descriptions-item label="è®¾å¤‡å‹å·">
              {{ deviceInfo.deviceModel }}
            </a-descriptions-item>
            <a-descriptions-item label="å®‰è£…ä½ç½®">
              {{ deviceInfo.installLocation }}
            </a-descriptions-item>
            <a-descriptions-item label="æ‰€å±åŒºåŸŸ">
              {{ deviceInfo.areaName }}
            </a-descriptions-item>
            <a-descriptions-item label="è®¾å¤‡çŠ¶æ€">
              <a-badge
                :status="getStatusBadge(deviceInfo.status)"
                :text="getStatusText(deviceInfo.status)"
              />
            </a-descriptions-item>
          </a-descriptions>
        </a-card>
      </a-col>

      <!-- è¿è¡ŒçŠ¶æ€ -->
      <a-col :span="8">
        <a-card title="è¿è¡ŒçŠ¶æ€" class="status-card">
          <div class="status-overview">
            <div class="status-item">
              <div class="status-label">åœ¨çº¿çŠ¶æ€</div>
              <div class="status-value">
                <a-badge
                  :status="deviceInfo.isOnline ? 'success' : 'error'"
                  :text="deviceInfo.isOnline ? 'åœ¨çº¿' : 'ç¦»çº¿'"
                />
              </div>
            </div>
            <div class="status-item">
              <div class="status-label">ç½‘ç»œå»¶è¿Ÿ</div>
              <div class="status-value">{{ deviceInfo.networkDelay }}ms</div>
            </div>
            <div class="status-item">
              <div class="status-label">CPUä½¿ç”¨ç‡</div>
              <div class="status-value">
                <a-progress
                  :percent="deviceInfo.cpuUsage"
                  :status="deviceInfo.cpuUsage > 80 ? 'exception' : 'normal'"
                />
              </div>
            </div>
            <div class="status-item">
              <div class="status-label">å†…å­˜ä½¿ç”¨ç‡</div>
              <div class="status-value">
                <a-progress
                  :percent="deviceInfo.memoryUsage"
                  :status="deviceInfo.memoryUsage > 80 ? 'exception' : 'normal'"
                />
              </div>
            </div>
          </div>
        </a-card>
      </a-col>

      <!-- ä»Šæ—¥ç»Ÿè®¡ -->
      <a-col :span="8">
        <a-card title="ä»Šæ—¥ç»Ÿè®¡" class="stats-card">
          <div class="daily-stats">
            <div class="stat-item">
              <div class="stat-number">{{ deviceInfo.todayPassCount }}</div>
              <div class="stat-label">é€šè¡Œæ¬¡æ•°</div>
            </div>
            <div class="stat-item">
              <div class="stat-number">{{ deviceInfo.todayPassUserCount }}</div>
              <div class="stat-label">é€šè¡Œäººæ•°</div>
            </div>
            <div class="stat-item">
              <div class="stat-number">{{ deviceInfo.todayFailCount }}</div>
              <div class="stat-label">å¤±è´¥æ¬¡æ•°</div>
            </div>
            <div class="stat-item">
              <div class="stat-number">{{ deviceInfo.todayAlarmCount }}</div>
              <div class="stat-label">å‘Šè­¦æ¬¡æ•°</div>
            </div>
          </div>
        </a-card>
      </a-col>
    </a-row>

    <!-- æ ‡ç­¾é¡µå†…å®¹ -->
    <a-card class="detail-tabs">
      <a-tabs v-model:activeKey="activeTab">
        <!-- é€šè¡Œè®°å½• -->
        <a-tab-pane key="records" tab="é€šè¡Œè®°å½•">
          <AccessRecordTable
            :device-id="deviceId"
            :show-pagination="true"
          />
        </a-tab-pane>

        <!-- æƒé™ç®¡ç† -->
        <a-tab-pane key="permissions" tab="æƒé™ç®¡ç†">
          <DevicePermissionList
            :device-id="deviceId"
            @update="handlePermissionUpdate"
          />
        </a-tab-pane>

        <!-- é…ç½®ä¿¡æ¯ -->
        <a-tab-pane key="config" tab="é…ç½®ä¿¡æ¯">
          <DeviceConfigForm
            :device="deviceInfo"
            @update="handleConfigUpdate"
          />
        </a-tab-pane>

        <!-- è¿è¡Œæ—¥å¿— -->
        <a-tab-pane key="logs" tab="è¿è¡Œæ—¥å¿—">
          <DeviceLogList
            :device-id="deviceId"
          />
        </a-tab-pane>
      </a-tabs>
    </a-card>
  </div>
</template>

<style lang="scss" scoped>
.device-detail {
  .info-card, .status-card, .stats-card {
    height: 100%;
    min-height: 280px;
  }

  .status-overview, .daily-stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;

    .status-item, .stat-item {
      text-align: center;
      padding: 16px;
      border: 1px solid #f0f0f0;
      border-radius: 6px;

      .status-label, .stat-label {
        font-size: $font-size-xs;
        color: $text-secondary;
        margin-bottom: 8px;
      }

      .status-value {
        font-size: $font-size-lg;
        font-weight: 600;
        color: $text-primary;
      }

      .stat-number {
        font-size: 28px;
        font-weight: 700;
        color: $primary-color;
        margin-bottom: 4px;
      }
    }
  }
}
</style>
```

### 3.3 æƒé™ç®¡ç†é¡µé¢

#### 3.3.1 æƒé™ç”³è¯·é¡µé¢
```vue
<template>
  <div class="permission-application">
    <a-card title="æƒé™ç”³è¯·" class="application-card">
      <a-form
        ref="formRef"
        :model="form"
        :rules="rules"
        layout="vertical"
        @finish="handleSubmit"
      >
        <a-row :gutter="24">
          <!-- ç”³è¯·äººä¿¡æ¯ -->
          <a-col :span="12">
            <a-form-item label="ç”³è¯·äºº" name="userId">
              <a-user-select
                v-model:value="form.userId"
                placeholder="è¯·é€‰æ‹©ç”³è¯·äºº"
                :show-search="true"
                @change="handleUserChange"
              />
            </a-form-item>
          </a-col>

          <a-col :span="12">
            <a-form-item label="æ‰€å±éƒ¨é—¨" name="departmentId">
              <a-tree-select
                v-model:value="form.departmentId"
                placeholder="è¯·é€‰æ‹©æ‰€å±éƒ¨é—¨"
                :tree-data="departmentTree"
                disabled
              />
            </a-form-item>
          </a-col>
        </a-row>

        <a-row :gutter="24">
          <!-- æƒé™ç±»å‹ -->
          <a-col :span="12">
            <a-form-item label="æƒé™ç±»å‹" name="permissionType">
              <a-select
                v-model:value="form.permissionType"
                placeholder="è¯·é€‰æ‹©æƒé™ç±»å‹"
                @change="handlePermissionTypeChange"
              >
                <a-select-option value="permanent">æ°¸ä¹…æƒé™</a-select-option>
                <a-select-option value="temporary">ä¸´æ—¶æƒé™</a-select-option>
                <a-select-option value="visitor">è®¿å®¢æƒé™</a-select-option>
              </a-select>
            </a-form-item>
          </a-col>

          <a-col :span="12" v-if="form.permissionType === 'temporary'">
            <a-form-item label="æœ‰æ•ˆæœŸ" name="validPeriod">
              <a-range-picker
                v-model:value="form.validPeriod"
                :disabled-date="disabledDate"
                show-time
                format="YYYY-MM-DD HH:mm:ss"
              />
            </a-form-item>
          </a-col>
        </a-row>

        <!-- æƒé™åŒºåŸŸ -->
        <a-form-item label="æƒé™åŒºåŸŸ" name="areaIds">
          <a-tree-select
            v-model:value="form.areaIds"
            placeholder="è¯·é€‰æ‹©æƒé™åŒºåŸŸ"
            multiple
            :tree-data="areaTree"
            :dropdown-style="{ maxHeight: '400px', overflow: 'auto' }"
            tree-default-expand-all
          />
        </a-form-item>

        <!-- æƒé™è®¾å¤‡ -->
        <a-form-item label="æƒé™è®¾å¤‡" name="deviceIds">
          <a-select
            v-model:value="form.deviceIds"
            mode="multiple"
            placeholder="è¯·é€‰æ‹©æƒé™è®¾å¤‡"
            :filter-option="filterDeviceOption"
            @focus="handleDeviceFocus"
          >
            <a-select-option
              v-for="device in availableDevices"
              :key="device.deviceId"
              :value="device.deviceId"
            >
              {{ device.deviceName }} ({{ device.deviceCode }})
            </a-select-option>
          </a-select>
        </a-form-item>

        <!-- é€šè¡Œæ—¶æ®µ -->
        <a-form-item label="é€šè¡Œæ—¶æ®µ" name="timeRanges">
          <TimeRangeSelector
            v-model:value="form.timeRanges"
            :show-weekday="true"
          />
        </a-form-item>

        <!-- ç”³è¯·ç†ç”± -->
        <a-form-item label="ç”³è¯·ç†ç”±" name="reason">
          <a-textarea
            v-model:value="form.reason"
            :rows="4"
            placeholder="è¯·è¾“å…¥ç”³è¯·ç†ç”±"
            :maxlength="500"
            show-count
          />
        </a-form-item>

        <!-- é™„ä»¶ä¸Šä¼  -->
        <a-form-item label="ç›¸å…³é™„ä»¶" name="attachments">
          <a-upload
            v-model:file-list="fileList"
            :custom-request="handleUpload"
            :before-upload="beforeUpload"
            multiple
          >
            <a-button>
              <UploadOutlined /> ä¸Šä¼ é™„ä»¶
            </a-button>
          </a-upload>
        </a-form-item>

        <!-- è¡¨å•æ“ä½œ -->
        <a-form-item>
          <a-space>
            <a-button type="primary" html-type="submit" :loading="submitting">
              æäº¤ç”³è¯·
            </a-button>
            <a-button @click="handleReset">é‡ç½®</a-button>
            <a-button @click="handleSaveDraft">ä¿å­˜è‰ç¨¿</a-button>
          </a-space>
        </a-form-item>
      </a-form>
    </a-card>
  </div>
</template>
```

#### 3.3.2 æƒé™å®¡æ‰¹é¡µé¢
```vue
<template>
  <div class="permission-approval">
    <!-- å¾…å®¡æ‰¹åˆ—è¡¨ -->
    <a-card title="å¾…å®¡æ‰¹æƒé™" class="approval-card">
      <a-tabs v-model:activeKey="activeTab">
        <a-tab-pane key="pending" tab="å¾…å®¡æ‰¹">
          <ApprovalTable
            :data="pendingList"
            :loading="pendingLoading"
            type="pending"
            @approve="handleApprove"
            @reject="handleReject"
          />
        </a-tab-pane>

        <a-tab-pane key="approved" tab="å·²é€šè¿‡">
          <ApprovalTable
            :data="approvedList"
            :loading="approvedLoading"
            type="approved"
            @view="handleViewDetail"
          />
        </a-tab-pane>

        <a-tab-pane key="rejected" tab="å·²æ‹’ç»">
          <ApprovalTable
            :data="rejectedList"
            :loading="rejectedLoading"
            type="rejected"
            @view="handleViewDetail"
          />
        </a-tab-pane>
      </a-tabs>
    </a-card>

    <!-- å®¡æ‰¹å¼¹çª— -->
    <ApprovalModal
      v-model:visible="showApprovalModal"
      :approval-data="selectedApproval"
      @success="handleApprovalSuccess"
    />
  </div>
</template>
```

### 3.4 é€šè¡Œè®°å½•é¡µé¢

#### 3.4.1 é€šè¡Œè®°å½•æŸ¥è¯¢é¡µé¢
```vue
<template>
  <div class="access-records">
    <!-- æœç´¢æ¡ä»¶ -->
    <a-card class="search-card">
      <a-form layout="inline" :model="searchForm">
        <a-form-item label="é€šè¡Œæ—¶é—´">
          <a-range-picker
            v-model:value="searchForm.dateRange"
            format="YYYY-MM-DD"
            @change="handleDateChange"
          />
        </a-form-item>

        <a-form-item label="é€šè¡Œäººå‘˜">
          <a-input
            v-model:value="searchForm.userName"
            placeholder="è¯·è¾“å…¥å§“å/å·¥å·"
            allow-clear
          />
        </a-form-item>

        <a-form-item label="è®¾å¤‡åç§°">
          <a-select
            v-model:value="searchForm.deviceId"
            placeholder="è¯·é€‰æ‹©è®¾å¤‡"
            allow-clear
            style="width: 200px"
          >
            <a-select-option
              v-for="device in deviceList"
              :key="device.deviceId"
              :value="device.deviceId"
            >
              {{ device.deviceName }}
            </a-select-option>
          </a-select>
        </a-form-item>

        <a-form-item label="é€šè¡ŒçŠ¶æ€">
          <a-select
            v-model:value="searchForm.status"
            placeholder="è¯·é€‰æ‹©çŠ¶æ€"
            allow-clear
            style="width: 120px"
          >
            <a-select-option value="SUCCESS">æˆåŠŸ</a-select-option>
            <a-select-option value="FAILED">å¤±è´¥</a-select-option>
            <a-select-option value="ALARM">å‘Šè­¦</a-select-option>
          </a-select>
        </a-form-item>

        <a-form-item>
          <a-space>
            <a-button type="primary" @click="handleSearch">
              <SearchOutlined /> æŸ¥è¯¢
            </a-button>
            <a-button @click="handleReset">é‡ç½®</a-button>
            <a-button @click="handleExport">
              <ExportOutlined /> å¯¼å‡º
            </a-button>
          </a-space>
        </a-form-item>
      </a-form>
    </a-card>

    <!-- ç»Ÿè®¡ä¿¡æ¯ -->
    <a-row :gutter="24" class="stats-row">
      <a-col :span="6" v-for="stat in statistics" :key="stat.key">
        <a-card class="stat-card">
          <a-statistic
            :title="stat.title"
            :value="stat.value"
            :value-style="{ color: stat.color }"
          />
        </a-card>
      </a-col>
    </a-row>

    <!-- é€šè¡Œè®°å½•è¡¨æ ¼ -->
    <a-card title="é€šè¡Œè®°å½•" class="records-card">
      <a-table
        :columns="columns"
        :data-source="recordList"
        :loading="loading"
        :pagination="pagination"
        :scroll="{ x: 1200 }"
        @change="handleTableChange"
      >
        <!-- é€šè¡Œæ—¶é—´ -->
        <template #punchTime="{ record }">
          {{ formatDateTime(record.punchTime) }}
        </template>

        <!-- é€šè¡ŒçŠ¶æ€ -->
        <template #status="{ record }">
          <a-tag :color="getStatusColor(record.status)">
            {{ getStatusText(record.status) }}
          </a-tag>
        </template>

        <!-- éªŒè¯æ–¹å¼ -->
        <template #verifyMethod="{ record }">
          <a-tag>{{ getVerifyMethodText(record.verifyMethod) }}</a-tag>
        </template>

        <!-- æŠ“æ‹å›¾ç‰‡ -->
        <template #captureImage="{ record }">
          <a-image
            v-if="record.captureImage"
            :src="record.captureImage"
            :width="60"
            :height="60"
            :preview="{
              mask: 'æŸ¥çœ‹å¤§å›¾'
            }"
          />
          <span v-else>-</span>
        </template>

        <!-- æ“ä½œåˆ— -->
        <template #action="{ record }">
          <a-space>
            <a-button type="link" size="small" @click="handleViewDetail(record)">
              è¯¦æƒ…
            </a-button>
            <a-button
              type="link"
              size="small"
              v-if="record.captureImage"
              @click="handleViewImage(record)"
            >
              æŸ¥çœ‹å›¾ç‰‡
            </a-button>
          </a-space>
        </template>
      </a-table>
    </a-card>

    <!-- è¯¦æƒ…å¼¹çª— -->
    <RecordDetailModal
      v-model:visible="showDetailModal"
      :record="selectedRecord"
    />
  </div>
</template>
```

---

## 4. ç»„ä»¶è®¾è®¡

### 4.1 é€šç”¨ç»„ä»¶

#### 4.1.1 è®¾å¤‡çŠ¶æ€æŒ‡ç¤ºå™¨
```vue
<template>
  <div class="device-status-indicator">
    <div class="status-dot" :class="statusClass"></div>
    <span class="status-text">{{ statusText }}</span>
  </div>
</template>

<script setup>
import { computed } from 'vue'

const props = defineProps({
  status: {
    type: [String, Number],
    required: true
  },
  showText: {
    type: Boolean,
    default: true
  }
})

const statusClass = computed(() => {
  const statusMap = {
    1: 'status-online',
    0: 'status-offline',
    2: 'status-error',
    3: 'status-maintenance'
  }
  return statusMap[props.status] || 'status-unknown'
})

const statusText = computed(() => {
  const textMap = {
    1: 'åœ¨çº¿',
    0: 'ç¦»çº¿',
    2: 'æ•…éšœ',
    3: 'ç»´æŠ¤'
  }
  return textMap[props.status] || 'æœªçŸ¥'
})
</script>

<style lang="scss" scoped>
.device-status-indicator {
  display: inline-flex;
  align-items: center;
  gap: 6px;

  .status-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;

    &.status-online {
      background-color: $success-color;
      box-shadow: 0 0 6px rgba($success-color, 0.5);
    }

    &.status-offline {
      background-color: $text-disabled;
    }

    &.status-error {
      background-color: $error-color;
      box-shadow: 0 0 6px rgba($error-color, 0.5);
    }

    &.status-maintenance {
      background-color: $warning-color;
    }
  }

  .status-text {
    font-size: $font-size-sm;
    color: $text-secondary;
  }
}
</style>
```

#### 4.1.2 å®æ—¶ç›‘æ§ç»„ä»¶
```vue
<template>
  <div class="real-time-monitor">
    <div class="monitor-header">
      <h4>å®æ—¶ç›‘æ§</h4>
      <a-switch
        v-model:checked="enabled"
        checked-children="å¼€å¯"
        un-checked-children="å…³é—­"
        @change="handleToggle"
      />
    </div>

    <div class="monitor-content" v-show="enabled">
      <!-- å‘Šè­¦ä¿¡æ¯ -->
      <div class="alert-section" v-if="alerts.length > 0">
        <a-alert
          v-for="alert in alerts"
          :key="alert.id"
          :message="alert.message"
          :type="alert.level"
          show-icon
          closable
          @close="handleAlertClose(alert)"
        />
      </div>

      <!-- è®¾å¤‡çŠ¶æ€æ¦‚è§ˆ -->
      <div class="device-overview">
        <div class="overview-item" v-for="item in overview" :key="item.type">
          <div class="overview-icon">
            <component :is="item.icon" />
          </div>
          <div class="overview-content">
            <div class="overview-value">{{ item.value }}</div>
            <div class="overview-label">{{ item.label }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, reactive, onMounted, onUnmounted } from 'vue'
import { useWebSocket } from '@/composables/useWebSocket'

const enabled = ref(false)
const alerts = ref([])
const overview = reactive([
  {
    type: 'online',
    label: 'åœ¨çº¿è®¾å¤‡',
    value: 0,
    icon: 'WifiOutlined'
  },
  {
    type: 'today',
    label: 'ä»Šæ—¥é€šè¡Œ',
    value: 0,
    icon: 'UserOutlined'
  },
  {
    type: 'alarm',
    label: 'å‘Šè­¦æ•°é‡',
    value: 0,
    icon: 'AlertOutlined'
  }
])

const { connect, disconnect, subscribe, unsubscribe } = useWebSocket()

const handleToggle = (checked) => {
  if (checked) {
    connect()
    subscribe('/topic/access/monitor', handleMonitorMessage)
  } else {
    unsubscribe('/topic/access/monitor')
    disconnect()
  }
}

const handleMonitorMessage = (data) => {
  switch (data.type) {
    case 'DEVICE_STATUS':
      updateDeviceStatus(data.payload)
      break
    case 'ACCESS_RECORD':
      updateAccessRecord(data.payload)
      break
    case 'ALERT':
      addAlert(data.payload)
      break
  }
}

const addAlert = (alert) => {
  alerts.value.unshift({
    id: alert.id,
    message: alert.message,
    level: alert.level,
    timestamp: alert.timestamp
  })

  // é™åˆ¶å‘Šè­¦æ•°é‡
  if (alerts.value.length > 5) {
    alerts.value = alerts.value.slice(0, 5)
  }
}

onUnmounted(() => {
  if (enabled.value) {
    handleToggle(false)
  }
})
</script>

<style lang="scss" scoped>
.real-time-monitor {
  position: fixed;
  top: 80px;
  right: 20px;
  width: 320px;
  background: white;
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  z-index: 1000;

  .monitor-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px;
    border-bottom: 1px solid #f0f0f0;

    h4 {
      margin: 0;
      font-size: $font-size-base;
      font-weight: 600;
    }
  }

  .monitor-content {
    padding: 16px;
  }

  .alert-section {
    margin-bottom: 16px;

    .ant-alert {
      margin-bottom: 8px;

      &:last-child {
        margin-bottom: 0;
      }
    }
  }

  .device-overview {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 12px;

    .overview-item {
      text-align: center;
      padding: 12px;
      border: 1px solid #f0f0f0;
      border-radius: 6px;

      .overview-icon {
        font-size: 24px;
        color: $primary-color;
        margin-bottom: 8px;
      }

      .overview-value {
        font-size: 20px;
        font-weight: 700;
        color: $text-primary;
        margin-bottom: 4px;
      }

      .overview-label {
        font-size: $font-size-xs;
        color: $text-secondary;
      }
    }
  }
}
</style>
```

#### 4.1.3 é€šè¡Œè®°å½•è¡¨æ ¼ç»„ä»¶
```vue
<template>
  <div class="access-record-table">
    <a-table
      :columns="columns"
      :data-source="records"
      :loading="loading"
      :pagination="pagination"
      :scroll="{ x: 1200 }"
      :size="tableSize"
      @change="handleTableChange"
    >
      <!-- è‡ªå®šä¹‰åˆ—æ¨¡æ¿ -->
      <template #userName="{ record }">
        <div class="user-info">
          <a-avatar
            :src="record.userAvatar"
            :size="32"
          >
            {{ record.userName.charAt(0) }}
          </a-avatar>
          <div class="user-details">
            <div class="user-name">{{ record.userName }}</div>
            <div class="user-dept">{{ record.departmentName }}</div>
          </div>
        </div>
      </template>

      <template #punchTime="{ record }">
        <div class="time-info">
          <div class="time-main">{{ formatDate(record.punchTime) }}</div>
          <div class="time-sub">{{ formatTime(record.punchTime) }}</div>
        </div>
      </template>

      <template #status="{ record }">
        <a-tag :color="getStatusColor(record.status)">
          <component :is="getStatusIcon(record.status)" />
          {{ getStatusText(record.status) }}
        </a-tag>
      </template>

      <template #verifyMethod="{ record }">
        <a-space>
          <a-tag v-for="method in record.verifyMethods" :key="method">
            {{ getVerifyMethodIcon(method) }} {{ getVerifyMethodText(method) }}
          </a-tag>
        </a-space>
      </template>

      <template #deviceInfo="{ record }">
        <div class="device-info">
          <div class="device-name">{{ record.deviceName }}</div>
          <div class="device-location">{{ record.location }}</div>
        </div>
      </template>

      <template #captureImage="{ record }">
        <a-image
          v-if="record.captureImage"
          :src="record.captureImage"
          :width="60"
          :height="60"
          :preview="{
            mask: 'æŸ¥çœ‹å¤§å›¾'
          }"
          :fallback="defaultImage"
        />
        <span v-else class="no-image">æ— å›¾ç‰‡</span>
      </template>

      <template #action="{ record }">
        <a-space>
          <a-button type="link" size="small" @click="handleViewDetail(record)">
            è¯¦æƒ…
          </a-button>
          <a-button
            type="link"
            size="small"
            v-if="record.captureImage"
            @click="handleViewImage(record)"
          >
            æŸ¥çœ‹å›¾ç‰‡
          </a-button>
          <a-button
            type="link"
            size="small"
            v-if="record.status === 'FAILED'"
            @click="handleAnalyze(record)"
          >
            åˆ†æåŸå› 
          </a-button>
        </a-space>
      </template>
    </a-table>
  </div>
</template>

<script setup>
import { ref, computed } from 'vue'
import { format } from 'date-fns'

const props = defineProps({
  records: {
    type: Array,
    default: () => []
  },
  loading: {
    type: Boolean,
    default: false
  },
  pagination: {
    type: Object,
    default: () => ({})
  },
  tableSize: {
    type: String,
    default: 'middle'
  }
})

const emit = defineEmits(['change', 'view-detail', 'view-image', 'analyze'])

// è¡¨æ ¼åˆ—é…ç½®
const columns = [
  {
    title: 'é€šè¡Œäººå‘˜',
    dataIndex: 'userName',
    key: 'userName',
    width: 180,
    slots: { customRender: 'userName' }
  },
  {
    title: 'é€šè¡Œæ—¶é—´',
    dataIndex: 'punchTime',
    key: 'punchTime',
    width: 160,
    slots: { customRender: 'punchTime' },
    sorter: true
  },
  {
    title: 'é€šè¡ŒçŠ¶æ€',
    dataIndex: 'status',
    key: 'status',
    width: 100,
    slots: { customRender: 'status' },
    filters: [
      { text: 'æˆåŠŸ', value: 'SUCCESS' },
      { text: 'å¤±è´¥', value: 'FAILED' },
      { text: 'å‘Šè­¦', value: 'ALARM' }
    ]
  },
  {
    title: 'éªŒè¯æ–¹å¼',
    dataIndex: 'verifyMethods',
    key: 'verifyMethods',
    width: 180,
    slots: { customRender: 'verifyMethod' }
  },
  {
    title: 'è®¾å¤‡ä¿¡æ¯',
    dataIndex: 'deviceName',
    key: 'deviceInfo',
    width: 200,
    slots: { customRender: 'deviceInfo' }
  },
  {
    title: 'æŠ“æ‹å›¾ç‰‡',
    dataIndex: 'captureImage',
    key: 'captureImage',
    width: 100,
    slots: { customRender: 'captureImage' }
  },
  {
    title: 'æ“ä½œ',
    key: 'action',
    width: 150,
    fixed: 'right',
    slots: { customRender: 'action' }
  }
]

// å·¥å…·å‡½æ•°
const formatDate = (date) => format(new Date(date), 'yyyy-MM-dd')
const formatTime = (date) => format(new Date(date), 'HH:mm:ss')

const getStatusColor = (status) => {
  const colorMap = {
    SUCCESS: 'green',
    FAILED: 'red',
    ALARM: 'orange'
  }
  return colorMap[status] || 'default'
}

const getStatusText = (status) => {
  const textMap = {
    SUCCESS: 'æˆåŠŸ',
    FAILED: 'å¤±è´¥',
    ALARM: 'å‘Šè­¦'
  }
  return textMap[status] || 'æœªçŸ¥'
}

const getStatusIcon = (status) => {
  const iconMap = {
    SUCCESS: 'CheckCircleOutlined',
    FAILED: 'CloseCircleOutlined',
    ALARM: 'AlertOutlined'
  }
  return iconMap[status] || 'QuestionCircleOutlined'
}

const getVerifyMethodIcon = (method) => {
  const iconMap = {
    FACE: 'ğŸ‘¤',
    FINGERPRINT: 'ğŸ‘†',
    CARD: 'ğŸ’³',
    PASSWORD: 'ğŸ”‘',
    QR_CODE: 'ğŸ“±'
  }
  return iconMap[method] || 'â“'
}

const getVerifyMethodText = (method) => {
  const textMap = {
    FACE: 'äººè„¸',
    FINGERPRINT: 'æŒ‡çº¹',
    CARD: 'åˆ·å¡',
    PASSWORD: 'å¯†ç ',
    QR_CODE: 'äºŒç»´ç '
  }
  return textMap[method] || 'æœªçŸ¥'
}

// äº‹ä»¶å¤„ç†
const handleTableChange = (pagination, filters, sorter) => {
  emit('change', { pagination, filters, sorter })
}

const handleViewDetail = (record) => {
  emit('view-detail', record)
}

const handleViewImage = (record) => {
  emit('view-image', record)
}

const handleAnalyze = (record) => {
  emit('analyze', record)
}

// é»˜è®¤å›¾ç‰‡
const defaultImage = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjYwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjRjVGNUY1Ii8+CjxwYXRoIGQ9Ik0yNSAyMkMxNy44MjAzIDIyIDEyIDI3LjgyMDMgMTIgMzVDMTIgNDIuMTc5NyAxNy44MjAzIDQ4IDI1IDQ4QzMyLjE3OTcgNDggMzggNDIuMTc5NyAzOCAzNUMzOCAyNy44MjAzIDMyLjE3OTcgMjIgMjUgMjJaIiBmaWxsPSIjQ0NDQ0NDIi8+CjxwYXRoIGQ9Ik0zNSAzOEMzNSAzMy41ODE3IDMwLjQxODMgMzAgMjYgMzBDMjEuNTgxNyAzMCAxOSAzMy41ODE3IDE5IDM4QzE5IDQyLjQxODMgMjEuNTgxNyA0NiAyNiA0NkMzMC40MTgzIDQ2IDMzIDQyLjQxODMgMzMgMzhDMzMgMzMuNTgxNyAzMC40MTgzIDMwIDM1IDMwWiIgZmlsbD0iI0NDQ0NDQyIvPgo8L3N2Zz4K'
</script>

<style lang="scss" scoped>
.access-record-table {
  .user-info {
    display: flex;
    align-items: center;
    gap: 12px;

    .user-details {
      .user-name {
        font-weight: 600;
        color: $text-primary;
        margin-bottom: 2px;
      }

      .user-dept {
        font-size: $font-size-xs;
        color: $text-secondary;
      }
    }
  }

  .time-info {
    .time-main {
      font-weight: 600;
      color: $text-primary;
      margin-bottom: 2px;
    }

    .time-sub {
      font-size: $font-size-xs;
      color: $text-secondary;
    }
  }

  .device-info {
    .device-name {
      font-weight: 600;
      color: $text-primary;
      margin-bottom: 2px;
    }

    .device-location {
      font-size: $font-size-xs;
      color: $text-secondary;
    }
  }

  .no-image {
    color: $text-disabled;
    font-size: $font-size-xs;
  }
}

// è¡¨æ ¼è¡Œæ ·å¼å¢å¼º
:deep(.ant-table-tbody > tr) {
  &:hover {
    background-color: #fafafa;
  }

  &.failed-row {
    background-color: #fff2f0;

    &:hover {
      background-color: #ffebe8;
    }
  }

  &.alarm-row {
    background-color: #fffbe6;

    &:hover {
      background-color: #fff7e6;
    }
  }
}
</style>
```

### 4.2 ä¸šåŠ¡ç»„ä»¶

#### 4.2.1 è®¾å¤‡åœ°å›¾ç»„ä»¶
```vue
<template>
  <div class="device-map">
    <div class="map-container" ref="mapContainer"></div>

    <!-- è®¾å¤‡ä¿¡æ¯å¼¹çª— -->
    <div
      class="device-popup"
      v-show="selectedDevice"
      :style="popupStyle"
    >
      <div class="popup-header">
        <h4>{{ selectedDevice.deviceName }}</h4>
        <a-button type="text" size="small" @click="closePopup">
          <CloseOutlined />
        </a-button>
      </div>
      <div class="popup-content">
        <div class="device-status">
          <DeviceStatusIndicator :status="selectedDevice.status" />
        </div>
        <div class="device-info">
          <div class="info-item">
            <span class="label">è®¾å¤‡ç¼–å·:</span>
            <span class="value">{{ selectedDevice.deviceCode }}</span>
          </div>
          <div class="info-item">
            <span class="label">å®‰è£…ä½ç½®:</span>
            <span class="value">{{ selectedDevice.installLocation }}</span>
          </div>
          <div class="info-item">
            <span class="label">ä»Šæ—¥é€šè¡Œ:</span>
            <span class="value">{{ selectedDevice.todayPassCount }}æ¬¡</span>
          </div>
        </div>
        <div class="popup-actions">
          <a-button type="primary" size="small" @click="handleControl">
            è¿œç¨‹æ§åˆ¶
          </a-button>
          <a-button size="small" @click="handleViewDetail">
            æŸ¥çœ‹è¯¦æƒ…
          </a-button>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, onMounted, nextTick } from 'vue'
import * as echarts from 'echarts'

const props = defineProps({
  devices: {
    type: Array,
    default: () => []
  }
})

const emit = defineEmits(['device-click', 'control', 'view-detail'])

const mapContainer = ref(null)
const selectedDevice = ref(null)
const popupStyle = ref({})

let chart = null

onMounted(() => {
  initMap()
})

const initMap = () => {
  nextTick(() => {
    if (mapContainer.value) {
      chart = echarts.init(mapContainer.value)
      updateMap()

      // ç›‘å¬çª—å£å¤§å°å˜åŒ–
      window.addEventListener('resize', handleResize)
    }
  })
}

const updateMap = () => {
  if (!chart) return

  // è®¾å¤‡æ•°æ®è½¬æ¢ä¸ºåœ°å›¾ç‚¹ä½
  const points = props.devices.map(device => ({
    name: device.deviceName,
    value: [device.longitude, device.latitude],
    itemStyle: {
      color: getDeviceColor(device.status)
    },
    device: device
  }))

  const option = {
    title: {
      text: 'å›­åŒºè®¾å¤‡åˆ†å¸ƒå›¾',
      left: 'center',
      textStyle: {
        fontSize: 16,
        fontWeight: 600
      }
    },
    tooltip: {
      trigger: 'item',
      formatter: (params) => {
        const device = params.data.device
        return `
          <div style="padding: 8px;">
            <div style="font-weight: 600; margin-bottom: 4px;">${device.deviceName}</div>
            <div>çŠ¶æ€: ${getStatusText(device.status)}</div>
            <div>ä½ç½®: ${device.installLocation}</div>
            <div>ä»Šæ—¥é€šè¡Œ: ${device.todayPassCount}æ¬¡</div>
          </div>
        `
      }
    },
    geo: {
      map: 'å›­åŒº',
      roam: true,
      zoom: 1,
      center: [116.404, 39.915],
      itemStyle: {
        areaColor: '#f3f3f3',
        borderColor: '#999'
      }
    },
    series: [
      {
        type: 'scatter',
        coordinateSystem: 'geo',
        data: points,
        symbolSize: 12,
        symbol: 'circle',
        emphasis: {
          scale: 1.5,
          itemStyle: {
            borderColor: '#333',
            borderWidth: 2
          }
        }
      }
    ]
  }

  chart.setOption(option)

  // ç‚¹å‡»äº‹ä»¶
  chart.on('click', (params) => {
    if (params.data && params.data.device) {
      handleDeviceClick(params.data.device, params.event)
    }
  })
}

const handleDeviceClick = (device, event) => {
  selectedDevice.value = device
  emit('device-click', device)

  // è®¡ç®—å¼¹çª—ä½ç½®
  if (event && event.event) {
    const { offsetX, offsetY } = event.event
    popupStyle.value = {
      left: `${offsetX + 10}px`,
      top: `${offsetY - 50}px`
    }
  }
}

const closePopup = () => {
  selectedDevice.value = null
}

const handleControl = () => {
  emit('control', selectedDevice.value)
  closePopup()
}

const handleViewDetail = () => {
  emit('view-detail', selectedDevice.value)
  closePopup()
}

const getDeviceColor = (status) => {
  const colorMap = {
    1: '#52c41a', // åœ¨çº¿ - ç»¿è‰²
    0: '#d9d9d9', // ç¦»çº¿ - ç°è‰²
    2: '#ff4d4f', // æ•…éšœ - çº¢è‰²
    3: '#faad14'  // ç»´æŠ¤ - æ©™è‰²
  }
  return colorMap[status] || '#d9d9d9'
}

const getStatusText = (status) => {
  const textMap = {
    1: 'åœ¨çº¿',
    0: 'ç¦»çº¿',
    2: 'æ•…éšœ',
    3: 'ç»´æŠ¤'
  }
  return textMap[status] || 'æœªçŸ¥'
}

const handleResize = () => {
  if (chart) {
    chart.resize()
  }
}

// ç›‘å¬è®¾å¤‡æ•°æ®å˜åŒ–
watch(() => props.devices, () => {
  updateMap()
}, { deep: true })
</script>

<style lang="scss" scoped>
.device-map {
  position: relative;
  width: 100%;
  height: 400px;

  .map-container {
    width: 100%;
    height: 100%;
  }

  .device-popup {
    position: absolute;
    background: white;
    border: 1px solid #d9d9d9;
    border-radius: 6px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    padding: 0;
    min-width: 280px;
    z-index: 1000;

    .popup-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      border-bottom: 1px solid #f0f0f0;

      h4 {
        margin: 0;
        font-size: $font-size-base;
        font-weight: 600;
      }
    }

    .popup-content {
      padding: 16px;

      .device-status {
        margin-bottom: 12px;
      }

      .device-info {
        margin-bottom: 16px;

        .info-item {
          display: flex;
          justify-content: space-between;
          margin-bottom: 8px;

          .label {
            color: $text-secondary;
            font-size: $font-size-sm;
          }

          .value {
            color: $text-primary;
            font-weight: 500;
            font-size: $font-size-sm;
          }
        }
      }

      .popup-actions {
        display: flex;
        gap: 8px;
      }
    }
  }
}
</style>
```

#### 4.2.2 æƒé™æ—¶é—´èŒƒå›´é€‰æ‹©å™¨
```vue
<template>
  <div class="time-range-selector">
    <div class="weekdays-section">
      <h4>é€šè¡Œæ—¥æœŸ</h4>
      <a-checkbox-group v-model:value="selectedWeekdays">
        <a-checkbox
          v-for="day in weekdays"
          :key="day.value"
          :value="day.value"
        >
          {{ day.label }}
        </a-checkbox>
      </a-checkbox-group>
    </div>

    <div class="time-ranges-section">
      <h4>é€šè¡Œæ—¶æ®µ</h4>
      <div class="time-ranges-list">
        <div
          v-for="(range, index) in timeRanges"
          :key="index"
          class="time-range-item"
        >
          <a-time-picker
            v-model:value="range.startTime"
            format="HH:mm"
            placeholder="å¼€å§‹æ—¶é—´"
          />
          <span class="time-separator">è‡³</span>
          <a-time-picker
            v-model:value="range.endTime"
            format="HH:mm"
            placeholder="ç»“æŸæ—¶é—´"
          />
          <a-button
            type="text"
            danger
            @click="removeTimeRange(index)"
            v-if="timeRanges.length > 1"
          >
            <DeleteOutlined />
          </a-button>
        </div>
      </div>

      <a-button
        type="dashed"
        @click="addTimeRange"
        style="width: 100%; margin-top: 12px;"
      >
        <PlusOutlined /> æ·»åŠ æ—¶æ®µ
      </a-button>
    </div>

    <!-- å¿«æ·é…ç½® -->
    <div class="quick-config-section">
      <h4>å¿«æ·é…ç½®</h4>
      <a-space direction="vertical" style="width: 100%;">
        <a-button @click="setWorkingHours">
          å·¥ä½œæ—¶é—´ (9:00-18:00)
        </a-button>
        <a-button @click="setAllDay">
          å…¨å¤©é€šè¡Œ
        </a-button>
        <a-button @click="clearAll">
          æ¸…ç©ºé…ç½®
        </a-button>
      </a-space>
    </div>
  </div>
</template>

<script setup>
import { ref, watch } from 'vue'

const props = defineProps({
  value: {
    type: Object,
    default: () => ({
      weekdays: [],
      timeRanges: [{ startTime: null, endTime: null }]
    })
  },
  showWeekday: {
    type: Boolean,
    default: true
  }
})

const emit = defineEmits(['update:value', 'change'])

const selectedWeekdays = ref([])
const timeRanges = ref([{ startTime: null, endTime: null }])

const weekdays = [
  { label: 'å‘¨ä¸€', value: 1 },
  { label: 'å‘¨äºŒ', value: 2 },
  { label: 'å‘¨ä¸‰', value: 3 },
  { label: 'å‘¨å››', value: 4 },
  { label: 'å‘¨äº”', value: 5 },
  { label: 'å‘¨å…­', value: 6 },
  { label: 'å‘¨æ—¥', value: 0 }
]

// ç›‘å¬å˜åŒ–å¹¶emit
watch([selectedWeekdays, timeRanges], () => {
  const newValue = {
    weekdays: selectedWeekdays.value,
    timeRanges: timeRanges.value
  }
  emit('update:value', newValue)
  emit('change', newValue)
}, { deep: true })

// æ·»åŠ æ—¶æ®µ
const addTimeRange = () => {
  timeRanges.value.push({ startTime: null, endTime: null })
}

// ç§»é™¤æ—¶æ®µ
const removeTimeRange = (index) => {
  timeRanges.value.splice(index, 1)
}

// å·¥ä½œæ—¶é—´é…ç½®
const setWorkingHours = () => {
  selectedWeekdays.value = [1, 2, 3, 4, 5]
  timeRanges.value = [
    { startTime: '09:00', endTime: '18:00' }
  ]
}

// å…¨å¤©é€šè¡Œ
const setAllDay = () => {
  selectedWeekdays.value = [0, 1, 2, 3, 4, 5, 6]
  timeRanges.value = [
    { startTime: '00:00', endTime: '23:59' }
  ]
}

// æ¸…ç©ºé…ç½®
const clearAll = () => {
  selectedWeekdays.value = []
  timeRanges.value = [{ startTime: null, endTime: null }]
}

// åˆå§‹åŒ–å€¼
if (props.value) {
  selectedWeekdays.value = props.value.weekdays || []
  timeRanges.value = props.value.timeRanges || [{ startTime: null, endTime: null }]
}
</script>

<style lang="scss" scoped>
.time-range-selector {
  .weekdays-section, .time-ranges-section, .quick-config-section {
    margin-bottom: 24px;

    h4 {
      margin-bottom: 12px;
      font-size: $font-size-base;
      font-weight: 600;
      color: $text-primary;
    }
  }

  .weekdays-section {
    .ant-checkbox-group {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
    }
  }

  .time-ranges-list {
    .time-range-item {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 12px;
      padding: 12px;
      border: 1px solid #f0f0f0;
      border-radius: 6px;

      .time-separator {
        color: $text-secondary;
        font-weight: 500;
      }

      .ant-time-picker {
        flex: 1;
      }
    }
  }

  .quick-config-section {
    .ant-btn {
      width: 100%;
      justify-content: flex-start;
    }
  }
}
</style>
```

---

## 5. ç§»åŠ¨ç«¯é€‚é…

### 5.1 å“åº”å¼æ–­ç‚¹
```scss
// å“åº”å¼æ–­ç‚¹
$breakpoints: (
  xs: 480px,
  sm: 576px,
  md: 768px,
  lg: 992px,
  xl: 1200px,
  xxl: 1600px
);

// åª’ä½“æŸ¥è¯¢æ··å…¥
@mixin respond-to($breakpoint) {
  @if map-has-key($breakpoints, $breakpoint) {
    @media (max-width: map-get($breakpoints, $breakpoint)) {
      @content;
    }
  }
}

// ä½¿ç”¨ç¤ºä¾‹
.container {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 24px;

  @include respond-to(md) {
    grid-template-columns: repeat(2, 1fr);
    gap: 16px;
  }

  @include respond-to(sm) {
    grid-template-columns: 1fr;
    gap: 12px;
  }
}
```

### 5.2 ç§»åŠ¨ç«¯å¯¼èˆªä¼˜åŒ–
```vue
<template>
  <div class="mobile-access-layout">
    <!-- é¡¶éƒ¨å¯¼èˆª -->
    <div class="mobile-header">
      <div class="header-left">
        <a-button type="text" @click="showSidebar = true">
          <MenuOutlined />
        </a-button>
      </div>
      <div class="header-title">é—¨ç¦ç®¡ç†</div>
      <div class="header-right">
        <a-badge :count="alertCount" :offset="[5, -5]">
          <a-button type="text" @click="showNotifications = true">
            <BellOutlined />
          </a-button>
        </a-badge>
      </div>
    </div>

    <!-- ä¾§è¾¹æ  -->
    <a-drawer
      v-model:visible="showSidebar"
      placement="left"
      :closable="false"
      :body-style="{ padding: 0 }"
    >
      <MobileSideMenu @select="handleMenuSelect" />
    </a-drawer>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <div class="mobile-content">
      <router-view />
    </div>

    <!-- åº•éƒ¨å¯¼èˆª -->
    <div class="mobile-bottom-nav">
      <a-tab-bar v-model:activeKey="activeTab" @change="handleTabChange">
        <a-tab-bar-item key="overview">
          <template #icon>
            <DashboardOutlined />
          </template>
          æ€»è§ˆ
        </a-tab-bar-item>
        <a-tab-bar-item key="records">
          <template #icon>
            <HistoryOutlined />
          </template>
          è®°å½•
        </a-tab-bar-item>
        <a-tab-bar-item key="devices">
          <template #icon>
            <MobileOutlined />
          </template>
          è®¾å¤‡
        </a-tab-bar-item>
        <a-tab-bar-item key="profile">
          <template #icon>
            <UserOutlined />
          </template>
          æˆ‘çš„
        </a-tab-bar-item>
      </a-tab-bar>
    </div>

    <!-- é€šçŸ¥æŠ½å±‰ -->
    <a-drawer
      v-model:visible="showNotifications"
      placement="right"
      title="é€šçŸ¥æ¶ˆæ¯"
      :body-style="{ padding: 0 }"
    >
      <NotificationList />
    </a-drawer>
  </div>
</template>

<script setup>
import { ref, computed } from 'vue'
import { useRoute, useRouter } from 'vue-router'

const route = useRoute()
const router = useRouter()

const showSidebar = ref(false)
const showNotifications = ref(false)
const alertCount = ref(3)

const activeTab = computed(() => {
  const path = route.path
  if (path.includes('/overview')) return 'overview'
  if (path.includes('/records')) return 'records'
  if (path.includes('/devices')) return 'devices'
  if (path.includes('/profile')) return 'profile'
  return 'overview'
})

const handleMenuSelect = (key) => {
  showSidebar.value = false
  router.push(key)
}

const handleTabChange = (key) => {
  router.push(`/access/${key}`)
}
</script>

<style lang="scss" scoped>
.mobile-access-layout {
  display: flex;
  flex-direction: column;
  height: 100vh;

  .mobile-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 16px;
    background: white;
    border-bottom: 1px solid #f0f0f0;
    position: sticky;
    top: 0;
    z-index: 100;

    .header-title {
      font-size: 18px;
      font-weight: 600;
      color: $text-primary;
    }
  }

  .mobile-content {
    flex: 1;
    overflow-y: auto;
    background: $bg-color;
  }

  .mobile-bottom-nav {
    background: white;
    border-top: 1px solid #f0f0f0;
  }
}
</style>
```

### 5.3 ç§»åŠ¨ç«¯å¡ç‰‡ä¼˜åŒ–
```vue
<template>
  <div class="mobile-device-card">
    <div class="card-header">
      <div class="device-info">
        <div class="device-name">{{ device.deviceName }}</div>
        <div class="device-code">{{ device.deviceCode }}</div>
      </div>
      <DeviceStatusIndicator :status="device.status" />
    </div>

    <div class="card-content">
      <div class="info-grid">
        <div class="info-item">
          <div class="label">è®¾å¤‡ç±»å‹</div>
          <div class="value">{{ getDeviceTypeText(device.deviceType) }}</div>
        </div>
        <div class="info-item">
          <div class="label">å®‰è£…ä½ç½®</div>
          <div class="value">{{ device.installLocation }}</div>
        </div>
        <div class="info-item">
          <div class="label">ä»Šæ—¥é€šè¡Œ</div>
          <div class="value highlight">{{ device.todayPassCount }}æ¬¡</div>
        </div>
        <div class="info-item">
          <div class="label">æœ€ååœ¨çº¿</div>
          <div class="value">{{ formatDateTime(device.lastOnlineTime) }}</div>
        </div>
      </div>
    </div>

    <div class="card-actions">
      <a-space>
        <a-button size="small" @click="handleView">æŸ¥çœ‹</a-button>
        <a-button type="primary" size="small" @click="handleControl">æ§åˆ¶</a-button>
      </a-space>
    </div>
  </div>
</template>

<style lang="scss" scoped>
.mobile-device-card {
  background: white;
  border-radius: 8px;
  padding: 16px;
  margin-bottom: 12px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);

  .card-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;

    .device-info {
      .device-name {
        font-size: 16px;
        font-weight: 600;
        color: $text-primary;
        margin-bottom: 4px;
      }

      .device-code {
        font-size: 12px;
        color: $text-secondary;
      }
    }
  }

  .card-content {
    margin-bottom: 16px;

    .info-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;

      .info-item {
        .label {
          font-size: 12px;
          color: $text-secondary;
          margin-bottom: 4px;
        }

        .value {
          font-size: 14px;
          color: $text-primary;
          font-weight: 500;

          &.highlight {
            color: $primary-color;
            font-weight: 600;
          }
        }
      }
    }
  }

  .card-actions {
    display: flex;
    justify-content: flex-end;

    .ant-space {
      width: 100%;
      justify-content: flex-end;
    }
  }
}
</style>
```

---

## 6. ä¸»é¢˜å’Œæ ·å¼ç³»ç»Ÿ

### 6.1 ä¸»é¢˜é…ç½®
```scss
// ä¸»é¢˜å˜é‡
:root {
  // ä¸»è‰²è°ƒ
  --primary-color: #1890ff;
  --primary-color-hover: #40a9ff;
  --primary-color-active: #096dd9;
  --primary-color-bg: #e6f7ff;

  // åŠŸèƒ½è‰²å½©
  --success-color: #52c41a;
  --warning-color: #faad14;
  --error-color: #ff4d4f;
  --info-color: #1890ff;

  // ä¸­æ€§è‰²å½©
  --text-color: #262626;
  --text-color-secondary: #595959;
  --text-color-disabled: #bfbfbf;
  --border-color: #d9d9d9;
  --background-color: #f0f2f5;

  // åœ†è§’
  --border-radius-sm: 4px;
  --border-radius-base: 6px;
  --border-radius-lg: 8px;

  // é—´è·
  --spacing-xs: 4px;
  --spacing-sm: 8px;
  --spacing-base: 16px;
  --spacing-lg: 24px;
  --spacing-xl: 32px;

  // é˜´å½±
  --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.1);
  --shadow-base: 0 4px 8px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 8px 16px rgba(0, 0, 0, 0.1);
}

// æš—è‰²ä¸»é¢˜
[data-theme='dark'] {
  --text-color: #ffffff;
  --text-color-secondary: #a6a6a6;
  --border-color: #434343;
  --background-color: #141414;
}

// è‡ªå®šä¹‰ä¸»é¢˜
.theme-custom {
  --primary-color: #722ed1;
  --primary-color-hover: #9254de;
  --primary-color-active: #531dab;
  --primary-color-bg: #f9f0ff;
}
```

### 6.2 æ ·å¼è§„èŒƒ
```scss
// é€šç”¨æ ·å¼ç±»
.text-center { text-align: center; }
.text-left { text-align: left; }
.text-right { text-align: right; }

.flex-center {
  display: flex;
  align-items: center;
  justify-content: center;
}

.flex-between {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.flex-start {
  display: flex;
  align-items: center;
  justify-content: flex-start;
}

.flex-end {
  display: flex;
  align-items: center;
  justify-content: flex-end;
}

// é—´è·ç±»
.m-0 { margin: 0; }
.m-1 { margin: var(--spacing-xs); }
.m-2 { margin: var(--spacing-sm); }
.m-3 { margin: var(--spacing-base); }
.m-4 { margin: var(--spacing-lg); }

.p-0 { padding: 0; }
.p-1 { padding: var(--spacing-xs); }
.p-2 { padding: var(--spacing-sm); }
.p-3 { padding: var(--spacing-base); }
.p-4 { padding: var(--spacing-lg); }

// æ–‡å­—é¢œè‰²
.text-primary { color: var(--text-color); }
.text-secondary { color: var(--text-color-secondary); }
.text-success { color: var(--success-color); }
.text-warning { color: var(--warning-color); }
.text-error { color: var(--error-color); }

// èƒŒæ™¯è‰²
.bg-white { background-color: white; }
.bg-primary { background-color: var(--primary-color-bg); }
.bg-success { background-color: #f6ffed; }
.bg-warning { background-color: #fffbe6; }
.bg-error { background-color: #fff2f0; }

// åœ†è§’
.rounded-sm { border-radius: var(--border-radius-sm); }
.rounded { border-radius: var(--border-radius-base); }
.rounded-lg { border-radius: var(--border-radius-lg); }

// é˜´å½±
.shadow-sm { box-shadow: var(--shadow-sm); }
.shadow { box-shadow: var(--shadow-base); }
.shadow-lg { box-shadow: var(--shadow-lg); }

// è¿‡æ¸¡åŠ¨ç”»
.transition { transition: all 0.3s ease; }
.transition-fast { transition: all 0.15s ease; }
.transition-slow { transition: all 0.5s ease; }
```

---

## 7. æ€§èƒ½ä¼˜åŒ–

### 7.1 ç»„ä»¶æ‡’åŠ è½½
```javascript
// è·¯ç”±æ‡’åŠ è½½
const routes = [
  {
    path: '/access',
    name: 'Access',
    component: () => import('@/views/access/AccessLayout.vue'),
    children: [
      {
        path: 'overview',
        name: 'AccessOverview',
        component: () => import('@/views/access/Overview.vue')
      },
      {
        path: 'devices',
        name: 'AccessDevices',
        component: () => import('@/views/access/DeviceManagement.vue')
      }
    ]
  }
]

// ç»„ä»¶æ‡’åŠ è½½
export default {
  components: {
    DeviceMap: defineAsyncComponent(() => import('./DeviceMap.vue')),
    RealTimeMonitor: defineAsyncComponent(() => import('./RealTimeMonitor.vue'))
  }
}
```

### 7.2 è™šæ‹Ÿæ»šåŠ¨
```vue
<template>
  <div class="virtual-list-container">
    <a-virtual-list
      :data="recordList"
      :height="600"
      :item-height="80"
      :item-key="record => record.id"
    >
      <template #item="{ record, index }">
        <div class="record-item">
          <!-- è®°å½•å†…å®¹ -->
        </div>
      </template>
    </a-virtual-list>
  </div>
</template>
```

### 7.3 é˜²æŠ–å’ŒèŠ‚æµ
```javascript
// é˜²æŠ–æœç´¢
import { debounce } from 'lodash-es'

export default {
  methods: {
    handleSearch: debounce(function(query) {
      this.searchQuery = query
      this.fetchData()
    }, 300)
  }
}

// èŠ‚æµæ»šåŠ¨
import { throttle } from 'lodash-es'

export default {
  mounted() {
    this.handleScroll = throttle(this.onScroll, 100)
    window.addEventListener('scroll', this.handleScroll)
  },

  beforeUnmount() {
    window.removeEventListener('scroll', this.handleScroll)
  }
}
```

---

## 8. å›½é™…åŒ–æ”¯æŒ

### 8.1 è¯­è¨€é…ç½®
```javascript
// i18n/access/en.js
export default {
  access: {
    title: 'Access Control',
    overview: 'Overview',
    devices: 'Device Management',
    records: 'Access Records',
    permissions: 'Permission Management',

    device: {
      name: 'Device Name',
      code: 'Device Code',
      type: 'Device Type',
      status: 'Status',
      location: 'Location',
      online: 'Online',
      offline: 'Offline',
      error: 'Error',
      maintenance: 'Maintenance'
    },

    record: {
      user: 'User',
      time: 'Time',
      status: 'Status',
      method: 'Verify Method',
      success: 'Success',
      failed: 'Failed',
      alarm: 'Alarm'
    }
  }
}
```

### 8.2 å¤šè¯­è¨€åˆ‡æ¢
```vue
<template>
  <div class="language-switcher">
    <a-select
      v-model:value="currentLang"
      style="width: 120px"
      @change="handleLanguageChange"
    >
      <a-select-option value="zh-CN">ä¸­æ–‡</a-select-option>
      <a-select-option value="en-US">English</a-select-option>
    </a-select>
  </div>
</template>

<script setup>
import { computed } from 'vue'
import { useI18n } from 'vue-i18n'

const { locale } = useI18n()

const currentLang = computed({
  get: () => locale.value,
  set: (value) => locale.value = value
})

const handleLanguageChange = (lang) => {
  locale.value = lang
  localStorage.setItem('language', lang)
}
</script>
```

---

## 9. æ— éšœç¢è®¿é—®

### 9.1 ARIAæ ‡ç­¾
```vue
<template>
  <div class="access-control" role="main" aria-label="é—¨ç¦ç®¡ç†ç³»ç»Ÿ">
    <nav aria-label="ä¸»å¯¼èˆª">
      <ul role="menubar">
        <li role="menuitem">
          <router-link to="/access/overview" aria-current="page">
            é—¨ç¦æ€»è§ˆ
          </router-link>
        </li>
      </ul>
    </nav>

    <main>
      <h1 id="page-title">è®¾å¤‡ç®¡ç†</h1>

      <table
        role="table"
        aria-labelledby="page-title"
        aria-describedby="table-description"
      >
        <caption id="table-description">é—¨ç¦è®¾å¤‡åˆ—è¡¨ï¼Œæ˜¾ç¤ºè®¾å¤‡çŠ¶æ€å’Œæ“ä½œ</caption>
        <thead>
          <tr>
            <th scope="col">è®¾å¤‡åç§°</th>
            <th scope="col">è®¾å¤‡çŠ¶æ€</th>
            <th scope="col">æ“ä½œ</th>
          </tr>
        </thead>
        <tbody>
          <tr v-for="device in devices" :key="device.id">
            <td>{{ device.name }}</td>
            <td>
              <span
                :aria-label="`è®¾å¤‡çŠ¶æ€: ${getDeviceStatusText(device.status)}`"
                :class="getStatusClass(device.status)"
              >
                {{ getDeviceStatusText(device.status) }}
              </span>
            </td>
            <td>
              <button
                @click="handleControl(device)"
                :aria-label="`æ§åˆ¶è®¾å¤‡ ${device.name}`"
              >
                æ§åˆ¶
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </main>
  </div>
</template>
```

### 9.2 é”®ç›˜å¯¼èˆª
```vue
<template>
  <div class="accessible-table">
    <table
      tabindex="0"
      @keydown="handleKeydown"
      @keyup="handleKeyup"
    >
      <!-- è¡¨æ ¼å†…å®¹ -->
    </table>
  </div>
</template>

<script setup>
const handleKeydown = (event) => {
  const { key } = event

  switch (key) {
    case 'ArrowUp':
      event.preventDefault()
      navigateRow(-1)
      break
    case 'ArrowDown':
      event.preventDefault()
      navigateRow(1)
      break
    case 'Enter':
    case ' ':
      event.preventDefault()
      activateRow()
      break
  }
}

const navigateRow = (direction) => {
  // å®ç°è¡Œå¯¼èˆªé€»è¾‘
}

const activateRow = () => {
  // æ¿€æ´»å½“å‰è¡Œ
}
</script>
```

---

## 10. é”™è¯¯å¤„ç†å’Œé™çº§

### 10.1 é”™è¯¯è¾¹ç•Œ
```vue
<template>
  <div class="error-boundary">
    <slot v-if="!hasError" />
    <div v-else class="error-fallback">
      <a-result
        status="error"
        title="é¡µé¢åŠ è½½å¤±è´¥"
        :sub-title="errorMessage"
      >
        <template #extra>
          <a-button type="primary" @click="retry">
            é‡è¯•
          </a-button>
          <a-button @click="goHome">
            è¿”å›é¦–é¡µ
          </a-button>
        </template>
      </a-result>
    </div>
  </div>
</template>

<script setup>
import { ref, onErrorCaptured } from 'vue'

const hasError = ref(false)
const errorMessage = ref('')

onErrorCaptured((error) => {
  hasError.value = true
  errorMessage.value = error.message
  console.error('Component error:', error)

  // ä¸ŠæŠ¥é”™è¯¯
  reportError(error)

  return false
})

const retry = () => {
  hasError.value = false
  errorMessage.value = ''
}

const goHome = () => {
  window.location.href = '/'
}
</script>
```

### 10.2 ç½‘ç»œå¼‚å¸¸å¤„ç†
```javascript
// APIé”™è¯¯å¤„ç†
import { message } from 'ant-design-vue'

export const handleApiError = (error) => {
  const { response, message: errorMessage } = error

  if (response) {
    switch (response.status) {
      case 401:
        message.error('ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•')
        // è·³è½¬åˆ°ç™»å½•é¡µ
        break
      case 403:
        message.error('æ²¡æœ‰æƒé™è®¿é—®è¯¥èµ„æº')
        break
      case 404:
        message.error('è¯·æ±‚çš„èµ„æºä¸å­˜åœ¨')
        break
      case 500:
        message.error('æœåŠ¡å™¨å†…éƒ¨é”™è¯¯')
        break
      default:
        message.error(response.data?.message || 'è¯·æ±‚å¤±è´¥')
    }
  } else if (errorMessage) {
    message.error('ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè®¾ç½®')
  }
}

// ç½‘ç»œçŠ¶æ€ç›‘å¬
export const setupNetworkListener = () => {
  const updateOnlineStatus = () => {
    if (!navigator.onLine) {
      message.warning('ç½‘ç»œè¿æ¥å·²æ–­å¼€ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨', 5)
    } else {
      message.success('ç½‘ç»œè¿æ¥å·²æ¢å¤')
    }
  }

  window.addEventListener('online', updateOnlineStatus)
  window.addEventListener('offline', updateOnlineStatus)
}
```

---

## 11. å•å…ƒæµ‹è¯•

### 11.1 ç»„ä»¶æµ‹è¯•
```javascript
// AccessRecordTable.test.js
import { mount } from '@vue/test-utils'
import AccessRecordTable from '@/components/AccessRecordTable.vue'

describe('AccessRecordTable', () => {
  const mockRecords = [
    {
      id: 1,
      userName: 'å¼ ä¸‰',
      deviceName: 'ä¸»å…¥å£é—¨ç¦',
      punchTime: '2025-12-16 09:00:00',
      status: 'SUCCESS',
      verifyMethods: ['FACE', 'CARD']
    }
  ]

  it('renders correctly with records', () => {
    const wrapper = mount(AccessRecordTable, {
      props: {
        records: mockRecords
      }
    })

    expect(wrapper.find('.access-record-table').exists()).toBe(true)
    expect(wrapper.text()).toContain('å¼ ä¸‰')
    expect(wrapper.text()).toContain('ä¸»å…¥å£é—¨ç¦')
  })

  it('emits view-detail event when detail button clicked', async () => {
    const wrapper = mount(AccessRecordTable, {
      props: {
        records: mockRecords
      }
    })

    await wrapper.find('[data-testid="detail-btn"]').trigger('click')

    expect(wrapper.emitted('view-detail')).toBeTruthy()
    expect(wrapper.emitted('view-detail')[0]).toEqual([mockRecords[0]])
  })

  it('applies correct status class for failed records', () => {
    const failedRecords = [
      ...mockRecords,
      { ...mockRecords[0], id: 2, status: 'FAILED' }
    ]

    const wrapper = mount(AccessRecordTable, {
      props: {
        records: failedRecords
      }
    })

    const failedRow = wrapper.findAll('tr')[2]
    expect(failedRow.classes()).toContain('failed-row')
  })
})
```

### 11.2 ç”¨æˆ·äº¤äº’æµ‹è¯•
```javascript
// DeviceControlModal.test.js
import { mount } from '@vue/test-utils'
import DeviceControlModal from '@/components/DeviceControlModal.vue'

describe('DeviceControlModal', () => {
  it('opens modal when visible prop is true', () => {
    const wrapper = mount(DeviceControlModal, {
      props: {
        visible: true,
        device: { id: 1, name: 'æµ‹è¯•è®¾å¤‡' }
      }
    })

    expect(wrapper.find('.ant-modal').exists()).toBe(true)
    expect(wrapper.text()).toContain('æµ‹è¯•è®¾å¤‡')
  })

  it('emits control event when control button clicked', async () => {
    const wrapper = mount(DeviceControlModal, {
      props: {
        visible: true,
        device: { id: 1, name: 'æµ‹è¯•è®¾å¤‡' }
      }
    })

    await wrapper.find('[data-testid="open-door-btn"]').trigger('click')

    expect(wrapper.emitted('control')).toBeTruthy()
    expect(wrapper.emitted('control')[0]).toEqual([{
      deviceId: 1,
      action: 'open'
    }])
  })
})
```

---

## 12. éƒ¨ç½²å’Œæ„å»º

### 12.1 æ„å»ºé…ç½®
```javascript
// vite.config.js
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import { resolve } from 'path'

export default defineConfig({
  plugins: [vue()],
  resolve: {
    alias: {
      '@': resolve(__dirname, 'src'),
      '@components': resolve(__dirname, 'src/components'),
      '@views': resolve(__dirname, 'src/views'),
      '@utils': resolve(__dirname, 'src/utils')
    }
  },
  build: {
    target: 'es2015',
    outDir: 'dist',
    assetsDir: 'static',
    sourcemap: false,
    minify: 'terser',
    terserOptions: {
      compress: {
        drop_console: true,
        drop_debugger: true
      }
    },
    rollupOptions: {
      output: {
        chunkFileNames: 'static/js/[name]-[hash].js',
        entryFileNames: 'static/js/[name]-[hash].js',
        assetFileNames: 'static/[ext]/[name]-[hash].[ext]'
      }
    },
    chunkSizeWarningLimit: 1000
  },
  server: {
    host: true,
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://localhost:8090',
        changeOrigin: true,
        rewrite: (path) => path.replace(/^\/api/, '/api/v1')
      }
    }
  },
  define: {
    __VUE_PROD_DEVTOOLS__: false
  }
})
```

### 12.2 ç¯å¢ƒå˜é‡é…ç½®
```javascript
// .env.development
VITE_APP_TITLE=IOE-DREAMé—¨ç¦ç®¡ç†ç³»ç»Ÿ
VITE_APP_API_BASE_URL=http://localhost:8090/api/v1
VITE_APP_WS_URL=ws://localhost:8090/ws
VITE_APP_UPLOAD_URL=http://localhost:8090/api/v1/file/upload
VITE_APP_MAP_KEY=your_map_key_here

// .env.production
VITE_APP_TITLE=IOE-DREAMé—¨ç¦ç®¡ç†ç³»ç»Ÿ
VITE_APP_API_BASE_URL=https://api.ioedream.com/access/api/v1
VITE_APP_WS_URL=wss://api.ioedream.com/access/ws
VITE_APP_UPLOAD_URL=https://api.ioedream.com/access/api/v1/file/upload
VITE_APP_MAP_KEY=your_production_map_key
```

### 12.3 Dockeréƒ¨ç½²
```dockerfile
# Dockerfile
FROM node:18-alpine as build-stage

WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production

COPY . .
RUN npm run build

FROM nginx:alpine as production-stage

COPY --from=build-stage /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/nginx.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

```nginx
# nginx.conf
server {
    listen 80;
    server_name localhost;
    root /usr/share/nginx/html;
    index index.html;

    location / {
        try_files $uri $uri/ /index.html;
    }

    location /api/ {
        proxy_pass http://backend:8090/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /ws/ {
        proxy_pass http://backend:8090/ws/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
    }

    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;
}
```

---

## 13. æ€»ç»“

### 13.1 æŠ€æœ¯ç‰¹ç‚¹
- **ç°ä»£åŒ–æŠ€æœ¯æ ˆ**: Vue 3 + Composition API + TypeScript
- **å“åº”å¼è®¾è®¡**: æ”¯æŒPCã€å¹³æ¿ã€æ‰‹æœºå¤šç«¯é€‚é…
- **ç»„ä»¶åŒ–å¼€å‘**: é«˜åº¦å¯å¤ç”¨çš„ç»„ä»¶åº“
- **å®æ—¶é€šä¿¡**: WebSocketå®ç°å®æ—¶æ•°æ®æ›´æ–°
- **å›½é™…åŒ–æ”¯æŒ**: å¤šè¯­è¨€åˆ‡æ¢åŠŸèƒ½
- **æ— éšœç¢è®¿é—®**: ç¬¦åˆWCAGæ ‡å‡†
- **æ€§èƒ½ä¼˜åŒ–**: æ‡’åŠ è½½ã€è™šæ‹Ÿæ»šåŠ¨ã€é˜²æŠ–èŠ‚æµ
- **å®Œå–„çš„é”™è¯¯å¤„ç†**: é”™è¯¯è¾¹ç•Œå’Œç½‘ç»œå¼‚å¸¸å¤„ç†

### 13.2 ç”¨æˆ·ä½“éªŒ
- **ç›´è§‚çš„ç•Œé¢è®¾è®¡**: æ¸…æ™°çš„ä¿¡æ¯å±‚çº§å’Œè§†è§‰å¼•å¯¼
- **æµç•…çš„äº¤äº’åŠ¨ç”»**: æå‡ç”¨æˆ·æ“ä½œä½“éªŒ
- **å®æ—¶æ•°æ®æ›´æ–°**: é—¨ç¦çŠ¶æ€å®æ—¶ç›‘æ§
- **ç§»åŠ¨ç«¯ä¼˜åŒ–**: è§¦æ‘¸å‹å¥½çš„ç§»åŠ¨ç«¯ç•Œé¢
- **å¿«æ·æ“ä½œ**: å¸¸ç”¨åŠŸèƒ½ä¸€é”®ç›´è¾¾

### 13.3 å¯ç»´æŠ¤æ€§
- **ç»Ÿä¸€çš„ä»£ç è§„èŒƒ**: ESLint + Prettier
- **å®Œå–„çš„æµ‹è¯•è¦†ç›–**: å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- **è¯¦ç»†çš„æ–‡æ¡£**: ç»„ä»¶æ–‡æ¡£å’Œä½¿ç”¨è¯´æ˜
- **æ¨¡å—åŒ–è®¾è®¡**: åŠŸèƒ½æ¨¡å—æ¸…æ™°åˆ†ç¦»
- **ç‰ˆæœ¬æ§åˆ¶**: Gitå·¥ä½œæµå’Œç‰ˆæœ¬ç®¡ç†

### 13.4 æ‰©å±•æ€§
- **æ’ä»¶åŒ–æ¶æ„**: æ”¯æŒåŠŸèƒ½æ¨¡å—æ’ä»¶åŒ–æ‰©å±•
- **ä¸»é¢˜ç³»ç»Ÿ**: æ”¯æŒè‡ªå®šä¹‰ä¸»é¢˜å’Œæ ·å¼
- **é…ç½®åŒ–**: é€šè¿‡é…ç½®æ–‡ä»¶æ§åˆ¶ç³»ç»Ÿè¡Œä¸º
- **APIæ ‡å‡†åŒ–**: RESTful APIè®¾è®¡ä¾¿äºé›†æˆ
- **å¾®å‰ç«¯æ”¯æŒ**: æ”¯æŒå¾®å‰ç«¯æ¶æ„é›†æˆ

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
**æ›´æ–°æ—¥æœŸ**: 2025-12-16
**ç»´æŠ¤äººå‘˜**: å‰ç«¯å¼€å‘å›¢é˜Ÿ
**å®¡æ ¸äººå‘˜**: æŠ€æœ¯æ¶æ„å¸ˆ