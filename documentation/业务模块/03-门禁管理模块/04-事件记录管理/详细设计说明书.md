# äº‹ä»¶è®°å½•ç®¡ç† - è¯¦ç»†è®¾è®¡è¯´æ˜ä¹¦

> **ç‰ˆæœ¬**: v1.0.0  
> **åˆ›å»ºæ—¥æœŸ**: 2025-12-17

---

## ğŸ“ ç±»ç»“æ„è®¾è®¡

```
net.lab1024.sa.access/
â”œâ”€â”€ controller/
â”‚   â””â”€â”€ AccessRecordController.java
â”œâ”€â”€ service/
â”‚   â”œâ”€â”€ AccessEventService.java
â”‚   â””â”€â”€ impl/
â”‚       â””â”€â”€ AccessEventServiceImpl.java
â”œâ”€â”€ dao/
â”‚   â””â”€â”€ AccessRecordDao.java
â””â”€â”€ domain/
    â””â”€â”€ vo/
        â”œâ”€â”€ AccessRecordVO.java
        â””â”€â”€ AccessRecordStatisticsVO.java
```

---

## ğŸ”Œ æ¥å£è¯¦ç»†è®¾è®¡

### GET /api/access/v1/records

**è¯·æ±‚å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| pageNum | Integer | æ˜¯ | é¡µç  |
| pageSize | Integer | æ˜¯ | æ¯é¡µæ•°é‡ |
| startTime | DateTime | å¦ | å¼€å§‹æ—¶é—´ |
| endTime | DateTime | å¦ | ç»“æŸæ—¶é—´ |
| deviceId | Long | å¦ | è®¾å¤‡ID |
| userId | Long | å¦ | ç”¨æˆ·ID |
| result | Integer | å¦ | ç»“æœ |

**å“åº”æ•°æ®**:
```json
{
  "code": 200,
  "data": {
    "total": 12580,
    "pageNum": 1,
    "pageSize": 20,
    "records": [{
      "id": 1001,
      "deviceName": "ä¸»æ¥¼å‰é—¨",
      "userName": "å¼ ä¸‰",
      "eventType": "ACCESS_GRANTED",
      "verifyMethod": "FACE",
      "result": 1,
      "eventTime": "2025-12-17T10:30:00Z",
      "photoUrl": "https://oss.xxx.com/photo.jpg"
    }]
  }
}
```

---

## ğŸ“Š æ•°æ®åº“è¯¦ç»†è®¾è®¡

### è¡¨: t_access_record

```sql
CREATE TABLE t_access_record (
  id BIGINT PRIMARY KEY AUTO_INCREMENT,
  device_id BIGINT NOT NULL COMMENT 'è®¾å¤‡ID',
  user_id BIGINT COMMENT 'ç”¨æˆ·ID',
  area_id BIGINT COMMENT 'åŒºåŸŸID',
  event_type VARCHAR(50) NOT NULL COMMENT 'äº‹ä»¶ç±»å‹',
  verify_method VARCHAR(30) COMMENT 'éªŒè¯æ–¹å¼',
  result TINYINT NOT NULL DEFAULT 1 COMMENT 'ç»“æœ:1æˆåŠŸ0å¤±è´¥',
  fail_reason VARCHAR(200) COMMENT 'å¤±è´¥åŸå› ',
  event_time DATETIME NOT NULL COMMENT 'äº‹ä»¶æ—¶é—´',
  direction VARCHAR(10) COMMENT 'æ–¹å‘',
  photo_url VARCHAR(500) COMMENT 'ç…§ç‰‡URL',
  card_no VARCHAR(50) COMMENT 'å¡å·',
  create_time DATETIME NOT NULL,
  INDEX idx_device(device_id),
  INDEX idx_user(user_id),
  INDEX idx_time(event_time)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4
PARTITION BY RANGE (TO_DAYS(event_time)) (
  PARTITION p202512 VALUES LESS THAN (TO_DAYS('2026-01-01'))
);
```

---

**ğŸ“ æ–‡æ¡£ç»´æŠ¤**: IOE-DREAMæ¶æ„å›¢é˜Ÿ | 2025-12-17
