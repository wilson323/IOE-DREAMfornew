# 考勤管理模块 - 用户故事文档

> **版本**: v2.0.0  
> **更新日期**: 2025-12-17  
> **文档类型**: 用户故事与用例

---

## 1. 用户角色定义

### 1.1 角色清单

| 角色 | 角色编码 | 说明 |
|------|----------|------|
| 普通员工 | EMPLOYEE | 日常打卡、查看考勤、提交申请 |
| 部门主管 | MANAGER | 部门考勤管理、审批申请、排班 |
| HR管理员 | HR_ADMIN | 规则配置、报表统计、全局管理 |
| 系统管理员 | SYS_ADMIN | 系统配置、设备管理、权限管理 |

### 1.2 角色权限矩阵

| 功能 | 员工 | 主管 | HR | 管理员 |
|------|------|------|-----|--------|
| 打卡 | ✅ | ✅ | ✅ | ✅ |
| 查看个人考勤 | ✅ | ✅ | ✅ | ✅ |
| 查看部门考勤 | ❌ | ✅ | ✅ | ✅ |
| 提交异常申请 | ✅ | ✅ | ✅ | ✅ |
| 审批申请 | ❌ | ✅ | ✅ | ✅ |
| 排班管理 | ❌ | ✅ | ✅ | ✅ |
| 规则配置 | ❌ | ❌ | ✅ | ✅ |
| 报表统计 | ❌ | ✅ | ✅ | ✅ |
| 系统配置 | ❌ | ❌ | ❌ | ✅ |

---

## 2. 用户故事 - 班次时间管理

### US-ATT-001: 创建时间段

**作为** HR管理员  
**我希望** 能够创建工作时间段配置  
**以便** 为班次管理提供基础时间定义

**验收标准**:
- [ ] 可以设置时间段名称和编码
- [ ] 可以配置开始时间和结束时间
- [ ] 可以设置迟到/早退容忍时间
- [ ] 可以配置是否必须签到/签退
- [ ] 时间段编码唯一性校验
- [ ] 支持跨日时间段（如22:00-06:00）

**优先级**: P0  
**故事点**: 3

---

### US-ATT-002: 创建班次

**作为** HR管理员  
**我希望** 能够创建各类班次配置  
**以便** 满足不同岗位的排班需求

**验收标准**:
- [ ] 可以设置班次名称和编码
- [ ] 可以选择班次类型（规律/弹性/轮班）
- [ ] 可以配置轮班周期
- [ ] 可以设置弹性时间和核心时间
- [ ] 可以关联多个时间段
- [ ] 支持班次复制功能

**优先级**: P0  
**故事点**: 5

---

### US-ATT-003: 配置班次时间段

**作为** HR管理员  
**我希望** 能够为班次配置关联的时间段  
**以便** 定义完整的班次工作时间

**验收标准**:
- [ ] 可以为班次添加多个时间段
- [ ] 可以调整时间段顺序
- [ ] 系统自动检测时间冲突
- [ ] 可以预览班次时间线
- [ ] 支持批量操作

**优先级**: P0  
**故事点**: 3

---

## 3. 用户故事 - 排班管理

### US-ATT-004: 查看排班日历

**作为** 部门主管  
**我希望** 能够以日历形式查看部门排班情况  
**以便** 了解人员安排并进行调整

**验收标准**:
- [ ] 支持月历/周历视图切换
- [ ] 可以按部门/员工筛选
- [ ] 显示员工班次和状态
- [ ] 支持点击查看排班详情
- [ ] 不同班次用不同颜色区分

**优先级**: P0  
**故事点**: 5

---

### US-ATT-005: 手动排班

**作为** 部门主管  
**我希望** 能够为员工手动安排班次  
**以便** 灵活调整人员排班

**验收标准**:
- [ ] 可以选择员工和日期
- [ ] 可以选择班次
- [ ] 系统检测排班冲突
- [ ] 支持拖拽式排班
- [ ] 排班变更实时生效

**优先级**: P0  
**故事点**: 5

---

### US-ATT-006: 批量排班

**作为** HR管理员  
**我希望** 能够批量为多人排班  
**以便** 提高排班效率

**验收标准**:
- [ ] 可以选择多个员工
- [ ] 可以选择日期范围
- [ ] 可以选择班次或模板
- [ ] 显示批量操作预览
- [ ] 支持冲突处理策略选择

**优先级**: P1  
**故事点**: 5

---

### US-ATT-007: 使用排班模板

**作为** HR管理员  
**我希望** 能够创建和应用排班模板  
**以便** 标准化排班流程

**验收标准**:
- [ ] 可以创建部门/岗位/个人模板
- [ ] 可以配置排班周期和规则
- [ ] 可以将模板应用到员工
- [ ] 支持模板复制和修改
- [ ] 模板应用前可预览效果

**优先级**: P1  
**故事点**: 5

---

### US-ATT-008: 临时排班调整

**作为** 部门主管  
**我希望** 能够临时调整员工排班  
**以便** 应对突发情况

**验收标准**:
- [ ] 可以创建临时排班覆盖
- [ ] 可以设置覆盖优先级
- [ ] 支持整班或部分时段覆盖
- [ ] 需要填写调整原因
- [ ] 临时排班有明显标识

**优先级**: P1  
**故事点**: 3

---

## 4. 用户故事 - 考勤规则配置

### US-ATT-009: 配置考勤基础规则

**作为** HR管理员  
**我希望** 能够配置考勤计算规则  
**以便** 定义考勤判定标准

**验收标准**:
- [ ] 可以配置迟到/早退判定规则
- [ ] 可以配置旷工判定规则
- [ ] 可以配置加班计算规则
- [ ] 可以设置规则适用范围
- [ ] 规则变更有版本记录

**优先级**: P0  
**故事点**: 5

---

### US-ATT-010: 管理考勤点

**作为** HR管理员  
**我希望** 能够管理GPS考勤点  
**以便** 支持移动端位置打卡

**验收标准**:
- [ ] 可以在地图上标记考勤点
- [ ] 可以设置有效打卡半径
- [ ] 可以关联考勤设备
- [ ] 支持多考勤点管理
- [ ] 地图可视化展示

**优先级**: P1  
**故事点**: 5

---

### US-ATT-011: 配置预警规则

**作为** HR管理员  
**我希望** 能够配置考勤预警规则  
**以便** 及时发现考勤异常

**验收标准**:
- [ ] 可以配置预警触发条件
- [ ] 可以设置预警级别
- [ ] 可以配置预警通知对象
- [ ] 支持设备联动预警
- [ ] 预警规则可启用/禁用

**优先级**: P1  
**故事点**: 5

---

### US-ATT-012: 配置通知规则

**作为** HR管理员  
**我希望** 能够配置考勤通知规则  
**以便** 自动发送考勤相关通知

**验收标准**:
- [ ] 可以配置打卡提醒规则
- [ ] 可以配置未打卡通知规则
- [ ] 可以选择通知渠道
- [ ] 可以设置通知频率控制
- [ ] 支持通知模板自定义

**优先级**: P1  
**故事点**: 5

---

## 5. 用户故事 - 异常管理

### US-ATT-013: 管理假种配置

**作为** HR管理员  
**我希望** 能够管理请假类型配置  
**以便** 规范请假流程

**验收标准**:
- [ ] 可以创建各类假种
- [ ] 可以配置年度额度
- [ ] 可以设置是否需要证明
- [ ] 可以配置扣薪规则
- [ ] 可以配置审批流程

**优先级**: P0  
**故事点**: 5

---

### US-ATT-014: 提交请假申请

**作为** 普通员工  
**我希望** 能够在线提交请假申请  
**以便** 快速完成请假流程

**验收标准**:
- [ ] 可以选择假种类型
- [ ] 可以选择请假时间范围
- [ ] 显示剩余假期额度
- [ ] 可以填写请假原因
- [ ] 可以上传证明材料
- [ ] 提交后可查看审批进度

**优先级**: P0  
**故事点**: 5

---

### US-ATT-015: 提交加班申请

**作为** 普通员工  
**我希望** 能够在线提交加班申请  
**以便** 记录加班并获得补偿

**验收标准**:
- [ ] 可以选择加班类型
- [ ] 可以设置加班时间
- [ ] 系统自动计算加班时长
- [ ] 可以填写加班原因
- [ ] 可以选择补偿方式

**优先级**: P0  
**故事点**: 3

---

### US-ATT-016: 提交补签申请

**作为** 普通员工  
**我希望** 能够申请补签打卡  
**以便** 补正遗漏的打卡记录

**验收标准**:
- [ ] 可以选择补签类型
- [ ] 可以填写实际打卡时间
- [ ] 必须填写补签原因
- [ ] 可以上传证明材料
- [ ] 显示该日原有打卡记录

**优先级**: P0  
**故事点**: 3

---

### US-ATT-017: 审批异常申请

**作为** 部门主管  
**我希望** 能够审批下属的异常申请  
**以便** 及时处理员工申请

**验收标准**:
- [ ] 可以查看待审批列表
- [ ] 可以查看申请详情
- [ ] 可以通过或拒绝申请
- [ ] 必须填写审批意见
- [ ] 支持批量审批
- [ ] 审批后自动通知申请人

**优先级**: P0  
**故事点**: 5

---

### US-ATT-018: 提交销假申请

**作为** 普通员工  
**我希望** 能够申请提前销假  
**以便** 恢复未使用的假期额度

**验收标准**:
- [ ] 可以选择原请假申请
- [ ] 可以设置实际销假时间
- [ ] 系统自动计算销假时长
- [ ] 审批通过后恢复额度
- [ ] 支持部分销假

**优先级**: P1  
**故事点**: 3

---

## 6. 用户故事 - 考勤数据

### US-ATT-019: 员工打卡

**作为** 普通员工  
**我希望** 能够通过多种方式打卡  
**以便** 记录出勤情况

**验收标准**:
- [ ] 支持考勤机打卡
- [ ] 支持移动端打卡
- [ ] 支持人脸识别打卡
- [ ] 打卡成功有即时反馈
- [ ] 显示打卡时间和位置

**优先级**: P0  
**故事点**: 5

---

### US-ATT-020: 查看打卡记录

**作为** 普通员工  
**我希望** 能够查看自己的打卡记录  
**以便** 了解出勤情况

**验收标准**:
- [ ] 可以按日期范围查询
- [ ] 显示打卡时间和方式
- [ ] 显示打卡位置信息
- [ ] 异常打卡有明显标识
- [ ] 可以查看打卡照片

**优先级**: P0  
**故事点**: 3

---

### US-ATT-021: 查看考勤结果

**作为** 普通员工  
**我希望** 能够查看自己的考勤结果  
**以便** 了解考勤状态

**验收标准**:
- [ ] 可以按月查看考勤结果
- [ ] 显示每日考勤状态
- [ ] 显示迟到/早退/旷工信息
- [ ] 显示加班时长
- [ ] 异常情况有明显标识

**优先级**: P0  
**故事点**: 3

---

### US-ATT-022: 考勤数据计算

**作为** 系统  
**我希望** 能够自动计算考勤结果  
**以便** 生成准确的考勤数据

**验收标准**:
- [ ] 每日自动计算考勤结果
- [ ] 根据排班判定出勤状态
- [ ] 计算迟到/早退分钟数
- [ ] 计算加班时长
- [ ] 考虑请假等异常情况

**优先级**: P0  
**故事点**: 8

---

## 7. 用户故事 - 汇总报表

### US-ATT-023: 查看月度考勤汇总

**作为** HR管理员  
**我希望** 能够查看月度考勤汇总  
**以便** 了解整体出勤情况

**验收标准**:
- [ ] 可以选择统计月份
- [ ] 可以按部门/员工筛选
- [ ] 显示出勤天数、迟到次数等
- [ ] 显示出勤率
- [ ] 支持数据导出

**优先级**: P0  
**故事点**: 5

---

### US-ATT-024: 查看部门考勤统计

**作为** 部门主管  
**我希望** 能够查看部门考勤统计  
**以便** 了解部门出勤情况

**验收标准**:
- [ ] 显示部门整体出勤率
- [ ] 显示异常情况统计
- [ ] 支持与其他部门对比
- [ ] 显示趋势变化
- [ ] 可以钻取到员工明细

**优先级**: P1  
**故事点**: 5

---

### US-ATT-025: 导出考勤报表

**作为** HR管理员  
**我希望** 能够导出考勤报表  
**以便** 进行数据分析和存档

**验收标准**:
- [ ] 支持Excel格式导出
- [ ] 支持PDF格式导出
- [ ] 可以自定义导出字段
- [ ] 支持批量导出
- [ ] 保留导出历史记录

**优先级**: P1  
**故事点**: 3

---

## 8. 用例描述

### UC-ATT-001: 员工打卡用例

**用例名称**: 员工打卡  
**参与者**: 普通员工  
**前置条件**: 
- 员工已登录系统
- 员工已有当日排班

**基本流程**:
1. 员工到达打卡位置
2. 员工选择打卡方式（刷卡/人脸/移动端）
3. 系统验证员工身份
4. 系统验证打卡位置（如适用）
5. 系统记录打卡时间
6. 系统判定打卡状态（正常/迟到/早退）
7. 系统显示打卡结果

**替代流程**:
- 3a. 身份验证失败：提示重试或联系管理员
- 4a. 位置验证失败：提示不在有效范围内
- 6a. 无排班记录：记录打卡但标记为异常

**后置条件**:
- 打卡记录已保存
- 考勤状态已更新

---

### UC-ATT-002: 请假申请用例

**用例名称**: 提交请假申请  
**参与者**: 普通员工、部门主管  
**前置条件**: 
- 员工已登录系统
- 假种配置已完成

**基本流程**:
1. 员工进入请假申请页面
2. 员工选择假种类型
3. 系统显示剩余额度
4. 员工选择请假时间范围
5. 系统计算请假天数
6. 员工填写请假原因
7. 员工上传证明材料（如需要）
8. 员工提交申请
9. 系统发送审批通知给主管
10. 主管审批申请
11. 系统更新申请状态
12. 系统通知员工审批结果

**替代流程**:
- 3a. 额度不足：提示额度不足
- 10a. 主管拒绝：记录拒绝原因，通知员工

**后置条件**:
- 申请记录已保存
- 审批通过则更新排班和考勤

---

### UC-ATT-003: 考勤计算用例

**用例名称**: 每日考勤计算  
**参与者**: 系统（定时任务）  
**前置条件**: 
- 当日打卡数据已采集
- 排班数据已配置

**基本流程**:
1. 系统获取待计算的员工列表
2. 系统获取员工当日排班
3. 系统获取员工当日打卡记录
4. 系统获取员工当日异常申请
5. 系统根据规则计算考勤结果
6. 系统判定出勤状态
7. 系统计算工作时长和加班时长
8. 系统保存考勤结果
9. 系统触发异常预警（如有）

**替代流程**:
- 2a. 无排班：标记为无排班状态
- 3a. 无打卡：标记为旷工或请假
- 4a. 有请假：根据请假调整考勤结果

**后置条件**:
- 考勤结果已保存
- 异常预警已触发

---

## 9. 故事地图

```
                    考勤管理模块用户故事地图
                    
用户活动    │ 配置管理 │ 日常考勤 │ 异常处理 │ 数据统计 │
─────────────────────────────────────────────────────────
            │          │          │          │          │
用户任务    │ 班次配置 │ 员工打卡 │ 请假申请 │ 查看汇总 │
            │ 排班管理 │ 查看考勤 │ 加班申请 │ 导出报表 │
            │ 规则配置 │          │ 补签申请 │          │
            │          │          │ 审批处理 │          │
─────────────────────────────────────────────────────────
            │          │          │          │          │
Release 1   │ US-001   │ US-019   │ US-014   │ US-023   │
(P0)        │ US-002   │ US-020   │ US-015   │          │
            │ US-003   │ US-021   │ US-016   │          │
            │ US-004   │ US-022   │ US-017   │          │
            │ US-005   │          │          │          │
            │ US-009   │          │          │          │
            │ US-013   │          │          │          │
─────────────────────────────────────────────────────────
            │          │          │          │          │
Release 2   │ US-006   │          │ US-018   │ US-024   │
(P1)        │ US-007   │          │          │ US-025   │
            │ US-008   │          │          │          │
            │ US-010   │          │          │          │
            │ US-011   │          │          │          │
            │ US-012   │          │          │          │
─────────────────────────────────────────────────────────
```

---

*本文档持续更新中*

