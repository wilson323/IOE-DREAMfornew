# ç³»ç»Ÿç®¡ç†åŠŸèƒ½å¸ƒå±€æ–‡æ¡£ - å®Œæ•´ç‰ˆ

## åŠŸèƒ½æ¦‚è¿°

ç³»ç»Ÿç®¡ç†æ¨¡å—æ˜¯è€ƒå‹¤ç³»ç»Ÿçš„ç®¡ç†å’Œç»´æŠ¤ä¸­å¿ƒï¼Œä»…å¯¹ç³»ç»Ÿç®¡ç†å‘˜å¼€æ”¾ï¼ŒåŒ…å«ç”¨æˆ·ç®¡ç†ã€ç³»ç»Ÿé…ç½®ã€å®‰å…¨ç®¡ç†ã€ç³»ç»Ÿç›‘æ§ã€ç³»ç»Ÿç»´æŠ¤ç­‰åŠŸèƒ½ã€‚è¯¥æ¨¡å—è´Ÿè´£ç³»ç»Ÿçš„æ•´ä½“é…ç½®ã€ç”¨æˆ·æƒé™ç®¡ç†ã€å®‰å…¨ç­–ç•¥è®¾ç½®ã€ç³»ç»Ÿæ€§èƒ½ç›‘æ§ã€æ—¥å¸¸ç»´æŠ¤æ“ä½œç­‰ï¼Œç¡®ä¿ç³»ç»Ÿçš„ç¨³å®šè¿è¡Œå’Œå®‰å…¨å¯é ã€‚

## æŠ€æœ¯æ¶æ„è§„èŒƒ

### å‰ç«¯æŠ€æœ¯æ ˆ
- **æ ¸å¿ƒæ¡†æ¶**: Vue 3.4.27 (Composition API)
- **UIç»„ä»¶åº“**: Ant Design Vue 4.2.5
- **çŠ¶æ€ç®¡ç†**: Pinia 2.1.7
- **è·¯ç”±ç®¡ç†**: Vue Router 4.3.2
- **HTTPå®¢æˆ·ç«¯**: Axios 1.6.8
- **WebSocket**: Socket.io-client (å®æ—¶ç›‘æ§)
- **å›¾è¡¨ç»„ä»¶**: ECharts 5.x
- **æ ·å¼é¢„å¤„ç†å™¨**: Less 4.2.0
- **å›¾æ ‡åº“**: @ant-design/icons-vue

### é¡¹ç›®æ–‡ä»¶ç»„ç»‡ç»“æ„
```
src/views/business/attendance/system/
â”œâ”€â”€ index.vue                        # ç³»ç»Ÿç®¡ç†ä¸»é¡µé¢
â”œâ”€â”€ user-management/
â”‚   â”œâ”€â”€ index.vue                   # ç”¨æˆ·ç®¡ç†é¡µé¢
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ UserTable.vue           # ç”¨æˆ·è¡¨æ ¼ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ UserForm.vue            # ç”¨æˆ·è¡¨å•ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ RoleAssign.vue          # è§’è‰²åˆ†é…ç»„ä»¶
â”‚   â”‚   â””â”€â”€ PermissionTree.vue      # æƒé™æ ‘ç»„ä»¶
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ user-management-api.js  # ç”¨æˆ·ç®¡ç†API
â”œâ”€â”€ system-config/
â”‚   â”œâ”€â”€ index.vue                   # ç³»ç»Ÿé…ç½®é¡µé¢
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ BasicConfig.vue         # åŸºç¡€é…ç½®ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ TimeConfig.vue          # æ—¶é—´é…ç½®ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ BackupConfig.vue        # å¤‡ä»½é…ç½®ç»„ä»¶
â”‚   â”‚   â””â”€â”€ MonitorConfig.vue       # ç›‘æ§é…ç½®ç»„ä»¶
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ system-config-api.js    # ç³»ç»Ÿé…ç½®API
â”œâ”€â”€ security-management/
â”‚   â”œâ”€â”€ index.vue                   # å®‰å…¨ç®¡ç†é¡µé¢
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ AccessControl.vue       # è®¿é—®æ§åˆ¶ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ OperationLogs.vue       # æ“ä½œæ—¥å¿—ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ SecurityPolicy.vue      # å®‰å…¨ç­–ç•¥ç»„ä»¶
â”‚   â”‚   â””â”€â”€ VulnerabilityScan.vue   # æ¼æ´æ‰«æç»„ä»¶
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ security-api.js         # å®‰å…¨ç®¡ç†API
â”œâ”€â”€ system-monitor/
â”‚   â”œâ”€â”€ index.vue                   # ç³»ç»Ÿç›‘æ§é¡µé¢
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ PerformanceMonitor.vue  # æ€§èƒ½ç›‘æ§ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ DatabaseMonitor.vue     # æ•°æ®åº“ç›‘æ§ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ApiMonitor.vue          # APIç›‘æ§ç»„ä»¶
â”‚   â”‚   â””â”€â”€ AlertMonitor.vue        # å‘Šè­¦ç›‘æ§ç»„ä»¶
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ monitor-api.js          # ç›‘æ§API
â”œâ”€â”€ system-maintenance/
â”‚   â”œâ”€â”€ index.vue                   # ç³»ç»Ÿç»´æŠ¤é¡µé¢
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ DataBackup.vue          # æ•°æ®å¤‡ä»½ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ SystemUpgrade.vue       # ç³»ç»Ÿå‡çº§ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ LogCleanup.vue          # æ—¥å¿—æ¸…ç†ç»„ä»¶
â”‚   â”‚   â””â”€â”€ StorageMonitor.vue      # å­˜å‚¨ç›‘æ§ç»„ä»¶
â”‚   â””â”€â”€ api/
â”‚       â””â”€â”€ maintenance-api.js      # ç»´æŠ¤API
â”œâ”€â”€ mock/
â”‚   â””â”€â”€ system-mock.js              # æ¨¡æ‹Ÿæ•°æ®
â”œâ”€â”€ api/
â”‚   â””â”€â”€ system-api.js               # ç»Ÿä¸€APIæ¥å£
â””â”€â”€ utils/
    â”œâ”€â”€ auth-utils.js               # è®¤è¯å·¥å…·å‡½æ•°
    â”œâ”€â”€ permission-utils.js         # æƒé™å·¥å…·å‡½æ•°
    â””â”€â”€ system-utils.js             # ç³»ç»Ÿå·¥å…·å‡½æ•°
```

### APIæ¥å£è®¾è®¡
```javascript
// src/api/business/attendance/system/user-management-api.js
import { postRequest, getRequest, putRequest, deleteRequest } from '/@/lib/axios';

export const userManagementApi = {
  // ç”¨æˆ·ç®¡ç†
  getUsers: (params) => getRequest('/attendance/system/users', params),
  getUserById: (id) => getRequest(`/attendance/system/users/${id}`),
  createUser: (params) => postRequest('/attendance/system/users/create', params),
  updateUser: (id, params) => putRequest(`/attendance/system/users/${id}`, params),
  deleteUser: (id) => deleteRequest(`/attendance/system/users/${id}`),

  // å¯†ç ç®¡ç†
  resetPassword: (id, params) => postRequest(`/attendance/system/users/${id}/reset-password`, params),
  changePassword: (params) => postRequest('/attendance/system/users/change-password', params),

  // è§’è‰²æƒé™
  getUserRoles: (userId) => getRequest(`/attendance/system/users/${userId}/roles`),
  assignRoles: (userId, roleIds) => postRequest(`/attendance/system/users/${userId}/roles`, { roleIds }),
  getUserPermissions: (userId) => getRequest(`/attendance/system/users/${userId}/permissions`),

  // ç™»å½•æ—¥å¿—
  getLoginLogs: (params) => getRequest('/attendance/system/users/login-logs', params),
};

// src/api/business/attendance/system/system-config-api.js
export const systemConfigApi = {
  // åŸºç¡€é…ç½®
  getBasicConfig: () => getRequest('/attendance/system/config/basic'),
  updateBasicConfig: (params) => putRequest('/attendance/system/config/basic', params),

  // æ—¶é—´é…ç½®
  getTimeConfig: () => getRequest('/attendance/system/config/time'),
  updateTimeConfig: (params) => putRequest('/attendance/system/config/time', params),

  // å¤‡ä»½é…ç½®
  getBackupConfig: () => getRequest('/attendance/system/config/backup'),
  updateBackupConfig: (params) => putRequest('/attendance/system/config/backup', params),

  // ç›‘æ§é…ç½®
  getMonitorConfig: () => getRequest('/attendance/system/config/monitor'),
  updateMonitorConfig: (params) => putRequest('/attendance/system/config/monitor', params),
};

// src/api/business/attendance/system/security-api.js
export const securityApi = {
  // è®¿é—®æ§åˆ¶
  getAccessControl: () => getRequest('/attendance/system/security/access-control'),
  updateAccessControl: (params) => putRequest('/attendance/system/security/access-control', params),

  // æ“ä½œæ—¥å¿—
  getOperationLogs: (params) => getRequest('/attendance/system/security/operation-logs', params),
  clearOperationLogs: (params) => postRequest('/attendance/system/security/operation-logs/clear', params),

  // å®‰å…¨ç­–ç•¥
  getSecurityPolicy: () => getRequest('/attendance/system/security/policy'),
  updateSecurityPolicy: (params) => putRequest('/attendance/system/security/policy', params),

  // æ¼æ´æ‰«æ
  startVulnerabilityScan: () => postRequest('/attendance/system/security/vulnerability-scan'),
  getScanResults: () => getRequest('/attendance/system/security/scan-results'),
};
```

## æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
## ğŸ“‹ IOE-DREAMä¸ƒå¾®æœåŠ¡æ¶æ„

**æ ¸å¿ƒæ¶æ„ç»„æˆ**:
- **Gateway Service (8080)**: APIç½‘å…³
- **Common Service (8088)**: å…¬å…±æ¨¡å—å¾®æœåŠ¡
- **DeviceComm Service (8087)**: è®¾å¤‡é€šè®¯å¾®æœåŠ¡
- **OA Service (8089)**: OAå¾®æœåŠ¡
- **Access Service (8090)**: é—¨ç¦æœåŠ¡
- **Attendance Service (8091)**: è€ƒå‹¤æœåŠ¡
- **Video Service (8092)**: è§†é¢‘æœåŠ¡
- **Consume Service (8094)**: æ¶ˆè´¹æœåŠ¡
- **Visitor Service (8095)**: è®¿å®¢æœåŠ¡

**æ¶æ„ç‰¹ç‚¹**:
- åŸºäºSpring Boot 3.5.8 + Java 17
- ä¸¥æ ¼éµå¾ªä¼ä¸šçº§å¾®æœåŠ¡è§„èŒƒ
- æ”¯æŒé«˜å¹¶å‘ã€é«˜å¯ç”¨ã€æ°´å¹³æ‰©å±•

**æŠ€æœ¯æ ˆæ ‡å‡†**:
- **æ•°æ®åº“**: MySQL 8.0 + Druidè¿æ¥æ± 
- **ç¼“å­˜**: Redis + Caffeineå¤šçº§ç¼“å­˜
- **æ³¨å†Œä¸­å¿ƒ**: Nacos
- **é…ç½®ä¸­å¿ƒ**: Nacos Config
- **è®¤è¯æˆæƒ**: Sa-Token

## ğŸ—ï¸ å››å±‚æ¶æ„è§„èŒƒ

**æ ‡å‡†æ¶æ„æ¨¡å¼**:
```
Controller (æ¥å£æ§åˆ¶å±‚)
    â†“
Service (æ ¸å¿ƒä¸šåŠ¡å±‚)
    â†“
Manager (æµç¨‹ç®¡ç†å±‚)
    â†“
DAO (æ•°æ®è®¿é—®å±‚)
```

**å±‚çº§èŒè´£**:
- **Controllerå±‚**: HTTPè¯·æ±‚å¤„ç†ã€å‚æ•°éªŒè¯ã€æƒé™æ§åˆ¶
- **Serviceå±‚**: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ã€äº‹åŠ¡ç®¡ç†ã€ä¸šåŠ¡è§„åˆ™éªŒè¯
- **Managerå±‚**: å¤æ‚æµç¨‹ç¼–æ’ã€å¤šæ•°æ®ç»„è£…ã€ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆ
- **DAOå±‚**: æ•°æ®åº“CRUDæ“ä½œã€SQLæŸ¥è¯¢å®ç°ã€æ•°æ®è®¿é—®è¾¹ç•Œ

**ä¸¥æ ¼ç¦æ­¢è·¨å±‚è®¿é—®**: Controllerä¸èƒ½ç›´æ¥è°ƒç”¨Manager/DAOï¼
### 1. ç”¨æˆ·ç®¡ç†
## âš ï¸ IOE-DREAMé›¶å®¹å¿è§„åˆ™ï¼ˆå¼ºåˆ¶æ‰§è¡Œï¼‰

**å¿…é¡»éµå®ˆçš„æ¶æ„è§„åˆ™**:
- âœ… **å¿…é¡»ä½¿ç”¨ @Resource æ³¨å…¥ä¾èµ–**
- âœ… **å¿…é¡»ä½¿ç”¨ @Mapper æ³¨è§£** (ç¦æ­¢@Repository)
- âœ… **å¿…é¡»ä½¿ç”¨ Dao åç¼€** (ç¦æ­¢Repository)
- âœ… **å¿…é¡»ä½¿ç”¨ @RestController æ³¨è§£**
- âœ… **å¿…é¡»ä½¿ç”¨ @Valid å‚æ•°æ ¡éªŒ**
- âœ… **å¿…é¡»è¿”å›ç»Ÿä¸€ResponseDTOæ ¼å¼**
- âœ… **å¿…é¡»éµå¾ªå››å±‚æ¶æ„è¾¹ç•Œ**

**ä¸¥æ ¼ç¦æ­¢äº‹é¡¹**:
- âŒ **ç¦æ­¢ä½¿ç”¨ @Autowired æ³¨å…¥**
- âŒ **ç¦æ­¢ä½¿ç”¨ @Repository æ³¨è§£**
- âŒ **ç¦æ­¢ä½¿ç”¨ Repository åç¼€å‘½å**
- âŒ **ç¦æ­¢è·¨å±‚è®¿é—®**
- âŒ **ç¦æ­¢åœ¨Controllerä¸­åŒ…å«ä¸šåŠ¡é€»è¾‘**
- âŒ **ç¦æ­¢ç›´æ¥è®¿é—®æ•°æ®åº“**

**è¿è§„åæœ**: P0çº§é—®é¢˜ï¼Œç«‹å³ä¿®å¤ï¼Œç¦æ­¢åˆå¹¶ï¼

```vue
<!-- src/views/business/attendance/system/user-management/components/UserTable.vue -->
<template>
  <div class="user-table">
    <!-- æœç´¢å·¥å…·æ  -->
    <div class="table-toolbar">
      <a-form layout="inline" :model="searchForm" @finish="handleSearch">
        <a-form-item label="ç”¨æˆ·å">
          <a-input v-model:value="searchForm.username" placeholder="è¯·è¾“å…¥ç”¨æˆ·å" allow-clear />
        </a-form-item>
        <a-form-item label="å§“å">
          <a-input v-model:value="searchForm.realName" placeholder="è¯·è¾“å…¥å§“å" allow-clear />
        </a-form-item>
        <a-form-item label="è§’è‰²">
          <a-select
            v-model:value="searchForm.roleId"
            placeholder="è¯·é€‰æ‹©è§’è‰²"
            allow-clear
            style="width: 150px"
          >
            <a-select-option
              v-for="role in roleList"
              :key="role.id"
              :value="role.id"
            >
              {{ role.name }}
            </a-select-option>
          </a-select>
        </a-form-item>
        <a-form-item label="çŠ¶æ€">
          <a-select
            v-model:value="searchForm.status"
            placeholder="è¯·é€‰æ‹©çŠ¶æ€"
            allow-clear
            style="width: 120px"
          >
            <a-select-option value="active">å¯ç”¨</a-select-option>
            <a-select-option value="inactive">ç¦ç”¨</a-select-option>
            <a-select-option value="locked">é”å®š</a-select-option>
          </a-select>
        </a-form-item>
        <a-form-item>
          <a-button type="primary" html-type="submit" :loading="loading">
            <template #icon><SearchOutlined /></template>
            æœç´¢
          </a-button>
          <a-button @click="handleReset">
            <template #icon><ReloadOutlined /></template>
            é‡ç½®
          </a-button>
        </a-form-item>
      </a-form>
    </div>

    <!-- æ“ä½œå·¥å…·æ  -->
    <div class="table-actions">
      <div class="actions-left">
        <a-button type="primary" @click="handleAdd">
          <template #icon><PlusOutlined /></template>
          æ–°å¢ç”¨æˆ·
        </a-button>
        <a-button @click="handleBatchImport">
          <template #icon><UploadOutlined /></template>
          æ‰¹é‡å¯¼å…¥
        </a-button>
        <a-button @click="handleBatchExport" :disabled="selectedRowKeys.length === 0">
          <template #icon><ExportOutlined /></template>
          æ‰¹é‡å¯¼å‡º
        </a-button>
        <a-button @click="handleBatchOperation" :disabled="selectedRowKeys.length === 0">
          <template #icon><AppstoreOutlined /></template>
          æ‰¹é‡æ“ä½œ
        </a-button>
      </div>
      <div class="actions-right">
        <a-button @click="handleRefresh" :loading="loading">
          <template #icon><ReloadOutlined /></template>
          åˆ·æ–°
        </a-button>
        <a-button @click="toggleColumnSettings">
          <template #icon><SettingOutlined /></template>
          åˆ—è®¾ç½®
        </a-button>
      </div>
    </div>

    <!-- æ•°æ®è¡¨æ ¼ -->
    <a-table
      :columns="columns"
      :data-source="dataSource"
      :loading="loading"
      :pagination="pagination"
      :row-selection="rowSelection"
      row-key="id"
      @change="handleTableChange"
    >
      <template #bodyCell="{ column, record }">
        <template v-if="column.key === 'avatar'">
          <a-avatar :src="record.avatar" :alt="record.realName">
            {{ record.realName?.charAt(0) }}
          </a-avatar>
        </template>

        <template v-else-if="column.key === 'roles'">
          <a-tag v-for="role in record.roles" :key="role.id" :color="getRoleColor(role.code)">
            {{ role.name }}
          </a-tag>
        </template>

        <template v-else-if="column.key === 'status'">
          <a-badge :status="getStatusBadge(record.status)" :text="getStatusText(record.status)" />
        </template>

        <template v-else-if="column.key === 'lastLoginTime'">
          <span v-if="record.lastLoginTime">{{ formatDateTime(record.lastLoginTime) }}</span>
          <span v-else class="text-muted">ä»æœªç™»å½•</span>
        </template>

        <template v-else-if="column.key === 'action'">
          <a-space>
            <a-button type="link" size="small" @click="handleView(record)">æŸ¥çœ‹</a-button>
            <a-button type="link" size="small" @click="handleEdit(record)">ç¼–è¾‘</a-button>
            <a-dropdown>
              <template #overlay>
                <a-menu @click="({ key }) => handleMenuClick(key, record)">
                  <a-menu-item key="assign-roles">
                    <TeamOutlined />
                    åˆ†é…è§’è‰²
                  </a-menu-item>
                  <a-menu-item key="reset-password">
                    <KeyOutlined />
                    é‡ç½®å¯†ç 
                  </a-menu-item>
                  <a-menu-item key="login-logs">
                    <HistoryOutlined />
                    ç™»å½•æ—¥å¿—
                  </a-menu-item>
                  <a-menu-divider />
                  <a-menu-item key="enable" v-if="record.status !== 'active'">
                    <CheckCircleOutlined />
                    å¯ç”¨
                  </a-menu-item>
                  <a-menu-item key="disable" v-if="record.status === 'active'">
                    <StopOutlined />
                    ç¦ç”¨
                  </a-menu-item>
                  <a-menu-item key="lock" v-if="record.status !== 'locked'">
                    <LockOutlined />
                    é”å®š
                  </a-menu-item>
                  <a-menu-item key="unlock" v-if="record.status === 'locked'">
                    <UnlockOutlined />
                    è§£é”
                  </a-menu-item>
                  <a-menu-divider />
                  <a-menu-item key="delete" class="danger">
                    <DeleteOutlined />
                    åˆ é™¤
                  </a-menu-item>
                </a-menu>
              </template>
              <a-button type="link" size="small">
                æ›´å¤š <DownOutlined />
              </a-button>
            </a-dropdown>
          </a-space>
        </template>
      </template>
    </a-table>

    <!-- ç”¨æˆ·è¯¦æƒ…å¼¹çª— -->
    <a-modal
      v-model:open="detailVisible"
      title="ç”¨æˆ·è¯¦æƒ…"
      :footer="null"
      width="800px"
    >
      <UserDetail
        :user-data="currentUser"
        @close="detailVisible = false"
      />
    </a-modal>

    <!-- è§’è‰²åˆ†é…å¼¹çª— -->
    <a-modal
      v-model:open="roleAssignVisible"
      title="åˆ†é…è§’è‰²"
      @ok="handleRoleAssignConfirm"
      @cancel="roleAssignVisible = false"
      width="600px"
    >
      <RoleAssignForm
        ref="roleAssignRef"
        :user-data="currentUser"
        :role-list="roleList"
        @change="handleRoleAssignChange"
      />
    </a-modal>

    <!-- åˆ—è®¾ç½®å¼¹çª— -->
    <a-modal
      v-model:open="columnSettingsVisible"
      title="åˆ—è®¾ç½®"
      @ok="handleColumnSettingsSave"
      @cancel="columnSettingsVisible = false"
    >
      <ColumnSettings
        :columns="allColumns"
        :visible-columns="visibleColumns"
        @change="handleColumnChange"
      />
    </a-modal>
  </div>
</template>

<script setup>
import { ref, reactive, onMounted } from 'vue';
import { message, Modal } from 'ant-design-vue';
import {
  SearchOutlined,
  ReloadOutlined,
  PlusOutlined,
  UploadOutlined,
  ExportOutlined,
  AppstoreOutlined,
  SettingOutlined,
  TeamOutlined,
  KeyOutlined,
  HistoryOutlined,
  CheckCircleOutlined,
  StopOutlined,
  LockOutlined,
  UnlockOutlined,
  DeleteOutlined,
  DownOutlined
} from '@ant-design/icons-vue';
import { userManagementApi } from '/@/api/business/attendance/system/user-management-api';
import UserDetail from './UserDetail.vue';
import RoleAssignForm from './RoleAssignForm.vue';
import ColumnSettings from './ColumnSettings.vue';

const emit = defineEmits(['add', 'edit', 'view', 'export', 'import']);

const loading = ref(false);
const dataSource = ref([]);
const selectedRowKeys = ref([]);
const roleList = ref([]);

const detailVisible = ref(false);
const roleAssignVisible = ref(false);
const columnSettingsVisible = ref(false);
const currentUser = ref(null);
const roleAssignRef = ref();

const searchForm = reactive({
  username: '',
  realName: '',
  roleId: '',
  status: ''
});

const pagination = reactive({
  current: 1,
  pageSize: 20,
  total: 0,
  showSizeChanger: true,
  showQuickJumper: true,
  showTotal: (total) => `å…± ${total} æ¡è®°å½•`,
});

const allColumns = ref([
  {
    title: 'å¤´åƒ',
    key: 'avatar',
    width: 80,
    align: 'center',
  },
  {
    title: 'ç”¨æˆ·å',
    dataIndex: 'username',
    key: 'username',
    width: 120,
  },
  {
    title: 'å§“å',
    dataIndex: 'realName',
    key: 'realName',
    width: 100,
  },
  {
    title: 'é‚®ç®±',
    dataIndex: 'email',
    key: 'email',
    width: 180,
  },
  {
    title: 'æ‰‹æœºå·',
    dataIndex: 'phone',
    key: 'phone',
    width: 120,
  },
  {
    title: 'è§’è‰²',
    key: 'roles',
    width: 150,
  },
  {
    title: 'éƒ¨é—¨',
    dataIndex: 'department',
    key: 'department',
    width: 120,
  },
  {
    title: 'çŠ¶æ€',
    key: 'status',
    width: 80,
  },
  {
    title: 'æœ€åç™»å½•',
    key: 'lastLoginTime',
    width: 150,
  },
  {
    title: 'åˆ›å»ºæ—¶é—´',
    dataIndex: 'createdAt',
    key: 'createdAt',
    width: 150,
  },
  {
    title: 'æ“ä½œ',
    key: 'action',
    width: 200,
    fixed: 'right',
  },
]);

const visibleColumns = ref(allColumns.value.map(col => col.key));

const columns = computed(() => {
  return allColumns.value.filter(col => visibleColumns.value.includes(col.key));
});

const rowSelection = {
  selectedRowKeys: selectedRowKeys,
  onChange: (keys) => {
    selectedRowKeys.value = keys;
  },
};

// åŠ è½½ç”¨æˆ·æ•°æ®
const loadUsers = async () => {
  loading.value = true;
  try {
    const params = {
      ...searchForm,
      page: pagination.current,
      pageSize: pagination.pageSize,
    };
    const response = await userManagementApi.getUsers(params);
    dataSource.value = response.data.records;
    pagination.total = response.data.total;
  } catch (error) {
    console.error('åŠ è½½ç”¨æˆ·æ•°æ®å¤±è´¥:', error);
    message.error('åŠ è½½ç”¨æˆ·æ•°æ®å¤±è´¥');
  } finally {
    loading.value = false;
  }
};

// åŠ è½½è§’è‰²åˆ—è¡¨
const loadRoles = async () => {
  try {
    const response = await userManagementApi.getRoles();
    roleList.value = response.data;
  } catch (error) {
    console.error('åŠ è½½è§’è‰²åˆ—è¡¨å¤±è´¥:', error);
  }
};

// æœç´¢
const handleSearch = () => {
  pagination.current = 1;
  loadUsers();
};

// é‡ç½®
const handleReset = () => {
  Object.assign(searchForm, {
    username: '',
    realName: '',
    roleId: '',
    status: ''
  });
  pagination.current = 1;
  loadUsers();
};

// è¡¨æ ¼å˜åŒ–
const handleTableChange = (pag) => {
  pagination.current = pag.current;
  pagination.pageSize = pag.pageSize;
  loadUsers();
};

// æ–°å¢ç”¨æˆ·
const handleAdd = () => {
  emit('add');
};

// ç¼–è¾‘ç”¨æˆ·
const handleEdit = (record) => {
  emit('edit', record);
};

// æŸ¥çœ‹ç”¨æˆ·
const handleView = (record) => {
  currentUser.value = record;
  detailVisible.value = true;
};

// èœå•ç‚¹å‡»
const handleMenuClick = async (key, record) => {
  switch (key) {
    case 'assign-roles':
      await handleAssignRoles(record);
      break;
    case 'reset-password':
      await handleResetPassword(record);
      break;
    case 'login-logs':
      await handleViewLoginLogs(record);
      break;
    case 'enable':
      await handleUpdateStatus(record, 'active');
      break;
    case 'disable':
      await handleUpdateStatus(record, 'inactive');
      break;
    case 'lock':
      await handleUpdateStatus(record, 'locked');
      break;
    case 'unlock':
      await handleUpdateStatus(record, 'active');
      break;
    case 'delete':
      await handleDeleteUser(record);
      break;
  }
};

// åˆ†é…è§’è‰²
const handleAssignRoles = async (record) => {
  currentUser.value = record;
  try {
    const response = await userManagementApi.getUserRoles(record.id);
    currentUser.value.roleIds = response.data.map(role => role.id);
    roleAssignVisible.value = true;
  } catch (error) {
    message.error('è·å–ç”¨æˆ·è§’è‰²å¤±è´¥');
  }
};

// è§’è‰²åˆ†é…ç¡®è®¤
const handleRoleAssignConfirm = async () => {
  try {
    const roleIds = await roleAssignRef.value.getRoleIds();
    await userManagementApi.assignRoles(currentUser.value.id, roleIds);
    message.success('è§’è‰²åˆ†é…æˆåŠŸ');
    roleAssignVisible.value = false;
    loadUsers();
  } catch (error) {
    message.error('è§’è‰²åˆ†é…å¤±è´¥');
  }
};

// é‡ç½®å¯†ç 
const handleResetPassword = (record) => {
  Modal.confirm({
    title: 'ç¡®è®¤é‡ç½®å¯†ç ',
    content: `ç¡®å®šè¦é‡ç½®ç”¨æˆ·"${record.realName}"çš„å¯†ç å—ï¼Ÿ`,
    onOk: async () => {
      try {
        await userManagementApi.resetPassword(record.id, {
          newPassword: '123456',
          requireChangeOnFirstLogin: true
        });
        message.success('å¯†ç é‡ç½®æˆåŠŸï¼Œæ–°å¯†ç ï¼š123456');
      } catch (error) {
        message.error('å¯†ç é‡ç½®å¤±è´¥');
      }
    },
  });
};

// æŸ¥çœ‹ç™»å½•æ—¥å¿—
const handleViewLoginLogs = async (record) => {
  try {
    const response = await userManagementApi.getLoginLogs({
      userId: record.id,
      pageSize: 20
    });
    // è¿™é‡Œå¯ä»¥æ˜¾ç¤ºç™»å½•æ—¥å¿—å¼¹çª—
    console.log('ç™»å½•æ—¥å¿—:', response.data);
  } catch (error) {
    message.error('è·å–ç™»å½•æ—¥å¿—å¤±è´¥');
  }
};

// æ›´æ–°ç”¨æˆ·çŠ¶æ€
const handleUpdateStatus = async (record, status) => {
  try {
    await userManagementApi.updateUser(record.id, { status });
    message.success('çŠ¶æ€æ›´æ–°æˆåŠŸ');
    loadUsers();
  } catch (error) {
    message.error('çŠ¶æ€æ›´æ–°å¤±è´¥');
  }
};

// åˆ é™¤ç”¨æˆ·
const handleDeleteUser = (record) => {
  Modal.confirm({
    title: 'ç¡®è®¤åˆ é™¤',
    content: `ç¡®å®šè¦åˆ é™¤ç”¨æˆ·"${record.realName}"å—ï¼Ÿ`,
    onOk: async () => {
      try {
        await userManagementApi.deleteUser(record.id);
        message.success('ç”¨æˆ·åˆ é™¤æˆåŠŸ');
        loadUsers();
      } catch (error) {
        message.error('ç”¨æˆ·åˆ é™¤å¤±è´¥');
      }
    },
  });
};

// æ‰¹é‡å¯¼å…¥
const handleBatchImport = () => {
  emit('import');
};

// æ‰¹é‡å¯¼å‡º
const handleBatchExport = () => {
  emit('export', {
    type: 'users',
    ids: selectedRowKeys.value
  });
};

// æ‰¹é‡æ“ä½œ
const handleBatchOperation = () => {
  // æ‰¹é‡æ“ä½œé€»è¾‘
  console.log('æ‰¹é‡æ“ä½œ:', selectedRowKeys.value);
};

// åˆ·æ–°
const handleRefresh = () => {
  loadUsers();
};

// åˆ‡æ¢åˆ—è®¾ç½®
const toggleColumnSettings = () => {
  columnSettingsVisible.value = true;
};

// ä¿å­˜åˆ—è®¾ç½®
const handleColumnSettingsSave = () => {
  columnSettingsVisible.value = false;
};

// åˆ—å˜åŒ–
const handleColumnChange = (columns) => {
  visibleColumns.value = columns;
};

// è·å–çŠ¶æ€å¾½æ ‡
const getStatusBadge = (status) => {
  const statusMap = {
    active: 'success',
    inactive: 'default',
    locked: 'error',
  };
  return statusMap[status] || 'default';
};

// è·å–çŠ¶æ€æ–‡æœ¬
const getStatusText = (status) => {
  const statusMap = {
    active: 'å¯ç”¨',
    inactive: 'ç¦ç”¨',
    locked: 'é”å®š',
  };
  return statusMap[status] || 'æœªçŸ¥';
};

// è·å–è§’è‰²é¢œè‰²
const getRoleColor = (roleCode) => {
  const colorMap = {
    'admin': 'red',
    'hr': 'blue',
    'manager': 'green',
    'employee': 'default'
  };
  return colorMap[roleCode] || 'default';
};

// æ ¼å¼åŒ–æ—¥æœŸæ—¶é—´
const formatDateTime = (dateTime) => {
  if (!dateTime) return '';
  return new Date(dateTime).toLocaleString('zh-CN');
};

onMounted(() => {
  loadUsers();
  loadRoles();
});
</script>

<style scoped lang="less">
.user-table {
  background: #fff;
  border-radius: 8px;
  padding: 16px;

  .table-toolbar {
    margin-bottom: 16px;
    padding: 16px;
    background: #fafafa;
    border-radius: 4px;
  }

  .table-actions {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 16px;

    .actions-left,
    .actions-right {
      display: flex;
      gap: 8px;
    }
  }

  .text-muted {
    color: #999;
    font-style: italic;
  }
}
</style>
```

### 2. ç³»ç»Ÿç›‘æ§

```vue
<!-- src/views/business/attendance/system/system-monitor/components/PerformanceMonitor.vue -->
<template>
  <div class="performance-monitor">
    <!-- å®æ—¶æŒ‡æ ‡å¡ç‰‡ -->
    <div class="metrics-cards">
      <a-row :gutter="16">
        <a-col :span="6" v-for="(metric, index) in metricsData" :key="index">
          <a-card :bordered="false" class="metric-card">
            <div class="metric-header">
              <span class="metric-title">{{ metric.title }}</span>
              <a-tag :color="getMetricColor(metric.status)">{{ metric.statusText }}</a-tag>
            </div>
            <div class="metric-value">
              <span class="value">{{ metric.value }}</span>
              <span class="unit">{{ metric.unit }}</span>
            </div>
            <div class="metric-trend" v-if="metric.trend">
              <component :is="metric.trend > 0 ? 'ArrowUpOutlined' : 'ArrowDownOutlined'"
                        :style="{ color: metric.trend > 0 ? '#52c41a' : '#ff4d4f' }" />
              <span>{{ Math.abs(metric.trend) }}%</span>
              <span class="trend-text">è¾ƒä¸ŠæœŸ</span>
            </div>
          </a-card>
        </a-col>
      </a-row>
    </div>

    <!-- ç›‘æ§å›¾è¡¨ -->
    <div class="monitoring-charts">
      <a-row :gutter="16">
        <a-col :span="12">
          <a-card title="CPUä½¿ç”¨ç‡" :bordered="false">
            <div ref="cpuChartRef" class="chart-container"></div>
          </a-card>
        </a-col>
        <a-col :span="12">
          <a-card title="å†…å­˜ä½¿ç”¨ç‡" :bordered="false">
            <div ref="memoryChartRef" class="chart-container"></div>
          </a-card>
        </a-col>
      </a-row>

      <a-row :gutter="16" style="margin-top: 16px;">
        <a-col :span="12">
          <a-card title="ç£ç›˜ä½¿ç”¨ç‡" :bordered="false">
            <div ref="diskChartRef" class="chart-container"></div>
          </a-card>
        </a-col>
        <a-col :span="12">
          <a-card title="ç½‘ç»œæµé‡" :bordered="false">
            <div ref="networkChartRef" class="chart-container"></div>
          </a-card>
        </a-col>
      </a-row>
    </div>

    <!-- ç³»ç»Ÿä¿¡æ¯ -->
    <div class="system-info">
      <a-card title="ç³»ç»Ÿä¿¡æ¯" :bordered="false">
        <a-descriptions :column="3" bordered>
          <a-descriptions-item label="ç³»ç»Ÿç‰ˆæœ¬">
            {{ systemInfo.version }}
          </a-descriptions-item>
          <a-descriptions-item label="è¿è¡Œæ—¶é—´">
            {{ systemInfo.uptime }}
          </a-descriptions-item>
          <a-descriptions-item label="æœåŠ¡å™¨æ—¶é—´">
            {{ systemInfo.serverTime }}
          </a-descriptions-item>
          <a-descriptions-item label="CPUå‹å·">
            {{ systemInfo.cpuModel }}
          </a-descriptions-item>
          <a-descriptions-item label="å†…å­˜æ€»é‡">
            {{ systemInfo.totalMemory }}
          </a-descriptions-item>
          <a-descriptions-item label="ç£ç›˜ç©ºé—´">
            {{ systemInfo.diskSpace }}
          </a-descriptions-item>
        </a-descriptions>
      </a-card>
    </div>

    <!-- è¿›ç¨‹ç›‘æ§ -->
    <div class="process-monitor">
      <a-card title="è¿›ç¨‹ç›‘æ§" :bordered="false">
        <template #extra>
          <a-space>
            <a-button @click="refreshProcesses" :loading="refreshingProcesses">
              <template #icon><ReloadOutlined /></template>
              åˆ·æ–°
            </a-button>
            <a-button @click="killSelectedProcess" :disabled="!selectedProcess">
              <template #icon><StopOutlined /></template>
              ç»“æŸè¿›ç¨‹
            </a-button>
          </a-space>
        </template>

        <a-table
          :columns="processColumns"
          :data-source="processData"
          :loading="loadingProcesses"
          :pagination="false"
          size="small"
          :row-selection="processRowSelection"
          @row-select="handleProcessSelect"
        >
          <template #bodyCell="{ column, record }">
            <template v-if="column.key === 'status'">
              <a-badge :status="getProcessStatusBadge(record.status)" />
            </template>
            <template v-else-if="column.key === 'memory'">
              {{ formatBytes(record.memory) }}
            </template>
            <template v-else-if="column.key === 'cpu'">
              {{ record.cpu }}%
            </template>
          </template>
        </a-table>
      </a-card>
    </div>

    <!-- å‘Šè­¦ä¿¡æ¯ -->
    <div class="alert-info">
      <a-card title="å‘Šè­¦ä¿¡æ¯" :bordered="false">
        <template #extra>
          <a-badge :count="alertData.unhandled" :offset="[10, 0]">
            <a-button @click="viewAllAlerts">
              æŸ¥çœ‹å…¨éƒ¨
            </a-button>
          </a-badge>
        </template>

        <a-list :data-source="recentAlerts" :loading="loadingAlerts">
          <template #renderItem="{ item }">
            <a-list-item>
              <a-list-item-meta>
                <template #avatar>
                  <a-badge :status="getAlertBadge(item.level)" />
                </template>
                <template #title>
                  <span :style="{ color: getAlertColor(item.level) }">{{ item.title }}</span>
                </template>
                <template #description>
                  {{ item.description }}
                </template>
              </a-list-item-meta>
              <div class="alert-actions">
                <a-button type="link" size="small" @click="handleAlert(item)">
                  å¤„ç†
                </a-button>
                <a-button type="link" size="small" @click="ignoreAlert(item)">
                  å¿½ç•¥
                </a-button>
              </div>
            </a-list-item>
          </template>
        </a-list>
      </a-card>
    </div>
  </div>
</template>

<script setup>
import { ref, reactive, onMounted, onUnmounted } from 'vue';
import { message } from 'ant-design-vue';
import {
  ArrowUpOutlined,
  ArrowDownOutlined,
  ReloadOutlined,
  StopOutlined
} from '@ant-design/icons-vue';
import * as echarts from 'echarts';
import { monitorApi } from '/@/api/business/attendance/system/monitor-api';

const emit = defineEmits(['alert-handle', 'alert-ignore']);

const cpuChartRef = ref();
const memoryChartRef = ref();
const diskChartRef = ref();
const networkChartRef = ref();

const loadingProcesses = ref(false);
const loadingAlerts = ref(false);
const refreshingProcesses = ref(false);
const selectedProcess = ref(null);

const metricsData = ref([
  {
    title: 'CPUä½¿ç”¨ç‡',
    value: 45.2,
    unit: '%',
    status: 'normal',
    statusText: 'æ­£å¸¸',
    trend: 2.5
  },
  {
    title: 'å†…å­˜ä½¿ç”¨ç‡',
    value: 68.7,
    unit: '%',
    status: 'warning',
    statusText: 'è­¦å‘Š',
    trend: 5.2
  },
  {
    title: 'ç£ç›˜ä½¿ç”¨ç‡',
    value: 32.1,
    unit: '%',
    status: 'normal',
    statusText: 'æ­£å¸¸',
    trend: -1.2
  },
  {
    title: 'ç½‘ç»œå¸¦å®½',
    value: 125.6,
    unit: 'Mbps',
    status: 'normal',
    statusText: 'æ­£å¸¸',
    trend: 8.7
  }
]);

const systemInfo = reactive({
  version: 'v1.0.0',
  uptime: '15å¤© 8å°æ—¶ 32åˆ†é’Ÿ',
  serverTime: '',
  cpuModel: 'Intel Xeon E5-2680 v4',
  totalMemory: '32GB',
  diskSpace: '500GB / 1TB'
});

const processData = ref([]);
const recentAlerts = ref([]);
const alertData = reactive({
  total: 0,
  unhandled: 3
});

const processColumns = [
  {
    title: 'è¿›ç¨‹å',
    dataIndex: 'name',
    key: 'name',
    width: 150,
  },
  {
    title: 'PID',
    dataIndex: 'pid',
    key: 'pid',
    width: 80,
  },
  {
    title: 'CPU',
    dataIndex: 'cpu',
    key: 'cpu',
    width: 80,
    sorter: (a, b) => a.cpu - b.cpu,
  },
  {
    title: 'å†…å­˜',
    dataIndex: 'memory',
    key: 'memory',
    width: 100,
    sorter: (a, b) => a.memory - b.memory,
  },
  {
    title: 'çŠ¶æ€',
    dataIndex: 'status',
    key: 'status',
    width: 80,
  },
  {
    title: 'å¯åŠ¨æ—¶é—´',
    dataIndex: 'startTime',
    key: 'startTime',
    width: 150,
  },
];

const processRowSelection = {
  type: 'radio',
  onChange: (selectedRowKeys, selectedRows) => {
    selectedProcess.value = selectedRows[0];
  },
};

let charts = {};
let updateTimer = null;

// åˆå§‹åŒ–å›¾è¡¨
const initCharts = () => {
  // CPUä½¿ç”¨ç‡å›¾è¡¨
  charts.cpu = echarts.init(cpuChartRef.value);
  const cpuOption = {
    title: { text: 'CPUä½¿ç”¨ç‡', left: 'center', textStyle: { fontSize: 14 } },
    tooltip: { trigger: 'axis' },
    xAxis: { type: 'time', splitLine: { show: false } },
    yAxis: { type: 'value', max: 100, axisLabel: { formatter: '{value}%' } },
    series: [{
      type: 'line',
      data: [],
      smooth: true,
      lineStyle: { width: 2 },
      areaStyle: { opacity: 0.3 },
      itemStyle: { color: '#1890ff' }
    }]
  };
  charts.cpu.setOption(cpuOption);

  // å†…å­˜ä½¿ç”¨ç‡å›¾è¡¨
  charts.memory = echarts.init(memoryChartRef.value);
  const memoryOption = {
    title: { text: 'å†…å­˜ä½¿ç”¨ç‡', left: 'center', textStyle: { fontSize: 14 } },
    tooltip: { trigger: 'axis' },
    xAxis: { type: 'time', splitLine: { show: false } },
    yAxis: { type: 'value', max: 100, axisLabel: { formatter: '{value}%' } },
    series: [{
      type: 'line',
      data: [],
      smooth: true,
      lineStyle: { width: 2 },
      areaStyle: { opacity: 0.3 },
      itemStyle: { color: '#52c41a' }
    }]
  };
  charts.memory.setOption(memoryOption);

  // ç£ç›˜ä½¿ç”¨ç‡å›¾è¡¨
  charts.disk = echarts.init(diskChartRef.value);
  const diskOption = {
    title: { text: 'ç£ç›˜ä½¿ç”¨ç‡', left: 'center', textStyle: { fontSize: 14 } },
    tooltip: { trigger: 'item' },
    series: [{
      type: 'gauge',
      data: [{ value: 32.1, name: 'ä½¿ç”¨ç‡' }],
      detail: { formatter: '{value}%' }
    }]
  };
  charts.disk.setOption(diskOption);

  // ç½‘ç»œæµé‡å›¾è¡¨
  charts.network = echarts.init(networkChartRef.value);
  const networkOption = {
    title: { text: 'ç½‘ç»œæµé‡', left: 'center', textStyle: { fontSize: 14 } },
    tooltip: { trigger: 'axis' },
    legend: { data: ['å…¥ç«™', 'å‡ºç«™'], bottom: 0 },
    xAxis: { type: 'time', splitLine: { show: false } },
    yAxis: { type: 'value' },
    series: [
      {
        name: 'å…¥ç«™',
        type: 'line',
        data: [],
        smooth: true,
        itemStyle: { color: '#1890ff' }
      },
      {
        name: 'å‡ºç«™',
        type: 'line',
        data: [],
        smooth: true,
        itemStyle: { color: '#52c41a' }
      }
    ]
  };
  charts.network.setOption(networkOption);
};

// æ›´æ–°ç›‘æ§æ•°æ®
const updateMonitorData = async () => {
  try {
    const response = await monitorApi.getSystemMetrics();
    const data = response.data;

    // æ›´æ–°æŒ‡æ ‡æ•°æ®
    metricsData.value.forEach(metric => {
      const key = metric.title.replace('ä½¿ç”¨ç‡', '').replace('å¸¦å®½', '').toLowerCase();
      if (data[key]) {
        metric.value = data[key].value;
        metric.status = data[key].status;
        metric.statusText = data[key].statusText;
      }
    });

    // æ›´æ–°å›¾è¡¨æ•°æ®
    updateChartData(data);

    // æ›´æ–°ç³»ç»Ÿä¿¡æ¯
    systemInfo.serverTime = data.serverTime;

  } catch (error) {
    console.error('æ›´æ–°ç›‘æ§æ•°æ®å¤±è´¥:', error);
  }
};

// æ›´æ–°å›¾è¡¨æ•°æ®
const updateChartData = (data) => {
  const now = new Date();

  // æ›´æ–°CPUå›¾è¡¨
  if (charts.cpu && data.cpu) {
    const cpuData = charts.cpu.getOption().series[0].data;
    cpuData.push([now, data.cpu.value]);
    if (cpuData.length > 60) cpuData.shift();
    charts.cpu.setOption({ series: [{ data: cpuData }] });
  }

  // æ›´æ–°å†…å­˜å›¾è¡¨
  if (charts.memory && data.memory) {
    const memoryData = charts.memory.getOption().series[0].data;
    memoryData.push([now, data.memory.value]);
    if (memoryData.length > 60) memoryData.shift();
    charts.memory.setOption({ series: [{ data: memoryData }] });
  }

  // æ›´æ–°ç£ç›˜å›¾è¡¨
  if (charts.disk && data.disk) {
    charts.disk.setOption({
      series: [{ data: [{ value: data.disk.value }] }]
    });
  }

  // æ›´æ–°ç½‘ç»œå›¾è¡¨
  if (charts.network && data.network) {
    const networkOption = charts.network.getOption();
    networkOption.series[0].data.push([now, data.network.inbound]);
    networkOption.series[1].data.push([now, data.network.outbound]);

    if (networkOption.series[0].data.length > 60) {
      networkOption.series[0].data.shift();
      networkOption.series[1].data.shift();
    }
    charts.network.setOption(networkOption);
  }
};

// åŠ è½½è¿›ç¨‹æ•°æ®
const loadProcesses = async () => {
  loadingProcesses.value = true;
  try {
    const response = await monitorApi.getProcesses();
    processData.value = response.data;
  } catch (error) {
    console.error('åŠ è½½è¿›ç¨‹æ•°æ®å¤±è´¥:', error);
    message.error('åŠ è½½è¿›ç¨‹æ•°æ®å¤±è´¥');
  } finally {
    loadingProcesses.value = false;
  }
};

// åˆ·æ–°è¿›ç¨‹
const refreshProcesses = () => {
  refreshingProcesses.value = true;
  loadProcesses().finally(() => {
    refreshingProcesses.value = false;
  });
};

// è¿›ç¨‹é€‰æ‹©
const handleProcessSelect = (selectedRowKeys, selectedRows) => {
  selectedProcess.value = selectedRows[0];
};

// ç»“æŸè¿›ç¨‹
const killSelectedProcess = async () => {
  if (!selectedProcess.value) return;

  try {
    await monitorApi.killProcess(selectedProcess.value.pid);
    message.success('è¿›ç¨‹å·²ç»“æŸ');
    loadProcesses();
  } catch (error) {
    message.error('ç»“æŸè¿›ç¨‹å¤±è´¥');
  }
};

// åŠ è½½å‘Šè­¦æ•°æ®
const loadAlerts = async () => {
  loadingAlerts.value = true;
  try {
    const response = await monitorApi.getAlerts();
    recentAlerts.value = response.data.recent;
    alertData.total = response.data.total;
    alertData.unhandled = response.data.unhandled;
  } catch (error) {
    console.error('åŠ è½½å‘Šè­¦æ•°æ®å¤±è´¥:', error);
    message.error('åŠ è½½å‘Šè­¦æ•°æ®å¤±è´¥');
  } finally {
    loadingAlerts.value = false;
  }
};

// å¤„ç†å‘Šè­¦
const handleAlert = (alert) => {
  emit('alert-handle', alert);
};

// å¿½ç•¥å‘Šè­¦
const ignoreAlert = (alert) => {
  emit('alert-ignore', alert);
};

// æŸ¥çœ‹å…¨éƒ¨å‘Šè­¦
const viewAllAlerts = () => {
  // æŸ¥çœ‹å…¨éƒ¨å‘Šè­¦é€»è¾‘
};

// è·å–è¿›ç¨‹çŠ¶æ€å¾½æ ‡
const getProcessStatusBadge = (status) => {
  const statusMap = {
    running: 'success',
    sleeping: 'default',
    stopped: 'error',
    zombie: 'warning'
  };
  return statusMap[status] || 'default';
};

// è·å–å‘Šè­¦å¾½æ ‡
const getAlertBadge = (level) => {
  const levelMap = {
    info: 'default',
    warning: 'warning',
    error: 'error',
    critical: 'error'
  };
  return levelMap[level] || 'default';
};

// è·å–å‘Šè­¦é¢œè‰²
const getAlertColor = (level) => {
  const colorMap = {
    info: '#1890ff',
    warning: '#faad14',
    error: '#ff4d4f',
    critical: '#ff4d4f'
  };
  return colorMap[level] || '#1890ff';
};

// æ ¼å¼åŒ–å­—èŠ‚æ•°
const formatBytes = (bytes) => {
  if (bytes === 0) return '0 B';
  const k = 1024;
  const sizes = ['B', 'KB', 'MB', 'GB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
};

onMounted(() => {
  initCharts();
  updateMonitorData();
  loadProcesses();
  loadAlerts();

  // å¯åŠ¨å®šæ—¶æ›´æ–°
  updateTimer = setInterval(() => {
    updateMonitorData();
    loadProcesses();
    loadAlerts();
  }, 5000);

  // æ›´æ–°ç³»ç»Ÿæ—¶é—´
  setInterval(() => {
    systemInfo.serverTime = new Date().toLocaleString('zh-CN');
  }, 1000);
});

onUnmounted(() => {
  // æ¸…ç†å®šæ—¶å™¨
  if (updateTimer) {
    clearInterval(updateTimer);
  }

  // é”€æ¯å›¾è¡¨
  Object.values(charts).forEach(chart => {
    if (chart) {
      chart.dispose();
    }
  });
});
</script>

<style scoped lang="less">
.performance-monitor {
  .metrics-cards {
    margin-bottom: 24px;

    .metric-card {
      text-align: center;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      transition: all 0.3s;

      &:hover {
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
        transform: translateY(-2px);
      }

      .metric-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
      }

      .metric-title {
        font-size: 14px;
        color: #666;
      }

      .metric-value {
        margin-bottom: 8px;

        .value {
          font-size: 32px;
          font-weight: 600;
          color: #262626;
          line-height: 1;
        }

        .unit {
          font-size: 14px;
          color: #999;
          margin-left: 4px;
        }
      }

      .metric-trend {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 4px;
        font-size: 12px;

        .trend-text {
          color: #999;
        }
      }
    }
  }

  .monitoring-charts {
    margin-bottom: 24px;

    .chart-container {
      height: 200px;
      width: 100%;
    }
  }

  .system-info {
    margin-bottom: 24px;
  }

  .process-monitor {
    margin-bottom: 24px;
  }

  .alert-info {
    .alert-actions {
      display: flex;
      gap: 8px;
    }
  }
}
</style>
```

## Mockæ•°æ®ç¤ºä¾‹

```javascript
// src/mock/system-mock.js
export const mockUsers = [
  {
    id: 'user001',
    username: 'admin',
    realName: 'ç³»ç»Ÿç®¡ç†å‘˜',
    email: 'admin@company.com',
    phone: '13800138000',
    roles: [{ id: 'role001', name: 'ç³»ç»Ÿç®¡ç†å‘˜', code: 'admin' }],
    department: 'ä¿¡æ¯éƒ¨',
    status: 'active',
    lastLoginTime: '2024-01-15 10:30:00',
    createdAt: '2024-01-01 09:00:00'
  }
];

export const mockSystemMetrics = {
  cpu: { value: 45.2, status: 'normal', statusText: 'æ­£å¸¸' },
  memory: { value: 68.7, status: 'warning', statusText: 'è­¦å‘Š' },
  disk: { value: 32.1, status: 'normal', statusText: 'æ­£å¸¸' },
  network: { inbound: 125.6, outbound: 89.3 }
};

export const mockSystemConfig = {
  basic: {
    systemName: 'ä¼ä¸šè€ƒå‹¤ç®¡ç†ç³»ç»Ÿ',
    version: '1.0.0',
    company: 'ç§‘æŠ€æœ‰é™å…¬å¸'
  },
  time: {
    timezone: 'Asia/Shanghai',
    dateFormat: 'YYYY-MM-DD',
    timeFormat: 'HH:mm:ss'
  },
  backup: {
    enabled: true,
    frequency: 'daily',
    retention: 30
  }
};

export default {
  mockUsers,
  mockSystemMetrics,
  mockSystemConfig
};
```

## å¼€å‘æ³¨æ„äº‹é¡¹æ€»ç»“

### æ ¸å¿ƒåŠŸèƒ½è¦ç‚¹
1. **ç”¨æˆ·æƒé™ç®¡ç†** - ç²¾ç»†çš„ç”¨æˆ·æƒé™æ§åˆ¶ç³»ç»Ÿ
2. **ç³»ç»Ÿé…ç½®** - çµæ´»çš„ç³»ç»Ÿå‚æ•°é…ç½®
3. **å®‰å…¨é˜²æŠ¤** - å¤šå±‚æ¬¡çš„å®‰å…¨é˜²æŠ¤æœºåˆ¶
4. **å®æ—¶ç›‘æ§** - å…¨æ–¹ä½çš„ç³»ç»Ÿæ€§èƒ½ç›‘æ§
5. **è‡ªåŠ¨åŒ–ç»´æŠ¤** - æ™ºèƒ½çš„ç³»ç»Ÿç»´æŠ¤åŠŸèƒ½
6. **å®¡è®¡è¿½è¸ª** - å®Œæ•´çš„æ“ä½œå®¡è®¡æ—¥å¿—

### æ€§èƒ½ä¼˜åŒ–å»ºè®®
1. å¤§é‡æ•°æ®çš„åˆ†é¡µåŠ è½½
2. å®æ—¶æ•°æ®çš„WebSocketæ¨é€
3. ç³»ç»Ÿç›‘æ§æ•°æ®çš„ç¼“å­˜
4. å›¾è¡¨æ¸²æŸ“çš„æ€§èƒ½ä¼˜åŒ–

### ç”¨æˆ·ä½“éªŒä¼˜åŒ–
1. ç›´è§‚çš„ç®¡ç†ç•Œé¢
2. å®æ—¶çš„çŠ¶æ€åé¦ˆ
3. ä¸°å¯Œçš„æ“ä½œæç¤º
4. å®Œå–„çš„é”™è¯¯å¤„ç†

## æ€»ç»“

ç³»ç»Ÿç®¡ç†æ¨¡å—ä½œä¸ºè€ƒå‹¤ç³»ç»Ÿçš„ç®¡ç†ä¸­å¿ƒï¼Œéœ€è¦é‡ç‚¹å…³æ³¨ï¼š

- æƒé™æ§åˆ¶çš„ç²¾ç¡®æ€§å’Œå®‰å…¨æ€§
- ç³»ç»Ÿé…ç½®çš„çµæ´»æ€§å’Œå®Œæ•´æ€§
- å®‰å…¨é˜²æŠ¤çš„å…¨é¢æ€§å’Œæœ‰æ•ˆæ€§
- ç›‘æ§åŠŸèƒ½çš„å®æ—¶æ€§å’Œå‡†ç¡®æ€§
- ç»´æŠ¤æ“ä½œçš„ä¾¿æ·æ€§å’Œè‡ªåŠ¨åŒ–

é€šè¿‡éµå¾ªæœ¬æ–‡æ¡£çš„æŠ€æœ¯è§„èŒƒï¼Œå¯ä»¥æ„å»ºå‡ºåŠŸèƒ½å®Œå–„ã€å®‰å…¨å¯é çš„ç³»ç»Ÿç®¡ç†æ¨¡å—ã€‚