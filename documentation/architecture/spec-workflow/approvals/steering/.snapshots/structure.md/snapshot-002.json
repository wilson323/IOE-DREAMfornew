{
  "id": "snapshot_1764168782418_0wwmyc55y",
  "approvalId": "approval_1764168780801_75h30myjq",
  "approvalTitle": "项目结构文档审批",
  "version": 2,
  "timestamp": "2025-11-26T14:53:02.418Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# IOE-DREAM 项目结构文档\r\n\r\n## 目录组织结构\r\n\r\n### 根目录结构\r\n\r\n```\r\nIOE-DREAM/\r\n├── smart-admin-api-java17-springboot3/     # 后端项目 (Java 17 + Spring Boot 3)\r\n├── smart-admin-web-javascript/             # 前端项目 (Vue 3 + JavaScript)\r\n├── smart-app/                              # 移动端项目 (uni-app)\r\n├── 数据库SQL脚本/                           # 数据库初始化脚本\r\n├── docs/                                   # 项目文档\r\n├── openspec/                               # OpenSpec规范文档\r\n├── .spec-workflow/                         # OpenSpec工作流配置\r\n├── scripts/                                # 自动化脚本\r\n├── .github/                                # GitHub Actions配置\r\n├── CLAUDE.md                               # AI助手指导文档\r\n└── README.md                               # 项目说明文档\r\n```\r\n\r\n### 后端项目结构\r\n\r\n```\r\nsmart-admin-api-java17-springboot3/\r\n├── sa-base/                                # 基础模块 (公共服务)\r\n│   ├── src/main/java/net/lab1024/sa/base/\r\n│   │   ├── common/                         # 公共组件\r\n│   │   │   ├── config/                     # 配置类\r\n│   │   │   ├── constant/                   # 常量定义\r\n│   │   │   ├── domain/                     # 基础实体类\r\n│   │   │   ├── mapper/                     # 基础数据访问\r\n│   │   │   ├── service/                    # 基础服务接口\r\n│   │   │   ├── util/                       # 工具类\r\n│   │   │   └── validation/                 # 验证组件\r\n│   │   ├── config/                         # 配置文件\r\n│   │   └── resources/                      # 资源文件\r\n│   └── pom.xml                            # Maven配置\r\n│\r\n├── sa-admin/                               # 管理模块 (业务实现)\r\n│   ├── src/main/java/net/lab1024/sa/admin/\r\n│   │   ├── common/                         # 管理模块公共组件\r\n│   │   ├── config/                         # 配置类\r\n│   │   ├── module/                         # 业务模块\r\n│   │   │   ├── access/                     # 门禁模块\r\n│   │   │   ├── consume/                    # 消费模块\r\n│   │   │   ├── attendance/                 # 考勤模块\r\n│   │   │   ├── visitor/                    # 访客模块\r\n│   │   │   ├── video/                      # 视频模块\r\n│   │   │   ├── hr/                         # 人事模块\r\n│   │   │   ├── device/                     # 设备模块\r\n│   │   │   └── notification/               # 通知模块\r\n│   │   └── Application.java               # 启动类\r\n│   ├── src/main/resources/\r\n│   │   ├── mapper/                         # MyBatis映射文件\r\n│   │   ├── static/                         # 静态资源\r\n│   │   └── application-dev.yml            # 开发环境配置\r\n│   └── pom.xml                            # Maven配置\r\n│\r\n└── pom.xml                                # 父级Maven配置\r\n```\r\n\r\n### 前端项目结构\r\n\r\n```\r\nsmart-admin-web-javascript/\r\n├── public/                                 # 公共资源\r\n├── src/\r\n│   ├── api/                               # API接口封装\r\n│   │   ├── business/                      # 业务API\r\n│   │   ├── config/                        # 配置API\r\n│   │   └── system/                        # 系统API\r\n│   ├── assets/                            # 静态资源\r\n│   │   ├── images/                        # 图片资源\r\n│   │   ├── styles/                        # 样式文件\r\n│   │   └── fonts/                         # 字体文件\r\n│   ├── components/                        # 通用组件\r\n│   │   ├── common/                        # 公共组件\r\n│   │   ├── form/                          # 表单组件\r\n│   │   └── table/                         # 表格组件\r\n│   ├── config/                            # 配置文件\r\n│   │   ├── axios.js                       # HTTP配置\r\n│   │   ├── router.js                      # 路由配置\r\n│   │   └── vite.config.js                 # Vite配置\r\n│   ├── constants/                         # 常量定义\r\n│   ├── directives/                        # 自定义指令\r\n│   ├── i18n/                             # 国际化\r\n│   ├── layout/                           # 布局组件\r\n│   ├── lib/                              # 第三方库\r\n│   ├── plugins/                          # 插件配置\r\n│   ├── router/                           # 路由配置\r\n│   ├── store/                            # 状态管理\r\n│   ├── theme/                            # 主题配置\r\n│   ├── utils/                            # 工具函数\r\n│   ├── views/                            # 页面组件\r\n│   │   ├── business/                     # 业务页面\r\n│   │   ├── system/                       # 系统页面\r\n│   │   └── example/                      # 示例页面\r\n│   ├── App.vue                           # 根组件\r\n│   └── main.js                           # 入口文件\r\n├── package.json                          # 依赖配置\r\n└── vite.config.js                        # 构建配置\r\n```\r\n\r\n## 命名规范\r\n\r\n### 文件命名\r\n\r\n#### 后端Java文件\r\n- **实体类 (Entity)**: `PascalCase` + `Entity` 后缀 (例: `UserEntity.java`)\r\n- **值对象 (VO)**: `PascalCase` + `VO` 后缀 (例: `UserVO.java`)\r\n- **数据传输对象 (DTO)**: `PascalCase` + `DTO` 后缀 (例: `UserDTO.java`)\r\n- **表单对象 (Form)**: `PascalCase` + `Form` 后缀 (例: `UserForm.java`)\r\n- **控制器 (Controller)**: `PascalCase` + `Controller` 后缀 (例: `UserController.java`)\r\n- **服务接口 (Service)**: `PascalCase` + `Service` 后缀 (例: `UserService.java`)\r\n- **服务实现 (ServiceImpl)**: `PascalCase` + `ServiceImpl` 后缀 (例: `UserServiceImpl.java`)\r\n- **管理器 (Manager)**: `PascalCase` + `Manager` 后缀 (例: `UserManager.java`)\r\n- **数据访问 (DAO)**: `PascalCase` + `Dao` 后缀 (例: `UserDao.java`)\r\n- **枚举类 (Enum)**: `PascalCase` + `Enum` 后缀 (例: `UserStatusEnum.java`)\r\n- **配置类 (Config)**: `PascalCase` + `Config` 后缀 (例: `WebConfig.java`)\r\n\r\n#### 前端JavaScript文件\r\n- **Vue组件**: `PascalCase` (例: `UserList.vue`)\r\n- **JavaScript模块**: `kebab-case` (例: `user-service.js`)\r\n- **TypeScript类型**: `kebab-case` (例: `user-types.ts`)\r\n- **API模块**: `kebab-case` (例: `user-api.js`)\r\n- **工具函数**: `kebab-case` (例: `date-utils.js`)\r\n- **常量文件**: `UPPER_SNAKE_CASE` (例: `API_CONSTANTS.js`)\r\n\r\n### 代码命名\r\n\r\n#### Java代码\r\n- **类名**: `PascalCase` (例: `UserService`, `UserEntity`)\r\n- **方法名**: `camelCase` (例: `getUserById`, `validateUserForm`)\r\n- **变量名**: `camelCase` (例: `userService`, `userId`)\r\n- **常量**: `UPPER_SNAKE_CASE` (例: `MAX_PAGE_SIZE`, `DEFAULT_TIMEOUT`)\r\n- **包名**: `lowercase` + 点分隔 (例: `net.lab1024.sa.admin.module.user`)\r\n\r\n#### JavaScript/TypeScript代码\r\n- **组件名**: `PascalCase` (例: `UserList`, `UserProfile`)\r\n- **函数名**: `camelCase` (例: `getUserList`, `validateForm`)\r\n- **变量名**: `camelCase` (例: `userService`, `isLoading`)\r\n- **常量**: `UPPER_SNAKE_CASE` (例: `API_BASE_URL`, `MAX_RETRY_COUNT`)\r\n- **接口名**: `PascalCase` + `I` 前缀 (例: `IUserService`)\r\n\r\n## 导入模式\r\n\r\n### Java导入顺序\r\n\r\n```java\r\n// 1. Jakarta EE 标准库\r\nimport jakarta.persistence.*;\r\nimport jakarta.validation.*;\r\n\r\n// 2. Spring Framework\r\nimport org.springframework.*;\r\nimport org.springframework.boot.*;\r\n\r\n// 3. 第三方库\r\nimport com.baomidou.mybatisplus.*;\r\nimport lombok.*;\r\n\r\n// 4. 项目内部包\r\nimport net.lab1024.sa.base.common.entity.BaseEntity;\r\nimport net.lab1024.sa.admin.module.user.domain.entity.UserEntity;\r\n\r\n// 5. 同包下的类\r\nimport static net.lab1024.sa.admin.common.util.ResponseUtil.*;\r\n```\r\n\r\n### JavaScript导入顺序\r\n\r\n```javascript\r\n// 1. Node.js 内置模块\r\nimport fs from 'fs';\r\nimport path from 'path';\r\n\r\n// 2. 第三方库\r\nimport axios from 'axios';\r\nimport { ElMessage } from 'element-plus';\r\n\r\n// 3. 项目内部模块 (绝对路径)\r\nimport { useUserStore } from '@/store/user';\r\nimport { UserAPI } from '@/api/business/user';\r\n\r\n// 4. 相对路径导入\r\nimport './UserList.css';\r\nimport UserForm from './components/UserForm.vue';\r\n```\r\n\r\n## 代码结构模式\r\n\r\n### Java类结构模式\r\n\r\n```java\r\npackage net.lab1024.sa.admin.module.user.controller;\r\n\r\n// 1. 导入声明\r\nimport jakarta.annotation.Resource;\r\nimport lombok.extern.slf4j.Slf4j;\r\n\r\n// 2. 类注解\r\n@Slf4j\r\n@RestController\r\n@RequestMapping(\"/api/user\")\r\n@Tag(name = \"用户管理\", description = \"用户信息的增删改查\")\r\npublic class UserController {\r\n\r\n    // 3. 依赖注入\r\n    @Resource\r\n    private UserService userService;\r\n\r\n    // 4. 公共常量\r\n    private static final int MAX_PAGE_SIZE = 100;\r\n\r\n    // 5. 公共方法 (按功能分组)\r\n    // 5.1 查询方法\r\n    @GetMapping(\"/list\")\r\n    public ResponseDTO<PageResult<UserVO>> getUserList(@RequestBody UserQueryForm queryForm) {\r\n        // 实现逻辑\r\n    }\r\n\r\n    @GetMapping(\"/{id}\")\r\n    public ResponseDTO<UserVO> getUserById(@PathVariable Long id) {\r\n        // 实现逻辑\r\n    }\r\n\r\n    // 5.2 修改方法\r\n    @PostMapping(\"/add\")\r\n    public ResponseDTO<Long> addUser(@Valid @RequestBody UserForm userForm) {\r\n        // 实现逻辑\r\n    }\r\n\r\n    @PutMapping(\"/update\")\r\n    public ResponseDTO<Void> updateUser(@Valid @RequestBody UserForm userForm) {\r\n        // 实现逻辑\r\n    }\r\n\r\n    // 5.3 删除方法\r\n    @DeleteMapping(\"/{id}\")\r\n    public ResponseDTO<Void> deleteUser(@PathVariable Long id) {\r\n        // 实现逻辑\r\n    }\r\n\r\n    // 6. 私有方法\r\n    private UserVO convertToVO(UserEntity entity) {\r\n        // 转换逻辑\r\n    }\r\n}\r\n```\r\n\r\n### Vue组件结构模式\r\n\r\n```vue\r\n<template>\r\n  <!-- 1. 模板内容 -->\r\n  <div class=\"user-list\">\r\n    <!-- 搜索区域 -->\r\n    <div class=\"search-form\">\r\n      <!-- 表单组件 -->\r\n    </div>\r\n\r\n    <!-- 操作区域 -->\r\n    <div class=\"action-bar\">\r\n      <!-- 操作按钮 -->\r\n    </div>\r\n\r\n    <!-- 表格区域 -->\r\n    <div class=\"table-container\">\r\n      <!-- 表格组件 -->\r\n    </div>\r\n\r\n    <!-- 分页区域 -->\r\n    <div class=\"pagination\">\r\n      <!-- 分页组件 -->\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\n// 2. 导入声明\r\nimport { ref, reactive, onMounted } from 'vue';\r\nimport { ElMessage, ElMessageBox } from 'element-plus';\r\nimport { UserAPI } from '@/api/business/user';\r\nimport type { UserVO, UserQueryForm } from '@/types/user';\r\n\r\n// 3. 组件属性\r\nconst props = defineProps<{\r\n  departmentId?: number;\r\n}>();\r\n\r\n// 4. 响应式数据\r\nconst loading = ref(false);\r\nconst userList = ref<UserVO[]>([]);\r\nconst queryParams = reactive<UserQueryForm>({\r\n  pageNum: 1,\r\n  pageSize: 20,\r\n  departmentId: props.departmentId,\r\n});\r\n\r\n// 5. 计算属性\r\nconst tableColumns = computed(() => [\r\n  // 表格配置\r\n]);\r\n\r\n// 6. 生命周期钩子\r\nonMounted(() => {\r\n  loadUserList();\r\n});\r\n\r\n// 7. 方法定义\r\nconst loadUserList = async () => {\r\n  try {\r\n    loading.value = true;\r\n    const response = await UserAPI.getUserList(queryParams);\r\n    userList.value = response.data.list;\r\n  } catch (error) {\r\n    ElMessage.error('加载用户列表失败');\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n\r\nconst handleAdd = () => {\r\n  // 新增逻辑\r\n};\r\n\r\nconst handleEdit = (row: UserVO) => {\r\n  // 编辑逻辑\r\n};\r\n\r\nconst handleDelete = async (row: UserVO) => {\r\n  try {\r\n    await ElMessageBox.confirm('确定删除该用户吗？', '提示');\r\n    await UserAPI.deleteUser(row.id);\r\n    ElMessage.success('删除成功');\r\n    loadUserList();\r\n  } catch (error) {\r\n    // 错误处理\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n// 8. 样式定义\r\n.user-list {\r\n  padding: 20px;\r\n\r\n  .search-form {\r\n    margin-bottom: 20px;\r\n  }\r\n\r\n  .action-bar {\r\n    margin-bottom: 20px;\r\n  }\r\n\r\n  .table-container {\r\n    background: white;\r\n    border-radius: 4px;\r\n  }\r\n}\r\n</style>\r\n```\r\n\r\n## 代码组织原则\r\n\r\n### 1. 单一职责原则\r\n- 每个类应该只有一个变化的原因\r\n- 每个文件应该专注于一个功能模块\r\n- 避免过大的类和过长的方法\r\n\r\n### 2. 模块化设计\r\n- 按业务功能组织代码结构\r\n- 明确定义模块边界和接口\r\n- 模块间通过定义良好的接口通信\r\n\r\n### 3. 可测试性\r\n- 依赖注入优先于依赖查找\r\n- 业务逻辑与外部依赖解耦\r\n- 提供清晰的测试入口点\r\n\r\n### 4. 一致性原则\r\n- 遵循项目统一的编码规范\r\n- 使用一致的设计模式和命名约定\r\n- 保持代码风格的一致性\r\n\r\n## 模块边界\r\n\r\n### 分层架构边界\r\n\r\n```\r\n前端层 (Vue Components)\r\n    ↓ API调用 (HTTP/REST)\r\n控制器层 (Controllers)\r\n    ↓ 方法调用\r\n业务逻辑层 (Services)\r\n    ↓ 事务边界\r\n管理器层 (Managers)\r\n    ↓ 数据访问\r\n数据访问层 (DAOs)\r\n    ↓ SQL执行\r\n数据存储层 (MySQL/Redis)\r\n```\r\n\r\n### 业务模块边界\r\n\r\n#### 核心业务模块\r\n- **用户权限模块**: 用户管理、角色管理、权限管理\r\n- **门禁管理模块**: 门禁设备、通行记录、区域权限\r\n- **消费管理模块**: 账户管理、交易记录、结算管理\r\n- **考勤管理模块**: 考勤记录、排班管理、统计分析\r\n- **访客管理模块**: 访客预约、审批流程、通行管理\r\n- **视频监控模块**: 设备管理、录像存储、智能分析\r\n- **设备管理模块**: 设备注册、状态监控、维护管理\r\n- **通知服务模块**: 消息推送、邮件通知、短信服务\r\n\r\n#### 模块依赖规则\r\n- 核心模块不能依赖具体业务模块\r\n- 业务模块间通过服务接口通信\r\n- 避免循环依赖，必要时提取公共服务\r\n\r\n## 代码大小指南\r\n\r\n### 文件大小限制\r\n- **Java类文件**: 最大500行代码 (超过考虑拆分)\r\n- **Vue组件文件**: 最大400行代码 (模板+脚本+样式)\r\n- **JavaScript模块**: 最大300行代码 (超过考虑拆分)\r\n\r\n### 方法/函数大小限制\r\n- **Java方法**: 最大50行代码 (复杂逻辑建议拆分)\r\n- **JavaScript函数**: 最大30行代码 (保持简洁明了)\r\n- **SQL查询**: 最大100行字符 (复杂查询考虑视图)\r\n\r\n### 复杂度限制\r\n- **圈复杂度**: 单个方法不超过10\r\n- **嵌套深度**: 最大4层嵌套\r\n- **参数数量**: 单个方法最多5个参数 (超过考虑对象封装)\r\n\r\n## 前后端分离架构\r\n\r\n### 前后端通信模式\r\n\r\n```\r\n前端 (Vue 3 + TypeScript)\r\n    ↓ RESTful API (HTTP/JSON)\r\n后端网关 (Spring Cloud Gateway)\r\n    ↓ 路由转发\r\n微服务集群\r\n├── 用户权限服务\r\n├── 门禁管理服务\r\n├── 消费管理服务\r\n├── 考勤管理服务\r\n├── 访客管理服务\r\n├── 视频监控服务\r\n├── 设备管理服务\r\n└── 通知服务\r\n```\r\n\r\n### 数据流向规范\r\n\r\n#### 请求数据流\r\n1. 前端组件发起HTTP请求\r\n2. 网关层进行路由和认证\r\n3. 微服务处理业务逻辑\r\n4. 数据访问层操作数据库\r\n5. 响应数据原路返回\r\n\r\n#### 响应数据格式\r\n```json\r\n{\r\n  \"success\": true,\r\n  \"code\": 200,\r\n  \"message\": \"操作成功\",\r\n  \"data\": {\r\n    // 具体业务数据\r\n  },\r\n  \"timestamp\": \"2024-01-01T12:00:00Z\"\r\n}\r\n```\r\n\r\n## 文档标准\r\n\r\n### API文档\r\n- 所有REST API必须有OpenAPI/Swagger文档\r\n- 使用标准HTTP状态码\r\n- 提供完整的请求/响应示例\r\n- 包含错误码和处理说明\r\n\r\n### 代码注释标准\r\n\r\n#### Java类注释\r\n```java\r\n/**\r\n * 用户管理服务\r\n *\r\n * <p>提供用户信息的增删改查功能，包括用户基本信息管理、\r\n * 权限分配、状态管理等功能。</p>\r\n *\r\n * @author 开发团队\r\n * @version 1.0\r\n * @since 2024-01-01\r\n */\r\n@Service\r\npublic class UserService {\r\n\r\n    /**\r\n     * 根据用户ID获取用户信息\r\n     *\r\n     * @param userId 用户ID，不能为null\r\n     * @return 用户信息，如果用户不存在返回null\r\n     * @throws IllegalArgumentException 当userId为null时抛出\r\n     */\r\n    public UserVO getUserById(Long userId) {\r\n        // 实现逻辑\r\n    }\r\n}\r\n```\r\n\r\n#### Vue组件注释\r\n```vue\r\n<!--\r\n  用户列表组件\r\n\r\n  功能：\r\n  - 展示用户列表数据\r\n  - 支持分页查询\r\n  - 支持用户增删改操作\r\n\r\n  @props:\r\n    - departmentId: 部门ID，用于过滤用户\r\n\r\n  @events:\r\n    - user-selected: 用户选择事件\r\n    - user-updated: 用户更新事件\r\n-->\r\n<script setup lang=\"ts\">\r\n// 组件实现\r\n</script>\r\n```\r\n\r\n### README文档标准\r\n- 每个主要模块必须有README.md\r\n- 说明模块功能和使用方法\r\n- 提供快速开始示例\r\n- 包含依赖说明和配置要求\r\n\r\n通过遵循这些结构规范和组织原则，IOE-DREAM项目将保持代码的一致性、可维护性和可扩展性，为团队协作和项目长期发展奠定坚实基础。",
  "fileStats": {
    "size": 17479,
    "lines": 547,
    "lastModified": "2025-11-26T14:52:57.086Z"
  },
  "comments": []
}