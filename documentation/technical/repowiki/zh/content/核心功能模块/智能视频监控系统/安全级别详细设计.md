# IOE-DREAMæ™ºæ…§å›­åŒºä¸€å¡é€šç®¡ç†å¹³å° - æ™ºèƒ½è§†é¢‘ç›‘æ§ç³»ç»Ÿå®‰å…¨çº§åˆ«è¯¦ç»†è®¾è®¡

> **åˆ†çº§é˜²æŠ¤ Â· æƒé™ç²¾ç»† Â· å®‰å…¨å¯æ§**
> **æ›´æ–°æ—¶é—´**: 2025-11-13
> **ç‰ˆæœ¬**: v4.0
> **æ–‡æ¡£ç±»å‹**: å®‰å…¨çº§åˆ«è¯¦ç»†è®¾è®¡

## ğŸ“‹ æ¦‚è¿°

### å®‰å…¨çº§åˆ«ä½“ç³»æˆ˜ç•¥æ„ä¹‰

**äº”çº§å®‰å…¨çº§åˆ«ä½“ç³»**æ˜¯IOE-DREAMæ™ºæ…§å›­åŒºä¸€å¡é€šç®¡ç†å¹³å°æ™ºèƒ½è§†é¢‘ç›‘æ§ç³»ç»Ÿçš„æ ¸å¿ƒå®‰å…¨æœºåˆ¶ï¼Œé€šè¿‡ç»†ç²’åº¦çš„æƒé™æ§åˆ¶ç¡®ä¿ç³»ç»Ÿå®‰å…¨æ€§å’Œåˆè§„æ€§ã€‚è¯¥ä½“ç³»éµå¾ªå›½å®¶ä¿¡æ¯å®‰å…¨ç­‰çº§ä¿æŠ¤åˆ¶åº¦è¦æ±‚ï¼Œç»“åˆä¼ä¸šå®é™…ä¸šåŠ¡åœºæ™¯ï¼Œæ„å»ºäº†å®Œæ•´çš„å®‰å…¨é˜²æŠ¤ä½“ç³»ã€‚

#### è®¾è®¡ç›®æ ‡
- **åˆè§„æ€§**ï¼šç¬¦åˆå›½å®¶ä¿¡æ¯å®‰å…¨ç­‰çº§ä¿æŠ¤ä¸‰çº§ç­‰ä¿è¦æ±‚
- **å¯æ§æ€§**ï¼šå®ç°ç”¨æˆ·æƒé™çš„ç²¾ç»†åŒ–ç®¡ç†å’ŒåŠ¨æ€æ§åˆ¶
- **å¯è¿½æº¯æ€§**ï¼šæä¾›å®Œæ•´çš„æƒé™æ“ä½œå®¡è®¡å’Œè¿½è¸ªèƒ½åŠ›
- **å¯æ‰©å±•æ€§**ï¼šæ”¯æŒæƒé™æ¨¡å‹çš„å®‰å…¨æ‰©å±•å’Œçµæ´»é…ç½®

## ğŸ” äº”çº§å®‰å…¨çº§åˆ«ä½“ç³»

### 1. å®‰å…¨çº§åˆ«æ¶æ„å›¾

```mermaid
graph TB
    A[IOE-DREAMäº”çº§å®‰å…¨ä½“ç³»] --> B[ç»å¯†çº§ Level 5]
    A --> C[æœºå¯†çº§ Level 4]
    A --> D[ç§˜å¯†çº§ Level 3]
    A --> E[å†…éƒ¨çº§ Level 2]
    A --> F[å…¬å¼€çº§ Level 1]

    B --> B1[ç³»ç»Ÿè¶…çº§ç®¡ç†å‘˜]
    B --> B2[ç³»ç»Ÿå®‰å…¨ç®¡ç†å‘˜]
    B --> B3[å®¡è®¡å‘˜]
    B --> B4[ç³»ç»Ÿé…ç½®æƒé™]
    B --> B5[æ‰€æœ‰æ•°æ®è®¿é—®æƒé™]

    C --> C1[é«˜çº§ç®¡ç†å‘˜]
    C --> C2[éƒ¨é—¨ä¸»ç®¡]
    C --> C3[é¡¹ç›®ç»ç†]
    C --> C4[ä¸šåŠ¡ç®¡ç†æƒé™]
    C --> C5[å¤§éƒ¨åˆ†æ•°æ®è®¿é—®æƒé™]

    D --> D1[æ™®é€šç®¡ç†å‘˜]
    D --> D2[ç§‘å®¤ä¸»ä»»]
    D --> D3[åŒºåŸŸè´Ÿè´£äºº]
    D --> D4[å¸¸è§„æ“ä½œæƒé™]
    D --> D5[åˆ†é…æ•°æ®è®¿é—®æƒé™]

    E --> E1[æ“ä½œå‘˜]
    E --> E2[æ™®é€šå‘˜å·¥]
    E --> E3[ç»´æŠ¤äººå‘˜]
    E --> E4[åŸºç¡€æ“ä½œæƒé™]
    E --> E5[åªè¯»æ•°æ®è®¿é—®æƒé™]

    F --> F1[æŸ¥çœ‹è€…]
    F --> F2[è®¿å®¢]
    F --> F3[ä¸´æ—¶ç”¨æˆ·]
    F --> F4[æŸ¥çœ‹æƒé™]
    F --> F5[åŸºç¡€ä¿¡æ¯æŸ¥çœ‹æƒé™]
```

### 2. å®‰å…¨çº§åˆ«è¯¦ç»†å®šä¹‰

#### Level 5 - ç»å¯†çº§ï¼ˆæœ€é«˜æƒé™ï¼‰

**ç”¨æˆ·ç¾¤ä½“**ï¼š
- ç³»ç»Ÿè¶…çº§ç®¡ç†å‘˜
- ç³»ç»Ÿå®‰å…¨ç®¡ç†å‘˜
- å®¡è®¡å‘˜

**æƒé™èŒƒå›´**ï¼š

| æ¨¡å—ç±»åˆ« | æƒé™é¡¹ | è¯´æ˜ |
|---------|-------|------|
| **ç³»ç»Ÿç®¡ç†** | ç³»ç»Ÿé…ç½®ç®¡ç† | å…¨å±€å‚æ•°ã€å®‰å…¨ç­–ç•¥ã€å¤‡ä»½æ¢å¤ |
| | ç”¨æˆ·æƒé™ç®¡ç† | ç”¨æˆ·CRUDã€è§’è‰²åˆ†é…ã€æƒé™é…ç½® |
| | å®‰å…¨çº§åˆ«ç®¡ç† | çº§åˆ«å®šä¹‰ã€æƒé™çŸ©é˜µã€å®¡è®¡é…ç½® |
| | ç³»ç»Ÿç›‘æ§ç®¡ç† | æ€§èƒ½ç›‘æ§ã€èµ„æºç›‘æ§ã€å¥åº·æ£€æŸ¥ |
| **æ ¸å¿ƒä¸šåŠ¡** | è§£ç ä¸Šå¢™ç®¡ç† | è§£ç å™¨é…ç½®ã€å¤§å±ç®¡ç†ã€å…¨å±€è”åŠ¨ |
| | ç®—æ³•åº“ç®¡ç† | AIç®—æ³•é…ç½®ã€æ¨¡å‹æ›´æ–°ã€æ€§èƒ½è°ƒä¼˜ |
| **æ•°æ®è®¿é—®** | æ‰€æœ‰è®¾å¤‡æ•°æ® | è®¾å¤‡åˆ—è¡¨ã€é…ç½®ä¿¡æ¯ã€çŠ¶æ€æ•°æ® |
| | æ‰€æœ‰å½•åƒæ•°æ® | å®æ—¶å½•åƒã€å†å²å½•åƒã€å¤‡ä»½å½•åƒ |
| | æ‰€æœ‰ç”¨æˆ·æ•°æ® | ç”¨æˆ·ä¿¡æ¯ã€æ“ä½œæ—¥å¿—ã€å®¡è®¡æ—¥å¿— |

#### Level 4 - æœºå¯†çº§ï¼ˆé«˜æƒé™ï¼‰

**ç”¨æˆ·ç¾¤ä½“**ï¼š
- é«˜çº§ç®¡ç†å‘˜
- éƒ¨é—¨ä¸»ç®¡
- é¡¹ç›®ç»ç†

**æƒé™èŒƒå›´**ï¼š

| æ¨¡å—ç±»åˆ« | æƒé™é¡¹ | è¯´æ˜ |
|---------|-------|------|
| **è®¾å¤‡ç®¡ç†** | è®¾å¤‡ç®¡ç† | æ‰€æœ‰è®¾å¤‡æ³¨å†Œã€é…ç½®ã€åˆ é™¤ |
| **å®æ—¶ç›‘æ§** | å®æ—¶ç›‘æ§ | æ‰€æœ‰ç›‘æ§ç‚¹é¢„è§ˆã€æ§åˆ¶ |
| **å½•åƒå›æ”¾** | å½•åƒå›æ”¾ | æ‰€æœ‰å½•åƒæŸ¥è¯¢ã€å›æ”¾ã€ä¸‹è½½ |
| **è¡Œä¸ºåˆ†æ** | è¡Œä¸ºåˆ†æ | æ‰€æœ‰åˆ†æè§„åˆ™ã€ç»“æœæŸ¥çœ‹ã€ç®—æ³•é…ç½® |
| **å‘Šè­¦ç®¡ç†** | å‘Šè­¦ç®¡ç† | æ‰€æœ‰å‘Šè­¦é…ç½®ã€å¤„ç†ã€ç»Ÿè®¡ |
| **è§£ç ä¸Šå¢™** | è§£ç ä¸Šå¢™ | æ‰€æœ‰è§£ç å™¨æ§åˆ¶ã€å¤§å±æ“ä½œ |
| **æŠ¥è¡¨ç»Ÿè®¡** | æŠ¥è¡¨ç»Ÿè®¡ | æ‰€æœ‰ç»Ÿè®¡æŠ¥è¡¨ã€æ•°æ®å¯¼å‡º |

#### Level 3 - ç§˜å¯†çº§ï¼ˆä¸­æƒé™ï¼‰

**ç”¨æˆ·ç¾¤ä½“**ï¼š
- æ™®é€šç®¡ç†å‘˜
- ç§‘å®¤ä¸»ä»»
- åŒºåŸŸè´Ÿè´£äºº

**æƒé™èŒƒå›´**ï¼š

| æ¨¡å—ç±»åˆ« | æƒé™é¡¹ | è¯´æ˜ |
|---------|-------|------|
| **è®¾å¤‡ç®¡ç†** | åˆ†é…è®¾å¤‡ç®¡ç† | åˆ†é…è®¾å¤‡çš„æ³¨å†Œã€é…ç½®ã€åˆ é™¤ |
| **å®æ—¶ç›‘æ§** | åˆ†é…ç›‘æ§ç‚¹ | åˆ†é…ç›‘æ§ç‚¹çš„é¢„è§ˆã€æ§åˆ¶ |
| **å½•åƒå›æ”¾** | åˆ†é…è®¾å¤‡å½•åƒ | åˆ†é…è®¾å¤‡å½•åƒçš„æŸ¥è¯¢ã€å›æ”¾ã€ä¸‹è½½ |
| **è¡Œä¸ºåˆ†æ** | åˆ†é…è®¾å¤‡åˆ†æ | åˆ†é…è®¾å¤‡çš„åˆ†æè§„åˆ™ã€ç»“æœæŸ¥çœ‹ |
| **å‘Šè­¦ç®¡ç†** | åˆ†é…è®¾å¤‡å‘Šè­¦ | åˆ†é…è®¾å¤‡å‘Šè­¦çš„å¤„ç†ã€ç»Ÿè®¡ |
| **è§£ç ä¸Šå¢™** | åˆ†é…è§£ç å™¨ | åˆ†é…è§£ç å™¨çš„æ§åˆ¶ã€å¤§å±æ“ä½œ |

#### Level 2 - å†…éƒ¨çº§ï¼ˆä½æƒé™ï¼‰

**ç”¨æˆ·ç¾¤ä½“**ï¼š
- æ“ä½œå‘˜
- æ™®é€šå‘˜å·¥
- ç»´æŠ¤äººå‘˜

**æƒé™èŒƒå›´**ï¼š

| æ¨¡å—ç±»åˆ« | æƒé™é¡¹ | è¯´æ˜ |
|---------|-------|------|
| **å®æ—¶ç›‘æ§** | ç›‘æ§é¢„è§ˆæŸ¥çœ‹ | åˆ†é…ç›‘æ§ç‚¹çš„é¢„è§ˆæŸ¥çœ‹ |
| **å½•åƒå›æ”¾** | å½•åƒæŸ¥çœ‹ | åˆ†é…è®¾å¤‡å½•åƒçš„æŸ¥çœ‹ |
| **å‘Šè­¦ç®¡ç†** | å‘Šè­¦æŸ¥çœ‹å¤„ç† | åˆ†é…è®¾å¤‡å‘Šè­¦çš„æŸ¥çœ‹å’Œå¤„ç† |
| **åŸºç¡€æ“ä½œ** | è®¾å¤‡åŸºç¡€æ“ä½œ | é‡å¯ã€å›ºä»¶å‡çº§ |

#### Level 1 - å…¬å¼€çº§ï¼ˆæœ€ä½æƒé™ï¼‰

**ç”¨æˆ·ç¾¤ä½“**ï¼š
- æŸ¥çœ‹è€…
- è®¿å®¢
- ä¸´æ—¶ç”¨æˆ·

**æƒé™èŒƒå›´**ï¼š

| æ¨¡å—ç±»åˆ« | æƒé™é¡¹ | è¯´æ˜ |
|---------|-------|------|
| **å®æ—¶ç›‘æ§** | åªè¯»é¢„è§ˆ | åˆ†é…ç›‘æ§ç‚¹çš„åªè¯»é¢„è§ˆ |
| **å½•åƒå›æ”¾** | åªè¯»æŸ¥çœ‹ | åˆ†é…è®¾å¤‡å½•åƒçš„åªè¯»æŸ¥çœ‹ |
| **å‘Šè­¦ä¿¡æ¯** | åªè¯»æŸ¥çœ‹ | åˆ†é…è®¾å¤‡å‘Šè­¦çš„åªè¯»æŸ¥çœ‹ |

## ğŸ“Š åŠŸèƒ½æƒé™çŸ©é˜µ

### 1. è®¾å¤‡ç®¡ç†æ¨¡å—æƒé™çŸ©é˜µ

| åŠŸèƒ½é¡¹ | Level 5 | Level 4 | Level 3 | Level 2 | Level 1 | æƒé™è¯´æ˜ |
|--------|---------|---------|---------|---------|---------|---------|
| **è®¾å¤‡æ³¨å†Œ** |
| æ‰‹åŠ¨æ–°å¢è®¾å¤‡ | âœ… | âœ… | âœ… | âŒ | âŒ | æ‰‹åŠ¨æ·»åŠ å•ä¸ªè®¾å¤‡ |
| æ‰¹é‡å¯¼å…¥è®¾å¤‡ | âœ… | âœ… | âœ… | âŒ | âŒ | Excel/CSVæ‰¹é‡å¯¼å…¥ |
| è‡ªåŠ¨æ£€æµ‹è®¾å¤‡ | âœ… | âœ… | âœ… | âŒ | âŒ | è‡ªåŠ¨æ‰«æç½‘ç»œè®¾å¤‡ |
| è®¾å¤‡æ¨¡æ¿ç®¡ç† | âœ… | âœ… | âœ… | âŒ | âŒ | è®¾å¤‡é…ç½®æ¨¡æ¿ |
| **è®¾å¤‡é…ç½®** |
| åŸºç¡€ä¿¡æ¯é…ç½® | âœ… | âœ… | âœ… | âŒ | âŒ | è®¾å¤‡åç§°ã€ä½ç½®ã€æè¿° |
| è§†é¢‘å‚æ•°é…ç½® | âœ… | âœ… | âœ… | âŒ | âŒ | åˆ†è¾¨ç‡ã€ç ç‡ã€å¸§ç‡ |
| å½•åƒå‚æ•°é…ç½® | âœ… | âœ… | âœ… | âŒ | âŒ | å½•åƒè®¡åˆ’ã€å­˜å‚¨ç­–ç•¥ |
| ç½‘ç»œå‚æ•°é…ç½® | âœ… | âœ… | âœ… | âŒ | âŒ | IPåœ°å€ã€ç«¯å£ã€åè®® |
| AIç®—æ³•é…ç½® | âœ… | âœ… | âŒ | âŒ | âŒ | è¡Œä¸ºåˆ†æç®—æ³•å‚æ•° |
| **è®¾å¤‡æ“ä½œ** |
| è®¾å¤‡é‡å¯ | âœ… | âœ… | âœ… | âœ… | âŒ | è¿œç¨‹é‡å¯è®¾å¤‡ |
| å›ºä»¶å‡çº§ | âœ… | âœ… | âœ… | âŒ | âŒ | è®¾å¤‡å›ºä»¶åœ¨çº¿å‡çº§ |
| è®¾å¤‡åˆ é™¤ | âœ… | âœ… | âŒ | âŒ | âŒ | ä»ç³»ç»Ÿä¸­åˆ é™¤è®¾å¤‡ |
| è®¾å¤‡åˆ†ç»„ | âœ… | âœ… | âœ… | âŒ | âŒ | è®¾å¤‡åˆ†ç»„ç®¡ç† |
| **è®¾å¤‡æŸ¥çœ‹** |
| è®¾å¤‡åˆ—è¡¨æŸ¥çœ‹ | âœ… | âœ… | âœ… | âœ… | âœ… | æŸ¥çœ‹è®¾å¤‡åˆ—è¡¨ |
| è®¾å¤‡è¯¦æƒ…æŸ¥çœ‹ | âœ… | âœ… | âœ… | âœ… | âœ… | æŸ¥çœ‹è®¾å¤‡è¯¦ç»†ä¿¡æ¯ |
| è®¾å¤‡çŠ¶æ€æŸ¥çœ‹ | âœ… | âœ… | âœ… | âœ… | âœ… | æŸ¥çœ‹è®¾å¤‡åœ¨çº¿çŠ¶æ€ |
| è®¾å¤‡æ€§èƒ½æŸ¥çœ‹ | âœ… | âœ… | âœ… | âœ… | âŒ | æŸ¥çœ‹è®¾å¤‡æ€§èƒ½æŒ‡æ ‡ |

### 2. å®æ—¶ç›‘æ§æ¨¡å—æƒé™çŸ©é˜µ

| åŠŸèƒ½é¡¹ | Level 5 | Level 4 | Level 3 | Level 2 | Level 1 | æƒé™è¯´æ˜ |
|--------|---------|---------|---------|---------|---------|---------|
| **ç”»é¢é¢„è§ˆ** |
| å•ç”»é¢é¢„è§ˆ | âœ… | âœ… | âœ… | âœ… | âœ… | å•ä¸ªæ‘„åƒå¤´ç”»é¢ |
| 4ç”»é¢é¢„è§ˆ | âœ… | âœ… | âœ… | âœ… | âŒ | 2Ã—2ç”»é¢å¸ƒå±€ |
| 9ç”»é¢é¢„è§ˆ | âœ… | âœ… | âœ… | âœ… | âŒ | 3Ã—3ç”»é¢å¸ƒå±€ |
| 16ç”»é¢é¢„è§ˆ | âœ… | âœ… | âœ… | âŒ | âŒ | 4Ã—4ç”»é¢å¸ƒå±€ |
| 25ç”»é¢é¢„è§ˆ | âœ… | âœ… | âœ… | âŒ | âŒ | 5Ã—5ç”»é¢å¸ƒå±€ |
| å…¨å±é¢„è§ˆ | âœ… | âœ… | âœ… | âœ… | âœ… | å•ä¸ªç”»é¢å…¨å± |
| **äº‘å°æ§åˆ¶** |
| æ–¹å‘æ§åˆ¶ | âœ… | âœ… | âœ… | âœ… | âŒ | ä¸Šä¸‹å·¦å³ç§»åŠ¨ |
| å˜ç„¦æ§åˆ¶ | âœ… | âœ… | âœ… | âœ… | âŒ | å…‰å­¦å˜ç„¦/æ•°å­—å˜ç„¦ |
| é¢„ç½®ä½è®¾ç½® | âœ… | âœ… | âœ… | âŒ | âŒ | è®¾ç½®é¢„ç½®ä½ç½® |
| å·¡èˆªè®¾ç½® | âœ… | âœ… | âœ… | âŒ | âŒ | è‡ªåŠ¨æ¼«æ¸¸è·¯å¾„ |
| **ç”»é¢æ“ä½œ** |
| æˆªå›¾åŠŸèƒ½ | âœ… | âœ… | âœ… | âœ… | âŒ | æŠ“æ‹å½“å‰ç”»é¢ |
| å½•åƒåŠŸèƒ½ | âœ… | âœ… | âœ… | âŒ | âŒ | æœ¬åœ°å½•åƒå½•åˆ¶ |
| ç”»é¢è°ƒèŠ‚ | âœ… | âœ… | âœ… | âœ… | âŒ | äº®åº¦ã€å¯¹æ¯”åº¦ã€è‰²è°ƒ |
| ç”µå­æ”¾å¤§ | âœ… | âœ… | âœ… | âœ… | âœ… | æ•°å­—æ”¾å¤§åŠŸèƒ½ |

### 3. å½•åƒå›æ”¾æ¨¡å—æƒé™çŸ©é˜µ

| åŠŸèƒ½é¡¹ | Level 5 | Level 4 | Level 3 | Level 2 | Level 1 | æƒé™è¯´æ˜ |
|--------|---------|---------|---------|---------|---------|---------|
| **å½•åƒæŸ¥è¯¢** |
| æ—¶é—´æ®µæŸ¥è¯¢ | âœ… | âœ… | âœ… | âœ… | âœ… | æŒ‰æ—¶é—´èŒƒå›´æŸ¥è¯¢ |
| è®¾å¤‡æŸ¥è¯¢ | âœ… | âœ… | âœ… | âœ… | âœ… | æŒ‰è®¾å¤‡IDæŸ¥è¯¢ |
| äº‹ä»¶æŸ¥è¯¢ | âœ… | âœ… | âœ… | âœ… | âŒ | æŒ‰äº‹ä»¶ç±»å‹æŸ¥è¯¢ |
| é«˜çº§æŸ¥è¯¢ | âœ… | âœ… | âœ… | âœ… | âŒ | å¤šæ¡ä»¶ç»„åˆæŸ¥è¯¢ |
| **å›æ”¾æ§åˆ¶** |
| æ’­æ”¾/æš‚åœ | âœ… | âœ… | âœ… | âœ… | âœ… | åŸºæœ¬å›æ”¾æ§åˆ¶ |
| å€é€Ÿæ’­æ”¾ | âœ… | âœ… | âœ… | âœ… | âœ… | å¤šå€é€Ÿæ’­æ”¾ |
| æ—¶é—´è·³è½¬ | âœ… | âœ… | âœ… | âœ… | âœ… | æŒ‡å®šæ—¶é—´è·³è½¬ |
| å•å¸§æ’­æ”¾ | âœ… | âœ… | âœ… | âœ… | âŒ | é€å¸§ç²¾ç¡®æ’­æ”¾ |
| **å½•åƒæ“ä½œ** |
| å½•åƒä¸‹è½½ | âœ… | âœ… | âœ… | âŒ | âŒ | ä¸‹è½½åˆ°æœ¬åœ° |
| å½•åƒåˆ é™¤ | âœ… | âœ… | âŒ | âŒ | âŒ | åˆ é™¤å½•åƒæ–‡ä»¶ |
| å½•åƒå¤‡ä»½ | âœ… | âœ… | âŒ | âŒ | âŒ | å¤‡ä»½åˆ°å­˜å‚¨æœåŠ¡å™¨ |
| å½•åƒå‰ªè¾‘ | âœ… | âœ… | âŒ | âŒ | âŒ | å‰ªè¾‘è§†é¢‘ç‰‡æ®µ |
| **ç»Ÿè®¡æŠ¥è¡¨** |
| å½•åƒç»Ÿè®¡ | âœ… | âœ… | âœ… | âœ… | âŒ | å½•åƒä½¿ç”¨ç»Ÿè®¡ |
| å­˜å‚¨åˆ†æ | âœ… | âœ… | âœ… | âœ… | âŒ | å­˜å‚¨ç©ºé—´åˆ†æ |

### 4. è¡Œä¸ºåˆ†ææ¨¡å—æƒé™çŸ©é˜µ

| åŠŸèƒ½é¡¹ | Level 5 | Level 4 | Level 3 | Level 2 | Level 1 | æƒé™è¯´æ˜ |
|--------|---------|---------|---------|---------|---------|---------|
| **ç®—æ³•é…ç½®** |
| ç®—æ³•æ¨¡å‹ç®¡ç† | âœ… | âœ… | âŒ | âŒ | âŒ | AIç®—æ³•æ¨¡å‹ç®¡ç† |
| ç®—æ³•å‚æ•°é…ç½® | âœ… | âœ… | âŒ | âŒ | âŒ | ç®—æ³•è¿è¡Œå‚æ•° |
| ç®—æ³•æ€§èƒ½è°ƒä¼˜ | âœ… | âœ… | âŒ | âŒ | âŒ | æ€§èƒ½å‚æ•°ä¼˜åŒ– |
| **æ£€æµ‹è§„åˆ™** |
| æ£€æµ‹åŒºåŸŸè®¾ç½® | âœ… | âœ… | âŒ | âŒ | âŒ | åˆ†æåŒºåŸŸåˆ’å®š |
| æ£€æµ‹è§„åˆ™é…ç½® | âœ… | âœ… | âŒ | âŒ | âŒ | è¡Œä¸ºæ£€æµ‹è§„åˆ™ |
| å‘Šè­¦é˜ˆå€¼è®¾ç½® | âœ… | âœ… | âŒ | âŒ | âŒ | å‘Šè­¦è§¦å‘é˜ˆå€¼ |
| **åˆ†æç»“æœ** |
| å®æ—¶åˆ†ææŸ¥çœ‹ | âœ… | âœ… | âœ… | âœ… | âœ… | å®æ—¶åˆ†æç»“æœ |
| å†å²ç»“æœæŸ¥çœ‹ | âœ… | âœ… | âœ… | âœ… | âœ… | å†å²åˆ†æè®°å½• |
| ç»“æœå¯¼å‡º | âœ… | âœ… | âœ… | âŒ | âŒ | åˆ†æç»“æœå¯¼å‡º |
| ç»“æœåˆ é™¤ | âœ… | âœ… | âŒ | âŒ | âŒ | åˆ†æè®°å½•åˆ é™¤ |

### 5. å‘Šè­¦ç®¡ç†æ¨¡å—æƒé™çŸ©é˜µ

| åŠŸèƒ½é¡¹ | Level 5 | Level 4 | Level 3 | Level 2 | Level 1 | æƒé™è¯´æ˜ |
|--------|---------|---------|---------|---------|---------|---------|
| **å‘Šè­¦é…ç½®** |
| å‘Šè­¦è§„åˆ™é…ç½® | âœ… | âœ… | âœ… | âŒ | âŒ | å‘Šè­¦è§¦å‘è§„åˆ™ |
| å‘Šè­¦è”åŠ¨é…ç½® | âœ… | âœ… | âœ… | âŒ | âŒ | å‘Šè­¦è”åŠ¨åŠ¨ä½œ |
| å‘Šè­¦é€šçŸ¥é…ç½® | âœ… | âœ… | âŒ | âŒ | âŒ | å‘Šè­¦é€šçŸ¥æ–¹å¼ |
| å‘Šè­¦æ¨¡æ¿ç®¡ç† | âœ… | âœ… | âœ… | âŒ | âŒ | å‘Šè­¦æ¶ˆæ¯æ¨¡æ¿ |
| **å‘Šè­¦å¤„ç†** |
| å®æ—¶å‘Šè­¦æŸ¥çœ‹ | âœ… | âœ… | âœ… | âœ… | âœ… | å½“å‰å‘Šè­¦åˆ—è¡¨ |
| å‘Šè­¦ç¡®è®¤ | âœ… | âœ… | âœ… | âœ… | âŒ | ç¡®è®¤å‘Šè­¦å¤„ç† |
| å‘Šè­¦å¤„ç† | âœ… | âœ… | âœ… | âœ… | âŒ | å¤„ç†å‘Šè­¦äº‹ä»¶ |
| å‘Šè­¦åé¦ˆ | âœ… | âœ… | âœ… | âœ… | âŒ | æ·»åŠ å¤„ç†åé¦ˆ |
| **å‘Šè­¦æ“ä½œ** |
| å‘Šè­¦æŸ¥è¯¢ | âœ… | âœ… | âœ… | âœ… | âœ… | å†å²å‘Šè­¦æŸ¥è¯¢ |
| å‘Šè­¦å¯¼å‡º | âœ… | âœ… | âœ… | âŒ | âŒ | å‘Šè­¦æ•°æ®å¯¼å‡º |
| å‘Šè­¦åˆ é™¤ | âœ… | âœ… | âŒ | âŒ | âŒ | å‘Šè­¦è®°å½•åˆ é™¤ |
| å‘Šè­¦ç»Ÿè®¡ | âœ… | âœ… | âœ… | âœ… | âŒ | å‘Šè­¦ç»Ÿè®¡åˆ†æ |

## ğŸ›¡ï¸ æƒé™æ§åˆ¶å®ç°

### 1. æƒé™æ§åˆ¶æ¶æ„

```java
/**
 * å®‰å…¨çº§åˆ«æ§åˆ¶æ³¨è§£
 */
@Target({ElementType.METHOD, ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface SecurityLevel {
    /**
     * è¦æ±‚çš„å®‰å…¨çº§åˆ«
     */
    int value() default 1;

    /**
     * é¢å¤–çš„åŠŸèƒ½æƒé™
     */
    String[] permissions() default {};

    /**
     * æƒé™æè¿°
     */
    String description() default "";
}

/**
 * åŠŸèƒ½æƒé™æ³¨è§£
 */
@Target({ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface Permission {
    /**
     * æƒé™ä»£ç 
     */
    String value();

    /**
     * æƒé™æè¿°
     */
    String description() default "";

    /**
     * èµ„æºç±»å‹
     */
    String resourceType() default "";
}
```

### 2. æƒé™åˆ‡é¢å®ç°

```java
/**
 * å®‰å…¨æƒé™åˆ‡é¢
 */
@Aspect
@Component
@Slf4j
public class SecurityPermissionAspect {

    @Autowired
    private SecurityLevelService securityLevelService;

    @Autowired
    private PermissionService permissionService;

    @Autowired
    private PermissionCacheManager cacheManager;

    /**
     * å®‰å…¨çº§åˆ«æ£€æŸ¥
     */
    @Around("@annotation(securityLevel)")
    public Object checkSecurityLevel(ProceedingJoinPoint joinPoint, SecurityLevel securityLevel) throws Throwable {
        // è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
        RequestUser currentUser = SecurityUtils.getCurrentUser();
        if (currentUser == null) {
            throw new SecurityException("ç”¨æˆ·æœªç™»å½•");
        }

        // è·å–ç”¨æˆ·å®‰å…¨çº§åˆ«ï¼ˆå¸¦ç¼“å­˜ï¼‰
        Integer userLevel = cacheManager.getUserSecurityLevel(currentUser.getUserId());
        if (userLevel == null) {
            userLevel = securityLevelService.getUserSecurityLevel(currentUser.getUserId());
            cacheManager.cacheUserSecurityLevel(currentUser.getUserId(), userLevel);
        }

        // æ£€æŸ¥å®‰å…¨çº§åˆ«æ˜¯å¦æ»¡è¶³è¦æ±‚
        if (userLevel < securityLevel.value()) {
            log.warn("ç”¨æˆ·{}å®‰å…¨çº§åˆ«{}ä¸è¶³ï¼Œè¦æ±‚Level {}ï¼Œè®¿é—®æ¥å£ï¼š{}",
                    currentUser.getUserName(), userLevel, securityLevel.value(), joinPoint.getSignature().getName());

            throw new SecurityException(String.format("å®‰å…¨çº§åˆ«ä¸è¶³ï¼Œéœ€è¦Level %dï¼Œå½“å‰Level %d",
                    securityLevel.value(), userLevel));
        }

        // æ£€æŸ¥åŠŸèƒ½æƒé™
        if (securityLevel.permissions().length > 0) {
            Set<String> userPermissions = cacheManager.getUserPermissions(currentUser.getUserId());
            if (userPermissions == null) {
                userPermissions = permissionService.getUserPermissions(currentUser.getUserId());
                cacheManager.cacheUserPermissions(currentUser.getUserId(), userPermissions);
            }

            for (String permission : securityLevel.permissions()) {
                if (!userPermissions.contains(permission)) {
                    log.warn("ç”¨æˆ·{}ç¼ºå°‘æƒé™ï¼š{}", currentUser.getUserName(), permission);
                    throw new SecurityException("ç¼ºå°‘æƒé™ï¼š" + permission);
                }
            }
        }

        // è®°å½•æƒé™å®¡è®¡æ—¥å¿—
        recordPermissionAudit(currentUser, joinPoint, securityLevel, true);

        return joinPoint.proceed();
    }

    /**
     * æ•°æ®æƒé™æ£€æŸ¥
     */
    @Around("@annotation(dataPermission)")
    public Object checkDataPermission(ProceedingJoinPoint joinPoint, DataPermission dataPermission) throws Throwable {
        RequestUser currentUser = SecurityUtils.getCurrentUser();
        if (currentUser == null) {
            throw new SecurityException("ç”¨æˆ·æœªç™»å½•");
        }

        // è·å–æ–¹æ³•å‚æ•°ä¸­çš„èµ„æºID
        Object resourceId = extractResourceId(joinPoint.getArgs());
        if (resourceId == null) {
            return joinPoint.proceed();
        }

        // æ£€æŸ¥æ•°æ®æƒé™
        boolean hasPermission = checkDataAccessPermission(
                currentUser.getUserId(),
                dataPermission.value(),
                resourceId
        );

        if (!hasPermission) {
            log.warn("ç”¨æˆ·{}æ— æ•°æ®è®¿é—®æƒé™ï¼Œèµ„æºç±»å‹ï¼š{}ï¼Œèµ„æºIDï¼š{}",
                    currentUser.getUserName(), dataPermission.value(), resourceId);

            recordDataPermissionAudit(currentUser, dataPermission, resourceId, false);
            throw new SecurityException("æ— æ•°æ®è®¿é—®æƒé™");
        }

        recordDataPermissionAudit(currentUser, dataPermission, resourceId, true);
        return joinPoint.proceed();
    }

    /**
     * æå–èµ„æºID
     */
    private Object extractResourceId(Object[] args) {
        for (Object arg : args) {
            if (arg instanceof Long || arg instanceof String) {
                return arg;
            }
            // å¯ä»¥æ”¯æŒæ›´å¤æ‚çš„å¯¹è±¡æå–
            if (arg != null) {
                try {
                    Field idField = arg.getClass().getDeclaredField("id");
                    idField.setAccessible(true);
                    return idField.get(arg);
                } catch (Exception e) {
                    // å¿½ç•¥å¼‚å¸¸ï¼Œç»§ç»­ä¸‹ä¸€ä¸ªå‚æ•°
                }
            }
        }
        return null;
    }

    /**
     * è®°å½•æƒé™å®¡è®¡æ—¥å¿—
     */
    private void recordPermissionAudit(RequestUser user, ProceedingJoinPoint joinPoint,
                                      SecurityLevel securityLevel, boolean success) {
        SecurityAuditLog auditLog = SecurityAuditLog.builder()
                .userId(user.getUserId())
                .userName(user.getUserName())
                .securityLevel(getUserSecurityLevel(user.getUserId()))
                .operationType("ACCESS")
                .operationModule(getModuleName(joinPoint))
                .operationFunction(joinPoint.getSignature().getName())
                .operationData(buildOperationData(joinPoint.getArgs()))
                .checkResult(success ? 1 : 0)
                .clientIp(SecurityUtils.getClientIp())
                .userAgent(SecurityUtils.getUserAgent())
                .operationTime(new Date())
                .build();

        // å¼‚æ­¥è®°å½•å®¡è®¡æ—¥å¿—
        CompletableFuture.runAsync(() -> {
            try {
                securityAuditLogService.insert(auditLog);
            } catch (Exception e) {
                log.error("è®°å½•æƒé™å®¡è®¡æ—¥å¿—å¤±è´¥", e);
            }
        });
    }
}
```

### 3. æƒé™æœåŠ¡å®ç°

```java
/**
 * å®‰å…¨çº§åˆ«æœåŠ¡
 */
@Service
public class SecurityLevelServiceImpl implements SecurityLevelService {

    @Autowired
    private UserSecurityLevelMapper userSecurityLevelMapper;

    @Autowired
    private SecurityLevelConfigMapper securityLevelConfigMapper;

    @Autowired
    private UserDevicePermissionMapper userDevicePermissionMapper;

    /**
     * è·å–ç”¨æˆ·å®‰å…¨çº§åˆ«
     */
    @Override
    @Cacheable(value = "user_security_level", key = "#userId")
    public Integer getUserSecurityLevel(Long userId) {
        UserSecurityLevel userLevel = userSecurityLevelMapper.selectByUserId(userId);
        if (userLevel == null) {
            // é»˜è®¤ä¸ºLevel 1
            return 1;
        }

        // æ£€æŸ¥æ˜¯å¦è¿‡æœŸ
        if (userLevel.getExpireTime() != null && userLevel.getExpireTime().before(new Date())) {
            // è¿‡æœŸåé™çº§åˆ°Level 1
            return 1;
        }

        SecurityLevelConfig config = securityLevelConfigMapper.selectById(userLevel.getSecurityLevelId());
        return config != null ? config.getLevelValue() : 1;
    }

    /**
     * è®¾ç½®ç”¨æˆ·å®‰å…¨çº§åˆ«
     */
    @Override
    @CacheEvict(value = "user_security_level", key = "#userId")
    @Transactional(rollbackFor = Exception.class)
    public void setUserSecurityLevel(Long userId, Integer securityLevelId, Date expireTime, String reason) {
        // æ£€æŸ¥å®‰å…¨çº§åˆ«æ˜¯å¦å­˜åœ¨
        SecurityLevelConfig config = securityLevelConfigMapper.selectById(securityLevelId);
        if (config == null) {
            throw new BusinessException("å®‰å…¨çº§åˆ«ä¸å­˜åœ¨");
        }

        // æ£€æŸ¥æ“ä½œæƒé™ï¼ˆåªæœ‰Level 5å¯ä»¥è®¾ç½®å®‰å…¨çº§åˆ«ï¼‰
        RequestUser currentUser = SecurityUtils.getCurrentUser();
        if (currentUser == null || getUserSecurityLevel(currentUser.getUserId()) < 5) {
            throw new SecurityException("æ— æƒé™è®¾ç½®å®‰å…¨çº§åˆ«");
        }

        UserSecurityLevel userLevel = new UserSecurityLevel();
        userLevel.setUserId(userId);
        userLevel.setSecurityLevelId(securityLevelId);
        userLevel.setStartTime(new Date());
        userLevel.setExpireTime(expireTime);
        userLevel.setReason(reason);
        userLevel.setCreateBy(currentUser.getUserName());
        userLevel.setCreateTime(new Date());

        userSecurityLevelMapper.insertOrUpdate(userLevel);

        // è®°å½•æƒé™å˜æ›´æ—¥å¿—
        recordSecurityLevelChange(userId, securityLevelId, reason);
    }

    /**
     * è·å–ç”¨æˆ·å¯è®¿é—®è®¾å¤‡åˆ—è¡¨
     */
    @Override
    @Cacheable(value = "user_accessible_devices", key = "#userId")
    public List<Long> getAccessibleDeviceIds(Long userId) {
        Integer userLevel = getUserSecurityLevel(userId);

        // Level 5å’Œ4å¯ä»¥è®¿é—®æ‰€æœ‰è®¾å¤‡
        if (userLevel >= 4) {
            return deviceMapper.selectAllDeviceIds();
        }

        // Level 3åŠä»¥ä¸‹åªèƒ½è®¿é—®åˆ†é…è®¾å¤‡
        return userDevicePermissionMapper.selectDeviceIdsByUserId(userId);
    }

    /**
     * æ£€æŸ¥è®¾å¤‡è®¿é—®æƒé™
     */
    @Override
    public boolean hasDevicePermission(Long userId, Long deviceId, String operation) {
        Integer userLevel = getUserSecurityLevel(userId);

        // Level 5å’Œ4æœ‰æ‰€æœ‰è®¾å¤‡æƒé™
        if (userLevel >= 4) {
            return true;
        }

        // æ£€æŸ¥è®¾å¤‡åˆ†é…æƒé™
        UserDevicePermission permission = userDevicePermissionMapper
                .selectByUserAndDevice(userId, deviceId);

        if (permission == null) {
            return false;
        }

        // æ ¹æ®å®‰å…¨çº§åˆ«å’Œæ“ä½œç±»å‹æ£€æŸ¥æƒé™
        return checkDeviceOperationPermission(userLevel, operation, permission);
    }

    /**
     * æ£€æŸ¥è®¾å¤‡æ“ä½œæƒé™
     */
    private boolean checkDeviceOperationPermission(Integer userLevel, String operation,
                                                 UserDevicePermission permission) {
        switch (userLevel) {
            case 3: // ç§˜å¯†çº§ - å…¨éƒ¨æ“ä½œæƒé™
                return true;
            case 2: // å†…éƒ¨çº§ - åªè¯»å’Œéƒ¨åˆ†æ“ä½œæƒé™
                return permission.getReadOnly() || hasWritePermission(operation);
            case 1: // å…¬å¼€çº§ - åªè¯»æƒé™
                return permission.getViewOnly();
            default:
                return false;
        }
    }

    /**
     * æ£€æŸ¥å†™æ“ä½œæƒé™
     */
    private boolean hasWritePermission(String operation) {
        // å®šä¹‰Level 2å…è®¸çš„å†™æ“ä½œ
        Set<String> allowedWriteOps = Set.of(
                "DEVICE_RESTART", "ALARM_CONFIRM", "ALARM_PROCESS"
        );
        return allowedWriteOps.contains(operation);
    }
}
```

### 4. å‰ç«¯æƒé™æ§åˆ¶

#### Vue3æƒé™ç»„ä»¶
```vue
<!-- æƒé™æ§åˆ¶ç»„ä»¶ -->
<template>
  <div v-if="hasPermission">
    <slot />
  </div>
  <div v-else-if="showUnauthorized">
    <slot name="unauthorized">
      <a-result
        status="403"
        title="403"
        sub-title="æŠ±æ­‰ï¼Œæ‚¨æ²¡æœ‰æƒé™è®¿é—®æ­¤é¡µé¢"
      >
        <template #extra>
          <a-button type="primary" @click="goBack">
            è¿”å›
          </a-button>
        </template>
      </a-result>
    </slot>
  </div>
</template>

<script setup>
import { computed } from 'vue'
import { useUserStore } from '@/stores/modules/user'

const props = defineProps({
  // è¦æ±‚çš„å®‰å…¨çº§åˆ«
  level: {
    type: Number,
    default: 1
  },
  // æƒé™ä»£ç 
  permission: {
    type: String,
    default: ''
  },
  // æ˜¯å¦æ˜¾ç¤ºæœªæˆæƒæç¤º
  showUnauthorized: {
    type: Boolean,
    default: false
  }
})

const userStore = useUserStore()

const hasPermission = computed(() => {
  const userLevel = userStore.userLevel || 1

  // æ£€æŸ¥å®‰å…¨çº§åˆ«
  if (userLevel < props.level) {
    return false
  }

  // æ£€æŸ¥åŠŸèƒ½æƒé™
  if (props.permission) {
    return userStore.permissions?.includes(props.permission) || false
  }

  return true
})

const goBack = () => {
  window.history.back()
}
</script>
```

#### è·¯ç”±æƒé™å®ˆå«
```javascript
// è·¯ç”±æƒé™å®ˆå«
router.beforeEach((to, from, next) => {
  const userStore = useUserStore()

  // æ£€æŸ¥æ˜¯å¦éœ€è¦ç™»å½•
  if (to.meta.requiresAuth && !userStore.isLoggedIn) {
    next('/login')
    return
  }

  // æ£€æŸ¥å®‰å…¨çº§åˆ«
  if (to.meta.securityLevel) {
    const userLevel = userStore.userLevel || 1
    if (userLevel < to.meta.securityLevel) {
      next('/403')
      return
    }
  }

  // æ£€æŸ¥åŠŸèƒ½æƒé™
  if (to.meta.permission) {
    const hasPermission = userStore.permissions?.includes(to.meta.permission) || false
    if (!hasPermission) {
      next('/403')
      return
    }
  }

  next()
})
```

#### APIè¯·æ±‚æƒé™æ‹¦æˆª
```javascript
// APIè¯·æ±‚æƒé™æ‹¦æˆªå™¨
service.interceptors.request.use(
  (config) => {
    const userStore = useUserStore()

    // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ç™»å½•
    if (!userStore.isLoggedIn) {
      return Promise.reject(new Error('ç”¨æˆ·æœªç™»å½•'))
    }

    // æ£€æŸ¥æ¥å£æƒé™ï¼ˆå¦‚æœæœ‰é…ç½®ï¼‰
    if (config.meta?.securityLevel) {
      const userLevel = userStore.userLevel || 1
      if (userLevel < config.meta.securityLevel) {
        return Promise.reject(new Error('å®‰å…¨çº§åˆ«ä¸è¶³'))
      }
    }

    if (config.meta?.permission) {
      const hasPermission = userStore.permissions?.includes(config.meta.permission) || false
      if (!hasPermission) {
        return Promise.reject(new Error('ç¼ºå°‘åŠŸèƒ½æƒé™'))
      }
    }

    return config
  },
  (error) => {
    return Promise.reject(error)
  }
)
```

## ğŸ“Š æƒé™å®¡è®¡ä¸ç›‘æ§

### 1. å®¡è®¡æ—¥å¿—è®¾è®¡

```sql
-- æƒé™å®¡è®¡æ—¥å¿—è¡¨
CREATE TABLE security_audit_log (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'ID',
    user_id BIGINT NOT NULL COMMENT 'ç”¨æˆ·ID',
    user_name VARCHAR(100) NOT NULL COMMENT 'ç”¨æˆ·å',
    user_level INT NOT NULL COMMENT 'ç”¨æˆ·å®‰å…¨çº§åˆ«',
    operation_type VARCHAR(50) NOT NULL COMMENT 'æ“ä½œç±»å‹ï¼šLOGIN/LOGOUT/ACCESS/DENY/CHANGE',
    operation_module VARCHAR(50) NOT NULL COMMENT 'æ“ä½œæ¨¡å—ï¼šDEVICE/MONITOR/RECORD/ALARM/CONFIG',
    operation_function VARCHAR(100) NOT NULL COMMENT 'æ“ä½œåŠŸèƒ½',
    resource_type VARCHAR(50) COMMENT 'èµ„æºç±»å‹ï¼šdevice/record/alarm/config',
    resource_id VARCHAR(100) COMMENT 'èµ„æºID',
    resource_name VARCHAR(200) COMMENT 'èµ„æºåç§°',
    operation_data TEXT COMMENT 'æ“ä½œæ•°æ®ï¼ˆJSONæ ¼å¼ï¼‰',
    permission_checked VARCHAR(200) COMMENT 'æ£€æŸ¥çš„æƒé™',
    check_result TINYINT NOT NULL COMMENT 'æƒé™æ£€æŸ¥ç»“æœï¼š0-å¤±è´¥,1-æˆåŠŸ',
    failure_reason VARCHAR(500) COMMENT 'å¤±è´¥åŸå› ',
    client_ip VARCHAR(50) COMMENT 'å®¢æˆ·ç«¯IP',
    user_agent VARCHAR(500) COMMENT 'ç”¨æˆ·ä»£ç†',
    session_id VARCHAR(100) COMMENT 'ä¼šè¯ID',
    operation_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'æ“ä½œæ—¶é—´',
    duration_ms INT COMMENT 'æ“ä½œè€—æ—¶ï¼ˆæ¯«ç§’ï¼‰',
    INDEX idx_user_id (user_id),
    INDEX idx_user_level (user_level),
    INDEX idx_operation_time (operation_time),
    INDEX idx_operation_type (operation_type),
    INDEX idx_check_result (check_result),
    INDEX idx_client_ip (client_ip)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='æƒé™å®¡è®¡æ—¥å¿—è¡¨';

-- æƒé™å˜æ›´è®°å½•è¡¨
CREATE TABLE security_permission_change (
    id BIGINT PRIMARY KEY AUTO_INCREMENT COMMENT 'ID',
    user_id BIGINT NOT NULL COMMENT 'ç”¨æˆ·ID',
    user_name VARCHAR(100) NOT NULL COMMENT 'ç”¨æˆ·å',
    operator_id BIGINT NOT NULL COMMENT 'æ“ä½œå‘˜ID',
    operator_name VARCHAR(100) NOT NULL COMMENT 'æ“ä½œå‘˜å§“å',
    change_type VARCHAR(50) NOT NULL COMMENT 'å˜æ›´ç±»å‹ï¼šLEVEL/PERMISSION/DEVICE',
    change_data TEXT NOT NULL COMMENT 'å˜æ›´æ•°æ®ï¼ˆJSONæ ¼å¼ï¼‰',
    old_value TEXT COMMENT 'å˜æ›´å‰å€¼',
    new_value TEXT COMMENT 'å˜æ›´åå€¼',
    change_reason VARCHAR(500) COMMENT 'å˜æ›´åŸå› ',
    change_time DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT 'å˜æ›´æ—¶é—´',
    INDEX idx_user_id (user_id),
    INDEX idx_operator_id (operator_id),
    INDEX idx_change_time (change_time),
    INDEX idx_change_type (change_type)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='æƒé™å˜æ›´è®°å½•è¡¨';
```

### 2. å¼‚å¸¸æ£€æµ‹æœºåˆ¶

```java
/**
 * å¼‚å¸¸æƒé™æ£€æµ‹æœåŠ¡
 */
@Service
@Slf4j
public class AnomalyDetectionService {

    @Autowired
    private SecurityAuditLogMapper auditLogMapper;

    @Autowired
    private NotificationService notificationService;

    /**
     * æ£€æµ‹æƒé™å¼‚å¸¸
     */
    @Scheduled(fixedDelay = 300000) // æ¯5åˆ†é’Ÿæ‰§è¡Œä¸€æ¬¡
    public void detectAnomalies() {
        // æ£€æµ‹è¶Šæƒè®¿é—®
        detectUnauthorizedAccess();

        // æ£€æµ‹æƒé™æ»¥ç”¨
        detectPermissionAbuse();

        // æ£€æµ‹å¼‚å¸¸æ—¶é—´è®¿é—®
        detectUnusualTimeAccess();
    }

    /**
     * æ£€æµ‹è¶Šæƒè®¿é—®
     */
    private void detectUnauthorizedAccess() {
        // æŸ¥è¯¢æœ€è¿‘1å°æ—¶å†…çš„æƒé™æ‹’ç»è®°å½•
        List<SecurityAuditLog> deniedLogs = auditLogMapper.selectRecentDeniedAccess(60);

        // æŒ‰ç”¨æˆ·IPåˆ†ç»„ç»Ÿè®¡
        Map<String, List<SecurityAuditLog>> ipGroup = deniedLogs.stream()
                .collect(Collectors.groupingBy(SecurityAuditLog::getClientIp));

        for (Map.Entry<String, List<SecurityAuditLog>> entry : ipGroup.entrySet()) {
            String clientIp = entry.getKey();
            List<SecurityAuditLog> logs = entry.getValue();

            // åŒä¸€IPçŸ­æ—¶é—´å†…å¤šæ¬¡æƒé™æ‹’ç»ï¼Œå¯èƒ½æ˜¯æ”»å‡»
            if (logs.size() >= 10) {
                AnomalyAlert alert = AnomalyAlert.builder()
                        .alertType("UNAUTHORIZED_ACCESS")
                        .clientIp(clientIp)
                        .description(String.format("æ£€æµ‹åˆ°æ¥è‡ª%sçš„%dæ¬¡è¶Šæƒè®¿é—®å°è¯•", clientIp, logs.size()))
                        .severity("HIGH")
                        .createTime(new Date())
                        .build();

                sendAnomalyAlert(alert);
            }
        }
    }

    /**
     * æ£€æµ‹æƒé™æ»¥ç”¨
     */
    private void detectPermissionAbuse() {
        // æŸ¥è¯¢æœ€è¿‘1å°æ—¶å†…çš„æ“ä½œè®°å½•
        List<SecurityAuditLog> recentLogs = auditLogMapper.selectRecentOperations(60);

        // æŒ‰ç”¨æˆ·åˆ†ç»„ç»Ÿè®¡æ“ä½œæ¬¡æ•°
        Map<Long, List<SecurityAuditLog>> userGroup = recentLogs.stream()
                .collect(Collectors.groupingBy(SecurityAuditLog::getUserId));

        for (Map.Entry<Long, List<SecurityAuditLog>> entry : userGroup.entrySet()) {
            Long userId = entry.getKey();
            List<SecurityAuditLog> logs = entry.getValue();

            // åŒä¸€ç”¨æˆ·çŸ­æ—¶é—´å†…æ“ä½œæ¬¡æ•°å¼‚å¸¸ï¼Œå¯èƒ½æ˜¯æƒé™æ»¥ç”¨
            if (logs.size() >= 1000) {
                UserPermissionAnomaly anomaly = UserPermissionAnomaly.builder()
                        .userId(userId)
                        .operationCount(logs.size())
                        .timeWindow(60)
                        .description("ç”¨æˆ·æ“ä½œé¢‘ç‡å¼‚å¸¸")
                        .severity("MEDIUM")
                        .createTime(new Date())
                        .build();

                sendUserPermissionAbuseAlert(anomaly);
            }
        }
    }

    /**
     * å‘é€å¼‚å¸¸å‘Šè­¦
     */
    private void sendAnomalyAlert(AnomalyAlert alert) {
        log.warn("æ£€æµ‹åˆ°æƒé™å¼‚å¸¸ï¼š{}", alert.getDescription());

        // å‘é€å‘Šè­¦é€šçŸ¥
        notificationService.sendSecurityAlert(alert);

        // è®°å½•å¼‚å¸¸æ—¥å¿—
        auditLogMapper.insertAnomalyAlert(alert);

        // å¦‚æœæ˜¯é«˜å±å¼‚å¸¸ï¼Œè€ƒè™‘è‡ªåŠ¨å°ç¦IP
        if ("HIGH".equals(alert.getSeverity())) {
            blockSuspiciousIP(alert.getClientIp());
        }
    }

    /**
     * å°ç¦å¯ç–‘IP
     */
    private void blockSuspiciousIP(String clientIp) {
        // å®ç°IPå°ç¦é€»è¾‘
        // å¯ä»¥åœ¨é˜²ç«å¢™ã€åº”ç”¨ç½‘å…³æˆ–è´Ÿè½½å‡è¡¡å™¨å±‚é¢å®ç°
        log.info("å°ç¦å¯ç–‘IPï¼š{}", clientIp);
    }
}
```

### 3. æƒé™æ€§èƒ½ä¼˜åŒ–

```java
/**
 * æƒé™ç¼“å­˜ç®¡ç†å™¨
 */
@Component
public class PermissionCacheManager {

    @Autowired
    private RedisTemplate<String, Object> redisTemplate;

    // ç¼“å­˜é”®å‰ç¼€
    private static final String USER_LEVEL_KEY = "perm:user:level:";
    private static final String USER_PERMISSIONS_KEY = "perm:user:perms:";
    private static final String USER_DEVICES_KEY = "perm:user:devices:";
    private static final String DEVICE_PERMISSIONS_KEY = "perm:device:";

    // ç¼“å­˜è¿‡æœŸæ—¶é—´
    private static final long SHORT_EXPIRE = 300; // 5åˆ†é’Ÿ
    private static final long MEDIUM_EXPIRE = 1800; // 30åˆ†é’Ÿ
    private static final long LONG_EXPIRE = 3600; // 1å°æ—¶

    /**
     * ç¼“å­˜ç”¨æˆ·å®‰å…¨çº§åˆ«
     */
    public void cacheUserSecurityLevel(Long userId, Integer level) {
        String key = USER_LEVEL_KEY + userId;
        redisTemplate.opsForValue().set(key, level, LONG_EXPIRE, TimeUnit.SECONDS);
    }

    /**
     * ç¼“å­˜ç”¨æˆ·æƒé™é›†åˆ
     */
    public void cacheUserPermissions(Long userId, Set<String> permissions) {
        String key = USER_PERMISSIONS_KEY + userId;
        redisTemplate.opsForValue().set(key, permissions, MEDIUM_EXPIRE, TimeUnit.SECONDS);
    }

    /**
     * ç¼“å­˜ç”¨æˆ·å¯è®¿é—®è®¾å¤‡åˆ—è¡¨
     */
    public void cacheUserDevices(Long userId, List<Long> deviceIds) {
        String key = USER_DEVICES_KEY + userId;
        redisTemplate.opsForValue().set(key, deviceIds, SHORT_EXPIRE, TimeUnit.SECONDS);
    }

    /**
     * ç¼“å­˜è®¾å¤‡æƒé™ä¿¡æ¯
     */
    public void cacheDevicePermissions(Long deviceId, Map<String, Object> permissions) {
        String key = DEVICE_PERMISSIONS_KEY + deviceId;
        redisTemplate.opsForHash().putAll(key, permissions);
        redisTemplate.expire(key, MEDIUM_EXPIRE, TimeUnit.SECONDS);
    }

    /**
     * æ‰¹é‡è·å–ç”¨æˆ·æƒé™ï¼ˆæ”¯æŒPipelineï¼‰
     */
    public Map<String, Object> batchGetUserPermissions(List<Long> userIds) {
        List<String> keys = userIds.stream()
                .map(id -> USER_PERMISSIONS_KEY + id)
                .collect(Collectors.toList());

        List<Object> results = redisTemplate.executePipelined(new SessionCallback<Object>() {
            @Override
            public Object execute(RedisOperations operations) throws DataAccessException {
                for (String key : keys) {
                    operations.opsForValue().get(key);
                }
                return null;
            }
        });

        Map<String, Object> resultMap = new HashMap<>();
        for (int i = 0; i < userIds.size(); i++) {
            resultMap.put(userIds.get(i).toString(), results.get(i));
        }

        return resultMap;
    }

    /**
     * æ¸…é™¤ç”¨æˆ·ç›¸å…³ç¼“å­˜
     */
    @EventListener
    @Async
    public void handlePermissionChange(PermissionChangeEvent event) {
        Long userId = event.getUserId();

        // æ¸…é™¤ç”¨æˆ·ç›¸å…³çš„æ‰€æœ‰ç¼“å­˜
        redisTemplate.delete(USER_LEVEL_KEY + userId);
        redisTemplate.delete(USER_PERMISSIONS_KEY + userId);
        redisTemplate.delete(USER_DEVICES_KEY + userId);

        log.info("æ¸…é™¤ç”¨æˆ·{}çš„æƒé™ç¼“å­˜", userId);
    }

    /**
     * é¢„çƒ­æƒé™ç¼“å­˜
     */
    @EventListener
    @Async
    public void warmupPermissionCache(UserLoginEvent event) {
        Long userId = event.getUserId();

        // é¢„åŠ è½½ç”¨æˆ·æƒé™ç›¸å…³ä¿¡æ¯
        CompletableFuture.runAsync(() -> {
            try {
                // é¢„åŠ è½½ç”¨æˆ·å®‰å…¨çº§åˆ«
                securityLevelService.getUserSecurityLevel(userId);

                // é¢„åŠ è½½ç”¨æˆ·æƒé™é›†åˆ
                permissionService.getUserPermissions(userId);

                // é¢„åŠ è½½ç”¨æˆ·å¯è®¿é—®è®¾å¤‡åˆ—è¡¨
                deviceService.getAccessibleDeviceIds(userId);

                log.info("ç”¨æˆ·{}æƒé™ç¼“å­˜é¢„çƒ­å®Œæˆ", userId);
            } catch (Exception e) {
                log.error("ç”¨æˆ·{}æƒé™ç¼“å­˜é¢„çƒ­å¤±è´¥", userId, e);
            }
        });
    }
}
```

## ğŸ“ æ€»ç»“ä¸å±•æœ›

### æŠ€æœ¯ç‰¹è‰²æ€»ç»“

IOE-DREAMæ™ºæ…§å›­åŒºä¸€å¡é€šç®¡ç†å¹³å°çš„äº”çº§å®‰å…¨çº§åˆ«ä½“ç³»å…·å¤‡ä»¥ä¸‹æ ¸å¿ƒæŠ€æœ¯ç‰¹è‰²ï¼š

#### âœ… å®‰å…¨ä¿éšœ
1. **åˆ†çº§é˜²æŠ¤**ï¼š5çº§å®‰å…¨ä½“ç³»å®ç°ç²¾ç»†åŒ–æƒé™æ§åˆ¶
2. **åŒé‡éªŒè¯**ï¼šåŠŸèƒ½æƒé™ + æ•°æ®æƒé™åŒé‡éªŒè¯æœºåˆ¶
3. **å®æ—¶å®¡è®¡**ï¼šå®Œæ•´çš„æƒé™æ“ä½œå®¡è®¡å’Œå¼‚å¸¸æ£€æµ‹
4. **åŠ¨æ€æ§åˆ¶**ï¼šæ”¯æŒæƒé™çš„å®æ—¶å˜æ›´å’Œç”Ÿæ•ˆ

#### âœ… æ€§èƒ½ä¼˜åŒ–
1. **å¤šçº§ç¼“å­˜**ï¼šRedisåˆ†å¸ƒå¼ç¼“å­˜æå‡æƒé™æ£€æŸ¥æ€§èƒ½
2. **å¼‚æ­¥å¤„ç†**ï¼šå®¡è®¡æ—¥å¿—å¼‚æ­¥è®°å½•ï¼Œä¸å½±å“ä¸šåŠ¡æ€§èƒ½
3. **æ‰¹é‡æ“ä½œ**ï¼šæ”¯æŒæ‰¹é‡æƒé™æ£€æŸ¥å’Œç¼“å­˜é¢„çƒ­
4. **æ™ºèƒ½é™çº§**ï¼šç¼“å­˜å¤±æ•ˆæ—¶è‡ªåŠ¨é™çº§åˆ°æ•°æ®åº“æŸ¥è¯¢

#### âœ… æ‰©å±•èƒ½åŠ›
1. **æ³¨è§£é©±åŠ¨**ï¼šåŸºäºæ³¨è§£çš„æƒé™æ§åˆ¶ï¼Œæ˜“äºæ‰©å±•
2. **äº‹ä»¶é©±åŠ¨**ï¼šæƒé™å˜æ›´äº‹ä»¶é©±åŠ¨ç¼“å­˜æ›´æ–°
3. **é…ç½®åŒ–**ï¼šæƒé™è§„åˆ™å’Œçº§åˆ«é…ç½®åŒ–ç®¡ç†
4. **æ’ä»¶åŒ–**ï¼šæ”¯æŒæƒé™æ£€æŸ¥é€»è¾‘çš„æ’ä»¶åŒ–æ‰©å±•

### å®‰å…¨åˆè§„æ€§

æœ¬å®‰å…¨çº§åˆ«ä½“ç³»è®¾è®¡ä¸¥æ ¼éµå¾ªï¼š
- **ã€Šä¸­åäººæ°‘å…±å’Œå›½ç½‘ç»œå®‰å…¨æ³•ã€‹**
- **ã€Šä¿¡æ¯å®‰å…¨ç­‰çº§ä¿æŠ¤ç®¡ç†åŠæ³•ã€‹**
- **ã€Šä¸ªäººä¿¡æ¯ä¿æŠ¤æ³•ã€‹**
- **ã€Šæ•°æ®å®‰å…¨æ³•ã€‹**

ç¬¦åˆå›½å®¶ä¿¡æ¯å®‰å…¨ç­‰çº§ä¿æŠ¤ä¸‰çº§ç­‰ä¿è¦æ±‚ï¼Œä¸ºæ™ºæ…§å›­åŒºæä¾›ä¼ä¸šçº§å®‰å…¨ä¿éšœã€‚

---

*æœ¬æ–‡æ¡£ä¸ºIOE-DREAMæ™ºæ…§å›­åŒºä¸€å¡é€šç®¡ç†å¹³å°æ™ºèƒ½è§†é¢‘ç›‘æ§ç³»ç»Ÿçš„å®‰å…¨çº§åˆ«è¯¦ç»†è®¾è®¡ï¼Œå°†éšç€å®‰å…¨è¦æ±‚å’ŒæŠ€æœ¯å‘å±•æŒç»­æ›´æ–°å®Œå–„ã€‚*