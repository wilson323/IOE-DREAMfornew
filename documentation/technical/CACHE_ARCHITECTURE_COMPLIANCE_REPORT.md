# ä¸‰çº§ç¼“å­˜æ¶æ„åˆè§„æ€§æŠ¥å‘Š

**ç”Ÿæˆæ—¶é—´**: 2025-12-17  
**æ‰§è¡Œäºº**: IOE-DREAMæ¶æ„å§”å‘˜ä¼š

---

## ğŸ“‹ ä¸‰çº§ç¼“å­˜æ¶æ„æ ‡å‡†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   L1 æœ¬åœ°ç¼“å­˜ (Caffeine)  - æ¯«ç§’çº§å“åº”ï¼Œæ— ç½‘ç»œå¼€é”€              â”‚
â”‚   TTL: 5åˆ†é’Ÿï¼Œå®¹é‡: 10000                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   L2 Redisç¼“å­˜ - åˆ†å¸ƒå¼ä¸€è‡´æ€§ï¼Œé›†ç¾¤å…±äº«                         â”‚
â”‚   TTL: 30åˆ†é’Ÿï¼Œæ”¯æŒé›†ç¾¤æ¨¡å¼                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   L3 ç½‘å…³ç¼“å­˜ (GatewayServiceClient) - å‡å°‘å¾®æœåŠ¡é—´RPCè°ƒç”¨      â”‚
â”‚   TTL: 10åˆ†é’Ÿï¼ŒæœåŠ¡é—´è°ƒç”¨ç»“æœç¼“å­˜                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… åˆè§„çš„ç¼“å­˜ç®¡ç†å™¨

| æ–‡ä»¶ | ä½ç½® | L1 | L2 | L3 | çŠ¶æ€ |
|------|------|:--:|:--:|:--:|------|
| `UnifiedCacheManager.java` | microservices-common-permission/cache | âœ… Caffeine | âœ… Redis | âœ… ç½‘å…³ | âœ… å®Œå…¨åˆè§„ |
| `UnifiedCacheManager.java` | microservices-common/cache | âœ… Caffeine | âœ… Redis | âœ… ç½‘å…³ | âœ… å®Œå…¨åˆè§„ |
| `WorkflowCacheManager.java` | ioedream-oa-service/workflow/cache | âœ… Caffeine | âœ… Redis | âœ… Appç¼“å­˜ | âœ… å®Œå…¨åˆè§„ |
| `RuleCacheManagerImpl.java` | ioedream-attendance-service | âœ… Caffeine | âœ… Redis | - | âœ… å·²ä¼˜åŒ– |
| `PermissionCacheManagerImpl.java` | microservices-common-permission | âœ… æœ¬åœ°ç¼“å­˜ | âœ… Redis | - | âš ï¸ ç¼ºå°‘L3 |

---

## ğŸ“Š ç¼“å­˜å®ç°ç»Ÿè®¡

- **å®Œå…¨åˆè§„ (L1 Caffeine + L2 Redis + L3)**: 4ä¸ª
- **éƒ¨åˆ†åˆè§„ (L1 Caffeine + L2 Redis)**: 1ä¸ª
- **å·²ä¼˜åŒ–**: RuleCacheManagerImpl, WorkflowCacheManager å‡çº§ä¸ºCaffeine

---

## ğŸ”§ æ ¸å¿ƒç¼“å­˜ç®¡ç†å™¨

### 1. UnifiedCacheManager (microservices-common-permission)

**ä¸»è¦ç”¨é€”**: æƒé™æ¨¡å—ç¼“å­˜ç®¡ç†

**ç‰¹æ€§**:
- L1: Caffeineæœ¬åœ°ç¼“å­˜ (TTL 5åˆ†é’Ÿ, å®¹é‡10000)
- L2: Redisåˆ†å¸ƒå¼ç¼“å­˜ (TTL 30åˆ†é’Ÿ)
- L3: ç½‘å…³ç¼“å­˜æ”¯æŒ
- ç¼“å­˜å‘½ä¸­ç»Ÿè®¡
- ç¼“å­˜ç©¿é€/å‡»ç©¿/é›ªå´©é˜²æŠ¤

### 2. UnifiedCacheManager (microservices-common)

**ä¸»è¦ç”¨é€”**: é€šç”¨ç¼“å­˜ç®¡ç†

**ç‰¹æ€§**:
- æ”¯æŒå¤šç§ç¼“å­˜ç±»å‹é…ç½®
- ç¼“å­˜é¢„çƒ­åŠŸèƒ½
- æŒ‰ç±»å‹é…ç½®TTLå’Œç¼“å­˜çº§åˆ«

### 3. WorkflowCacheManager (ioedream-oa-service)

**ä¸»è¦ç”¨é€”**: å·¥ä½œæµç¼“å­˜ç®¡ç†

**ç‰¹æ€§**:
- ä¸‰çº§ç¼“å­˜ (L1æœ¬åœ° + L2 Redis + L3åº”ç”¨ç¼“å­˜)
- ç¼“å­˜ç­–ç•¥å¯é…ç½®
- æ‰¹é‡æ“ä½œæ”¯æŒ
- å®Œæ•´ç»Ÿè®¡åŠŸèƒ½

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [CLAUDE.md - ä¸‰çº§ç¼“å­˜æ¶æ„è§„èŒƒ](../../CLAUDE.md)
- [æŠ€æœ¯æ ˆæ ‡å‡†è§„èŒƒ](./TECHNOLOGY_STACK_STANDARD.md)

---

**ç»´æŠ¤å›¢é˜Ÿ**: IOE-DREAMæ¶æ„å§”å‘˜ä¼š
