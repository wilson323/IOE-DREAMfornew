# IOE-DREAM 性能测试基准文档

> **版本**: v1.0.0  
> **更新日期**: 2025-12-17

---

## 1. 性能指标总览

### 1.1 响应时间要求

| 操作类型 | P50 | P95 | P99 | 最大 |
|----------|-----|-----|-----|------|
| 简单查询 | < 50ms | < 100ms | < 200ms | < 500ms |
| 复杂查询 | < 200ms | < 500ms | < 1s | < 2s |
| 写操作 | < 100ms | < 300ms | < 500ms | < 1s |
| 文件上传 | < 1s | < 3s | < 5s | < 10s |

### 1.2 吞吐量要求

| 模块 | QPS目标 | 并发用户 |
|------|---------|----------|
| 网关 | ≥ 10000 | 5000 |
| 认证 | ≥ 1000 | 500 |
| 门禁 | ≥ 5000 | 2000 |
| 考勤 | ≥ 3000 | 1000 |
| 消费 | ≥ 2000 | 500 |

---

## 2. 各模块性能基准

### 2.1 网关服务

| 指标 | 基准值 | 测试条件 |
|------|--------|----------|
| 路由转发延迟 | < 5ms | 无认证 |
| JWT验证延迟 | < 10ms | 含Token校验 |
| 限流检测延迟 | < 2ms | Redis限流 |
| 最大连接数 | 50000 | Keep-Alive |

### 2.2 门禁服务

| 指标 | 基准值 | 测试条件 |
|------|--------|----------|
| 远程开门响应 | < 500ms | 设备在线 |
| 权限验证 | < 50ms | 缓存命中 |
| 事件查询 | < 200ms | 1000条/页 |
| 实时推送延迟 | < 100ms | WebSocket |

### 2.3 考勤服务

| 指标 | 基准值 | 测试条件 |
|------|--------|----------|
| 打卡响应 | < 200ms | 含定位校验 |
| 排班查询 | < 100ms | 单月数据 |
| 统计计算 | < 2s | 1000人/月 |
| 报表导出 | < 10s | 10000条 |

### 2.4 消费服务

| 指标 | 基准值 | 测试条件 |
|------|--------|----------|
| 消费交易 | < 300ms | 含扣款 |
| 余额查询 | < 50ms | 缓存 |
| 充值处理 | < 500ms | 含事务 |
| 对账查询 | < 1s | 单日数据 |

### 2.5 视频服务

| 指标 | 基准值 | 测试条件 |
|------|--------|----------|
| 视频流获取 | < 2s | 首帧 |
| 云台响应 | < 300ms | 单次指令 |
| 录像查询 | < 500ms | 单日 |
| 告警推送 | < 500ms | WebSocket |

---

## 3. 数据库性能基准

### 3.1 查询性能

| 操作 | 数据量 | 响应时间 |
|------|--------|----------|
| 主键查询 | - | < 5ms |
| 索引查询 | 100万 | < 50ms |
| 分页查询 | 100万 | < 100ms |
| 聚合统计 | 100万 | < 500ms |

### 3.2 连接池配置

```yaml
druid:
  initial-size: 10
  min-idle: 10
  max-active: 100
  max-wait: 60000
```

---

## 4. 缓存性能基准

### 4.1 Redis性能

| 操作 | 基准值 |
|------|--------|
| GET | < 1ms |
| SET | < 1ms |
| HGET | < 1ms |
| 批量操作(100) | < 10ms |

### 4.2 本地缓存(Caffeine)

| 操作 | 基准值 |
|------|--------|
| 读取 | < 0.1ms |
| 写入 | < 0.1ms |
| 命中率目标 | ≥ 90% |

---

## 5. 压测场景

### 5.1 门禁高峰场景

```
场景: 早高峰打卡
并发用户: 1000
持续时间: 30分钟
TPS目标: 500
成功率: ≥ 99.9%
```

### 5.2 消费高峰场景

```
场景: 午餐消费
并发用户: 500
持续时间: 60分钟
TPS目标: 200
成功率: ≥ 99.99%
```

---

## 6. 监控指标

### 6.1 JVM指标

| 指标 | 告警阈值 |
|------|----------|
| 堆内存使用率 | > 80% |
| GC暂停时间 | > 500ms |
| 线程数 | > 500 |

### 6.2 系统指标

| 指标 | 告警阈值 |
|------|----------|
| CPU使用率 | > 80% |
| 内存使用率 | > 85% |
| 磁盘IO | > 80% |

---

**📝 文档维护**: IOE-DREAM架构团队
