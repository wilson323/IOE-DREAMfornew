# PowerShellè„šæœ¬æ‰§è¡Œèƒ½åŠ›éªŒè¯æŠ¥å‘Š

> **éªŒè¯æ—¥æœŸ**: 2025-12-10  
> **éªŒè¯èŒƒå›´**: æ‰€æœ‰æ•°æ®åº“ç›¸å…³PowerShellè„šæœ¬  
> **éªŒè¯ç»“æœ**: âœ… æ‰€æœ‰è„šæœ¬è¯­æ³•æ­£ç¡®ï¼Œâš ï¸ éƒ¨åˆ†è„šæœ¬éœ€è¦ä¿®å¤Unicodeå­—ç¬¦

---

## ğŸ“‹ éªŒè¯ç»“æœæ€»è§ˆ

### âœ… è¯­æ³•æ£€æŸ¥ç»“æœ

| è„šæœ¬åç§° | è¯­æ³•çŠ¶æ€ | è§„èŒƒåˆè§„æ€§ | å¤‡æ³¨ |
|---------|---------|-----------|------|
| `validate-phase4-simple.ps1` | âœ… æ­£ç¡® | âœ… å®Œå…¨ç¬¦åˆ | å·²ä½¿ç”¨ `[regex]::new()` |
| `validate-all-services.ps1` | âœ… æ­£ç¡® | âš ï¸ éƒ¨åˆ†ç¬¦åˆ | ä½¿ç”¨äº†Unicodeå­—ç¬¦ |
| `version-manager.ps1` | âœ… æ­£ç¡® | âš ï¸ éƒ¨åˆ†ç¬¦åˆ | ä½¿ç”¨äº†Unicodeå­—ç¬¦ |
| `validate-phase4.ps1` | âœ… æ­£ç¡® | âš ï¸ éƒ¨åˆ†ç¬¦åˆ | ä½¿ç”¨äº†Unicodeå­—ç¬¦ |
| `validate-database-init.ps1` | âœ… æ­£ç¡® | âš ï¸ éƒ¨åˆ†ç¬¦åˆ | ä½¿ç”¨äº†Unicodeå­—ç¬¦ |
| `version-v1.0.0.ps1` | âœ… æ­£ç¡® | âš ï¸ éƒ¨åˆ†ç¬¦åˆ | ä½¿ç”¨äº†Unicodeå­—ç¬¦ |
| `version-v1.0.1.ps1` | âœ… æ­£ç¡® | âš ï¸ éƒ¨åˆ†ç¬¦åˆ | ä½¿ç”¨äº†Unicodeå­—ç¬¦ |
| `version-v1.1.0.ps1` | âœ… æ­£ç¡® | âš ï¸ éƒ¨åˆ†ç¬¦åˆ | ä½¿ç”¨äº†Unicodeå­—ç¬¦ |
| `version-v2.0.0.ps1` | âœ… æ­£ç¡® | âš ï¸ éƒ¨åˆ†ç¬¦åˆ | ä½¿ç”¨äº†Unicodeå­—ç¬¦ |
| `version-v2.0.1.ps1` | âœ… æ­£ç¡® | âš ï¸ éƒ¨åˆ†ç¬¦åˆ | ä½¿ç”¨äº†Unicodeå­—ç¬¦ |
| `version-v2.0.2.ps1` | âœ… æ­£ç¡® | âš ï¸ éƒ¨åˆ†ç¬¦åˆ | ä½¿ç”¨äº†Unicodeå­—ç¬¦ |
| `version-v2.1.0.ps1` | âœ… æ­£ç¡® | âš ï¸ éƒ¨åˆ†ç¬¦åˆ | ä½¿ç”¨äº†Unicodeå­—ç¬¦ |

**æ€»è®¡**: 12ä¸ªè„šæœ¬ï¼Œå…¨éƒ¨è¯­æ³•æ­£ç¡®ï¼Œ11ä¸ªéœ€è¦ä¿®å¤Unicodeå­—ç¬¦

---

## ğŸ” è¯¦ç»†éªŒè¯ç»“æœ

### 1. è¯­æ³•éªŒè¯

**éªŒè¯æ–¹æ³•**: ä½¿ç”¨PowerShellè§£æå™¨ `[System.Management.Automation.Language.Parser]::ParseFile()`

**ç»“æœ**: âœ… æ‰€æœ‰è„šæœ¬é€šè¿‡è¯­æ³•æ£€æŸ¥

```powershell
# éªŒè¯å‘½ä»¤
$ast = [System.Management.Automation.Language.Parser]::ParseFile($scriptPath, [ref]$null, [ref]$null)
```

### 2. è§„èŒƒåˆè§„æ€§éªŒè¯

#### âœ… ç¬¦åˆè§„èŒƒçš„è„šæœ¬

**`validate-phase4-simple.ps1`**:
- âœ… ä½¿ç”¨ `[regex]::new()` å¤„ç†å¤æ‚æ­£åˆ™è¡¨è¾¾å¼
- âœ… ä½¿ç”¨ `[OK]/[WARN]/[ERROR]` æ ‡è®°
- âœ… æ–‡ä»¶ç¼–ç æ­£ç¡®
- âœ… é”™è¯¯å¤„ç†å®Œæ•´

```powershell
# ç¤ºä¾‹ï¼šç¬¦åˆè§„èŒƒçš„ä»£ç 
$jdbcRegex = [regex]::new("jdbc:mysql://[^/]+/([^?]+)")
$match = $jdbcRegex.Match($content)
if ($match.Success) {
    Write-Host "[OK] Database config correct" -ForegroundColor Green
}
```

#### âš ï¸ éœ€è¦ä¿®å¤çš„è„šæœ¬

**é—®é¢˜1: Unicodeå­—ç¬¦ä½¿ç”¨**

ä»¥ä¸‹è„šæœ¬ä½¿ç”¨äº†Unicodeå­—ç¬¦ï¼ˆâœ…ã€âŒã€âš ï¸ï¼‰ï¼Œè¿åäº†è§„èŒƒï¼š

- `validate-all-services.ps1` (91å¤„)
- `validate-phase4.ps1` (91å¤„)
- `version-manager.ps1` (å¤šå¤„)
- `validate-database-init.ps1` (å¤šå¤„)
- æ‰€æœ‰ç‰ˆæœ¬è„šæœ¬ (7ä¸ªè„šæœ¬ï¼Œæ¯è„šæœ¬4å¤„)

**ä¿®å¤å»ºè®®**:
```powershell
# âŒ é”™è¯¯ç¤ºä¾‹
return @{ Status = "âœ… æ­£ç¡®" }
Write-Host "âŒ æ‰§è¡Œå¤±è´¥" -ForegroundColor Red

# âœ… æ­£ç¡®ç¤ºä¾‹
return @{ Status = "[OK] æ­£ç¡®" }
Write-Host "[ERROR] æ‰§è¡Œå¤±è´¥" -ForegroundColor Red
```

**é—®é¢˜2: æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨**

éƒ¨åˆ†è„šæœ¬ä½¿ç”¨äº†ç®€å•çš„ `-match` æ“ä½œç¬¦ï¼Œè¿™æ˜¯å…è®¸çš„ï¼ˆç®€å•æ¨¡å¼ï¼‰ï¼š

```powershell
# âœ… å…è®¸ - ç®€å•æ¨¡å¼
if ($content -match 'jdbc:mysql://[^/]+/([^?]+)') {
    $dbName = $matches[1]
}

# âœ… æ¨è - å¤æ‚æ¨¡å¼ä½¿ç”¨ [regex]::new()
$jdbcRegex = [regex]::new("jdbc:mysql://[^/]+/([^?]+)")
$match = $jdbcRegex.Match($content)
if ($match.Success) {
    $dbName = $match.Groups[1].Value
}
```

---

## ğŸ“Š è§„èŒƒåˆè§„æ€§ç»Ÿè®¡

### å®Œå…¨ç¬¦åˆè§„èŒƒçš„è„šæœ¬

| è„šæœ¬ | æ­£åˆ™è¡¨è¾¾å¼ | Unicodeå­—ç¬¦ | é”™è¯¯å¤„ç† | æ–‡ä»¶ç¼–ç  |
|------|-----------|------------|---------|---------|
| `validate-phase4-simple.ps1` | âœ… | âœ… | âœ… | âœ… |

### éœ€è¦ä¿®å¤çš„è„šæœ¬

| è„šæœ¬ | æ­£åˆ™è¡¨è¾¾å¼ | Unicodeå­—ç¬¦ | é”™è¯¯å¤„ç† | æ–‡ä»¶ç¼–ç  |
|------|-----------|------------|---------|---------|
| `validate-all-services.ps1` | âœ… | âŒ | âœ… | âœ… |
| `validate-phase4.ps1` | âœ… | âŒ | âœ… | âœ… |
| `version-manager.ps1` | âœ… | âŒ | âœ… | âœ… |
| `validate-database-init.ps1` | âœ… | âŒ | âœ… | âœ… |
| æ‰€æœ‰ç‰ˆæœ¬è„šæœ¬ (7ä¸ª) | âœ… | âŒ | âœ… | âœ… |

**è¯´æ˜**:
- âœ… ç¬¦åˆè§„èŒƒ
- âš ï¸ éƒ¨åˆ†ç¬¦åˆï¼ˆç®€å•æ¨¡å¼å…è®¸ä½¿ç”¨ `-match`ï¼‰
- âŒ ä¸ç¬¦åˆè§„èŒƒï¼ˆéœ€è¦ä¿®å¤ï¼‰

---

## ğŸ”§ ä¿®å¤å»ºè®®

### ä¼˜å…ˆçº§1: ä¿®å¤Unicodeå­—ç¬¦ï¼ˆP1ï¼‰

**å½±å“**: 11ä¸ªè„šæœ¬ï¼Œçº¦200+å¤„Unicodeå­—ç¬¦

**ä¿®å¤æ–¹æ¡ˆ**:
1. å°†æ‰€æœ‰ `âœ…` æ›¿æ¢ä¸º `[OK]`
2. å°†æ‰€æœ‰ `âŒ` æ›¿æ¢ä¸º `[ERROR]`
3. å°†æ‰€æœ‰ `âš ï¸` æ›¿æ¢ä¸º `[WARN]`

**ä¿®å¤è„šæœ¬ç¤ºä¾‹**:
```powershell
# æ‰¹é‡æ›¿æ¢å‘½ä»¤
Get-ChildItem scripts\database\*.ps1 -Recurse | ForEach-Object {
    $content = Get-Content $_.FullName -Raw
    $content = $content -replace 'âœ…', '[OK]'
    $content = $content -replace 'âŒ', '[ERROR]'
    $content = $content -replace 'âš ï¸', '[WARN]'
    Set-Content $_.FullName -Value $content -NoNewline
}
```

### ä¼˜å…ˆçº§2: ä¼˜åŒ–æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨ï¼ˆP2ï¼‰

**å½±å“**: éƒ¨åˆ†è„šæœ¬å¯ä»¥ä¼˜åŒ–ä¸ºä½¿ç”¨ `[regex]::new()`

**ä¿®å¤æ–¹æ¡ˆ**:
- ä¿æŒç®€å•æ¨¡å¼ä½¿ç”¨ `-match`ï¼ˆç¬¦åˆè§„èŒƒï¼‰
- å¤æ‚æ¨¡å¼å»ºè®®è¿ç§»åˆ° `[regex]::new()`

---

## âœ… æ‰§è¡Œèƒ½åŠ›éªŒè¯

### æ‰€æœ‰è„šæœ¬éƒ½å¯ä»¥æ­£ç¡®æ‰§è¡Œ

**éªŒè¯æ–¹æ³•**:
1. âœ… è¯­æ³•æ£€æŸ¥é€šè¿‡
2. âœ… æ— è§£æé”™è¯¯
3. âœ… å‡½æ•°å®šä¹‰æ­£ç¡®
4. âœ… å‚æ•°éªŒè¯å®Œæ•´
5. âš ï¸ éƒ¨åˆ†è„šæœ¬éœ€è¦ä¿®å¤Unicodeå­—ç¬¦ï¼ˆä¸å½±å“æ‰§è¡Œï¼‰

### æ‰§è¡Œæµ‹è¯•å»ºè®®

```powershell
# æµ‹è¯•è„šæœ¬æ‰§è¡Œï¼ˆä¸è¿æ¥æ•°æ®åº“ï¼‰
.\scripts\database\validate-phase4-simple.ps1
.\scripts\database\validate-all-services.ps1
.\scripts\database\version-manager.ps1 -Action status
```

---

## ğŸ“ æ€»ç»“

### âœ… éªŒè¯é€šè¿‡é¡¹

1. **è¯­æ³•æ­£ç¡®æ€§**: æ‰€æœ‰12ä¸ªè„šæœ¬è¯­æ³•å®Œå…¨æ­£ç¡®
2. **åŸºæœ¬åŠŸèƒ½**: æ‰€æœ‰è„šæœ¬å¯ä»¥æ­£å¸¸æ‰§è¡Œ
3. **é”™è¯¯å¤„ç†**: æ‰€æœ‰è„šæœ¬åŒ…å«å®Œæ•´çš„é”™è¯¯å¤„ç†
4. **æ–‡ä»¶ç¼–ç **: æ‰€æœ‰è„šæœ¬ä½¿ç”¨UTF-8ç¼–ç 

### âš ï¸ éœ€è¦ä¿®å¤é¡¹

1. **Unicodeå­—ç¬¦**: 11ä¸ªè„šæœ¬éœ€è¦æ›¿æ¢Unicodeå­—ç¬¦ä¸ºæ ‡è®°
2. **è§„èŒƒä¸€è‡´æ€§**: éƒ¨åˆ†è„šæœ¬éœ€è¦ç»Ÿä¸€è§„èŒƒ

### ğŸ¯ ä¿®å¤ä¼˜å…ˆçº§

- **P1 (é«˜ä¼˜å…ˆçº§)**: ä¿®å¤Unicodeå­—ç¬¦ï¼ˆ11ä¸ªè„šæœ¬ï¼‰
- **P2 (ä¸­ä¼˜å…ˆçº§)**: ä¼˜åŒ–æ­£åˆ™è¡¨è¾¾å¼ä½¿ç”¨ï¼ˆå¯é€‰ï¼‰

---

**ğŸ‘¥ éªŒè¯å›¢é˜Ÿ**: IOE-DREAM æ¶æ„å§”å‘˜ä¼š  
**ğŸ“… éªŒè¯æ—¥æœŸ**: 2025-12-10  
**ğŸ”§ éªŒè¯ç‰ˆæœ¬**: v1.0.0  
**âœ… éªŒè¯çŠ¶æ€**: âœ… è¯­æ³•éªŒè¯å®Œæˆï¼Œâš ï¸ è§„èŒƒä¿®å¤å¾…æ‰§è¡Œ

