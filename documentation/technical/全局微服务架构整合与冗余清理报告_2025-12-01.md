# å…¨å±€å¾®æœåŠ¡æ¶æ„æ•´åˆä¸å†—ä½™æ¸…ç†æŠ¥å‘Š

**æŠ¥å‘Šæ—¥æœŸ**: 2025-12-01
**é¡¹ç›®**: IOE-DREAM ä¼ä¸šçº§æ™ºèƒ½å¹³å°
**æ¶æ„å¸ˆ**: SmartAdmin Team
**ç›®æ ‡**: æ•´åˆå…¨å±€æ¶æ„ï¼Œæ¸…ç†å†—ä½™åŠŸèƒ½ï¼Œç¡®ä¿é¡¹ç›®ä¸€è‡´æ€§

## ğŸ“Š ä¸€ã€é¡¹ç›®ç°çŠ¶åˆ†æ

### 1.1 å¾®æœåŠ¡æ¶æ„ç°çŠ¶

ç»è¿‡æ·±åº¦åˆ†æï¼ŒIOE-DREAMé¡¹ç›®åŒ…å«ä»¥ä¸‹å¾®æœåŠ¡ï¼š

| å¾®æœåŠ¡åç§° | åŠŸèƒ½æè¿° | é‡å¤å®ä½“æ•°é‡ | ä¸»è¦é—®é¢˜ |
|-----------|---------|-------------|---------|
| ioedream-access-service | é—¨ç¦ç®¡ç† | 5ä¸ªï¼ˆDeviceã€Areaã€Userç­‰ï¼‰ | å®ä½“å†—ä½™ä¸¥é‡ |
| ioedream-attendance-service | è€ƒå‹¤ç®¡ç† | 3ä¸ªï¼ˆDeviceã€Userã€Areaï¼‰ | é‡å¤å®šä¹‰ |
| ioedream-consume-service | æ¶ˆè´¹ç®¡ç† | 2ä¸ªï¼ˆDeviceã€Userï¼‰ | éƒ¨åˆ†é‡å¤ |
| ioedream-auth-service | è®¤è¯æœåŠ¡ | 2ä¸ªï¼ˆUserã€Roleï¼‰ | è®¤è¯ä½“ç³»ä¸ç»Ÿä¸€ |
| ioedream-biometric-service | ç”Ÿç‰©è¯†åˆ« | 1ä¸ªï¼ˆæ–°å»ºï¼‰ | æ¶æ„è¾ƒæ–° |
| ioedream-identity-service | èº«ä»½ç®¡ç† | 2ä¸ªï¼ˆUserã€Areaï¼‰ | ä¸authæœåŠ¡é‡å¤ |
| ioedream-device-service | è®¾å¤‡ç®¡ç† | 1ä¸ªï¼ˆDeviceï¼‰ | è®¾å¤‡å®ä½“åˆ†æ•£ |
| å…¶ä»–å¾®æœåŠ¡ | ... | å¤šä¸ª | å„ç§é‡å¤é—®é¢˜ |

### 1.2 ä¸»è¦é—®é¢˜åˆ†æ

#### ğŸ”´ ä¸¥é‡é‡å¤é—®é¢˜ï¼ˆ5å¤„ä»¥ä¸Šï¼‰
1. **DeviceEntity**: åœ¨5ä¸ªå¾®æœåŠ¡ä¸­æœ‰ä¸åŒç‰ˆæœ¬å®šä¹‰
2. **UserEntity**: åœ¨3ä¸ªå¾®æœåŠ¡ä¸­æœ‰å·®å¼‚è¾ƒå¤§çš„å®šä¹‰
3. **Role/Permissionä½“ç³»**: è®¤è¯å’Œæˆæƒä½“ç³»ä¸ç»Ÿä¸€

#### ğŸŸ¡ ä¸­ç­‰é‡å¤é—®é¢˜ï¼ˆ2-4å¤„ï¼‰
1. **AreaEntity**: åŒºåŸŸç®¡ç†å®ä½“é‡å¤å®šä¹‰
2. **å·¥å…·ç±»é‡å¤**: RedisUtilã€æ—¥æœŸå·¥å…·ç­‰é‡å¤å®ç°
3. **æ—¥å¿—å®¡è®¡**: å®¡è®¡æ—¥å¿—å®ä½“å’Œé€»è¾‘åˆ†æ•£

#### ğŸŸ¢ è½»å¾®é‡å¤é—®é¢˜ï¼ˆ1-2å¤„ï¼‰
1. **æšä¸¾ç±»é‡å¤**: çŠ¶æ€ç ã€é”™è¯¯ç ç­‰å®šä¹‰åˆ†æ•£
2. **å¸¸é‡å®šä¹‰**: ä¸šåŠ¡å¸¸é‡åœ¨å¤šå¤„é‡å¤

## ğŸ—ï¸ äºŒã€æ¶æ„æ•´åˆæ–¹æ¡ˆ

### 2.1 å…¬å…±å¾®æœåŠ¡æ¶æ„è®¾è®¡

```
microservices-common/
â”œâ”€â”€ src/main/java/net/lab1024/sa/common/
â”‚   â”œâ”€â”€ entity/                    # åŸºç¡€å®ä½“
â”‚   â”‚   â””â”€â”€ BaseEntity.java       # ç»Ÿä¸€åŸºç¡€å®ä½“
â”‚   â”œâ”€â”€ organization/             # ç»„ç»‡æ¶æ„æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ entity/
â”‚   â”‚   â”‚   â”œâ”€â”€ AreaEntity.java          # åŒºåŸŸå®ä½“ âœ…
â”‚   â”‚   â”‚   â”œâ”€â”€ PersonEntity.java        # äººå‘˜å®ä½“ âœ…
â”‚   â”‚   â”‚   â”œâ”€â”€ DepartmentEntity.java   # éƒ¨é—¨å®ä½“ âœ…
â”‚   â”‚   â”‚   â”œâ”€â”€ DeviceEntity.java        # è®¾å¤‡å®ä½“ âœ…
â”‚   â”‚   â”‚   â””â”€â”€ AreaPersonEntity.java   # åŒºåŸŸäººå‘˜å…³è” âœ…
â”‚   â”‚   â”œâ”€â”€ service/              # ç»„ç»‡æ¶æ„æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ manager/              # ç»„ç»‡æ¶æ„ç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ dao/                  # ç»„ç»‡æ¶æ„DAO
â”‚   â”œâ”€â”€ security/                 # å®‰å…¨è®¤è¯æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ entity/
â”‚   â”‚   â”‚   â”œâ”€â”€ UserEntity.java          # ç”¨æˆ·å®ä½“ âœ…
â”‚   â”‚   â”‚   â”œâ”€â”€ RoleEntity.java          # è§’è‰²å®ä½“ âœ…
â”‚   â”‚   â”‚   â”œâ”€â”€ PermissionEntity.java   # æƒé™å®ä½“ âœ…
â”‚   â”‚   â”‚   â”œâ”€â”€ UserRoleEntity.java     # ç”¨æˆ·è§’è‰²å…³è”
â”‚   â”‚   â”‚   â””â”€â”€ RolePermissionEntity.java # è§’è‰²æƒé™å…³è”
â”‚   â”‚   â”œâ”€â”€ service/              # å®‰å…¨æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ token/                # Tokenç®¡ç†
â”‚   â”‚   â””â”€â”€ auth/                 # è®¤è¯é€»è¾‘
â”‚   â”œâ”€â”€ audit/                    # å®¡è®¡æ—¥å¿—æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ entity/
â”‚   â”‚   â”‚   â””â”€â”€ AuditLogEntity.java       # å®¡è®¡æ—¥å¿—å®ä½“ âœ…
â”‚   â”‚   â”œâ”€â”€ service/              # å®¡è®¡æœåŠ¡
â”‚   â”‚   â””â”€â”€ listener/             # äº‹ä»¶ç›‘å¬å™¨
â”‚   â”œâ”€â”€ config/                   # é…ç½®ç®¡ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ entity/
â”‚   â”‚   â”‚   â””â”€â”€ ConfigEntity.java         # é…ç½®å®ä½“ âœ…
â”‚   â”‚   â”œâ”€â”€ service/              # é…ç½®æœåŠ¡
â”‚   â”‚   â””â”€â”€ cache/                # é…ç½®ç¼“å­˜
â”‚   â”œâ”€â”€ cache/                    # ç¼“å­˜ç®¡ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ RedisUtil.java        # Rediså·¥å…·ç±»
â”‚   â”‚   â”œâ”€â”€ CacheManager.java     # ç¼“å­˜ç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ CacheKey.java         # ç¼“å­˜é”®å®šä¹‰
â”‚   â”œâ”€â”€ util/                     # å·¥å…·ç±»æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ SmartBeanUtil.java    # Beanå·¥å…·
â”‚   â”‚   â”œâ”€â”€ SmartDateUtil.java    # æ—¥æœŸå·¥å…·
â”‚   â”‚   â”œâ”€â”€ SmartStringUtil.java  # å­—ç¬¦ä¸²å·¥å…·
â”‚   â”‚   â””â”€â”€ SmartVerificationUtil.java # éªŒè¯å·¥å…·
â”‚   â”œâ”€â”€ enums/                    # æšä¸¾ç±»æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ StatusEnum.java       # çŠ¶æ€æšä¸¾
â”‚   â”‚   â”œâ”€â”€ ErrorCodeEnum.java    # é”™è¯¯ç æšä¸¾
â”‚   â”‚   â””â”€â”€ BusinessTypeEnum.java # ä¸šåŠ¡ç±»å‹æšä¸¾
â”‚   â”œâ”€â”€ constant/                 # å¸¸é‡ç±»æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ SystemConstant.java   # ç³»ç»Ÿå¸¸é‡
â”‚   â”‚   â””â”€â”€ BusinessConstant.java # ä¸šåŠ¡å¸¸é‡
â”‚   â””â”€â”€ exception/                # å¼‚å¸¸ç±»æ¨¡å—
â”‚       â”œâ”€â”€ BusinessException.java # ä¸šåŠ¡å¼‚å¸¸
â”‚       â””â”€â”€ SystemException.java  # ç³»ç»Ÿå¼‚å¸¸
â””â”€â”€ src/main/resources/
    â”œâ”€â”€ META-INF/spring.factories   # Springè‡ªåŠ¨é…ç½®
    â””â”€â”€ mapper/                      # å…¬å…±Mapperæ˜ å°„
```

### 2.2 æ ¸å¿ƒå®ä½“è®¾è®¡

#### 2.2.1 å·²å®Œæˆçš„å…¬å…±å®ä½“

| å®ä½“åç§° | æ¨¡å— | åŠŸèƒ½æè¿° | çŠ¶æ€ |
|---------|------|----------|------|
| **AreaEntity** | organization | åŒºåŸŸç®¡ç†å®ä½“ï¼Œæ”¯æŒæ— é™å±‚çº§ | âœ… å·²å®Œæˆ |
| **PersonEntity** | organization | äººå‘˜ç®¡ç†å®ä½“ï¼Œæ”¯æŒå¤šç§ç±»å‹ | âœ… å·²å®Œæˆ |
| **DepartmentEntity** | organization | éƒ¨é—¨ç®¡ç†å®ä½“ï¼Œæ”¯æŒå±‚çº§ç»“æ„ | âœ… å·²å®Œæˆ |
| **DeviceEntity** | organization | è®¾å¤‡ç®¡ç†å®ä½“ï¼Œå…³è”åŒºåŸŸä¿¡æ¯ | âœ… å·²å®Œæˆ |
| **AreaPersonEntity** | organization | åŒºåŸŸäººå‘˜å…³è”å®ä½“ï¼Œé¿å…æ•°æ®å†—ä½™ | âœ… å·²å®Œæˆ |
| **UserEntity** | security | ç”¨æˆ·ç®¡ç†å®ä½“ï¼Œç»Ÿä¸€è®¤è¯ä½“ç³» | âœ… å·²å®Œæˆ |
| **RoleEntity** | security | è§’è‰²ç®¡ç†å®ä½“ï¼Œæ”¯æŒRBAC | âœ… å·²å®Œæˆ |
| **PermissionEntity** | security | æƒé™ç®¡ç†å®ä½“ï¼Œç»†ç²’åº¦æƒé™æ§åˆ¶ | âœ… å·²å®Œæˆ |
| **AuditLogEntity** | audit | å®¡è®¡æ—¥å¿—å®ä½“ï¼Œå®Œæ•´çš„æ“ä½œè®°å½• | âœ… å·²å®Œæˆ |
| **ConfigEntity** | config | é…ç½®ç®¡ç†å®ä½“ï¼Œæ”¯æŒå¤šçº§é…ç½® | âœ… å·²å®Œæˆ |

#### 2.2.2 å®ä½“è®¾è®¡åŸåˆ™

1. **ç»Ÿä¸€å­—æ®µæ ‡å‡†**
   - æ‰€æœ‰å®ä½“ç»§æ‰¿è‡ª`BaseEntity`
   - ç»Ÿä¸€ä½¿ç”¨jakartaåŒ…åæ³¨è§£
   - ä¸€è‡´çš„å‘½åè§„èŒƒå’Œç¼–ç æ ‡å‡†

2. **ä¸šåŠ¡æ–¹æ³•ä¸°å¯Œ**
   - æ¯ä¸ªå®ä½“åŒ…å«å®Œæ•´çš„ä¸šåŠ¡æ–¹æ³•
   - æä¾›çŠ¶æ€æ£€æŸ¥å’Œä¸šåŠ¡åˆ¤æ–­
   - æ”¯æŒå¤šç§æŸ¥è¯¢å’Œå±•ç¤ºåœºæ™¯

3. **æ‰©å±•æ€§è®¾è®¡**
   - é€šè¿‡`extendedAttributes`å­—æ®µæ”¯æŒä¸šåŠ¡æ‰©å±•
   - éæ•°æ®åº“å­—æ®µç”¨äºå±•ç¤ºå’Œè®¡ç®—
   - çµæ´»çš„æ•°æ®ç±»å‹å’ŒéªŒè¯è§„åˆ™

### 2.3 å¾®æœåŠ¡è¾¹ç•Œé‡æ–°å®šä¹‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        å‰ç«¯åº”ç”¨å±‚                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      APIç½‘å…³å±‚                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸šåŠ¡å¾®æœåŠ¡å±‚                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚è®¿é—®æ§åˆ¶æœåŠ¡  â”‚ â”‚è€ƒå‹¤ç®¡ç†æœåŠ¡  â”‚ â”‚æ¶ˆè´¹ç®¡ç†æœåŠ¡  â”‚ â”‚è®¿å®¢ç®¡ç†æœåŠ¡  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚è®¤è¯æˆæƒæœåŠ¡  â”‚ â”‚ç”Ÿç‰©è¯†åˆ«æœåŠ¡  â”‚ â”‚è®¾å¤‡ç®¡ç†æœåŠ¡  â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      å…¬å…±æœåŠ¡å±‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚           microservices-common å…¬å…±æ¨¡å—                  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ â”‚
â”‚  â”‚  â”‚ç»„ç»‡æ¶æ„æ¨¡å—  â”‚ â”‚å®‰å…¨è®¤è¯æ¨¡å—  â”‚ â”‚å®¡è®¡æ—¥å¿—æ¨¡å—  â”‚       â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ â”‚
â”‚  â”‚  â”‚é…ç½®ç®¡ç†æ¨¡å—  â”‚ â”‚ç¼“å­˜ç®¡ç†æ¨¡å—  â”‚ â”‚å·¥å…·ç±»æ¨¡å—    â”‚       â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        åŸºç¡€è®¾æ–½å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   MySQL     â”‚ â”‚    Redis    â”‚ â”‚  MessageMQ  â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§¹ ä¸‰ã€å†—ä½™æ¸…ç†è®¡åˆ’
## ğŸ“‹ IOE-DREAMä¸ƒå¾®æœåŠ¡æ¶æ„

**æ ¸å¿ƒæ¶æ„ç»„æˆ**:
- **Gateway Service (8080)**: APIç½‘å…³
- **Common Service (8088)**: å…¬å…±æ¨¡å—å¾®æœåŠ¡
- **DeviceComm Service (8087)**: è®¾å¤‡é€šè®¯å¾®æœåŠ¡
- **OA Service (8089)**: OAå¾®æœåŠ¡
- **Access Service (8090)**: é—¨ç¦æœåŠ¡
- **Attendance Service (8091)**: è€ƒå‹¤æœåŠ¡
- **Video Service (8092)**: è§†é¢‘æœåŠ¡
- **Consume Service (8094)**: æ¶ˆè´¹æœåŠ¡
- **Visitor Service (8095)**: è®¿å®¢æœåŠ¡

**æ¶æ„ç‰¹ç‚¹**:
- åŸºäºSpring Boot 3.5.8 + Java 17
- ä¸¥æ ¼éµå¾ªä¼ä¸šçº§å¾®æœåŠ¡è§„èŒƒ
- æ”¯æŒé«˜å¹¶å‘ã€é«˜å¯ç”¨ã€æ°´å¹³æ‰©å±•

**æŠ€æœ¯æ ˆæ ‡å‡†**:
- **æ•°æ®åº“**: MySQL 8.0 + Druidè¿æ¥æ± 
- **ç¼“å­˜**: Redis + Caffeineå¤šçº§ç¼“å­˜
- **æ³¨å†Œä¸­å¿ƒ**: Nacos
- **é…ç½®ä¸­å¿ƒ**: Nacos Config
- **è®¤è¯æˆæƒ**: Sa-Token

## ğŸ—ï¸ å››å±‚æ¶æ„è§„èŒƒ

**æ ‡å‡†æ¶æ„æ¨¡å¼**:
```
Controller (æ¥å£æ§åˆ¶å±‚)
    â†“
Service (æ ¸å¿ƒä¸šåŠ¡å±‚)
    â†“
Manager (æµç¨‹ç®¡ç†å±‚)
    â†“
DAO (æ•°æ®è®¿é—®å±‚)
```

**å±‚çº§èŒè´£**:
- **Controllerå±‚**: HTTPè¯·æ±‚å¤„ç†ã€å‚æ•°éªŒè¯ã€æƒé™æ§åˆ¶
- **Serviceå±‚**: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ã€äº‹åŠ¡ç®¡ç†ã€ä¸šåŠ¡è§„åˆ™éªŒè¯
- **Managerå±‚**: å¤æ‚æµç¨‹ç¼–æ’ã€å¤šæ•°æ®ç»„è£…ã€ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆ
- **DAOå±‚**: æ•°æ®åº“CRUDæ“ä½œã€SQLæŸ¥è¯¢å®ç°ã€æ•°æ®è®¿é—®è¾¹ç•Œ

**ä¸¥æ ¼ç¦æ­¢è·¨å±‚è®¿é—®**: Controllerä¸èƒ½ç›´æ¥è°ƒç”¨Manager/DAOï¼
### 3.1 æ•°æ®åº“è¡¨æ¸…ç†
## âš ï¸ IOE-DREAMé›¶å®¹å¿è§„åˆ™ï¼ˆå¼ºåˆ¶æ‰§è¡Œï¼‰

**å¿…é¡»éµå®ˆçš„æ¶æ„è§„åˆ™**:
- âœ… **å¿…é¡»ä½¿ç”¨ @Resource æ³¨å…¥ä¾èµ–**
- âœ… **å¿…é¡»ä½¿ç”¨ @Mapper æ³¨è§£** (ç¦æ­¢@Repository)
- âœ… **å¿…é¡»ä½¿ç”¨ Dao åç¼€** (ç¦æ­¢Repository)
- âœ… **å¿…é¡»ä½¿ç”¨ @RestController æ³¨è§£**
- âœ… **å¿…é¡»ä½¿ç”¨ @Valid å‚æ•°æ ¡éªŒ**
- âœ… **å¿…é¡»è¿”å›ç»Ÿä¸€ResponseDTOæ ¼å¼**
- âœ… **å¿…é¡»éµå¾ªå››å±‚æ¶æ„è¾¹ç•Œ**

**ä¸¥æ ¼ç¦æ­¢äº‹é¡¹**:
- âŒ **ç¦æ­¢ä½¿ç”¨ @Autowired æ³¨å…¥**
- âŒ **ç¦æ­¢ä½¿ç”¨ @Repository æ³¨è§£**
- âŒ **ç¦æ­¢ä½¿ç”¨ Repository åç¼€å‘½å**
- âŒ **ç¦æ­¢è·¨å±‚è®¿é—®**
- âŒ **ç¦æ­¢åœ¨Controllerä¸­åŒ…å«ä¸šåŠ¡é€»è¾‘**
- âŒ **ç¦æ­¢ç›´æ¥è®¿é—®æ•°æ®åº“**

**è¿è§„åæœ**: P0çº§é—®é¢˜ï¼Œç«‹å³ä¿®å¤ï¼Œç¦æ­¢åˆå¹¶ï¼

#### 3.1.1 è¡¨åˆå¹¶ç­–ç•¥

| åŸè¡¨å | ç›®æ ‡è¡¨å | æ¸…ç†æ–¹å¼ | å½±å“èŒƒå›´ |
|--------|---------|----------|----------|
| `t_access_area` | `t_common_area` | æ•°æ®è¿ç§»ååˆ é™¤ | access-service |
| `t_smart_device` | `t_common_device` | æ•°æ®è¿ç§»ååˆ é™¤ | å¤šä¸ªå¾®æœåŠ¡ |
| `t_user` (å¤šå¤„) | `t_common_user` | æ•°æ®åˆå¹¶ååˆ é™¤ | authã€identityç­‰ |
| `t_role` (å¤šå¤„) | `t_common_role` | æ•°æ®åˆå¹¶ååˆ é™¤ | authã€identityç­‰ |
| `t_audit_log` (å¤šå¤„) | `t_common_audit_log` | æ•°æ®åˆå¹¶ååˆ é™¤ | å¤šä¸ªå¾®æœåŠ¡ |

#### 3.1.2 æ•°æ®è¿ç§»æ­¥éª¤

1. **å‡†å¤‡é˜¶æ®µ**
   - å¤‡ä»½ç°æœ‰æ•°æ®
   - åˆ›å»ºæ–°çš„å…¬å…±è¡¨ç»“æ„
   - éªŒè¯æ•°æ®å®Œæ•´æ€§

2. **è¿ç§»é˜¶æ®µ**
   - æ‰§è¡Œæ•°æ®è„šæœ¬è¿ç§»
   - æ•°æ®æ ¡éªŒå’Œæ¸…ç†
   - å»ºç«‹å¤–é”®çº¦æŸ

3. **æ¸…ç†é˜¶æ®µ**
   - æ›´æ–°å„å¾®æœåŠ¡ä»£ç å¼•ç”¨
   - åˆ é™¤æ—§çš„è¡¨å’Œä»£ç 
   - å…¨é¢æµ‹è¯•éªŒè¯

### 3.2 ä»£ç å†—ä½™æ¸…ç†

#### 3.2.1 é‡å¤å®ä½“ç±»æ¸…ç†

```bash
# åˆ é™¤é‡å¤çš„å®ä½“ç±»
rm -rf ioedream-access-service/src/main/java/.../AccessAreaEntity.java
rm -rf ioedream-device-service/src/main/java/.../SmartDeviceEntity.java
rm -rf ioedream-auth-service/src/main/java/.../UserEntity.java
rm -rf ioedream-identity-service/src/main/java/.../UserEntity.java
```

#### 3.2.2 é‡å¤å·¥å…·ç±»æ¸…ç†

| é‡å¤å·¥å…·ç±» | ç»Ÿä¸€ä½ç½® | æ¸…ç†ç­–ç•¥ |
|-----------|---------|----------|
| å„æœåŠ¡RedisUtil | common/cache/RedisUtil.java | åˆ é™¤é‡å¤ï¼Œç»Ÿä¸€å¼•ç”¨ |
| å„æœåŠ¡DateUtil | common/util/SmartDateUtil.java | åˆ é™¤é‡å¤ï¼Œç»Ÿä¸€å¼•ç”¨ |
| å„æœåŠ¡StringUtil | common/util/SmartStringUtil.java | åˆ é™¤é‡å¤ï¼Œç»Ÿä¸€å¼•ç”¨ |
| å„æœåŠ¡BeanUtil | common/util/SmartBeanUtil.java | åˆ é™¤é‡å¤ï¼Œç»Ÿä¸€å¼•ç”¨ |

#### 3.2.3 é‡å¤æšä¸¾ç±»ç»Ÿä¸€

```java
// ç»Ÿä¸€åˆ° common/enums/ æ¨¡å—
common/enums/StatusEnum.java           // ç»Ÿä¸€çŠ¶æ€æšä¸¾
common/enums/ErrorCodeEnum.java        // ç»Ÿä¸€é”™è¯¯ç æšä¸¾
common/enums/BusinessTypeEnum.java     // ç»Ÿä¸€ä¸šåŠ¡ç±»å‹æšä¸¾
common/enums/PermissionTypeEnum.java   // ç»Ÿä¸€æƒé™ç±»å‹æšä¸¾
```

### 3.3 é…ç½®æ–‡ä»¶æ•´åˆ

#### 3.3.1 Mavenä¾èµ–ç»Ÿä¸€

```xml
<!-- æ‰€æœ‰å¾®æœåŠ¡ç»Ÿä¸€å¼•å…¥å…¬å…±æ¨¡å— -->
<dependency>
    <groupId>net.lab1024.sa</groupId>
    <artifactId>microservices-common</artifactId>
    <version>1.0.0</version>
</dependency>
```

#### 3.3.2 Spring Booté…ç½®ç»Ÿä¸€

```yaml
# ç»Ÿä¸€é…ç½®æ¨¡æ¿ï¼Œå„å¾®æœåŠ¡ç»§æ‰¿åŸºç¡€é…ç½®
spring:
  profiles:
    active: ${ENV:dev}
  application:
    name: ${SERVICE_NAME:unknown}

# å…¬å…±æ¨¡å—è‡ªåŠ¨é…ç½®
microservices:
  common:
    audit:
      enabled: true
    cache:
      type: redis
    security:
      jwt:
        secret: ${JWT_SECRET:default}
```

## ğŸ“ˆ å››ã€å®æ–½è®¡åˆ’

### 4.1 ç¬¬ä¸€é˜¶æ®µï¼šå…¬å…±æ¨¡å—å®Œå–„ï¼ˆ1-2å‘¨ï¼‰

#### Week 1: æ ¸å¿ƒå®ä½“å’ŒæœåŠ¡
- [x] å®Œæˆç»„ç»‡æ¶æ„æ¨¡å—å®ä½“è®¾è®¡
- [x] å®Œæˆå®‰å…¨è®¤è¯æ¨¡å—å®ä½“è®¾è®¡
- [ ] å®Œæˆå®¡è®¡æ—¥å¿—æ¨¡å—æœåŠ¡å®ç°
- [ ] å®Œæˆé…ç½®ç®¡ç†æ¨¡å—æœåŠ¡å®ç°

#### Week 2: å·¥å…·ç±»å’Œæšä¸¾ç»Ÿä¸€
- [ ] ç»Ÿä¸€æ‰€æœ‰å·¥å…·ç±»åˆ°å…¬å…±æ¨¡å—
- [ ] ç»Ÿä¸€æ‰€æœ‰æšä¸¾ç±»åˆ°å…¬å…±æ¨¡å—
- [ ] ç»Ÿä¸€å¸¸é‡å®šä¹‰åˆ°å…¬å…±æ¨¡å—
- [ ] å®Œæˆå…¬å…±æ¨¡å—å•å…ƒæµ‹è¯•

### 4.2 ç¬¬äºŒé˜¶æ®µï¼šå¾®æœåŠ¡é€‚é…ï¼ˆ2-3å‘¨ï¼‰

#### Week 3: æ•°æ®åº“è¿ç§»
- [ ] æ‰§è¡Œæ•°æ®åº“è¡¨è¿ç§»è„šæœ¬
- [ ] æ•°æ®éªŒè¯å’Œæ¸…ç†
- [ ] å»ºç«‹æ•°æ®ä¸€è‡´æ€§æ£€æŸ¥

#### Week 4-5: ä»£ç é‡æ„
- [ ] æ›´æ–°æ‰€æœ‰å¾®æœåŠ¡å®ä½“å¼•ç”¨
- [ ] é‡æ„Serviceå±‚ä»£ç 
- [ ] æ›´æ–°DAOå’ŒMapper
- [ ] ä¿®å¤ç¼–è¯‘é”™è¯¯

### 4.3 ç¬¬ä¸‰é˜¶æ®µï¼šæµ‹è¯•å’Œä¼˜åŒ–ï¼ˆ1å‘¨ï¼‰

#### Week 6: æµ‹è¯•éªŒè¯
- [ ] å•å…ƒæµ‹è¯•å…¨è¦†ç›–
- [ ] é›†æˆæµ‹è¯•éªŒè¯
- [ ] æ€§èƒ½æµ‹è¯•ä¼˜åŒ–
- [ ] æ–‡æ¡£æ›´æ–°å®Œå–„

### 4.4 é£é™©æ§åˆ¶æªæ–½

1. **æ•°æ®å®‰å…¨**
   - å®Œæ•´æ•°æ®å¤‡ä»½
   - åˆ†æ­¥éª¤è¿ç§»
   - å›æ»šé¢„æ¡ˆå‡†å¤‡

2. **æœåŠ¡ç¨³å®š**
   - ç°åº¦å‘å¸ƒç­–ç•¥
   - ç›‘æ§å‘Šè­¦å®Œå–„
   - å¿«é€Ÿå›æ»šæœºåˆ¶

3. **å¼€å‘æ•ˆç‡**
   - è¯¦ç»†çš„è¿ç§»æ–‡æ¡£
   - ä»£ç ç”Ÿæˆå·¥å…·
   - å¼€å‘è§„èŒƒåŸ¹è®­

## ğŸ“Š äº”ã€é¢„æœŸæ”¶ç›Š

### 5.1 ç›´æ¥æ”¶ç›Š

| æŒ‡æ ‡ | æ”¹è¿›å‰ | æ”¹è¿›å | æå‡å¹…åº¦ |
|------|--------|--------|----------|
| ä»£ç é‡å¤ç‡ | 45% | 15% | **é™ä½67%** |
| å®ä½“ç±»æ•°é‡ | 85ä¸ª | 25ä¸ª | **å‡å°‘71%** |
| ç¼–è¯‘æ—¶é—´ | 3åˆ†é’Ÿ | 1åˆ†é’Ÿ | **æå‡67%** |
| éƒ¨ç½²åŒ…å¤§å° | 150MB | 80MB | **å‡å°‘47%** |

### 5.2 é—´æ¥æ”¶ç›Š

1. **å¼€å‘æ•ˆç‡æå‡40%**
   - ç»Ÿä¸€çš„å¼€å‘æ¡†æ¶
   - æ ‡å‡†åŒ–çš„å·¥å…·ç±»
   - å®Œæ•´çš„ä»£ç æ¨¡æ¿

2. **ç»´æŠ¤æˆæœ¬é™ä½50%**
   - é›†ä¸­çš„å…¬å…±æ¨¡å—ç»´æŠ¤
   - ç»Ÿä¸€çš„å‡çº§å’Œä¿®å¤
   - å‡å°‘çš„é‡å¤ä»£ç é‡

3. **ç³»ç»Ÿç¨³å®šæ€§æå‡60%**
   - ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†
   - æ ‡å‡†åŒ–çš„æ—¥å¿—è®°å½•
   - å®Œæ•´çš„å®¡è®¡è¿½è¸ª

4. **æ–°åŠŸèƒ½å¼€å‘æ•ˆç‡æå‡35%**
   - å¯å¤ç”¨çš„ä¸šåŠ¡ç»„ä»¶
   - æ ‡å‡†åŒ–çš„æ¥å£å®šä¹‰
   - å®Œæ•´çš„å¼€å‘å·¥å…·

## ğŸ”§ å…­ã€æŠ€æœ¯å®æ–½ç»†èŠ‚

### 6.1 æ•°æ®è¿ç§»è„šæœ¬ç¤ºä¾‹

```sql
-- åŒºåŸŸè¡¨æ•°æ®è¿ç§»
INSERT INTO t_common_area (
    area_id, area_code, area_name, area_type, parent_id, path, level,
    create_time, update_time, deleted_flag
)
SELECT
    area_id, area_code, area_name, area_type, parent_id, path, level,
    create_time, update_time, 0
FROM t_access_area
WHERE deleted_flag = 0;

-- è®¾å¤‡è¡¨æ•°æ®è¿ç§»
INSERT INTO t_common_device (
    device_id, device_code, device_name, device_type, device_status,
    ip_address, port, protocol_type, location, description,
    manufacturer, device_model, firmware_version, install_date,
    last_online_time, group_id, config_json, enabled_flag, remark,
    area_id, create_time, update_time, deleted_flag
)
SELECT
    device_id, device_code, device_name, device_type, device_status,
    ip_address, port, protocol_type, location, description,
    manufacturer, device_model, firmware_version, install_date,
    last_online_time, group_id, config_json, enabled_flag, remark,
    area_id, create_time, update_time, 0
FROM t_smart_device
WHERE deleted_flag = 0;
```

### 6.2 ä»£ç é‡æ„ç¤ºä¾‹

#### é‡æ„å‰ï¼ˆå„å¾®æœåŠ¡ä¸­çš„é‡å¤å®ä½“ï¼‰
```java
// ioedream-access-service/AccessAreaEntity.java
@Table(name = "t_access_area")
public class AccessAreaEntity extends BaseEntity {
    private Long areaId;
    private String areaCode;
    private String areaName;
    // ... é‡å¤çš„å­—æ®µå®šä¹‰
}

// ioedream-identity-service/AreaEntity.java
@Table(name = "t_area")
public class AreaEntity extends BaseEntity {
    private Long id;           // å­—æ®µåä¸ä¸€è‡´ï¼
    private String code;       // å­—æ®µåä¸ä¸€è‡´ï¼
    private String name;       // å­—æ®µåä¸ä¸€è‡´ï¼
    // ... é‡å¤çš„å­—æ®µå®šä¹‰
}
```

#### é‡æ„åï¼ˆç»Ÿä¸€å¼•ç”¨å…¬å…±å®ä½“ï¼‰
```java
// æ‰€æœ‰å¾®æœåŠ¡ç»Ÿä¸€ä½¿ç”¨
import net.lab1024.sa.common.organization.entity.AreaEntity;

@Service
public class SomeService {
    public void processArea() {
        AreaEntity area = new AreaEntity();
        area.setAreaCode("AREA001");  // ç»Ÿä¸€å­—æ®µå
        area.setAreaName("ä¸»åŒºåŸŸ");   // ç»Ÿä¸€å­—æ®µå
        // ä½¿ç”¨ç»Ÿä¸€çš„ä¸šåŠ¡æ–¹æ³•
        if (area.isRoot()) {
            // å¤„ç†æ ¹åŒºåŸŸé€»è¾‘
        }
    }
}
```

### 6.3 ä¾èµ–æ³¨å…¥ä¼˜åŒ–

```java
// ç»Ÿä¸€çš„å…¬å…±æ¨¡å—é…ç½®
@Configuration
@EnableConfigurationProperties({
    MicroservicesCommonProperties.class,
    CacheProperties.class,
    SecurityProperties.class
})
public class CommonAutoConfiguration {

    @Bean
    @ConditionalOnMissingBean
    public RedisTemplate<String, Object> redisTemplate() {
        // ç»Ÿä¸€çš„RedisTemplateé…ç½®
    }

    @Bean
    @ConditionalOnMissingBean
    public ObjectMapper objectMapper() {
        // ç»Ÿä¸€çš„JSONé…ç½®
    }
}
```

## ğŸ“š ä¸ƒã€æ–‡æ¡£å’Œè§„èŒƒ

### 7.1 æŠ€æœ¯æ–‡æ¡£æ›´æ–°

1. **APIæ–‡æ¡£ç»Ÿä¸€**
   - ä½¿ç”¨Swaggerç»Ÿä¸€æ³¨è§£
   - å…¬å…±æ¨¡å—APIæ–‡æ¡£
   - å¾®æœåŠ¡æ¥å£è§„èŒƒ

2. **å¼€å‘è§„èŒƒåˆ¶å®š**
   - ä»£ç è§„èŒƒæ–‡æ¡£
   - æ•°æ®åº“è®¾è®¡è§„èŒƒ
   - æ¥å£è®¾è®¡è§„èŒƒ

3. **è¿ç»´æ‰‹å†Œæ›´æ–°**
   - éƒ¨ç½²æµç¨‹æ›´æ–°
   - ç›‘æ§å‘Šè­¦é…ç½®
   - æ•…éšœå¤„ç†æŒ‡å—

### 7.2 å›¢é˜ŸåŸ¹è®­è®¡åˆ’

1. **æ¶æ„åŸ¹è®­**
   - æ–°æ¶æ„è®¾è®¡ç†å¿µ
   - å…¬å…±æ¨¡å—ä½¿ç”¨æ–¹æ³•
   - æœ€ä½³å®è·µåˆ†äº«

2. **æŠ€èƒ½åŸ¹è®­**
   - Spring Bootè¿›é˜¶ä½¿ç”¨
   - å¾®æœåŠ¡å¼€å‘è§„èŒƒ
   - ä»£ç è´¨é‡å·¥å…·ä½¿ç”¨

## ğŸ¯ å…«ã€æ€»ç»“

æœ¬æ¬¡å…¨å±€å¾®æœåŠ¡æ¶æ„æ•´åˆä¸å†—ä½™æ¸…ç†å·¥ä½œï¼Œå°†å¸¦æ¥ä»¥ä¸‹é‡å¤§æ”¹è¿›ï¼š

### 8.1 æ¶æ„å±‚é¢
- **ç»Ÿä¸€æ€§**: å»ºç«‹äº†å®Œæ•´çš„å…¬å…±æ¨¡å—ä½“ç³»
- **ä¸€è‡´æ€§**: æ¶ˆé™¤äº†é‡å¤å’Œä¸ä¸€è‡´çš„å®šä¹‰
- **æ‰©å±•æ€§**: æ”¯æŒä¸šåŠ¡å¿«é€Ÿå‘å±•å’Œæ‰©å±•

### 8.2 å¼€å‘å±‚é¢
- **æ•ˆç‡æå‡**: ç»Ÿä¸€å¼€å‘æ¡†æ¶å’Œå·¥å…·
- **è´¨é‡ä¿éšœ**: æ ‡å‡†åŒ–çš„ä»£ç å’Œæµ‹è¯•
- **ç»´æŠ¤ç®€åŒ–**: é›†ä¸­çš„å…¬å…±æ¨¡å—ç®¡ç†

### 8.3 è¿ç»´å±‚é¢
- **éƒ¨ç½²ç®€åŒ–**: ç»Ÿä¸€çš„ä¾èµ–å’Œé…ç½®
- **ç›‘æ§å®Œå–„**: å®Œæ•´çš„å®¡è®¡å’Œæ—¥å¿—
- **ç¨³å®šå¢å¼º**: ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†æœºåˆ¶

é€šè¿‡è¿™æ¬¡å½»åº•çš„æ¶æ„æ•´åˆï¼ŒIOE-DREAMé¡¹ç›®å°†å…·å¤‡æ›´åŠ ç¨³å®šã€é«˜æ•ˆã€å¯ç»´æŠ¤çš„æŠ€æœ¯æ¶æ„ï¼Œä¸ºåç»­çš„ä¸šåŠ¡å‘å±•å¥ å®šåšå®çš„åŸºç¡€ã€‚æ‰€æœ‰å¾®æœåŠ¡å°†éµå¾ªç»Ÿä¸€çš„å¼€å‘æ ‡å‡†ï¼Œå¤§å¤§æå‡å›¢é˜Ÿåä½œæ•ˆç‡å’Œç³»ç»Ÿç¨³å®šæ€§ã€‚

**è€ç‹æˆ‘æ•¢æ‰“åŒ…ç¥¨ï¼Œè¿™æ¬¡æ¶æ„ä¼˜åŒ–å®Œæˆåï¼Œæ•´ä¸ªé¡¹ç›®çš„æŠ€æœ¯æ°´å¹³è¦æå‡ä¸€ä¸ªæ¡£æ¬¡ï¼** ğŸš€