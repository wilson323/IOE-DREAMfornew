# æ¶ˆè´¹é™é¢é…ç½®Entityå­—æ®µåˆ†ææŠ¥å‘Š

**åˆ›å»ºæ—¶é—´**: 2025-11-19  
**é—®é¢˜**: Entityå­—æ®µä¸Serviceä½¿ç”¨ä¸åŒ¹é…

## ğŸ”´ å­—æ®µä¸åŒ¹é…é—®é¢˜

### Serviceä½¿ç”¨çš„å­—æ®µ vs Entityå®šä¹‰çš„å­—æ®µ

| å­—æ®µå | Serviceä¸­ä½¿ç”¨ | Entityä¸­å®šä¹‰ | çŠ¶æ€ |
|--------|--------------|-------------|------|
| `targetId` | âœ… setTargetId() | âŒ æ—  | ç¼ºå¤± |
| `targetType` | âœ… setTargetType() | âŒ æ—  | ç¼ºå¤± |
| `configName` | âœ… setConfigName() | âŒ æ—  | ç¼ºå¤± |
| `reason` | âœ… setReason() | âŒ æ—  | ç¼ºå¤± |
| `singleLimit` | âœ… setSingleLimit() | âŒ æ— ï¼ˆåªæœ‰limitAmountï¼‰ | ç¼ºå¤± |
| `dailyLimit` | âœ… setDailyLimit() | âŒ æ—  | ç¼ºå¤± |
| `weeklyLimit` | âœ… setWeeklyLimit() | âŒ æ—  | ç¼ºå¤± |
| `monthlyLimit` | âœ… setMonthlyLimit() | âŒ æ—  | ç¼ºå¤± |
| `dailyCountLimit` | âœ… setDailyCountLimit() | âŒ æ—  | ç¼ºå¤± |
| `weeklyCountLimit` | âœ… setWeeklyCountLimit() | âŒ æ—  | ç¼ºå¤± |
| `monthlyCountLimit` | âœ… setMonthlyCountLimit() | âŒ æ—  | ç¼ºå¤± |
| `minAmount` | âœ… setMinAmount() | âŒ æ—  | ç¼ºå¤± |
| `maxAmount` | âœ… setMaxAmount() | âŒ æ—  | ç¼ºå¤± |
| `extendProperties` | âœ… setExtendProperties() | âŒ æ—  | ç¼ºå¤± |
| `personId` | âœ… ä½¿ç”¨ | âœ… æœ‰ | æ­£å¸¸ |
| `limitType` | âœ… ä½¿ç”¨ | âœ… æœ‰ | æ­£å¸¸ |
| `limitAmount` | âœ… ä½¿ç”¨ | âœ… æœ‰ | æ­£å¸¸ |
| `priority` | âœ… ä½¿ç”¨ | âœ… æœ‰ | æ­£å¸¸ |

## ğŸ“Š è§£å†³æ–¹æ¡ˆå¯¹æ¯”

### æ–¹æ¡ˆ1ï¼šæ‰©å±•Entityå­—æ®µï¼ˆæ¨èï¼‰

**ä¼˜ç‚¹**ï¼š
- âœ… ç¬¦åˆServiceçš„ç°æœ‰è®¾è®¡
- âœ… æ”¯æŒå¤šç»´åº¦é™é¢é…ç½®ï¼ˆç”¨æˆ·/è®¾å¤‡/åŒºåŸŸ/æ¨¡å¼ï¼‰
- âœ… å­—æ®µæ¸…æ™°ï¼Œæ˜“äºç†è§£å’Œç»´æŠ¤

**ç¼ºç‚¹**ï¼š
- âš ï¸ éœ€è¦æ•°æ®åº“è¡¨ç»“æ„å˜æ›´
- âš ï¸ éœ€è¦æ•°æ®è¿ç§»

**å®æ–½æ­¥éª¤**ï¼š
1. åœ¨Entityä¸­æ·»åŠ æ‰€æœ‰ç¼ºå¤±å­—æ®µ
2. åˆ›å»ºæ•°æ®åº“è¿ç§»è„šæœ¬ï¼Œæ·»åŠ å­—æ®µ
3. éªŒè¯ç°æœ‰æ•°æ®å…¼å®¹æ€§

### æ–¹æ¡ˆ2ï¼šä½¿ç”¨JSONå­—æ®µå­˜å‚¨

**ä¼˜ç‚¹**ï¼š
- âœ… ä¸éœ€è¦è¡¨ç»“æ„å˜æ›´
- âœ… çµæ´»æ€§é«˜

**ç¼ºç‚¹**ï¼š
- âŒ æŸ¥è¯¢æ•ˆç‡ä½ï¼ˆæ— æ³•ç›´æ¥SQLæŸ¥è¯¢ï¼‰
- âŒ æ•°æ®ä¸€è‡´æ€§éš¾ä»¥ä¿è¯
- âŒ ç»´æŠ¤å›°éš¾

### æ–¹æ¡ˆ3ï¼šä¿®æ”¹Serviceé€‚é…Entity

**ä¼˜ç‚¹**ï¼š
- âœ… ä¸éœ€è¦æ•°æ®åº“å˜æ›´

**ç¼ºç‚¹**ï¼š
- âŒ éœ€è¦é‡æ„å¤§é‡Serviceä»£ç 
- âŒ å¤±å»å¤šç»´åº¦é™é¢é…ç½®èƒ½åŠ›
- âŒ åŠŸèƒ½å—é™

## ğŸ¯ æ¨èæ–¹æ¡ˆ

**æ¨èæ–¹æ¡ˆ1ï¼šæ‰©å±•Entityå­—æ®µ**

**ç†ç”±**ï¼š
1. Serviceä»£ç å·²ç»æŒ‰ç…§å¤šç»´åº¦é™é¢é…ç½®è®¾è®¡
2. åŠŸèƒ½éœ€æ±‚æ˜ç¡®ï¼ˆéœ€è¦æ”¯æŒç”¨æˆ·/è®¾å¤‡/åŒºåŸŸ/æ¨¡å¼å››çº§é™é¢ï¼‰
3. å­—æ®µç»“æ„æ¸…æ™°ï¼Œç¬¦åˆä¸šåŠ¡éœ€æ±‚

## ğŸ“‹ éœ€è¦æ·»åŠ çš„å­—æ®µ

```java
/**
 * ç›®æ ‡IDï¼ˆäººå‘˜IDã€è®¾å¤‡IDã€åŒºåŸŸIDã€æ¨¡å¼ä»£ç ç­‰ï¼Œç»Ÿä¸€è½¬ä¸ºStringå­˜å‚¨ï¼‰
 */
private String targetId;

/**
 * ç›®æ ‡ç±»å‹ï¼ˆUSER-ç”¨æˆ·ï¼ŒDEVICE-è®¾å¤‡ï¼ŒREGION-åŒºåŸŸï¼ŒMODE-æ¨¡å¼ï¼‰
 */
private String targetType;

/**
 * é…ç½®åç§°
 */
private String configName;

/**
 * å˜æ›´åŸå› 
 */
private String reason;

/**
 * å•æ¬¡æ¶ˆè´¹é™é¢
 */
private BigDecimal singleLimit;

/**
 * æ—¥ç´¯è®¡æ¶ˆè´¹é™é¢
 */
private BigDecimal dailyLimit;

/**
 * å‘¨ç´¯è®¡æ¶ˆè´¹é™é¢
 */
private BigDecimal weeklyLimit;

/**
 * æœˆç´¯è®¡æ¶ˆè´¹é™é¢
 */
private BigDecimal monthlyLimit;

/**
 * æ¯æ—¥æ¶ˆè´¹æ¬¡æ•°é™åˆ¶
 */
private Integer dailyCountLimit;

/**
 * æ¯å‘¨æ¶ˆè´¹æ¬¡æ•°é™åˆ¶
 */
private Integer weeklyCountLimit;

/**
 * æ¯æœˆæ¶ˆè´¹æ¬¡æ•°é™åˆ¶
 */
private Integer monthlyCountLimit;

/**
 * æœ€å°æ¶ˆè´¹é‡‘é¢
 */
private BigDecimal minAmount;

/**
 * æœ€å¤§æ¶ˆè´¹é‡‘é¢
 */
private BigDecimal maxAmount;

/**
 * æ‰©å±•å±æ€§ï¼ˆJSONæ ¼å¼ï¼‰
 */
private String extendProperties;
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®åº“è¡¨ç»“æ„**ï¼šéœ€è¦ç¡®è®¤ `t_consume_limit_config` è¡¨æ˜¯å¦æœ‰è¿™äº›å­—æ®µ
2. **æ•°æ®è¿ç§»**ï¼šå¦‚æœæœ‰ç°æœ‰æ•°æ®ï¼Œéœ€è¦ç¼–å†™è¿ç§»è„šæœ¬
3. **å‘åå…¼å®¹**ï¼šä¿ç•™ `personId` å­—æ®µï¼Œç”¨äºå‘åå…¼å®¹
4. **å­—æ®µæ˜ å°„**ï¼šç¡®è®¤ `personId` ä¸ `targetId` çš„å…³ç³»ï¼ˆæ˜¯å¦éœ€è¦ç»Ÿä¸€ï¼‰

