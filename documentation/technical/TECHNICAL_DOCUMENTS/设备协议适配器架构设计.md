# è®¾å¤‡åè®®é€‚é…å™¨æ¶æ„è®¾è®¡

## ğŸ“‹ æ¦‚è¿°

è®¾å¤‡åè®®é€‚é…å™¨æ˜¯IOE-DREAMé¡¹ç›®ä¸­çš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£ç»Ÿä¸€å¤„ç†ä¸åŒä¸šåŠ¡æ¨¡å—ï¼ˆé—¨ç¦ã€è€ƒå‹¤ã€æ¶ˆè´¹ã€è§†é¢‘ï¼‰çš„è®¾å¤‡é€šä¿¡åè®®ã€‚é€šè¿‡é€‚é…å™¨æ¨¡å¼ï¼Œå®ç°äº†è®¾å¤‡æŠ½è±¡å±‚ä¸å…·ä½“åè®®çš„è§£è€¦ã€‚

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ ¸å¿ƒç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è®¾å¤‡åè®®é€‚é…å™¨æ¶æ„                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ä¸šåŠ¡å±‚ (Controller/Service)                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  é—¨ç¦æ¨¡å—    â”‚  è€ƒå‹¤æ¨¡å—    â”‚  æ¶ˆè´¹æ¨¡å—    â”‚  è§†é¢‘æ¨¡å—    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ç»Ÿä¸€é€‚é…å™¨å±‚ (UnifiedDeviceAdapter)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          æ¨èä½¿ç”¨ - åŸºäºSmartDeviceEntity                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å…¼å®¹æ€§é€‚é…å™¨å±‚ (DeviceProtocolAdapter)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          å‘åå…¼å®¹ - åŸºäºå­—ç¬¦ä¸²å‚æ•°                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  é€‚é…å™¨å·¥å‚å±‚ (DeviceProtocolAdapterFactory)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          æ™ºèƒ½åŒ¹é… + åŒç¼“å­˜ + ç»Ÿè®¡ç›‘æ§                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  è®¾å¤‡æŠ½è±¡å±‚ (SmartDeviceEntity)                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          ç»Ÿä¸€è®¾å¤‡æ¨¡å‹ + è®¾å¤‡èƒ½åŠ›æè¿°                        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è®¾è®¡åŸåˆ™

1. **å•ä¸€èŒè´£åŸåˆ™**: æ¯ä¸ªé€‚é…å™¨åªè´Ÿè´£ä¸€ç§è®¾å¤‡ç±»å‹çš„åè®®å¤„ç†
2. **å¼€é—­åŸåˆ™**: å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å°é—­
3. **ä¾èµ–å€’ç½®åŸåˆ™**: ä¾èµ–æŠ½è±¡è€Œéå…·ä½“å®ç°
4. **æ¥å£éš”ç¦»åŸåˆ™**: æä¾›ä¸“é—¨çš„ä¸šåŠ¡æ–¹æ³•æ¥å£

## ğŸ”§ æ ¸å¿ƒæ¥å£

### UnifiedDeviceAdapter (æ¨è)

```java
public interface UnifiedDeviceAdapter {
    // åŸºç¡€ä¿¡æ¯
    String getSupportedDeviceType();
    String getSupportedProtocolType();
    List<String> getSupportedManufacturers();

    // è®¾å¤‡åŒ¹é…
    boolean supportsDevice(SmartDeviceEntity device);
    boolean testDeviceConnection(SmartDeviceEntity device);

    // é€šç”¨æ¥å£
    DeviceDispatchResult dispatchPersonData(SmartDeviceEntity device, Map<String, Object> personData);
    DeviceDispatchResult deletePersonData(SmartDeviceEntity device, Long personId);
    List<Map<String, Object>> queryPersonsOnDevice(SmartDeviceEntity device);

    // ä¸šåŠ¡ä¸“ç”¨æ¥å£ï¼ˆé»˜è®¤æŠ›å‡ºå¼‚å¸¸ï¼Œå­ç±»é€‰æ‹©æ€§å®ç°ï¼‰
    default DeviceDispatchResult dispatchBiometricData(SmartDeviceEntity device, Map<String, Object> biometricData);
    default DeviceDispatchResult dispatchAccessPolicy(SmartDeviceEntity device, Map<String, Object> policyData);
    default DeviceDispatchResult dispatchAttendanceRule(SmartDeviceEntity device, Map<String, Object> ruleData);
    default DeviceDispatchResult dispatchPaymentConfig(SmartDeviceEntity device, Map<String, Object> configData);
    default DeviceDispatchResult dispatchSurveillanceConfig(SmartDeviceEntity device, Map<String, Object> configData);

    // æ‰¹é‡æ“ä½œ
    default DeviceDispatchResult dispatchBatchPersonData(SmartDeviceEntity device, List<Map<String, Object>> personList);
}
```

### DeviceProtocolAdapter (å…¼å®¹æ€§)

```java
public interface DeviceProtocolAdapter {
    // åŸºç¡€ä¿¡æ¯
    String getProtocolType();
    String getSupportedDeviceType();
    List<String> getSupportedManufacturers();

    // åŸºäºé…ç½®å‚æ•°çš„æ¥å£
    boolean supportsDevice(String deviceType, String manufacturer, String deviceCategory);
    boolean testConnection(Map<String, Object> deviceConfig);
    DeviceDispatchResult dispatchPersonData(Map<String, Object> deviceConfig, Map<String, Object> personData);

    // é…ç½®ç®¡ç†
    Map<String, Object> getDeviceConfigTemplate();
    boolean validateDeviceConfig(Map<String, Object> deviceConfig);

    // åè®®èƒ½åŠ›
    ProtocolCapabilities getProtocolCapabilities();
}
```

## ğŸ­ è®¾å¤‡ç±»å‹ä¸ç‰¹æ€§

### é—¨ç¦è®¾å¤‡ (ACCESS)

**ç‰¹æœ‰éœ€æ±‚**:
- ç”Ÿç‰©ç‰¹å¾ä¸‹å‘ (æŒ‡çº¹ã€äººè„¸ã€è™¹è†œ)
- æƒé™ç­–ç•¥ä¸‹å‘ (æ—¶é—´æ®µã€åŒºåŸŸæƒé™)
- é—¨ç¦è®°å½•åŒæ­¥

**æ”¯æŒçš„åè®®**: HTTPã€TCPã€UDP
**æ”¯æŒçš„å‚å•†**: æµ·åº·å¨è§†ã€å¤§åã€ä¸­æ§æ™ºæ…§

### è€ƒå‹¤è®¾å¤‡ (ATTENDANCE)

**ç‰¹æœ‰éœ€æ±‚**:
- è€ƒå‹¤è§„åˆ™ä¸‹å‘
- æ’ç­ä¿¡æ¯åŒæ­¥
- è€ƒå‹¤è®°å½•è·å–

**æ”¯æŒçš„åè®®**: HTTPã€TCPã€MQTT
**æ”¯æŒçš„å‚å•†**: ç§‘å¯†ã€æ±‰ç‹ã€ä¸­æ§

### æ¶ˆè´¹è®¾å¤‡ (CONSUME)

**ç‰¹æœ‰éœ€æ±‚**:
- æ”¯ä»˜é…ç½®ä¸‹å‘
- ä»·æ ¼ç­–ç•¥åŒæ­¥
- æ¶ˆè´¹è®°å½•å¯¹è´¦

**æ”¯æŒçš„åè®®**: HTTPã€TCPã€ä¸²å£
**æ”¯æŒçš„å‚å•†**: æ–°åŒ—æ´‹ã€ç™¾å¯Œã€é›„å¸

### è§†é¢‘è®¾å¤‡ (VIDEO)

**ç‰¹æœ‰éœ€æ±‚**:
- ç›‘æ§é…ç½®ä¸‹å‘
- å‘Šè­¦è§„åˆ™è®¾ç½®
- å½•åƒè®¡åˆ’é…ç½®

**æ”¯æŒçš„åè®®**: HTTPã€RTSPã€ONVIF
**æ”¯æŒçš„å‚å•†**: æµ·åº·å¨è§†ã€å¤§åã€å®‡è§†

## ğŸš€ ä½¿ç”¨æŒ‡å—

### æ¨èç”¨æ³• (åŸºäºå®ä½“)

```java
@Service
public class DeviceService {

    @Resource
    private DeviceProtocolAdapterFactory adapterFactory;

    @Resource
    private SmartDeviceService smartDeviceService;

    public void dispatchPersonData(Long deviceId, Map<String, Object> personData) {
        // 1. è·å–è®¾å¤‡å®ä½“
        SmartDeviceEntity device = smartDeviceService.getById(deviceId);
        if (device == null) {
            throw new BusinessException("è®¾å¤‡ä¸å­˜åœ¨");
        }

        // 2. è·å–ç»Ÿä¸€é€‚é…å™¨
        UnifiedDeviceAdapter adapter = adapterFactory.getUnifiedAdapter(device);
        if (adapter == null) {
            throw new BusinessException("ä¸æ”¯æŒçš„è®¾å¤‡ç±»å‹");
        }

        // 3. æ‰§è¡Œæ•°æ®ä¸‹å‘
        DeviceDispatchResult result = adapter.dispatchPersonData(device, personData);

        // 4. å¤„ç†ç»“æœ
        if (!result.isSuccess()) {
            throw new BusinessException("æ•°æ®ä¸‹å‘å¤±è´¥: " + result.getErrorMessage());
        }
    }
}
```

### å…¼å®¹æ€§ç”¨æ³• (åŸºäºå­—ç¬¦ä¸²å‚æ•°)

```java
@Service
public class LegacyDeviceService {

    @Resource
    private DeviceProtocolAdapterFactory adapterFactory;

    public void dispatchPersonData(String deviceType, String protocol,
                                  String manufacturer, Map<String, Object> deviceConfig,
                                  Map<String, Object> personData) {
        // è·å–å…¼å®¹æ€§é€‚é…å™¨
        DeviceProtocolAdapter adapter = adapterFactory.getAdapter(deviceType, protocol, manufacturer);
        if (adapter == null) {
            throw new BusinessException("ä¸æ”¯æŒçš„è®¾å¤‡åè®®");
        }

        // æ‰§è¡Œæ•°æ®ä¸‹å‘
        DeviceDispatchResult result = adapter.dispatchPersonData(deviceConfig, personData);
        if (!result.isSuccess()) {
            throw new BusinessException("æ•°æ®ä¸‹å‘å¤±è´¥: " + result.getErrorMessage());
        }
    }
}
```

### é—¨ç¦è®¾å¤‡ä¸“ç”¨æ“ä½œ

```java
public void accessDeviceOperations(Long deviceId) {
    SmartDeviceEntity device = smartDeviceService.getById(deviceId);
    UnifiedDeviceAdapter adapter = adapterFactory.getUnifiedAdapter(device);

    // ç”Ÿç‰©ç‰¹å¾ä¸‹å‘
    Map<String, Object> biometricData = Map.of(
        "fingerprint", "base64_data",
        "face", "base64_face_data"
    );
    adapter.dispatchBiometricData(device, biometricData);

    // æƒé™ç­–ç•¥ä¸‹å‘
    Map<String, Object> policyData = Map.of(
        "accessLevel", 5,
        "timeSlots", List.of("09:00-18:00"),
        "areas", List.of("AREA_001", "AREA_002")
    );
    adapter.dispatchAccessPolicy(device, policyData);
}
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥

1. **åŒç¼“å­˜æ¶æ„**:
   - ç»Ÿä¸€é€‚é…å™¨ç¼“å­˜: `deviceType:protocolType:manufacturer`
   - å…¼å®¹æ€§é€‚é…å™¨ç¼“å­˜: `deviceType:protocolType:manufacturer:deviceCategory`

2. **ç¼“å­˜å¤±æ•ˆç­–ç•¥**:
   - æ³¨å†Œæ–°é€‚é…å™¨æ—¶æ¸…ç©ºæ‰€æœ‰ç¼“å­˜
   - æ”¯æŒæ‰‹åŠ¨æ¸…ç©ºç¼“å­˜
   - LRUè‡ªåŠ¨æ·˜æ±°

### åŒ¹é…ç®—æ³•

1. **ç²¾ç¡®åŒ¹é…**: deviceType + protocolType + manufacturer
2. **åè®®åŒ¹é…**: deviceType + protocolType + Generalå‚å•†
3. **ç±»å‹åŒ¹é…**: deviceType + é€šç”¨é€‚é…å™¨

### ç»Ÿè®¡ç›‘æ§

```java
// è·å–å·¥å‚ç»Ÿè®¡ä¿¡æ¯
EnhancedAdapterStatistics stats = adapterFactory.getStatistics();

// ç›‘æ§æŒ‡æ ‡
log.info("æ€»é€‚é…å™¨æ•°: {}", stats.getTotalAdapterCount());
log.info("ç»Ÿä¸€é€‚é…å™¨å æ¯”: {:.1f}%", stats.getUnifiedRatio() * 100);
log.info("æ˜¯å¦å»ºè®®è¿ç§»: {}", stats.shouldMigrateToUnified());

// æ”¯æŒçš„ç±»å‹ç»Ÿè®¡
log.info("æ”¯æŒè®¾å¤‡ç±»å‹: {}", adapterFactory.getSupportedDeviceTypes());
log.info("æ”¯æŒåè®®ç±»å‹: {}", adapterFactory.getSupportedProtocolTypes());
log.info("æ”¯æŒå‚å•†: {}", adapterFactory.getSupportedManufacturers());
```

## ğŸ”§ æ‰©å±•å¼€å‘

### æ·»åŠ æ–°çš„è®¾å¤‡ç±»å‹

1. **åˆ›å»ºé€‚é…å™¨å®ç°ç±»**:

```java
@Component
public class NewDeviceAdapter implements UnifiedDeviceAdapter {

    @Override
    public String getSupportedDeviceType() {
        return "NEW_DEVICE";
    }

    @Override
    public String getSupportedProtocolType() {
        return "HTTP";
    }

    @Override
    public List<String> getSupportedManufacturers() {
        return List.of("NewCompany", "General");
    }

    // å®ç°å…·ä½“çš„ä¸šåŠ¡æ–¹æ³•...
}
```

2. **é€‚é…å™¨è‡ªåŠ¨æ³¨å†Œ**:

```java
@Component
public class DeviceAdapterInitializer {

    @Resource
    private DeviceProtocolAdapterFactory adapterFactory;

    @Resource
    private NewDeviceAdapter newDeviceAdapter;

    @PostConstruct
    public void registerAdapters() {
        adapterFactory.registerUnifiedAdapter(newDeviceAdapter);
    }
}
```

### æ·»åŠ æ–°çš„åè®®ç±»å‹

1. **æ‰©å±•ç°æœ‰é€‚é…å™¨**:

```java
@Component
public class EnhancedAccessAdapter extends HttpPersonDispatchAdapter {

    @Override
    public String getSupportedProtocolType() {
        return "MQTT"; // æ–°å¢MQTTåè®®æ”¯æŒ
    }

    @Override
    public DeviceDispatchResult dispatchPersonData(SmartDeviceEntity device, Map<String, Object> personData) {
        if ("MQTT".equals(device.getProtocolType())) {
            return dispatchViaMqtt(device, personData);
        }
        return super.dispatchPersonData(device, personData);
    }
}
```

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **é€‚é…å™¨æœªæ‰¾åˆ°**
   - æ£€æŸ¥è®¾å¤‡ç±»å‹ã€åè®®ç±»å‹ã€å‚å•†åç§°æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤é€‚é…å™¨å·²æ­£ç¡®æ³¨å†Œ
   - æŸ¥çœ‹é€‚é…å™¨å·¥å‚ç»Ÿè®¡ä¿¡æ¯

2. **å­—æ®µæ˜ å°„é”™è¯¯**
   - ç¡®è®¤ä½¿ç”¨ `device.getProtocolType()` è€Œä¸æ˜¯ `device.getProtocol()`
   - æ£€æŸ¥ `SmartDeviceEntity` å­—æ®µåæ˜¯å¦æ­£ç¡®

3. **è¿æ¥æµ‹è¯•å¤±è´¥**
   - æ£€æŸ¥è®¾å¤‡ç½‘ç»œè¿é€šæ€§
   - éªŒè¯è®¾å¤‡é…ç½®å‚æ•°
   - æŸ¥çœ‹é€‚é…å™¨å®ç°ä¸­çš„è¿æ¥é€»è¾‘

### è°ƒè¯•æŠ€å·§

```java
// å¯ç”¨è¯¦ç»†æ—¥å¿—
@Slf4j
public class DebugDeviceService {

    public void debugAdapterMatching(Long deviceId) {
        SmartDeviceEntity device = smartDeviceService.getById(deviceId);

        // æ‰“å°è®¾å¤‡ä¿¡æ¯
        log.info("è®¾å¤‡ä¿¡æ¯: type={}, protocol={}, manufacturer={}",
                device.getDeviceType(), device.getProtocolType(), device.getManufacturer());

        // è·å–é€‚é…å™¨ç»Ÿè®¡
        var stats = adapterFactory.getStatistics();
        log.info("é€‚é…å™¨å·¥å‚ç»Ÿè®¡: {}", stats);

        // æµ‹è¯•é€‚é…å™¨è·å–
        UnifiedDeviceAdapter adapter = adapterFactory.getUnifiedAdapter(device);
        log.info("è·å–åˆ°çš„é€‚é…å™¨: {}", adapter != null ? adapter.getClass().getSimpleName() : "null");
    }
}
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [è®¾å¤‡ä¸‹å‘å¼•æ“è®¾è®¡æ–‡æ¡£](./è®¾å¤‡ä¸‹å‘å¼•æ“è®¾è®¡.md)
- [SmartDeviceEntityå®ä½“è®¾è®¡](../æ•°æ®åº“è®¾è®¡/è®¾å¤‡å®ä½“è®¾è®¡.md)
- [äººå‘˜åŒºåŸŸç®¡ç†æ¶æ„](../ä¸šåŠ¡æ¶æ„/äººå‘˜åŒºåŸŸç®¡ç†æ¶æ„.md)
- [åè®®é€‚é…å™¨å®ç°ç¤ºä¾‹](../ä»£ç ç¤ºä¾‹/åè®®é€‚é…å™¨ç¤ºä¾‹.md)

---

**æœ€åæ›´æ–°**: 2025-11-24
**æ–‡æ¡£ç‰ˆæœ¬**: v1.0.0
**ç»´æŠ¤å›¢é˜Ÿ**: SmartAdmin Team