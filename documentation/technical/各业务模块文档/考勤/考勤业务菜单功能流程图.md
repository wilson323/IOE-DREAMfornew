# 考勤系统 - 最终优化后的业务功能流程图（周末加班增强版）

## 1. 考勤管理模块流程图

### 1.1 区域人员管理流程图

```mermaid
flowchart TD
    A[进入区域人员管理页面] --> B[查询区域列表]
    B --> C[区域列表展示]
    C --> D{选择区域}
    D --> E[查看区域人员列表]
    E --> F[人员列表展示]
    F --> G{选择操作}

    G -->|添加人员| H[点击添加人员按钮]
    H --> I[查询可选人员列表]
    I --> J[人员筛选<br/>部门/岗位/姓名]
    J --> K[选择要添加的人员]
    K --> L[设置人员权限<br/>查看/编辑/审批]
    L --> M[设置生效时间]
    M --> N[保存人员配置]
    N --> O[验证配置]
    O --> P{配置有效查}
    P -->|否| Q[显示错误信息]
    P -->|是| R[人员添加成功]
    Q --> L
    R --> S[刷新人员列表]
    S --> F

    G -->|移除人员| T[选择人员]
    T --> U[点击移除人员]
    U --> V[确认移除操作]
    V --> W{确认移除查}
    W -->|否| F
    W -->|是| X[执行移除操作]
    X --> Y[人员移除成功]
    Y --> F

    G -->|编辑权限| Z[选择人员]
    Z --> AA[点击编辑权限]
    AA --> AB[加载当前权限]
    AB --> AC[修改权限设置]
    AC --> AD[保存权限修改]
    AD --> AE[权限验证]
    AE --> AF{验证通过查}
    AF -->|否| AG[显示错误信息]
    AF -->|是| AH[权限更新成功]
    AG --> AC
    AH --> F

    G -->|批量添加| AI[点击批量添加]
    AI --> AJ[选择添加方式]
    AJ --> AK{添加方式}
    AK -->|按部门添加| AL[选择部门]
    AL --> AM[选择部门内人员]
    AM --> AN[设置统一权限]
    AN --> AO[批量保存]
    AK -->|按岗位添加| AP[选择岗位]
    AP --> AQ[选择岗位人员]
    AQ --> AN
    AK -->|按文件导入| AR[下载模板]
    AR --> AS[填写人员信息]
    AS --> AT[上传文件]
    AT --> AU[文件验证]
    AU --> AV{文件有效查}
    AV -->|否| AW[显示错误信息]
    AV -->|是| AX[导入人员数据]
    AW --> AS
    AX --> AY[导入成功]
    AY --> F
    AO --> AZ[批量添加成功]
    AZ --> F

    G -->|人员查询| BA[输入查询条件]
    BA --> BB[姓名/工号/部门]
    BB --> BC[执行查询]
    BC --> BD[显示查询结果]
    BD --> F

    G -->|查看详情| BE[选择人员]
    BE --> BF[点击查看详情]
    BF --> BG[显示人员基本信息]
    BG --> BH[显示权限信息]
    BH --> BI[显示生效时间]
    BI --> BJ[显示操作记录]
    BJ --> F

    G -->|导出人员| BK[点击导出按钮]
    BK --> BL[选择导出格式<br/>Excel/PDF]
    BL --> BM[选择导出字段]
    BM --> BN[执行导出]
    BN --> BO[导出成功]
    BO --> F

    F --> BP{选择其他区域查}
    BP -->|是| D
    BP -->|否| C
    C --> BQ{退出查}
    BQ -->|否| B
    BQ -->|是| BR[退出区域人员管理]
```

## 2. 基础信息模块流程图

### 2.1 考勤参数规则流程图（整合考勤规则、考勤点管理、移动端签到地址）

```mermaid
flowchart TD
    A[进入考勤参数规则页面] --> B[查询参数配置]
    B --> C[参数配置展示]
    C --> D{选择参数类型}

    D -->|考勤计算规则| E[点击考勤规则配置]
    E --> F[查询现有规则]
    F --> G[规则列表展示]
    G --> H{选择操作}
    H -->|新增规则| I[点击新增规则]
    I --> J[填写规则基本信息<br/>规则名称/描述]
    J --> K[设置考勤计算规则]
    K --> L[配置迟到早退规则]
    L --> M[设置旷工判断规则]
    M --> N[配置加班计算规则]
    N --> O[设置异常处理规则]
    O --> P[选择适用范围<br/>人员/部门/分组]
    P --> Q[保存考勤规则]
    Q --> R[规则生效检查]
    R --> S{规则验证通过查}
    S -->|否| T[显示错误信息]
    S -->|是| U[规则添加成功]
    T --> J
    U --> V[返回规则列表]
    H -->|编辑规则| W[选择规则]
    W --> X[点击编辑按钮]
    X --> Y[加载规则详细信息]
    Y --> Z[修改规则参数]
    Z --> AA[保存规则修改]
    AA --> BB[规则验证]
    BB --> CC{验证通过查}
    CC -->|否| DD[显示验证错误]
    CC -->|是| EE[更新规则]
    DD --> Z
    EE --> FF[规则更新成功]
    FF --> V
    H -->|启用/禁用规则| GG[选择规则]
    GG --> HH[点击启用/禁用]
    HH --> II[确认操作]
    II --> JJ[更新规则状态]
    JJ --> V
    V --> C

    D -->|考勤点配置| KK[点击考勤点配置]
    KK --> LL[查询考勤点列表]
    LL --> MM[考勤点列表展示]
    MM --> NN{选择操作}
    NN -->|新增考勤点| OO[点击新增按钮]
    OO --> PP[填写考勤点信息<br/>考勤点名称/描述]
    PP --> QQ[设置地理位置<br/>经度/纬度]
    QQ --> RR[配置有效范围<br/>半径/误差范围]
    RR --> SS[关联考勤设备]
    SS --> TT[保存考勤点信息]
    TT --> UU[考勤点添加成功]
    UU --> VV[返回考勤点列表]
    NN -->|编辑考勤点| WW[选择考勤点]
    WW --> XX[修改考勤点参数]
    XX --> YY[保存修改]
    YY --> VV
    NN -->|删除考勤点| ZZ[选择考勤点]
    ZZ --> AAA[确认删除操作]
    AAA --> BBB{确认删除查}
    BBB -->|是| CCC[执行删除操作]
    BBB -->|否| VV
    CCC --> DDD[考勤点删除成功]
    DDD --> VV
    VV --> C

    D -->|移动端签到配置| EEE[点击移动端配置]
    EEE --> FFF[设置签到地址规则]
    FFF --> GGG[配置有效范围参数]
    GGG --> HHH[设置定位精度要求]
    HHH --> III[设置签到时间限制]
    III --> JJJ[配置移动设备绑定规则]
    JJJ --> KKK[保存移动端配置]
    KKK --> LLL[配置保存成功]
    LLL --> C

    D -->|其他参数配置| MMM[选择其他参数]
    MMM --> NNN[修改参数值]
    NNN --> OOO[保存参数]
    OOO --> PPP[参数更新成功]
    PPP --> C

    C --> QQQ[刷新参数配置]
    QQQ --> C
```

### 2.2 假种管理流程图

```mermaid
flowchart TD
    A[进入假种管理页面] --> B[查询假种列表]
    B --> C[假种列表展示]
    C --> D{选择操作}

    D -->|新增假种| E[点击新增按钮]
    E --> F[填写假种信息<br/>假种名称/编码]
    F --> G[设置假种类型<br/>带薪/无薪/其他]
    G --> H[配置请假规则<br/>最小请假单位/最大请假天数]
    H --> I[设置审批流程]
    I --> J[配置请假凭证要求]
    J --> K[选择适用人员范围]
    K --> L[保存假种信息]
    L --> M[假种添加成功]
    M --> N[返回假种列表]

    D -->|编辑假种| O[选择假种]
    O --> P[点击编辑按钮]
    P --> Q[加载假种详细信息]
    Q --> R[修改假种参数]
    R --> S[保存修改]
    S --> T[更新假种状态]
    T --> N

    D -->|删除假种| U[选择假种]
    U --> V[点击删除按钮]
    V --> W[确认删除操作]
    W --> X{确认删除查}
    X -->|否| Y[取消删除]
    X -->|是| Z[检查使用情况]
    Z --> AA{有关联请假记录查}
    AA -->|是| BB[提示不能删除]
    AA -->|否| CC[执行删除]
    BB --> N
    CC --> DD[假种删除成功]
    DD --> N

    N --> EE[刷新假种列表]
    EE --> C
```

### 2.3 报表推送配置流程图

```mermaid
flowchart TD
    A[进入报表推送页面] --> B[查询推送配置列表]
    B --> C[推送配置展示]
    C --> D{选择操作}

    D -->|新增推送配置| E[点击新增按钮]
    E --> F[填写推送基本信息<br/>配置名称/描述]
    F --> G[选择报表类型<br/>日报/月报/年报]
    G --> H[设置推送时间<br/>具体时间/周期]
    H --> I[配置推送方式]
    I --> J{推送方式}
    J -->|邮件推送| K[配置邮件参数<br/>收件人/主题/模板]
    J -->|FTP推送| L[配置FTP参数<br/>服务器/用户名/密码]
    J -->|系统消息| M[配置接收人员]
    K --> N[设置推送格式<br/>Excel/PDF/HTML]
    L --> N
    M --> N
    N --> O[配置推送条件<br/>人员/部门/时间范围]
    O --> P[保存推送配置]
    P --> Q[配置验证]
    Q --> R{配置验证通过查}
    R -->|否| S[显示验证错误]
    R -->|是| T[配置添加成功]
    S --> F
    T --> U[返回配置列表]

    D -->|测试推送| V[选择配置]
    V --> W[点击测试按钮]
    W --> X[生成测试报表]
    X --> Y[执行推送操作]
    Y --> Z[等待推送结果]
    Z --> AA{推送成功查}
    AA -->|否| BB[显示推送失败原因]
    AA -->|是| CC[推送测试成功]
    BB --> U
    CC --> U

    D -->|启用/禁用| DD[选择配置]
    DD --> EE[点击启用/禁用]
    EE --> FF[更新配置状态]
    FF --> U

    U --> GG[刷新配置列表]
    GG --> C
```

## 3. 班次时间管理模块流程图（合并时间段和班次管理，增加三班倒和四班三倒支持）

### 3.1 班次时间管理流程图

```mermaid
flowchart TD
    A[进入班次时间管理页面] --> B[查询班次时间列表]
    B --> C[班次时间展示]
    C --> D{选择操作}

    D -->|新增班次时间| E[点击新增按钮]
    E --> F[填写基本信息<br/>名称/类型]
    F --> G{班次时间类型}
    G -->|时间段| H[设置时间参数<br/>开始签到时间/上班时间]
    G -->|班次| I[设置班次基本信息<br/>班次编号/班次名称]
    H --> J[设置结束参数<br/>结束签到时间/下班时间]
    I --> K[选择班次类型]
    J --> L[配置容差规则<br/>允许迟到分钟/允许早退分钟]
    K --> M{班次类型}
    L --> N[设置签到要求<br/>是否必须签到/签退]
    M -->|规律班次| O[设置周期参数<br/>周期单位/周期数]
    M -->|弹性班次| P[设置弹性参数<br/>弹性工作时间/核心工作时间]
    M -->|三班倒| Q[设置三班倒参数<br/>早班/中班/晚班时间]
    M -->|四班三倒| R[设置四班三倒参数<br/>班次轮换规则/休息规则]
    N --> S[配置工作时长]
    O --> T[配置时间段明细]
    P --> T
    Q --> U[配置早班时间]
    U --> V[配置中班时间]
    V --> W[配置晚班时间]
    W --> X[设置轮换规则<br/>轮换周期/轮换顺序]
    R --> Y[配置四个班次时间]
    Y --> Z[设置轮换规则<br/>三天工作/一天休息]
    Z --> AA[设置轮换顺序]
    T --> AB[添加时间段明细]
    X --> AB
    AA --> AB
    S --> AC[设置加班规则<br/>是否计加班/加班开始时间]
    AB --> AD[选择已有时间段]
    AD --> AE[设置时间段顺序]
    AE --> AF[配置考勤方式<br/>刷卡规则/免打卡等]
    AF --> AG[设置加班方式<br/>自动计算/申请审批等]
    AG --> AH[配置加班标记<br/>平时/休息日/节假日]
    AH --> AI[保存班次时间信息]
    AI --> AJ[班次时间验证]
    AJ --> AK{配置有效查}
    AK -->|否| AL[显示验证错误]
    AK -->|是| AM[班次时间添加成功]
    AL --> F
    AM --> AN[返回班次时间列表]

    D -->|编辑班次时间| AO[选择班次时间]
    AO --> AP[点击编辑按钮]
    AP --> AQ[加载详细信息]
    AQ --> AR[修改参数]
    AR --> AS[保存修改]
    AS --> AT[班次时间验证]
    AT --> AU{验证通过查}
    AU -->|否| AV[显示验证错误]
    AU -->|是| AW[更新班次时间]
    AV --> AR
    AW --> AX[班次时间更新成功]
    AX --> AN

    D -->|复制班次时间| AY[选择班次时间]
    AY --> AZ[点击复制按钮]
    AZ --> BA[修改名称]
    BA --> BB[调整参数]
    BB --> BC[保存复制的班次时间]
    BC --> BD[复制成功]
    BD --> AN

    D -->|查看详情| BE[选择班次时间]
    BE --> BF[点击查看详情]
    BF --> BG[显示完整信息]
    BG --> BH[显示关联关系]
    BH --> BI[显示规则配置]
    BI --> AN

    AN --> BJ[刷新班次时间列表]
    BJ --> C
```

## 4. 排班管理模块流程图（增加三班倒、四班三倒和智能排班功能，增加周末加班处理）

### 4.1 排班日历流程图（合并人员排班、分组排班、排班详情，增加异常操作、销假功能、智能排班和周末加班处理）

```mermaid
flowchart TD
    A[进入排班日历页面] --> B[选择排班条件]
    B --> C[设置查询参数<br/>部门/人员/时间范围]
    C --> D[查询排班信息]
    D --> E[日历视图展示]
    E --> F{选择操作}

    F -->|日历排班| G[选择日期]
    G --> H[选择排班对象<br/>个人/分组]
    H --> I{排班对象}
    I -->|个人排班| J[选择个人]
    I -->|分组排班| K[选择分组]
    J --> L[为选中日期排班]
    K --> L
    L --> M[选择班次时间]
    M --> N[保存排班记录]
    N --> O[更新排班显示]

    F -->|批量排班| P[选择多个对象]
    P --> Q[点击批量排班]
    Q --> R[选择排班方式]
    R --> S{排班方式}
    S -->|按班次排班| T[选择班次]
    S -->|按模板排班| U[选择排班模板]
    S -->|循环排班| V[设置循环规则]
    S -->|三班倒排班| W[设置三班倒规则]
    S -->|四班三倒排班| X[设置四班三倒规则]
    S -->|智能排班| Y[进入智能排班流程]
    T --> Z[设置排班时间范围]
    U --> Z
    V --> Z
    W --> AA[设置轮换周期]
    X --> BB[设置轮换和休息规则]
    Y --> CC[获取员工历史打卡数据]
    AA --> DD[配置早中晚班人员]
    BB --> EE[配置四个班次轮换]
    CC --> FF[分析最早打卡时间分布]
    DD --> GG[设置轮换顺序]
    EE --> GG
    FF --> HH[分析最晚打卡时间分布]
    HH --> II[匹配最合适班次]
    GG --> JJ[预览排班结果]
    II --> JJ
    JJ --> KK{排班结果正确查}
    KK -->|否| LL[调整排班参数]
    KK -->|是| MM[确认批量排班]
    LL --> R
    MM --> NN[执行批量排班]
    NN --> OO[更新排班数据]
    OO --> PP[排班成功]
    PP --> QQ[刷新排班显示]

    F -->|临时排班| PP[选择对象]
    PP --> QQ[点击临时排班]
    QQ --> RR[填写临时排班信息<br/>日期/班次/原因]
    RR --> SS[保存临时排班]
    SS --> TT[临时排班添加成功]
    TT --> OO

    F -->|异常处理| UU[选择日期和人员]
    UU --> VV[点击异常处理]
    VV --> WW{选择异常类型}
    WW -->|请假申请| XX[进入请假申请流程]
    WW -->|补签申请| YY[进入补签申请流程]
    WW -->|调班申请| ZZ[进入调班申请流程]
    WW -->|销假操作| AAA[进入销假流程]
    WW -->|周末加班处理| BBB[进入周末加班处理流程]
    
    XX --> CCC[选择请假类型]
    CCC --> DDD[设置请假时间范围]
    DDD --> EEE[填写请假原因]
    EEE --> FFF[上传请假凭证]
    FFF --> GGG[选择审批人]
    GGG --> HHH[提交请假申请]
    HHH --> III[请假申请成功]
    III --> OO
    
    YY --> JJJ[选择补签类型<br/>上班/下班/外出]
    JJJ --> KKK[设置补签时间]
    KKK --> LLL[填写补签原因]
    LLL --> MMM[上传补签凭证]
    MMM --> NNN[选择审批人]
    NNN --> OOO[提交补签申请]
    OOO --> PPP[补签申请成功]
    PPP --> OO
    
    ZZ --> QQQ[选择调班对象]
    QQQ --> RRR[设置原班次信息]
    RRR --> SSS[设置新班次信息]
    SSS --> TTT[填写调班原因]
    TTT --> UUU[选择审批人]
    UUU --> VVV[提交调班申请]
    VVV --> WWW[调班申请成功]
    WWW --> OO
    
    AAA --> XXX[查询有效请假记录]
    XXX --> YYY[选择要销假的请假记录]
    YYY --> ZZZ[填写实际销假时间]
    ZZZ --> AAAA[填写销假说明]
    AAAA --> BBBB[上传销假证明]
    BBBB --> CCCC[提交销假申请]
    CCCC --> DDDD{销假时间是否早于请假结束时间查}
    DDDD -->|是| EEEE[计算剩余假期]
    DDDD -->|否| FFFF[提示销假时间无效]
    EEEE --> GGGG[更新请假状态]
    GGGG --> HHHH[更新剩余假期额度]
    HHHH --> IIII[销假成功]
    IIII --> OO
    FFFF --> YYY
    
    BBB --> JJJJ[选择周末日期]
    JJJJ --> KKKK[查询周末打卡记录]
    KKKK --> LLLL{是否有打卡记录查}
    LLLL -->|否| MMMM[提示无打卡记录]
    LLLL -->|是| NNNN[显示打卡时间]
    NNNN --> OOOO[计算工作时长]
    OOOO --> PPPP[设置加班类型<br/>周末加班]
    PPPP --> QQQQ[填写加班说明]
    QQQQ --> RRRR[上传加班证明]
    RRRR --> SSSS[提交加班申请]
    SSSS --> TTTT{加班时长计算正确查}
    TTTT -->|否| UUUU[调整加班时长]
    TTTT -->|是| VVVV[加班申请成功]
    UUUU --> OOOO
    VVVV --> OO
    MMMM --> OO

    F -->|清除排班| WWWW[选择排班记录]
    WWWW --> XXXX[点击清除排班]
    XXXX --> YYYY[确认清除操作]
    YYYY --> ZZZZ{确认清除查}
    ZZZZ -->|否| AAAAA[取消清除]
    ZZZZ -->|是| BBBBB[执行清除操作]
    BBBBB --> CCCCC[排班清除成功]
    CCCCC --> OO
    AAAAA --> OO

    F -->|查看排班详情| DDDDD[选择排班记录]
    DDDDD --> EEEEE[点击查看详情]
    EEEEE --> FFFFF[显示排班完整信息]
    FFFFF --> GGGGG[显示班次时间详情]
    GGGGG --> HHHHH[显示人员关联信息]
    HHHHH --> IIIII[显示异常申请记录]
    IIIII --> JJJJJ[显示销假记录]
    JJJJJ --> KKKKK[显示周末加班记录]
    KKKKK --> OO

    F -->|异常审批| LLLLL[选择待审批异常记录]
    LLLLL --> MMMMM[点击审批按钮]
    MMMMM --> NNNNN[查看异常详情]
    NNNNN --> OOOOO[查看申请凭证]
    OOOOO --> PPPPP[核实申请信息]
    PPPPP --> QQQQQ[填写审批意见]
    QQQQQ --> RRRRR{审批决定}
    RRRRR -->|通过| SSSSS[确认通过审批]
    RRRRR -->|拒绝| TTTTT[填写拒绝原因]
    RRRRR -->|部分通过| UUUUU[调整申请内容]
    SSSSS --> VVVVV{是否销假申请查}
    TTTTT --> WWWWW[更新状态为已拒绝]
    UUUUU --> XXXXX[更新申请时间和状态]
    VVVVV -->|是| YYYYY[计算剩余假期]
    VVVVV -->|否| ZZZZZ[更新状态为已通过]
    YYYYY --> AAAAAA[更新剩余假期额度]
    AAAAAA --> BBBBBB[更新状态为已销假]
    WWWWW --> CCCCCC[通知申请人]
    XXXXX --> CCCCCC
    ZZZZZ --> CCCCCC
    BBBBBB --> CCCCCC
    CCCCCC --> OO

    OO --> E
```

### 4.2 智能排班流程图（新增）

```mermaid
flowchart TD
    A[进入智能排班页面] --> B[选择排班对象]
    B --> C{排班对象类型}
    C -->|个人排班| D[选择个人员工]
    C -->|部门排班| E[选择部门]
    C -->|分组排班| F[选择分组]
    D --> G[设置排班时间范围]
    E --> G
    F --> G
    G --> H[进入智能排班流程]
    
    H --> I[获取员工历史打卡数据]
    I --> J[分析最早打卡时间分布]
    J --> K[分析最晚打卡时间分布]
    K --> L[匹配最合适班次]
    L --> M[生成排班建议]
    
    M --> N[预览排班结果]
    N --> O{排班结果满意查}
    O -->|否| P[调整排班参数]
    O -->|是| Q[确认智能排班]
    P --> I
    Q --> R[执行智能排班]
    R --> S[更新排班数据]
    S --> T[智能排班成功]
    T --> U[返回排班列表]
```

## 5. 异常管理模块流程图（统一管理所有考勤异常，增加销假功能）

### 5.1 异常管理流程图

```mermaid
flowchart TD
    A[进入异常管理页面] --> B[查询异常记录列表]
    B --> C[异常记录展示<br/>可变表头显示不同异常类型]
    C --> D{选择操作}

    D -->|新增异常申请| E[点击新增按钮]
    E --> F[选择异常类型]
    F --> G{异常类型}
    G -->|补签申请| H[选择补签人员]
    G -->|请假申请| I[选择请假人员]
    G -->|加班申请| J[选择加班人员]
    G -->|调休申请| K[选择调休人员]
    G -->|调班申请| L[选择调班人员]
    G -->|销假申请| M[选择销假人员]
    G -->|周末加班申请| N[选择周末加班人员]

    H --> O[选择补签类型]
    I --> P[选择请假类型]
    J --> Q[选择加班类型]
    K --> R[检查调休资格]
    L --> S[选择调班对象]
    M --> T[查询有效请假记录]
    N --> U[查询周末打卡记录]

    O --> V{补签类型}
    P --> W[设置请假时间]
    Q --> X{加班类型}
    R --> Y{有足够加班时长查}
    S --> Z[设置调班信息]
    T --> AA{是否有有效请假记录查}
    U --> BB{是否有周末打卡记录查}

    V -->|上班补签| CC[设置补签时间]
    V -->|下班补签| DD[设置补签时间]
    V -->|外出补签| EE[设置外出时间范围]
    W --> FF[系统自动计算请假时长]
    X -->|工作日加班| GG[设置加班时间]
    X -->|休息日加班| HH[设置加班时间]
    X -->|节假日加班| II[选择节假日]
    X -->|周末加班| JJ[查询周末打卡记录]
    Y -->|否| KK[提示调休时长不足]
    Y -->|是| LL[设置调休时长]
    Z --> MM[填写调班原因]
    AA -->|否| NN[提示无有效请假记录]
    AA -->|是| OO[选择要销假的请假记录]
    BB -->|否| PP[提示无周末打卡记录]
    BB -->|是| QQ[显示打卡时间详情]

    CC --> RR[填写申请原因]
    DD --> RR
    EE --> RR
    FF --> SS{时长计算正确查}
    GG --> TT[系统自动计算加班时长]
    HH --> TT
    II --> TT
    JJ --> UU[计算周末打卡时长]
    KK --> VV[返回异常列表]
    LL --> WW[填写调休原因]
    MM --> RR
    NN --> VV
    OO --> XX[填写实际销假时间]
    PP --> VV
    QQ --> YY[确认加班时长]

    RR --> ZZ[上传申请凭证]
    SS -->|否| AAA[手动调整时长]
    SS -->|是| BBB[填写申请原因]
    TT --> CCC{加班时长正确查}
    UU --> DDD[设置加班说明]
    WW --> ZZ
    XX --> EEE[填写销假说明]
    YY --> FFF[上传加班证明]

    AAA --> BBB
    BBB --> ZZ
    CCC -->|否| GGG[手动调整加班时长]
    CCC -->|是| HHH[填写加班原因]
    DDD --> III[确认周末加班申请]
    EEE --> ZZZ[上传销假证明]
    GGG --> HHH
    HHH --> ZZ
    III --> ZZZ
    FFF --> ZZZ

    ZZZ --> AAAA[选择审批人]
    EEE --> AAAA
    AAAA --> BBBB[保存异常申请]
    BBBB --> CCCC[申请信息验证]
    CCCC --> DDDD{验证通过查}
    DDDD -->|否| EEEE[显示验证错误]
    DDDD -->|是| FFFF[启动审批流程]
    EEEE --> E
    FFFF --> GGGG[异常申请提交成功]
    GGGG --> HHHH[返回异常列表]

    D -->|审批异常申请| IIII[选择待审批记录]
    IIII --> JJJJ[点击审批按钮]
    JJJJ --> KKKK[查看详细信息]
    KKKK --> LLLL[查看申请凭证]
    LLLL --> MMMM[核实申请信息]
    MMMM --> NNNN[检查资格条件]
    NNNN --> OOOO[填写审批意见]
    OOOO --> PPPP{审批决定}
    PPPP -->|通过| QQQQ[确认通过审批]
    PPPP -->|拒绝| RRRR[填写拒绝原因]
    PPPP -->|部分通过| SSSS[调整申请内容]
    QQQQ --> TTTT{是否销假申请查}
    RRRR --> UUUU[更新状态为已拒绝]
    SSSS --> VVVV[更新申请时间和状态]
    TTTT -->|是| WWWW[计算剩余假期]
    TTTT -->|否| XXXX[更新状态为已通过]
    WWWW --> YYYY[更新剩余假期额度]
    YYYY --> ZZZZ[更新状态为已销假]
    UUUU --> AAAAA[通知申请人]
    VVVV --> AAAAA
    XXXX --> AAAAA
    ZZZZ --> AAAAA
    AAAAA --> BBBBB[审批完成]
    BBBBB --> HHHH

    D -->|异常确认处理| CCCCC[选择已通过申请]
    CCCCC --> DDDDD[点击确认按钮]
    DDDDD --> EEEEE[确认完成情况]
    EEEEE --> FFFFF[填写实际信息]
    FFFFF --> GGGGG[上传工作证明]
    GGGGG --> HHHHH[保存确认信息]
    HHHHH --> IIIII[异常确认完成]
    IIIII --> HHHH

    D -->|异常查询统计| JJJJJ[点击查询统计]
    JJJJJ --> KKKKK[设置查询条件]
    KKKKK --> LLLLL[选择时间范围]
    LLLLL --> MMMMM[选择异常类型]
    MMMMM --> NNNNN[生成统计报表]
    NNNNN --> OOOOO[显示统计结果]
    OOOOO --> HHHH

    D -->|批量导入| PPPPP[点击批量导入]
    PPPPP --> QQQQQ[下载导入模板]
    QQQQQ --> RRRRR[填写Excel文件]
    RRRRR --> SSSSS[上传文件]
    SSSSS --> TTTTT[解析文件数据]
    TTTTT --> UUUUU[数据验证]
    UUUUU --> VVVVV{数据验证通过查}
    VVVVV -->|否| WWWWW[显示验证错误]
    VVVVV -->|是| XXXXX[执行批量导入]
    WWWWW --> QQQQQ
    XXXXX --> YYYYY[批量导入成功]
    YYYYY --> HHHH

    D -->|导出异常记录| ZZZZZ[选择导出条件]
    ZZZZZ --> AAAAAA[设置时间范围]
    AAAAAA --> BBBBBB[选择导出格式]
    BBBBBB --> CCCCCC{导出格式}
    CCCCCC -->|Excel| DDDDDD[生成Excel文件]
    CCCCCC -->|PDF| EEEEEE[生成PDF文件]
    DDDDDD --> FFFFFF[文件下载]
    EEEEEE --> FFFFFF
    FFFFFF --> HHHH

    HHHH --> GGGGGG[刷新异常记录列表]
    GGGGGG --> C
```

## 6. 考勤汇总报表模块流程图

### 6.1 考勤计算流程图（增加智能找班匹配功能和周末打卡记为加班功能）

```mermaid
flowchart TD
    A[进入考勤计算页面] --> B[设置计算条件]
    B --> C[选择计算范围]
    C --> D{计算范围}
    D -->|按人员计算| E[选择具体人员]
    D -->|按部门计算| F[选择部门]
    D -->|按分组计算| G[选择分组]
    D -->|全部计算| H[选择全部人员]
    E --> I[设置计算时间范围]
    F --> I
    G --> I
    H --> I
    I --> J[选择计算选项]
    J --> K{计算选项}
    K -->|重新计算| L[清除原有计算结果]
    K -->|增量计算| M[保留已有结果]
    K -->|异常重算| N[仅重算异常记录]
    L --> O[启动考勤计算]
    M --> O
    N --> O
    O --> P[收集基础数据<br/>人员/排班/打卡记录]
    P --> Q[收集异常数据<br/>请假/加班/调整]
    Q --> R[逐人执行考勤计算]
    R --> S[智能找班匹配]
    S --> T{找到匹配班次查}
    T -->|否| U[检查是否为周末]
    T -->|是| V[应用班次规则]
    U --> W{是否为周末且有打卡查}
    W -->|否| X[异常考勤处理]
    W -->|是| Y[周末打卡记为加班]
    Y --> Z[计算周末加班时长]
    Z --> AA[生成周末加班记录]
    AA --> BB[保存加班记录]
    V --> CC[计算出勤时长]
    CC --> DD[计算迟到早退]
    DD --> EE[计算旷工时间]
    EE --> FF[计算加班时长]
    FF --> GG[应用异常处理]
    GG --> HH[生成考勤结果]
    X --> HH
    BB --> HH
    HH --> II[保存考勤记录]
    II --> JJ{还有人员查}
    JJ -->|是| R
    JJ -->|否| KK[计算汇总统计]
    KK --> LL[生成计算报告]
    LL --> MM[计算完成]
    MM --> NN[显示计算结果]
    NN --> OO[返回计算页面]
```

### 6.2 考勤结果表流程图（合并日报表和月报表）

```mermaid
flowchart TD
    A[进入考勤结果表页面] --> B[设置报表条件]
    B --> C[选择报表类型]
    C --> D{报表类型}
    D -->|日报表| E[选择报表日期]
    D -->|月报表| F[选择报表月份]
    D -->|自定义报表| G[设置时间范围]
    E --> H[选择查询范围]
    F --> H
    G --> H
    H --> I{查询范围}
    I -->|个人报表| J[选择具体人员]
    I -->|部门报表| K[选择部门]
    I -->|全公司报表| L[选择全公司]
    J --> M[设置报表参数]
    K --> M
    L --> M
    M --> N[选择显示字段<br/>可变表头配置]
    N --> O[设置排序方式]
    O --> P[执行报表生成]
    P --> Q[查询考勤计算结果]
    Q --> R[汇总明细数据]
    R --> S[计算统计数据]
    S --> T[生成报表数据]
    T --> U[报表格式化处理]
    U --> V[考勤结果表展示]
    V --> W{选择操作}

    W -->|查看个人详情| X[选择人员]
    X --> Y[点击查看详情]
    Y --> Z[显示个人考勤明细]
    Z --> AA[显示每日考勤状态]
    AA --> BB[显示异常明细]
    BB --> CC[显示统计汇总]
    CC --> DD[显示周末加班记录]
    DD --> EE[返回报表列表]

    W -->|切换报表类型| FF[点击切换类型]
    FF --> GG{切换到}
    GG -->|日报表| HH[生成日报表]
    GG -->|月报表| II[生成月报表]
    GG -->|自定义| JJ[生成自定义报表]
    HH --> V
    II --> V
    JJ --> V

    W -->|导出报表| KK[点击导出按钮]
    KK --> LL[选择导出格式]
    LL --> MM{导出格式}
    MM -->|Excel| NN[生成Excel文件]
    MM -->|PDF| OO[生成PDF文件]
    MM -->|HTML| PP[生成HTML报表]
    NN --> QQ[文件下载]
    OO --> QQ
    PP --> QQ
    QQ --> RR[记录导出日志]
    RR --> EE

    W -->|打印报表| SS[点击打印按钮]
    SS --> TT[生成打印预览]
    TT --> UU[调整打印设置]
    UU --> VV[执行打印操作]
    VV --> WW[打印完成]
    WW --> EE

    W -->|报表分析| XX[点击分析按钮]
    XX --> YY[生成分析图表]
    YY --> ZZ[出勤率分析]
    ZZ --> AAA[异常考勤分析]
    AAA --> BBB[加班时长分析]
    BBB --> CCC[周末加班分析]
    CCC --> DDD[显示分析结果]
    DDD --> EE

    W -->|可变表头配置| EEE[点击配置表头]
    EEE --> FFF[选择显示字段]
    FFF --> GGG[设置字段顺序]
    GGG --> HHH[保存表头配置]
    HHH --> V

    EE --> V
```