# éƒ¨ç½²æŒ‡å—

<cite>
**æœ¬æ–‡æ¡£å¼•ç”¨çš„æ–‡ä»¶**  
- [pom.xml](file://smart-admin-api-java17-springboot3/sa-admin/pom.xml)
- [sa-base.yaml](file://smart-admin-api-java17-springboot3/sa-base/src/main/resources/prod/sa-base.yaml)
- [AdminApplication.java](file://smart-admin-api-java17-springboot3/sa-admin/src/main/java/net/lab1024/sa/admin/AdminApplication.java)
- [vite.config.js](file://smart-admin-web-javascript/vite.config.js)
- [package.json](file://smart-admin-web-javascript/package.json)
- [application.yaml](file://smart-admin-api-java17-springboot3/sa-admin/src/main/resources/prod/application.yaml)
- [smart_area.sql](file://æ•°æ®åº“SQLè„šæœ¬/mysql/smart_area.sql)
- [log4j2-spring.xml](file://smart-admin-api-java17-springboot3/sa-admin/src/main/resources/prod/log4j2-spring.xml)
</cite>

## ç›®å½•
1. [åç«¯æœåŠ¡éƒ¨ç½²](#åç«¯æœåŠ¡éƒ¨ç½²)
2. [å‰ç«¯é¡¹ç›®éƒ¨ç½²](#å‰ç«¯é¡¹ç›®éƒ¨ç½²)
3. [ç”Ÿäº§ç¯å¢ƒé…ç½®](#ç”Ÿäº§ç¯å¢ƒé…ç½®)
4. [éƒ¨ç½²æ¶æ„å›¾](#éƒ¨ç½²æ¶æ„å›¾)
5. [è¿ç»´ç›‘æ§æ–¹æ¡ˆ](#è¿ç»´ç›‘æ§æ–¹æ¡ˆ)
6. [ç‰ˆæœ¬å‡çº§ä¸å›æ»šæµç¨‹](#ç‰ˆæœ¬å‡çº§ä¸å›æ»šæµç¨‹)
7. [é«˜å¯ç”¨ä¸ç¾å¤‡æ–¹æ¡ˆ](#é«˜å¯ç”¨ä¸ç¾å¤‡æ–¹æ¡ˆ)

## åç«¯æœåŠ¡éƒ¨ç½²

### Mavenæ‰“åŒ…æµç¨‹
åç«¯æœåŠ¡é‡‡ç”¨Mavenè¿›è¡Œé¡¹ç›®æ„å»ºå’Œæ‰“åŒ…ã€‚é¡¹ç›®åŒ…å«ä¸¤ä¸ªä¸»è¦æ¨¡å—ï¼š`sa-admin`ï¼ˆä¸»åº”ç”¨æ¨¡å—ï¼‰å’Œ`sa-base`ï¼ˆåŸºç¡€ä¾èµ–æ¨¡å—ï¼‰ã€‚é¦–å…ˆéœ€è¦å¯¹`sa-base`æ¨¡å—æ‰§è¡Œ`install`å‘½ä»¤ï¼Œå°†å…¶å®‰è£…åˆ°æœ¬åœ°Mavenä»“åº“ï¼Œç„¶ååœ¨`sa-admin`æ¨¡å—ä¸­æ‰§è¡Œ`package`å‘½ä»¤ç”Ÿæˆå¯æ‰§è¡Œçš„JARæ–‡ä»¶ã€‚

æ‰“åŒ…å‘½ä»¤å¦‚ä¸‹ï¼š
```bash
# è¿›å…¥sa-baseç›®å½•å¹¶å®‰è£…åˆ°æœ¬åœ°ä»“åº“
cd smart-admin-api-java17-springboot3/sa-base
mvn clean install

# è¿›å…¥sa-adminç›®å½•å¹¶æ‰“åŒ…
cd ../sa-admin
mvn clean package
```

æ‰“åŒ…å®Œæˆåï¼Œå¯åœ¨`sa-admin/target`ç›®å½•ä¸‹æ‰¾åˆ°ç”Ÿæˆçš„JARæ–‡ä»¶ï¼Œæ–‡ä»¶åä¸º`sa-admin-3.0.0.jar`ã€‚

**Section sources**
- [pom.xml](file://smart-admin-api-java17-springboot3/sa-admin/pom.xml#L1-L47)
- [pom.xml](file://smart-admin-api-java17-springboot3/sa-base/pom.xml#L1-L276)

### Dockeré•œåƒæ„å»º
ä¸ºå®ç°å®¹å™¨åŒ–éƒ¨ç½²ï¼Œå¯åŸºäºç”Ÿæˆçš„JARæ–‡ä»¶æ„å»ºDockeré•œåƒã€‚å»ºè®®ä½¿ç”¨Java 17ä½œä¸ºåŸºç¡€é•œåƒï¼Œç¡®ä¿ä¸é¡¹ç›®è¦æ±‚çš„Javaç‰ˆæœ¬ä¸€è‡´ã€‚

Dockerfileç¤ºä¾‹ï¼š
```dockerfile
FROM openjdk:17-jdk-slim

WORKDIR /app

COPY target/sa-admin-3.0.0.jar app.jar

EXPOSE 1024

ENTRYPOINT ["java", "-jar", "app.jar"]
```

æ„å»ºé•œåƒå‘½ä»¤ï¼š
```bash
docker build -t smartadmin-backend:3.0.0 .
```

### JVMå‚æ•°é…ç½® (æŒ‰ç…§CLAUDE.md v4.0.0æ ‡å‡†)
ä¸ºç¡®ä¿åç«¯æœåŠ¡åœ¨ç”Ÿäº§ç¯å¢ƒä¸­çš„ç¨³å®šè¿è¡Œï¼Œå¿…é¡»é…ç½®ä»¥ä¸‹JVMå‚æ•°ï¼š

```bash
java -Xms2g -Xmx4g \
     -XX:MetaspaceSize=256m \
     -XX:MaxMetaspaceSize=512m \
     -XX:+UseG1GC \
     -XX:MaxGCPauseMillis=200 \
     -XX:+PrintGCDetails \
     -XX:+PrintGCTimeStamps \
     -XX:+HeapDumpOnOutOfMemoryError \
     -XX:HeapDumpPath=/var/log/app/heapdump.hprof \
     -Dfile.encoding=UTF-8 \
     -Duser.timezone=Asia/Shanghai \
     -jar sa-admin-3.0.0.jar
```

å…³é”®å‚æ•°è¯´æ˜ï¼š
- `-Xms`å’Œ`-Xmx`ï¼šæŒ‰ç…§CLAUDE.mdæ ‡å‡†è®¾ç½®ä¸º2g-4g
- `-XX:+UseG1GC`ï¼šä½¿ç”¨G1åƒåœ¾æ”¶é›†å™¨ï¼Œç¬¦åˆå…¨å±€æ ‡å‡†
- `-XX:MaxGCPauseMillis`ï¼šè®¾ç½®æœ€å¤§GCæš‚åœæ—¶é—´ç›®æ ‡ä¸º200ms
- `-XX:+PrintGCDetails`ï¼šæ‰“å°GCè¯¦ç»†ä¿¡æ¯ï¼ˆå…¨å±€è§„èŒƒè¦æ±‚ï¼‰
- `-XX:+PrintGCTimeStamps`ï¼šæ‰“å°GCæ—¶é—´æˆ³ï¼ˆå…¨å±€è§„èŒƒè¦æ±‚ï¼‰
- `-Dfile.encoding=UTF-8`ï¼šå¼ºåˆ¶UTF-8ç¼–ç ï¼ˆå…¨å±€è§„èŒƒè¦æ±‚ï¼‰
- `-Duser.timezone=Asia/Shanghai`ï¼šè®¾ç½®æ—¶åŒºä¸ºä¸Šæµ·ï¼ˆå…¨å±€è§„èŒƒè¦æ±‚ï¼‰

**Section sources**
- [AdminApplication.java](file://smart-admin-api-java17-springboot3/sa-admin/src/main/java/net/lab1024/sa/admin/AdminApplication.java#L1-L41)
- [log4j2-spring.xml](file://smart-admin-api-java17-springboot3/sa-admin/src/main/resources/prod/log4j2-spring.xml#L1-L26)

## å‰ç«¯é¡¹ç›®éƒ¨ç½²
## ğŸ“‹ IOE-DREAMä¸ƒå¾®æœåŠ¡æ¶æ„

**æ ¸å¿ƒæ¶æ„ç»„æˆ**:
- **Gateway Service (8080)**: APIç½‘å…³
- **Common Service (8088)**: å…¬å…±æ¨¡å—å¾®æœåŠ¡
- **DeviceComm Service (8087)**: è®¾å¤‡é€šè®¯å¾®æœåŠ¡
- **OA Service (8089)**: OAå¾®æœåŠ¡
- **Access Service (8090)**: é—¨ç¦æœåŠ¡
- **Attendance Service (8091)**: è€ƒå‹¤æœåŠ¡
- **Video Service (8092)**: è§†é¢‘æœåŠ¡
- **Consume Service (8094)**: æ¶ˆè´¹æœåŠ¡
- **Visitor Service (8095)**: è®¿å®¢æœåŠ¡

**æ¶æ„ç‰¹ç‚¹**:
- åŸºäºSpring Boot 3.5.8 + Java 17
- ä¸¥æ ¼éµå¾ªä¼ä¸šçº§å¾®æœåŠ¡è§„èŒƒ
- æ”¯æŒé«˜å¹¶å‘ã€é«˜å¯ç”¨ã€æ°´å¹³æ‰©å±•

**æŠ€æœ¯æ ˆæ ‡å‡†**:
- **æ•°æ®åº“**: MySQL 8.0 + Druidè¿æ¥æ± 
- **ç¼“å­˜**: Redis + Caffeineå¤šçº§ç¼“å­˜
- **æ³¨å†Œä¸­å¿ƒ**: Nacos
- **é…ç½®ä¸­å¿ƒ**: Nacos Config
- **è®¤è¯æˆæƒ**: Sa-Token

## ğŸ—ï¸ å››å±‚æ¶æ„è§„èŒƒ

**æ ‡å‡†æ¶æ„æ¨¡å¼**:
```
Controller (æ¥å£æ§åˆ¶å±‚)
    â†“
Service (æ ¸å¿ƒä¸šåŠ¡å±‚)
    â†“
Manager (æµç¨‹ç®¡ç†å±‚)
    â†“
DAO (æ•°æ®è®¿é—®å±‚)
```

**å±‚çº§èŒè´£**:
- **Controllerå±‚**: HTTPè¯·æ±‚å¤„ç†ã€å‚æ•°éªŒè¯ã€æƒé™æ§åˆ¶
- **Serviceå±‚**: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ã€äº‹åŠ¡ç®¡ç†ã€ä¸šåŠ¡è§„åˆ™éªŒè¯
- **Managerå±‚**: å¤æ‚æµç¨‹ç¼–æ’ã€å¤šæ•°æ®ç»„è£…ã€ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆ
- **DAOå±‚**: æ•°æ®åº“CRUDæ“ä½œã€SQLæŸ¥è¯¢å®ç°ã€æ•°æ®è®¿é—®è¾¹ç•Œ

**ä¸¥æ ¼ç¦æ­¢è·¨å±‚è®¿é—®**: Controllerä¸èƒ½ç›´æ¥è°ƒç”¨Manager/DAOï¼
### Viteæ„å»ºé…ç½®
## âš ï¸ IOE-DREAMé›¶å®¹å¿è§„åˆ™ï¼ˆå¼ºåˆ¶æ‰§è¡Œï¼‰

**å¿…é¡»éµå®ˆçš„æ¶æ„è§„åˆ™**:
- âœ… **å¿…é¡»ä½¿ç”¨ @Resource æ³¨å…¥ä¾èµ–**
- âœ… **å¿…é¡»ä½¿ç”¨ @Mapper æ³¨è§£** (ç¦æ­¢@Repository)
- âœ… **å¿…é¡»ä½¿ç”¨ Dao åç¼€** (ç¦æ­¢Repository)
- âœ… **å¿…é¡»ä½¿ç”¨ @RestController æ³¨è§£**
- âœ… **å¿…é¡»ä½¿ç”¨ @Valid å‚æ•°æ ¡éªŒ**
- âœ… **å¿…é¡»è¿”å›ç»Ÿä¸€ResponseDTOæ ¼å¼**
- âœ… **å¿…é¡»éµå¾ªå››å±‚æ¶æ„è¾¹ç•Œ**

**ä¸¥æ ¼ç¦æ­¢äº‹é¡¹**:
- âŒ **ç¦æ­¢ä½¿ç”¨ @Autowired æ³¨å…¥**
- âŒ **ç¦æ­¢ä½¿ç”¨ @Repository æ³¨è§£**
- âŒ **ç¦æ­¢ä½¿ç”¨ Repository åç¼€å‘½å**
- âŒ **ç¦æ­¢è·¨å±‚è®¿é—®**
- âŒ **ç¦æ­¢åœ¨Controllerä¸­åŒ…å«ä¸šåŠ¡é€»è¾‘**
- âŒ **ç¦æ­¢ç›´æ¥è®¿é—®æ•°æ®åº“**

**è¿è§„åæœ**: P0çº§é—®é¢˜ï¼Œç«‹å³ä¿®å¤ï¼Œç¦æ­¢åˆå¹¶ï¼
å‰ç«¯é¡¹ç›®ä½¿ç”¨Viteä½œä¸ºæ„å»ºå·¥å…·ï¼Œæ”¯æŒå¤šç¯å¢ƒæ„å»ºã€‚é¡¹ç›®æ ¹ç›®å½•ä¸‹çš„`vite.config.js`æ–‡ä»¶å®šä¹‰äº†æ„å»ºé…ç½®ï¼ŒåŒ…æ‹¬åˆ«åè®¾ç½®ã€ä»£ç†é…ç½®å’Œæ„å»ºä¼˜åŒ–ç­‰ã€‚

å…³é”®é…ç½®è¯´æ˜ï¼š
- `base`ï¼šæ ¹æ®ç¯å¢ƒå˜é‡è®¾ç½®åŸºç¡€è·¯å¾„ï¼Œç”Ÿäº§ç¯å¢ƒä¸ºåŸºç¡€è·¯å¾„`/`
- `resolve.alias`ï¼šè®¾ç½®äº†`/@/`åˆ«åï¼ŒæŒ‡å‘`src`ç›®å½•ï¼Œç®€åŒ–æ¨¡å—å¯¼å…¥
- `server.proxy`ï¼šå¼€å‘ç¯å¢ƒä¸‹çš„ä»£ç†é…ç½®ï¼Œå°†APIè¯·æ±‚ä»£ç†åˆ°åç«¯æœåŠ¡
- `build.rollupOptions`ï¼šé…ç½®äº†ä»£ç åˆ†å‰²ç­–ç•¥ï¼Œå°†node_modulesä¸­çš„ä¾èµ–æŒ‰åŒ…ååˆ†å‰²

**Section sources**
- [vite.config.js](file://smart-admin-web-javascript/vite.config.js#L1-L100)

### é™æ€èµ„æºéƒ¨ç½²
å‰ç«¯é¡¹ç›®é€šè¿‡Viteæ„å»ºç”Ÿæˆé™æ€èµ„æºæ–‡ä»¶ï¼Œéƒ¨ç½²åˆ°WebæœåŠ¡å™¨æˆ–CDNã€‚é¡¹ç›®æä¾›äº†é’ˆå¯¹ä¸åŒç¯å¢ƒçš„æ„å»ºè„šæœ¬ï¼š

```json
"scripts": {
  "build:test": "vite build  --base=/admin/ --mode test",
  "build:pre": "vite build  --mode pre",
  "build:prod": "vite build  --mode production"
}
```

æ„å»ºå‘½ä»¤æ‰§è¡Œåï¼Œä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹ç”Ÿæˆ`dist`æ–‡ä»¶å¤¹ï¼ŒåŒ…å«æ‰€æœ‰é™æ€èµ„æºæ–‡ä»¶ã€‚å»ºè®®å°†`dist`ç›®å½•ä¸‹çš„å†…å®¹éƒ¨ç½²åˆ°Nginxç­‰WebæœåŠ¡å™¨ã€‚

Nginxé…ç½®ç¤ºä¾‹ï¼š
```nginx
server {
    listen 80;
    server_name smartadmin.example.com;
    
    root /var/www/smartadmin/dist;
    index index.html;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    location /api/ {
        proxy_pass http://backend-server:1024/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

**Section sources**
- [package.json](file://smart-admin-web-javascript/package.json#L1-L75)
- [vite.config.js](file://smart-admin-web-javascript/vite.config.js#L57-L86)

## ç”Ÿäº§ç¯å¢ƒé…ç½®

### æœåŠ¡å™¨é…ç½®è¦æ±‚
ä¸ºç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œï¼Œå»ºè®®ç”Ÿäº§ç¯å¢ƒæœåŠ¡å™¨é…ç½®å¦‚ä¸‹ï¼š

- **CPU**ï¼š4æ ¸åŠä»¥ä¸Š
- **å†…å­˜**ï¼š8GBåŠä»¥ä¸Šï¼ˆå»ºè®®16GBï¼‰
- **å­˜å‚¨**ï¼š100GB SSDç¡¬ç›˜
- **æ“ä½œç³»ç»Ÿ**ï¼šCentOS 7+ æˆ– Ubuntu 18.04+
- **Javaç‰ˆæœ¬**ï¼šOpenJDK 17
- **Node.jsç‰ˆæœ¬**ï¼š18+

### æ•°æ®åº“é…ç½® (æŒ‰ç…§CLAUDE.md v4.0.0æ ‡å‡†)
ç³»ç»Ÿä½¿ç”¨MySQLä½œä¸ºä¸»è¦æ•°æ®åº“ï¼Œç”Ÿäº§ç¯å¢ƒé…ç½®ä½äº`sa-base.yaml`æ–‡ä»¶ä¸­ã€‚æŒ‰ç…§å…¨å±€æ¶æ„è§„èŒƒï¼Œå¿…é¡»ä½¿ç”¨Druidè¿æ¥æ± ï¼š

```yaml
spring:
  datasource:
    # å¿…é¡»æŒ‡å®šDruidæ•°æ®æºç±»å‹
    type: com.alibaba.druid.pool.DruidDataSource
    url: jdbc:mysql://127.0.0.1:3306/smart_admin_v3?autoReconnect=true&useServerPreparedStmts=false&rewriteBatchedStatements=true&characterEncoding=UTF-8&useSSL=false&allowMultiQueries=true&serverTimezone=Asia/Shanghai
    username: root
    # ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨åŠ å¯†é…ç½®ï¼Œç¦æ­¢æ˜æ–‡å¯†ç 
    password: ENC(AES256:encrypted_password_hash)
    driver-class-name: com.mysql.cj.jdbc.Driver
    druid:
      # Druidè¿æ¥æ± æ ¸å¿ƒé…ç½®
      initial-size: 5
      min-idle: 5
      max-active: 20
      max-wait: 60000
      # æ€§èƒ½ä¼˜åŒ–é…ç½®
      validation-query: SELECT 1
      test-while-idle: true
      test-on-borrow: false
      test-on-return: false
      # ç›‘æ§é…ç½®
      stat-view-servlet:
        enabled: true
        url-pattern: /druid/*
      web-stat-filter:
        enabled: true
        url-pattern: /*
```

**é‡è¦è¯´æ˜**ï¼š
- **å¼ºåˆ¶ä½¿ç”¨Druidè¿æ¥æ± **ï¼šæŒ‰ç…§CLAUDE.mdè§„èŒƒï¼Œå¿…é¡»æŒ‡å®š`type: com.alibaba.druid.pool.DruidDataSource`
- **ç¦æ­¢æ˜æ–‡å¯†ç **ï¼šç”Ÿäº§ç¯å¢ƒå¿…é¡»ä½¿ç”¨NacosåŠ å¯†é…ç½®æ ¼å¼
- **è¿æ¥æ± å‚æ•°ä¼˜åŒ–**ï¼šæŒ‰ç…§å…¨å±€æ¶æ„è§„èŒƒè®¾ç½®åˆç†çš„è¿æ¥æ± å‚æ•°

æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ä½äº`æ•°æ®åº“SQLè„šæœ¬/mysql/`ç›®å½•ä¸‹ï¼ŒåŒ…æ‹¬`smart_area.sql`ç­‰æ–‡ä»¶ï¼Œç”¨äºåˆ›å»ºåŒºåŸŸç®¡ç†æ¨¡å—çš„æ•°æ®åº“è¡¨ç»“æ„ã€‚

**Section sources**
- [sa-base.yaml](file://smart-admin-api-java17-springboot3/sa-base/src/main/resources/prod/sa-base.yaml#L1-L184)
- [smart_area.sql](file://æ•°æ®åº“SQLè„šæœ¬/mysql/smart_area.sql#L1-L197)

### ç½‘ç»œé…ç½® (æŒ‰ç…§CLAUDE.md v4.0.0ä¸ƒå¾®æœåŠ¡æ¶æ„)
ç³»ç»Ÿé‡‡ç”¨ä¸ƒå¾®æœåŠ¡æ¶æ„ï¼Œéœ€è¦é…ç½®ç›¸åº”çš„ç½‘ç»œè®¿é—®ç­–ç•¥ï¼š

#### ä¸ƒå¾®æœåŠ¡ç«¯å£åˆ†é… (ä¸¥æ ¼æŒ‰ç…§CLAUDE.mdè§„èŒƒ)
| æœåŠ¡åç§° | ç«¯å£ | ç±»å‹ | æ ¸å¿ƒèŒè´£ | çŠ¶æ€ |
|---------|------|------|---------|------|
| **ioedream-gateway-service** | 8080 | åŸºç¡€è®¾æ–½ | APIç½‘å…³ã€è·¯ç”±ã€è´Ÿè½½å‡è¡¡ | âœ… è¿è¡Œä¸­ |
| **ioedream-common-service** | 8088 | æ ¸å¿ƒå…¬å…±æœåŠ¡ | è®¤è¯ã€æˆæƒã€é…ç½®ã€ç›‘æ§ã€é€šçŸ¥ | âœ… è¿è¡Œä¸­ |
| **ioedream-device-comm-service** | 8087 | æ ¸å¿ƒæœåŠ¡ | è®¾å¤‡åè®®é€‚é…ã€é€šä¿¡ç®¡ç† | âœ… è¿è¡Œä¸­ |
| **ioedream-oa-service** | 8089 | æ ¸å¿ƒæœåŠ¡ | æ–‡æ¡£ç®¡ç†ã€å·¥ä½œæµã€ä¼ä¸šä¿¡æ¯ | âœ… è¿è¡Œä¸­ |
| **ioedream-access-service** | 8090 | ä¸šåŠ¡æœåŠ¡ | é—¨ç¦æ§åˆ¶ã€æƒé™ç®¡ç† | âœ… è¿è¡Œä¸­ |
| **ioedream-attendance-service** | 8091 | ä¸šåŠ¡æœåŠ¡ | è€ƒå‹¤ç®¡ç†ã€æ’ç­ç»Ÿè®¡ | âœ… è¿è¡Œä¸­ |
| **ioedream-video-service** | 8092 | ä¸šåŠ¡æœåŠ¡ | è§†é¢‘ç›‘æ§ã€æ™ºèƒ½åˆ†æ | âœ… è¿è¡Œä¸­ |
| **ioedream-consume-service** | 8094 | ä¸šåŠ¡æœåŠ¡ | æ¶ˆè´¹ç®¡ç†ã€æ”¯ä»˜ã€å•†æˆ· | âœ… è¿è¡Œä¸­ |
| **ioedream-visitor-service** | 8095 | ä¸šåŠ¡æœåŠ¡ | è®¿å®¢ç®¡ç†ã€é¢„çº¦ç™»è®° | âœ… è¿è¡Œä¸­ |

#### å…¶ä»–åŸºç¡€è®¾æ–½ç«¯å£
- **å‰ç«¯è®¿é—®ç«¯å£**ï¼š80ï¼ˆHTTPï¼‰æˆ–443ï¼ˆHTTPSï¼‰
- **Nacosé…ç½®ä¸­å¿ƒ**ï¼š8848
- **æ•°æ®åº“ç«¯å£**ï¼š3306
- **Redisç«¯å£**ï¼š6379

#### ç½‘ç»œå®‰å…¨é…ç½®
å»ºè®®é…ç½®é˜²ç«å¢™è§„åˆ™ï¼Œä»…å…è®¸å¿…è¦çš„ç«¯å£å¯¹å¤–æš´éœ²ï¼š
- âœ… **å¯¹å¤–æš´éœ²**ï¼š8080ï¼ˆç½‘å…³ï¼‰ã€80/443ï¼ˆå‰ç«¯ï¼‰
- âŒ **å†…éƒ¨è®¿é—®**ï¼š8088ã€8087ã€8089ã€8090ã€8091ã€8092ã€8094ã€8095ï¼ˆä»…å†…ç½‘è®¿é—®ï¼‰
- âŒ **æ•°æ®åº“è®¿é—®**ï¼š3306ã€6379ã€8848ï¼ˆä»…åº”ç”¨æœåŠ¡å™¨è®¿é—®ï¼‰

ä½¿ç”¨åå‘ä»£ç†æœåŠ¡å™¨ï¼ˆå¦‚Nginxï¼‰è¿›è¡Œè¯·æ±‚è½¬å‘å’ŒSSLç»ˆæ­¢ã€‚

**Section sources**
- [sa-base.yaml](file://smart-admin-api-java17-springboot3/sa-base/src/main/resources/prod/sa-base.yaml#L24-L37)

## éƒ¨ç½²æ¶æ„å›¾

```mermaid
graph TB
subgraph "å®¢æˆ·ç«¯"
A[æµè§ˆå™¨] --> B[Nginx]
end
subgraph "æœåŠ¡ç«¯"
B --> C[å‰ç«¯é™æ€èµ„æº]
B --> D[APIç½‘å…³]
D --> E[åç«¯æœåŠ¡]
E --> F[MySQLæ•°æ®åº“]
E --> G[Redisç¼“å­˜]
end
subgraph "å¤–éƒ¨æœåŠ¡"
E --> H[é‚®ä»¶æœåŠ¡å™¨]
E --> I[å¯¹è±¡å­˜å‚¨]
end
style A fill:#f9f,stroke:#333
style B fill:#bbf,stroke:#333
style C fill:#f96,stroke:#333
style D fill:#9f9,stroke:#333
style E fill:#6f9,stroke:#333
style F fill:#99f,stroke:#333
style G fill:#f66,stroke:#333
style H fill:#696,stroke:#333
style I fill:#669,stroke:#333
```

**Diagram sources**
- [sa-base.yaml](file://smart-admin-api-java17-springboot3/sa-base/src/main/resources/prod/sa-base.yaml#L1-L184)
- [vite.config.js](file://smart-admin-web-javascript/vite.config.js#L38-L51)

## è¿ç»´ç›‘æ§æ–¹æ¡ˆ

### æ—¥å¿—æ”¶é›†
ç³»ç»Ÿä½¿ç”¨Log4j2ä½œä¸ºæ—¥å¿—æ¡†æ¶ï¼Œé…ç½®æ–‡ä»¶ä½äº`log4j2-spring.xml`ã€‚æ—¥å¿—æŒ‰çº§åˆ«åˆ†å‰²å­˜å‚¨ï¼ŒåŒ…å«ä»¥ä¸‹æ–‡ä»¶ï¼š

- `debug.log`ï¼šè°ƒè¯•æ—¥å¿—
- `info.log`ï¼šä¿¡æ¯æ—¥å¿—
- `error.log`ï¼šé”™è¯¯æ—¥å¿—
- `tomcat-logs`ï¼šTomcatè®¿é—®æ—¥å¿—

å»ºè®®ä½¿ç”¨ELKï¼ˆElasticsearch, Logstash, Kibanaï¼‰æˆ–EFKï¼ˆElasticsearch, Fluentd, Kibanaï¼‰ç­‰æ—¥å¿—æ”¶é›†ç³»ç»Ÿï¼Œé›†ä¸­ç®¡ç†æ—¥å¿—æ–‡ä»¶ï¼Œä¾¿äºé—®é¢˜æ’æŸ¥å’Œåˆ†æã€‚

**Section sources**
- [log4j2-spring.xml](file://smart-admin-api-java17-springboot3/sa-admin/src/main/resources/prod/log4j2-spring.xml#L1-L26)

### æ€§èƒ½ç›‘æ§
ç³»ç»Ÿå†…ç½®äº†å¤šç§æ€§èƒ½ç›‘æ§æœºåˆ¶ï¼š

1. **Druidç›‘æ§**ï¼šé€šè¿‡Druidæ•°æ®æºæä¾›çš„ç›‘æ§åŠŸèƒ½ï¼Œå¯ä»¥ç›‘æ§æ•°æ®åº“è¿æ¥æ± çŠ¶æ€ã€SQLæ‰§è¡Œæƒ…å†µç­‰
2. **å¥åº·æ£€æŸ¥**ï¼šé€šè¿‡Spring Boot Actuatoræä¾›çš„å¥åº·æ£€æŸ¥ç«¯ç‚¹ï¼Œç›‘æ§ç³»ç»Ÿè¿è¡ŒçŠ¶æ€
3. **å¿ƒè·³æœºåˆ¶**ï¼šç³»ç»Ÿé…ç½®äº†å®šæ—¶å¿ƒè·³ä»»åŠ¡ï¼Œç”¨äºç›‘æ§æœåŠ¡å¯ç”¨æ€§

å»ºè®®é›†æˆPrometheuså’ŒGrafanaï¼Œå®ç°ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡çš„å¯è§†åŒ–ç›‘æ§ã€‚

### å‘Šè­¦è®¾ç½®
å»ºè®®é…ç½®ä»¥ä¸‹å‘Šè­¦è§„åˆ™ï¼š

- **CPUä½¿ç”¨ç‡**ï¼šè¶…è¿‡80%æŒç»­5åˆ†é’Ÿ
- **å†…å­˜ä½¿ç”¨ç‡**ï¼šè¶…è¿‡85%æŒç»­5åˆ†é’Ÿ
- **ç£ç›˜ç©ºé—´**ï¼šå‰©ä½™ç©ºé—´ä½äº20%
- **æœåŠ¡å¯ç”¨æ€§**ï¼šHTTPå¥åº·æ£€æŸ¥å¤±è´¥è¿ç»­3æ¬¡
- **æ•°æ®åº“è¿æ¥**ï¼šæ´»è·ƒè¿æ¥æ•°è¶…è¿‡æœ€å¤§è¿æ¥æ•°çš„80%

å‘Šè­¦å¯é€šè¿‡é‚®ä»¶ã€çŸ­ä¿¡æˆ–å³æ—¶é€šè®¯å·¥å…·å‘é€ç»™è¿ç»´äººå‘˜ã€‚

**Section sources**
- [sa-base.yaml](file://smart-admin-api-java17-springboot3/sa-base/src/main/resources/prod/sa-base.yaml#L77-L86)

## ç‰ˆæœ¬å‡çº§ä¸å›æ»šæµç¨‹

### ç‰ˆæœ¬å‡çº§æµç¨‹
1. **å¤‡ä»½å½“å‰ç‰ˆæœ¬**ï¼šå¤‡ä»½æ•°æ®åº“å’Œé…ç½®æ–‡ä»¶
2. **åœæ­¢æœåŠ¡**ï¼šä¼˜é›…åœæ­¢å½“å‰è¿è¡Œçš„æœåŠ¡
3. **éƒ¨ç½²æ–°ç‰ˆæœ¬**ï¼šå°†æ–°ç‰ˆæœ¬çš„JARæ–‡ä»¶æˆ–Dockeré•œåƒéƒ¨ç½²åˆ°æœåŠ¡å™¨
4. **æ•°æ®åº“è¿ç§»**ï¼šæ‰§è¡Œå¿…è¦çš„æ•°æ®åº“è¿ç§»è„šæœ¬
5. **å¯åŠ¨æœåŠ¡**ï¼šå¯åŠ¨æ–°ç‰ˆæœ¬æœåŠ¡å¹¶éªŒè¯åŠŸèƒ½
6. **ç›‘æ§è¿è¡Œ**ï¼šè§‚å¯Ÿç³»ç»Ÿæ—¥å¿—å’Œæ€§èƒ½æŒ‡æ ‡ï¼Œç¡®ä¿ç¨³å®šè¿è¡Œ

### ç‰ˆæœ¬å›æ»šæµç¨‹
å½“æ–°ç‰ˆæœ¬å‡ºç°ä¸¥é‡é—®é¢˜æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹å›æ»šæµç¨‹ï¼š

1. **åœæ­¢æ–°ç‰ˆæœ¬æœåŠ¡**ï¼šç«‹å³åœæ­¢æœ‰é—®é¢˜çš„æ–°ç‰ˆæœ¬æœåŠ¡
2. **æ¢å¤å¤‡ä»½**ï¼šæ¢å¤æ•°æ®åº“å’Œé…ç½®æ–‡ä»¶åˆ°ä¸Šä¸€ä¸ªç¨³å®šç‰ˆæœ¬çš„çŠ¶æ€
3. **å¯åŠ¨æ—§ç‰ˆæœ¬**ï¼šå¯åŠ¨ä¸Šä¸€ä¸ªç¨³å®šç‰ˆæœ¬çš„æœåŠ¡
4. **éªŒè¯åŠŸèƒ½**ï¼šæ£€æŸ¥æ ¸å¿ƒåŠŸèƒ½æ˜¯å¦æ­£å¸¸
5. **é€šçŸ¥ç›¸å…³äººå‘˜**ï¼šå‘ŠçŸ¥å¼€å‘å›¢é˜Ÿå’Œä¸šåŠ¡æ–¹å›æ»šæƒ…å†µ

å»ºè®®åœ¨å‡çº§å‰åˆ›å»ºæ•°æ®åº“å¿«ç…§ï¼Œä»¥ä¾¿å¿«é€Ÿå›æ»šã€‚

**Section sources**
- [sa-base.yaml](file://smart-admin-api-java17-springboot3/sa-base/src/main/resources/prod/sa-base.yaml#L173-L184)

## é«˜å¯ç”¨ä¸ç¾å¤‡æ–¹æ¡ˆ

### é«˜å¯ç”¨éƒ¨ç½²
ä¸ºå®ç°ç³»ç»Ÿé«˜å¯ç”¨ï¼Œå»ºè®®é‡‡ç”¨ä»¥ä¸‹éƒ¨ç½²æ–¹æ¡ˆï¼š

- **åç«¯æœåŠ¡**ï¼šéƒ¨ç½²å¤šä¸ªå®ä¾‹ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡å™¨ï¼ˆå¦‚Nginxæˆ–HAProxyï¼‰åˆ†å‘è¯·æ±‚
- **æ•°æ®åº“**ï¼šé‡‡ç”¨ä¸»ä»å¤åˆ¶æ¶æ„ï¼Œä¸»åº“è´Ÿè´£å†™æ“ä½œï¼Œä»åº“è´Ÿè´£è¯»æ“ä½œ
- **Redis**ï¼šéƒ¨ç½²Redisé›†ç¾¤ï¼Œå®ç°æ•°æ®åˆ†ç‰‡å’Œé«˜å¯ç”¨
- **å‰ç«¯èµ„æº**ï¼šéƒ¨ç½²åˆ°CDNï¼Œæé«˜è®¿é—®é€Ÿåº¦å’Œå¯ç”¨æ€§

### ç¾å¤‡æ–¹æ¡ˆ
ä¸ºåº”å¯¹ç¾éš¾æ€§æ•…éšœï¼Œå»ºè®®å®æ–½ä»¥ä¸‹ç¾å¤‡æªæ–½ï¼š

1. **æ•°æ®å¤‡ä»½**ï¼šæ¯å¤©å®šæ—¶å¤‡ä»½æ•°æ®åº“ï¼Œä¿ç•™æœ€è¿‘7å¤©çš„å¤‡ä»½
2. **å¼‚åœ°å¤‡ä»½**ï¼šå°†å¤‡ä»½æ–‡ä»¶åŒæ­¥åˆ°å¼‚åœ°å­˜å‚¨ï¼Œé˜²æ­¢æœ¬åœ°ç¾éš¾å¯¼è‡´æ•°æ®ä¸¢å¤±
3. **å®¹ç¾æ¼”ç»ƒ**ï¼šå®šæœŸè¿›è¡Œå®¹ç¾æ¼”ç»ƒï¼ŒéªŒè¯å¤‡ä»½æ¢å¤æµç¨‹çš„æœ‰æ•ˆæ€§
4. **ç›‘æ§å‘Šè­¦**ï¼šå»ºç«‹å®Œå–„çš„ç›‘æ§å‘Šè­¦ä½“ç³»ï¼ŒåŠæ—¶å‘ç°å’Œå¤„ç†æ½œåœ¨é—®é¢˜

é€šè¿‡ä»¥ä¸Šé«˜å¯ç”¨å’Œç¾å¤‡æ–¹æ¡ˆï¼Œå¯ä»¥æœ€å¤§ç¨‹åº¦åœ°ä¿éšœç³»ç»Ÿçš„ç¨³å®šæ€§å’Œæ•°æ®çš„å®‰å…¨æ€§ã€‚

**Section sources**
- [sa-base.yaml](file://smart-admin-api-java17-springboot3/sa-base/src/main/resources/prod/sa-base.yaml#L24-L37)
- [sa-base.yaml](file://smart-admin-api-java17-springboot3/sa-base/src/main/resources/prod/sa-base.yaml#L77-L86)