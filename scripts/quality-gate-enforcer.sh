#!/bin/bash

# =============================================================================
# IOE-DREAM 质量门禁执行器
#
# 功能：在Maven编译前执行质量检查，失败时阻止构建
# 集成方式：在pom.xml中通过exec-maven-plugin调用
# =============================================================================

set -e

# 执行编译质量检查
echo "🚪 IOE-DREAM 质量门禁检查开始..."
./scripts/compile-quality-check.sh

# 如果检查失败，阻止构建
EXIT_CODE=$?
if [ $EXIT_CODE -ne 0 ]; then
    echo "❌ 质量门禁检查失败，构建被阻止"
    echo "请修复上述问题后重新构建"
    exit 1
fi

echo "✅ 质量门禁检查通过，继续构建..."