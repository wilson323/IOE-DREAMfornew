#!/bin/bash

# 批量修复Java文件中的中文编码错误
# 使用sed进行字符替换

echo "开始批量修复Java文件编码错误..."

# 常见编码错误修复映射
declare -A ENCODING_FIXES=(
    # 管理类
    ["鑰冨嫟绠＄悊"]="考勤管理"
    ["娑堣垂绠＄悊"]="消费管理"
    ["璁惧绠＄悊"]="设备管理"
    ["璺虫绠＄悊"]="监控管理"
    ["浜哄绠＄悊"]="人员管理"
    ["鍏荤绠＄悊"]="员工管理"
    ["缁组织绠＄悊"]="组织管理"

    # 基本词汇
    ["璁惧"]="设备"
    ["璺虫"]="监控"
    ["鍏荤"]="员工"
    ["浜哄"]="人脸"
    ["璇嗗埆"]="识别"
    ["褰曞儚"]="录像"
    ["娴佺"]="视频"
    ["鎺у埗"]="控制"
    ["浜嬩欢"]="事件"
    ["搴旂敤"]="应用"
    ["鏁版嵁"]="数据"
    ["鏌ヨ"]="查询"
    ["鏂囦欢"]="文件"
    ["璁板綍"]="记录"
    ["缁撴灉"]="结果"
    ["鎿嶄綔"]="操作"
    ["绠楁潵"]="统计"
    ["鏃堕棿"]="时间"
    ["绫诲瀷"]="类型"
    ["鐘舵€"]="状态"
    ["鍚敤"]="启用"
    ["绂荤嚎"]="离线"
    ["鍦ㄧ嚎"]="在线"
    ["鏄惁"]="是否"
    ["鏂板"]="新增"
    ["缂栬缓"]="编辑"
    ["鍒犻櫎"]="删除"
    ["鏌ュ"]="查看"
    ["鍒楄〃"]="列表"
    ["璇︾粏"]="详情"
    ["淇℃伩"]="信息"
    ["閰嶇疆"]="配置"
    ["鍙傛暟"]="参数"
    ["璇锋眰"]="请求"
    ["鍝嶅"]="响应"
    ["鏃ュ織"]="日志"
    ["寮傚父"]="异常"
    ["鎻愮"]="提示"
    ["纭"]="确认"
    ["鍙栚€"]="取消"
    ["淇濆瓨"]="保存"
    ["鎻愪氦"]="提交"
    ["瀹℃牳"]="审核"
    ["鍚戞"]="用户"
    ["瑙掕壊"]="角色"
    ["鏉冮檺"]="权限"
    ["鑱岂彧"]="员工"
    ["閮¨"]="部门"
    ["鍏徃"]="公司"
    ["浼佷笟"]="企业"
    ["閮ㄩ棬"]="部门"
    ["宸ヤ綔"]="工作"
    ["浠诲姟"]="任务"
    ["娴佭"]="流程"
    ["瀹℃壒"]="审批"
    ["鏂囦欢"]="文件"
    ["妗ｆ"]="档案"
    ["褰撳墠"]="当前"
    ["鍘嗗厛"]="以前"
    ["浠ュ悗"]="以后"
    ["绗竴"]="第一"
    ["绗簩"]="第二"
    ["鎵€鏈"]="所有"
    ["閮､"]="部分"
    ["澶氫釜"]="多个"
    ["鍗曚釜"]="单个"
    ["甯歌"]="正常"
    ["寮傚父"]="异常"
    ["閿欒"]="错误"
    ["棰勬"]="警告"
    ["淇℃"]="信息"
    ["鎴愬姛"]="成功"
    ["澶辫触"]="失败"
    ["瀹屾垚"]="完成"
    ["杩涜"]="进行"
    ["寮€濮"]="开始"
    ["缁撴"]="结束"
    ["缁х画"]="继续"
    ["鏆傚仠"]="暂停"
    ["鍋滄"]="停止"
    ["閲嶈浇"]="重启"
    ["鏇存柊"]="更新"
    ["鍒涘缓"]="创建"
    ["鐢熸垚"]="生成"
    ["鑾峰彇"]="获取"
    ["璁句疆"]="设置"
    ["淇敼"]="修改"
    ["绉婚櫎"]="移除"
    ["娓呴櫎"]="清除"
    ["閲嶈"]="重新"
    ["鍒锋柊"]="刷新"
    ["妫€鏌"]="检查"
    ["娴嬭瘯"]="测试"
    ["璋冭瘯"]="调试"
    ["杩愮"]="运行"
    ["鍚姩"]="启动"
    ["鍏抽棴"]="关闭"
    ["鎵撳紑"]="打开"
    ["鎻愪"]="发送"
    ["鎺ユ敹"]="接收"
    ["涓嬭澆"]="下载"
    ["涓婭澆"]="上传"
    ["瀵煎嚭"]="导出"
    ["瀵煎叆"]="导入"
    ["鎵撳嵃"]="打印"
    ["闂€"]="问题"
    ["绛旀"]="答案"
    ["璇存槑"]="说明"
    ["甯:"]="备注"
    ["绀轰"]="显示"
    ["闅愯"]="隐藏"
    ["鎼滅储"]="搜索"
    ["绛涢"]="筛选"
    ["鎺掑簭"]="排序"
    ["鍒嗙被"]="分类"
    ["鏍囩"]="标签"
    ["鍏冲璞"]="对象"
    ["瀹炰綋"]="实体"
    ["绫"]="类"
    ["鏂规"]="方法"
    ["灞炴"]="属性"
    ["鍙橀噺"]="变量"
    ["甯搁"]="常量"
    ["鍑芥"]="函数"
    ["鎺ュ彛"]="接口"
    ["瀹炵幇"]="实现"
    ["缙栬"]="继承"
    ["澶氭"]="多态"
    ["灏佽"]="封装"
    ["妯℃澘"]="模板"
    ["鏋:"]="架构"
    ["璁捐"]="设计"
    ["寮€鍙"]="开发"
    ["娴嬭瘯"]="测试"
    ["閮ㄧ疆"]="部署"
    ["杩愯"]="运行"
    ["缁存"]="维护"
    ["浼佷笟"]="优化"
    ["鎵╁"]="扩展"
    ["鍗囩骇"]="升级"
    ["杩"]="迁移"
    ["澶囦唤"]="备份"
    ["澶嶅綋"]="恢复"
    ["瀹夊"]="安装"
    ["鍗闄"]="卸载"
    ["鐗:"]="版本"
    ["鐗堟湰"]="版本"
    ["闆嗗悕"]="包名"
    ["绫:"]="类名"
    ["鏂规:"]="方法名"
    ["鍙橀噺"]="变量名"
    ["甯搁"]="常量名"
    ["鎺ュ彛"]="接口名"
    ["娉ㄥ:"]="注释"
    ["鏂囨。"]="文档"
    ["璇存槑"]="说明"
    ["甯﹀:"]="帮助"
    ["绀轰:"]="显示"
    ["瑙ｉ"]="解析"
    ["澶勭悊"]="处理"
    ["杞崲"]="转换"
    ["鏍煎"]="格式"
    ["缂栫"]="编码"
    ["瑙ｉ"]="解码"
    ["鍔犲瘑"]="加密"
    ["瑙ｉ瘑"]="解密"
    ["鏍:"]="签名"
    ["楠verage"]="验证"
    ["鏉冮檺"]="权限"
    ["瀹㈡"]="客户端"
    ["鏋舵"]="服务器"
    ["鏈嶅"]="服务端"
    ["鏋:"]="架构"
    ["缂撳瓨"]="缓存"
    ["闆嗘浉"]="缓存"
    ["浼']="内存"
    ["澶栭"]="外部"
    ["鍐呭"]="内部"
    ["瑙勫范"]="规范"
    ["鏍囧噯"]="标准"
    ["鍗忚"]="协议"
    ["鏍煎紡"]="格式"
    ["瑙勫:"]="规则"
    ["閫夐」"]="选项"
    ["璁:"]="设置"
    ["绂《敤"]="禁用"
    ["鍏:"]="开关"
    ["閫夋嫨"]="选择"
    ["閫夋复"]="选项"
    ["榛樿"]="默认"
    ["鑷畾涔"]="自定义"
    ["鎻掍欢"]="插件"
    ["缁勪欢"]="组件"
)

# 查找所有Java文件
find "smart-admin-api-java17-springboot3" -name "*.java" -type f | while read -r file; do
    if [ ! -f "$file" ]; then
        continue
    fi

    changed=false
    temp_file=$(mktemp)

    # 复制原文件到临时文件
    cp "$file" "$temp_file"

    # 应用所有修复
    for wrong in "${!ENCODING_FIXES[@]}"; do
        correct="${ENCODING_FIXES[$wrong]}"
        if grep -q "$wrong" "$temp_file"; then
            sed -i "s/$wrong/$correct/g" "$temp_file"
            echo "修复 $file: $wrong -> $correct"
            changed=true
        fi
    done

    # 如果有修改，则替换原文件
    if [ "$changed" = true ]; then
        mv "$temp_file" "$file"
        echo "✓ 已更新: $file"
    else
        rm "$temp_file"
    fi
done

echo "批量修复完成!"