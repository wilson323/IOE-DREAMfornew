#!/bin/bash

echo "开始修复Java文件编码错误..."

# 定义基本的编码修复
FIXES=(
    "s/鑰冨嫟绠＄悊/考勤管理/g"
    "s/娑堣垂绠＄悊/消费管理/g"
    "s/璁惧绠＄悊/设备管理/g"
    "s/璺虫绠＄悊/监控管理/g"
    "s/浜哄绠＄悊/人员管理/g"
    "s/鍏荤绠＄悊/员工管理/g"
    "s/璁惧/设备/g"
    "s/璺虫/监控/g"
    "s/鍏荤/员工/g"
    "s/浜哄/人脸/g"
    "s/璇嗗埆/识别/g"
    "s/褰曞儚/录像/g"
    "s/娴佺/视频/g"
    "s/鎺у埗/控制/g"
    "s/浜嬩欢/事件/g"
    "s/搴旂敤/应用/g"
    "s/鏁版嵁/数据/g"
    "s/鏌ヨ/查询/g"
    "s/鏂囦欢/文件/g"
    "s/璁板綍/记录/g"
    "s/缁撴灉/结果/g"
    "s/鎿嶄綔/操作/g"
    "s/绠楁潵/统计/g"
    "s/鏃堕棿/时间/g"
    "s/绫诲瀷/类型/g"
    "s/鐘舵€/状态/g"
    "s/鍚敤/启用/g"
    "s/绂荤嚎/离线/g"
    "s/鍦ㄧ嚎/在线/g"
    "s/鏄惁/是否/g"
    "s/鏂板/新增/g"
    "s/缂栬缓/编辑/g"
    "s/鍒犻櫎/删除/g"
    "s/鏌ュ/查看/g"
    "s/鍒楄〃/列表/g"
    "s/璇︾粏/详情/g"
    "s/淇℃伩/信息/g"
    "s/閰嶇疆/配置/g"
    "s/鍙傛暟/参数/g"
    "s/璇锋眰/请求/g"
    "s/鍝嶅/响应/g"
    "s/鏃ュ織/日志/g"
    "s/寮傚父/异常/g"
    "s/鎻愮/提示/g"
    "s/纭/确认/g"
    "s/鍙栚€/取消/g"
    "s/淇濆瓨/保存/g"
    "s/鎻愪氦/提交/g"
    "s/瀹℃牳/审核/g"
    "s/鍚戞/用户/g"
    "s/瑙掕壊/角色/g"
    "s/鏉冮檺/权限/g"
    "s/鑱岂彧/员工/g"
    "s/閮¨/部门/g"
    "s/鍏徃/公司/g"
    "s/浼佷笟/企业/g"
    "s/閮ㄩ棬/部门/g"
    "s/宸ヤ綔/工作/g"
    "s/浠诲姟/任务/g"
    "s/娴佭/流程/g"
    "s/瀹℃壒/审批/g"
    "s/鏂囦欢/文件/g"
    "s/妗ｆ/档案/g"
    "s/褰撳墠/当前/g"
    "s/鍘嗗厛/以前/g"
    "s/浠ュ悗/以后/g"
    "s/绗竴/第一/g"
    "s/绗簩/第二/g"
    "s/鎵€鏈/所有/g"
    "s/閮､/部分/g"
    "s/澶氫釜/多个/g"
    "s/鍗曚釜/单个/g"
    "s/甯歌/正常/g"
    "s/鎴愬姛/成功/g"
    "s/澶辫触/失败/g"
    "s/瀹屾垚/完成/g"
    "s/杩涜/进行/g"
    "s/寮€濮/开始/g"
    "s/缁撴/结束/g"
    "s/缁х画/继续/g"
    "s/鏆傚仠/暂停/g"
    "s/鍋滄/停止/g"
    "s/閲嶈浇/重启/g"
    "s/鏇存柊/更新/g"
    "s/鍒涘缓/创建/g"
    "s/鐢熸垚/生成/g"
    "s/鑾峰彇/获取/g"
    "s/璁句疆/设置/g"
    "s/淇敼/修改/g"
    "s/绉婚櫎/移除/g"
    "s/娓呴櫎/清除/g"
    "s/閲嶈/重新/g"
    "s/鍒锋柊/刷新/g"
    "s/妫€鏌/检查/g"
    "s/娴嬭瘯/测试/g"
    "s/璋冭瘯/调试/g"
    "s/杩愮/运行/g"
    "s/鍚姩/启动/g"
    "s/鍏抽棴/关闭/g"
    "s/鎵撳紑/打开/g"
    "s/鎻愪/发送/g"
    "s/鎺ユ敹/接收/g"
    "s/涓嬭澆/下载/g"
    "s/涓婭澆/上传/g"
    "s/瀵煎嚭/导出/g"
    "s/瀵煎叆/导入/g"
    "s/鎵撳嵃/打印/g"
    "s/闂€/问题/g"
    "s/绛旀/答案/g"
    "s/璇存槑/说明/g"
    "s/甯:/备注/g"
    "s/绀轰/显示/g"
    "s/闅愯/隐藏/g"
    "s/鎼滅储/搜索/g"
    "s/绛涢/筛选/g"
    "s/鎺掑簭/排序/g"
    "s/鍒嗙被/分类/g"
    "s/鏍囩/标签/g"
    "s/鍏冲璞/对象/g"
    "s/瀹炰綋/实体/g"
    "s/绫/类/g"
    "s/鏂规/方法/g"
    "s/灞炴/属性/g"
    "s/鍙橀噺/变量/g"
    "s/甯搁/常量/g"
    "s/鍑芥/函数/g"
    "s/鎺ュ彛/接口/g"
    "s/瀹炵幇/实现/g"
    "s/缙栬/继承/g"
    "s/澶氭/多态/g"
    "s/灏佽/封装/g"
    "s/妯℃澘/模板/g"
    "s/鏋:/架构/g"
    "s/璁捐/设计/g"
    "s/寮€鍙/开发/g"
    "s/娴嬭瘯/测试/g"
    "s/閮ㄧ疆/部署/g"
    "s/杩愯/运行/g"
    "s/缁存/维护/g"
    "s/鎵╁/扩展/g"
    "s/鍗囩骇/升级/g"
    "s/杩/迁移/g"
    "s/澶囦唤/备份/g"
    "s/澶嶅綋/恢复/g"
    "s/瀹夊/安装/g"
    "s/鍗闄/卸载/g"
    "s/鐗堟湰/版本/g"
    "s/闆嗗悕/包名/g"
    "s/绫:/类名/g"
    "s/鏂规:/方法名/g"
    "s/鍙橀噺/变量名/g"
    "s/甯搁/常量名/g"
    "s/鎺ュ彛/接口名/g"
    "s/娉ㄥ:/注释/g"
    "s/鏂囨。/文档/g"
    "s/甯﹀:/帮助/g"
    "s/绀轰:/显示/g"
    "s/瑙ｉ/解析/g"
    "s/澶勭悊/处理/g"
    "s/杞崲/转换/g"
    "s/鏍煎/格式/g"
    "s/缂栫/编码/g"
    "s/瑙ｉ/解码/g"
    "s/鍔犲瘑/加密/g"
    "s/瑙ｉ瘑/解密/g"
    "s/鏍:/签名/g"
    "s/鏉冮檺/权限/g"
    "s/瀹㈡/客户端/g"
    "s/鏋舵/服务器/g"
    "s/鏈嶅/服务端/g"
    "s/鏋:/架构/g"
    "s/缂撳瓨/缓存/g"
    "s/闆嗘浉/缓存/g"
    "s/浼/内存/g"
    "s/澶栭/外部/g"
    "s/鍐呭/内部/g"
    "s/瑙勫范/规范/g"
    "s/鏍囧噯/标准/g"
    "s/鍗忚/协议/g"
    "s/鏍煎紡/格式/g"
    "s/瑙勫:/规则/g"
    "s/閫夐」/选项/g"
    "s/璁:/设置/g"
    "s/绂《敤/禁用/g"
    "s/鍏:/开关/g"
    "s/閫夋嫨/选择/g"
    "s/閫夋复/选项/g"
    "s/榛樿/默认/g"
    "s/鑷畾涔/自定义/g"
    "s/鎻掍欢/插件/g"
    "s/缁勪欢/组件/g"
    "s/绉婚櫎/移除/g"
    "s/楠 verage/验证/g"
)

# 查找需要修复的Java文件
echo "查找包含编码错误的Java文件..."
find "smart-admin-api-java17-springboot3" -name "*.java" -exec grep -l "鑰\|娉\|涔\|绯\|鐢\|璁\|璺\|绠\|悦\|鏁\|閿\|鍏\|鎵\|鏈\|娴\|鍔\|渚\|娴\|鏋\|锛\|浠\|姝\|寮\|濮\|鐢\|鐨\|澶\|勭\|悊\|鍣\|鐘\|舵\|绫\|瀛\|楗\|鍒\|鍒\|涔\|娴\|瓒\|婃\|鏋\|浠\|姝\|椤\|椤" {} \; | while read file; do
    echo "正在修复文件: $file"

    # 创建临时文件
    temp_file=$(mktemp)
    cp "$file" "$temp_file"

    # 应用所有修复
    for fix in "${FIXES[@]}"; do
        sed -i "$fix" "$temp_file"
    done

    # 检查是否有变化
    if ! cmp -s "$file" "$temp_file"; then
        mv "$temp_file" "$file"
        echo "✓ 已修复: $file"
    else
        rm "$temp_file"
    fi
done

echo "编码修复完成!"