# ============================================================
# IOE-DREAM é€šç”¨Jasyptç”Ÿäº§ç¯å¢ƒé…ç½®
#
# @Author:    IOE-DREAM Team
# @Date:      2025-12-09
# @Description: ç»Ÿä¸€çš„JasyptåŠ å¯†é…ç½®ï¼Œä¾›æ‰€æœ‰å¾®æœåŠ¡ä½¿ç”¨
# ============================================================

# ============================================================
# Jasypt åŠ å¯†é…ç½®
# ============================================================
jasypt:
  encryptor:
    # ä»ç¯å¢ƒå˜é‡è¯»å–åŠ å¯†å¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒå¿…é¡»è®¾ç½®ï¼‰
    password: ${JASYPT_PASSWORD:default-password-change-in-production}

    # åŠ å¯†ç®—æ³• - ä½¿ç”¨AES-256 + SHA-512
    algorithm: PBEWITHHMACSHA512ANDAES_256

    # å¯†é’¥è·å–è¿­ä»£æ¬¡æ•°
    key-obtention-iterations: 1000

    # æ± å¤§å°
    pool-size: 1

    # æä¾›è€…åç§°
    provider-name: SunJCE

    # ç›ç”Ÿæˆå™¨ç±»å
    salt-generator-classname: org.jasypt.salt.RandomSaltGenerator

    # IVç”Ÿæˆå™¨ç±»å
    iv-generator-classname: org.jasypt.iv.RandomIvGenerator

    # å­—ç¬¦ä¸²è¾“å‡ºç±»å‹
    string-output-type: base64

    # å±æ€§å‰ç¼€å’Œåç¼€
    property:
      prefix: "ENC("
      suffix: ")"

# ============================================================
# é€šç”¨åŠ å¯†é…ç½®ç¤ºä¾‹
# æ‰€æœ‰å¾®æœåŠ¡éƒ½å¯ä»¥å¼•ç”¨è¿™äº›é…ç½®
# ============================================================

# æ•°æ®åº“é…ç½®
spring:
  datasource:
    # æ³¨æ„ï¼šè¿™é‡Œä½¿ç”¨ENC()æ ¼å¼ï¼Œå®é™…å€¼éœ€è¦é€šè¿‡JasyptåŠ å¯†å·¥å…·ç”Ÿæˆ
    # ä½¿ç”¨æ–¹æ³•ï¼šjava -cp jasypt-cli-3.0.5.jar org.jasypt.intf.cli.JasyptPBEStringEncryptionCLI input="åŸå§‹å¯†ç " password="åŠ å¯†å¯†é’¥" algorithm="PBEWITHHMACSHA512ANDAES_256"

    # æ•°æ®åº“è¿æ¥ç¤ºä¾‹
    url: jdbc:mysql://${DATABASE_HOST:localhost}:${DATABASE_PORT:3306}/${DATABASE_NAME:ioedream}?useSSL=true&useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Shanghai
    username: ${DATABASE_USERNAME:root}
    password: ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„æ•°æ®åº“å¯†ç )

    # Druidè¿æ¥æ± é…ç½®
    druid:
      password: ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„æ•°æ®åº“å¯†ç )
      stat-view-servlet:
        login-password: ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„Druidç›‘æ§å¯†ç )

# Redisé…ç½®
  redis:
    password: ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„Rediså¯†ç )

# é‚®ä»¶æœåŠ¡é…ç½®
  mail:
    username: ${SMTP_USERNAME:ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„é‚®ç®±ç”¨æˆ·å)}
    password: ${SMTP_PASSWORD:ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„é‚®ç®±å¯†ç )}

# çŸ­ä¿¡æœåŠ¡é…ç½®
  sms:
    access-key: ${SMS_ACCESS_KEY:ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„çŸ­ä¿¡APIå¯†é’¥)}
    secret-key: ${SMS_SECRET_KEY:ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„çŸ­ä¿¡APIå¯†é’¥)}

# MinIOå¯¹è±¡å­˜å‚¨é…ç½®
minio:
  access-key: ${MINIO_ACCESS_KEY:ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„MinIOè®¿é—®å¯†é’¥)}
  secret-key: ${MINIO_SECRET_KEY:ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„MinIOå¯†é’¥)}

# JWTé…ç½®
jwt:
  secret: ${JWT_SECRET:ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„JWTå¯†é’¥)}

# æ”¯ä»˜ç½‘å…³é…ç½®
payment:
  wechat:
    api-key: ${WECHAT_API_KEY:ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„å¾®ä¿¡æ”¯ä»˜APIå¯†é’¥)}
    mch-id: ${WECHAT_MCH_ID:ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„å¾®ä¿¡å•†æˆ·ID)}

  alipay:
    app-id: ${ALIPAY_APP_ID:ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„æ”¯ä»˜å®åº”ç”¨ID)}
    private-key: ${ALIPAY_PRIVATE_KEY:ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„æ”¯ä»˜å®ç§é’¥)}
    public-key: ${ALIPAY_PUBLIC_KEY:ENC(è¿™é‡Œæ”¾ç½®åŠ å¯†åçš„æ”¯ä»˜å®å…¬é’¥)}

# ============================================================
# ç¯å¢ƒç‰¹å®šé…ç½®
# ============================================================

# å¼€å‘ç¯å¢ƒï¼ˆä½¿ç”¨é»˜è®¤å¯†ç ï¼Œä»…ç”¨äºå¼€å‘æµ‹è¯•ï¼‰
---
spring:
  config:
    activate:
      profile: dev

jasypt:
  encryptor:
    password: dev-default-key-please-change

# æµ‹è¯•ç¯å¢ƒ
---
spring:
  config:
    activate:
      profile: test

jasypt:
  encryptor:
    password: test-default-key-please-change

# ç”Ÿäº§ç¯å¢ƒï¼ˆå¿…é¡»è®¾ç½®ç¯å¢ƒå˜é‡ï¼‰
---
spring:
  config:
    activate:
      profile: prod

jasypt:
  encryptor:
    password: ${JASYPT_PASSWORD}

# ============================================================
# åŠ å¯†å¯†é’¥ç®¡ç†è¯´æ˜
# ============================================================

# ğŸ” å¯†é’¥ç”Ÿæˆæ–¹æ³•ï¼š
# 1. ä½¿ç”¨æä¾›çš„è„šæœ¬ï¼š./setup-jasypt.ps1 (Windows) æˆ– ./jasypt-setup.sh (Linux)
# 2. ä½¿ç”¨OpenSSLï¼šopenssl rand -hex 32
# 3. ä½¿ç”¨åœ¨çº¿å·¥å…·ç”Ÿæˆ32å­—èŠ‚çš„éšæœºå­—ç¬¦ä¸²

# ğŸš¨ å®‰å…¨æ³¨æ„äº‹é¡¹ï¼š
# 1. ç”Ÿäº§ç¯å¢ƒå¿…é¡»é€šè¿‡ç¯å¢ƒå˜é‡ JASYPT_PASSWORD è®¾ç½®åŠ å¯†å¯†é’¥
# 2. ä¸è¦å°†åŠ å¯†å¯†é’¥æäº¤åˆ°ä»£ç ä»“åº“
# 3. å®šæœŸè½®æ¢åŠ å¯†å¯†é’¥
# 4. ä½¿ç”¨å¼ºå¯†é’¥ç­–ç•¥ï¼ˆè‡³å°‘32å­—èŠ‚ï¼ŒåŒ…å«å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ç‰¹æ®Šå­—ç¬¦ï¼‰

# ğŸ“‹ å¯†ç åŠ å¯†æµç¨‹ï¼š
# 1. ç¼–è¾‘ Batch-Encrypt.ps1 æˆ– batch-encrypt.sh æ·»åŠ éœ€è¦åŠ å¯†çš„æ˜æ–‡å¯†ç 
# 2. è¿è¡Œæ‰¹é‡åŠ å¯†è„šæœ¬è·å– ENC() æ ¼å¼çš„åŠ å¯†å€¼
# 3. å°† ENC(åŠ å¯†å€¼) æ›¿æ¢é…ç½®æ–‡ä»¶ä¸­çš„æ˜æ–‡å¯†ç 
# 4. è®¾ç½®ç¯å¢ƒå˜é‡ JASYPT_PASSWORD
# 5. å¯åŠ¨åº”ç”¨æµ‹è¯•é…ç½®

# ğŸ” å¯†ç è§£å¯†éªŒè¯ï¼š
# 1. ä½¿ç”¨æä¾›çš„è§£å¯†è„šæœ¬éªŒè¯åŠ å¯†æ˜¯å¦æ­£ç¡®
# 2. è§£å¯†è„šæœ¬ï¼š.\Decrypt-Password.ps1 "ENC(åŠ å¯†å€¼)"
# 3. ç¡®ä¿è§£å¯†ç»“æœä¸åŸå§‹å¯†ç ä¸€è‡´

# ============================================================
# å¸¸è§åŠ å¯†åœºæ™¯ç¤ºä¾‹
# ============================================================

# æ•°æ®åº“å¯†ç ç¤ºä¾‹
database:
  # åŸå§‹: mypassword123
  # åŠ å¯†: ENC(G6K7X8J9M0N1O2P3Q4R5S6T7U8V9W0X)
  password: ENC(G6K7X8J9M0N1O2P3Q4R5S6T7U8V9W0X)

# Rediså¯†ç ç¤ºä¾‹
redis:
  # åŸå§‹: redis123
  # åŠ å¯†: ENC(H7K8L9M0N1O2P3Q4R5S6T7U8V9W0X1Y)
  password: ENC(H7K8L9M0N1O2P3Q4R5S6T7U8V9W0X1Y)

# JWTå¯†é’¥ç¤ºä¾‹
jwt:
  # åŸå§‹: my-jwt-secret-key-2023
  # åŠ å¯†: ENC(I8L9M0N1O2P3Q4R5S6T7U8V9W0X1Y2Z)
  secret: ENC(I8L9M0N1O2P3Q4R5S6T7U8V9W0X1Y2Z)