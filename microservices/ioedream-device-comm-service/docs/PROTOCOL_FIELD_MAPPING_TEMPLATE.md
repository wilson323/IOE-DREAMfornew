# 协议字段映射模板

## 📋 使用说明

本文档用于记录从PDF协议文档中提取的字段定义信息。请根据实际PDF文档填写以下模板，然后根据填写的内容更新代码。

---

## 🔐 门禁协议（AccessProtocolHandler）

### 协议基本信息
- **文档**: 安防PUSH通讯协议 （熵基科技）V4.8-20240107
- **协议头**: `[待填写]` (例如：`0xAA 0x55`)
- **协议头长度**: `[待填写]` 字节
- **最小消息长度**: `[待填写]` 字节
- **字节序**: `[待填写]` (Little-Endian / Big-Endian)
- **校验和算法**: `[待填写]` (累加和 / CRC16 / 异或 / 其他)
- **校验和位置**: `[待填写]` (消息末尾 / 消息头 / 特定位置)
- **校验和长度**: `[待填写]` 字节

### 消息类型定义

| 消息类型码 | 消息类型名称 | 说明 |
|-----------|-------------|------|
| `[待填写]` | ACCESS_RECORD | 门禁事件消息 |
| `[待填写]` | DEVICE_STATUS | 设备状态消息 |
| `[待填写]` | ALARM_EVENT | 报警事件消息 |

### 门禁事件消息（ACCESS_RECORD）字段定义

| 字段名称 | 字节偏移 | 字节长度 | 数据类型 | 说明 | 取值范围 |
|---------|---------|---------|---------|------|---------|
| 协议头 | 0 | `[待填写]` | byte[] | 协议头标识 | `[待填写]` |
| 消息类型 | `[待填写]` | `[待填写]` | byte | 消息类型码 | `[待填写]` |
| 设备编号 | `[待填写]` | `[待填写]` | string | 设备编号 | `[待填写]` |
| 用户ID | `[待填写]` | `[待填写]` | int/uint | 用户ID | `[待填写]` |
| 通行时间 | `[待填写]` | `[待填写]` | int/uint | Unix时间戳 | `[待填写]` |
| 通行类型 | `[待填写]` | `[待填写]` | byte | 0-进入，1-离开 | 0-1 |
| 门号 | `[待填写]` | `[待填写]` | byte | 门号 | `[待填写]` |
| 通行方式 | `[待填写]` | `[待填写]` | byte | 0-卡片，1-人脸，2-指纹 | `[待填写]` |
| 通行结果 | `[待填写]` | `[待填写]` | byte | 0-失败，1-成功 | 0-1 |
| 温度 | `[待填写]` | `[待填写]` | byte/short | 温度值（可选） | `[待填写]` |
| 照片URL | `[待填写]` | `[待填写]` | string | 照片URL（可选） | `[待填写]` |
| 校验和 | `[待填写]` | `[待填写]` | int/short | 校验和 | `[待填写]` |

### 设备状态消息（DEVICE_STATUS）字段定义

| 字段名称 | 字节偏移 | 字节长度 | 数据类型 | 说明 | 取值范围 |
|---------|---------|---------|---------|------|---------|
| 协议头 | 0 | `[待填写]` | byte[] | 协议头标识 | `[待填写]` |
| 消息类型 | `[待填写]` | `[待填写]` | byte | 消息类型码 | `[待填写]` |
| 设备编号 | `[待填写]` | `[待填写]` | string | 设备编号 | `[待填写]` |
| 设备状态 | `[待填写]` | `[待填写]` | byte | 0-离线，1-在线 | 0-1 |
| 最后在线时间 | `[待填写]` | `[待填写]` | int/uint | Unix时间戳 | `[待填写]` |
| 校验和 | `[待填写]` | `[待填写]` | int/short | 校验和 | `[待填写]` |

### 报警事件消息（ALARM_EVENT）字段定义

| 字段名称 | 字节偏移 | 字节长度 | 数据类型 | 说明 | 取值范围 |
|---------|---------|---------|---------|------|---------|
| 协议头 | 0 | `[待填写]` | byte[] | 协议头标识 | `[待填写]` |
| 消息类型 | `[待填写]` | `[待填写]` | byte | 消息类型码 | `[待填写]` |
| 设备编号 | `[待填写]` | `[待填写]` | string | 设备编号 | `[待填写]` |
| 报警类型 | `[待填写]` | `[待填写]` | byte | 报警类型码 | `[待填写]` |
| 报警时间 | `[待填写]` | `[待填写]` | int/uint | Unix时间戳 | `[待填写]` |
| 报警级别 | `[待填写]` | `[待填写]` | byte | 报警级别 | `[待填写]` |
| 报警描述 | `[待填写]` | `[待填写]` | string | 报警描述（可选） | `[待填写]` |
| 校验和 | `[待填写]` | `[待填写]` | int/short | 校验和 | `[待填写]` |

### 校验和算法说明

**算法类型**: `[待填写]` (累加和 / CRC16 / 异或 / 其他)

**计算范围**: `[待填写]`
- 起始位置: `[待填写]` (例如：协议头后)
- 结束位置: `[待填写]` (例如：校验和前)

**计算方式**: `[待填写]`
```
[详细描述校验和的计算步骤]
```

**示例**:
```
[提供校验和计算的示例]
```

---

## ⏰ 考勤协议（AttendanceProtocolHandler）

### 协议基本信息
- **文档**: 考勤PUSH通讯协议 （熵基科技） V4.0-20210113
- **协议头**: `[待填写]`
- **协议头长度**: `[待填写]` 字节
- **最小消息长度**: `[待填写]` 字节
- **字节序**: `[待填写]` (Little-Endian / Big-Endian)
- **校验和算法**: `[待填写]`
- **校验和位置**: `[待填写]`
- **校验和长度**: `[待填写]` 字节

### 消息类型定义

| 消息类型码 | 消息类型名称 | 说明 |
|-----------|-------------|------|
| `[待填写]` | ATTENDANCE_RECORD | 考勤记录消息 |
| `[待填写]` | DEVICE_STATUS | 设备状态消息 |

### 考勤记录消息（ATTENDANCE_RECORD）字段定义

| 字段名称 | 字节偏移 | 字节长度 | 数据类型 | 说明 | 取值范围 |
|---------|---------|---------|---------|------|---------|
| 协议头 | 0 | `[待填写]` | byte[] | 协议头标识 | `[待填写]` |
| 消息类型 | `[待填写]` | `[待填写]` | byte | 消息类型码 | `[待填写]` |
| 设备编号 | `[待填写]` | `[待填写]` | string | 设备编号 | `[待填写]` |
| 用户ID | `[待填写]` | `[待填写]` | int/uint | 用户ID | `[待填写]` |
| 打卡时间 | `[待填写]` | `[待填写]` | int/uint | Unix时间戳 | `[待填写]` |
| 打卡类型 | `[待填写]` | `[待填写]` | byte | 0-上班，1-下班 | `[待填写]` |
| 打卡方式 | `[待填写]` | `[待填写]` | byte | 0-卡片，1-人脸，2-指纹 | `[待填写]` |
| 考勤状态 | `[待填写]` | `[待填写]` | byte | 考勤状态 | `[待填写]` |
| 温度 | `[待填写]` | `[待填写]` | byte/short | 温度值（可选） | `[待填写]` |
| 位置信息 | `[待填写]` | `[待填写]` | string | 位置描述（可选） | `[待填写]` |
| 经纬度 | `[待填写]` | `[待填写]` | double/float | 经纬度（可选） | `[待填写]` |
| 照片URL | `[待填写]` | `[待填写]` | string | 照片URL（可选） | `[待填写]` |
| 校验和 | `[待填写]` | `[待填写]` | int/short | 校验和 | `[待填写]` |

### 校验和算法说明

**算法类型**: `[待填写]`

**计算范围**: `[待填写]`

**计算方式**: `[待填写]`

---

## 💳 消费协议（ConsumeProtocolHandler）

### 协议基本信息
- **文档**: 消费PUSH通讯协议 （中控智慧） V1.0-20181225
- **协议头**: `[待填写]`
- **协议头长度**: `[待填写]` 字节
- **最小消息长度**: `[待填写]` 字节
- **字节序**: `[待填写]` (Little-Endian / Big-Endian)
- **校验和算法**: `[待填写]`
- **校验和位置**: `[待填写]`
- **校验和长度**: `[待填写]` 字节

### 消息类型定义

| 消息类型码 | 消息类型名称 | 说明 |
|-----------|-------------|------|
| `[待填写]` | CONSUME_RECORD | 消费记录消息 |
| `[待填写]` | BALANCE_QUERY | 余额查询消息 |
| `[待填写]` | DEVICE_STATUS | 设备状态消息 |

### 消费记录消息（CONSUME_RECORD）字段定义

| 字段名称 | 字节偏移 | 字节长度 | 数据类型 | 说明 | 取值范围 |
|---------|---------|---------|---------|------|---------|
| 协议头 | 0 | `[待填写]` | byte[] | 协议头标识 | `[待填写]` |
| 消息类型 | `[待填写]` | `[待填写]` | byte | 消息类型码 | `[待填写]` |
| 设备编号 | `[待填写]` | `[待填写]` | string | 设备编号 | `[待填写]` |
| 用户ID | `[待填写]` | `[待填写]` | int/uint | 用户ID | `[待填写]` |
| 消费金额 | `[待填写]` | `[待填写]` | int/uint | 金额（单位：分/元） | `[待填写]` |
| 消费时间 | `[待填写]` | `[待填写]` | int/uint | Unix时间戳 | `[待填写]` |
| 消费类型 | `[待填写]` | `[待填写]` | byte | 0-刷卡，1-刷脸，2-NFC | `[待填写]` |
| 消费结果 | `[待填写]` | `[待填写]` | byte | 0-失败，1-成功 | 0-1 |
| 余额 | `[待填写]` | `[待填写]` | int/uint | 消费后余额（可选） | `[待填写]` |
| 交易流水号 | `[待填写]` | `[待填写]` | string/int | 交易流水号（可选） | `[待填写]` |
| 校验和 | `[待填写]` | `[待填写]` | int/short | 校验和 | `[待填写]` |

### 余额查询消息（BALANCE_QUERY）字段定义

| 字段名称 | 字节偏移 | 字节长度 | 数据类型 | 说明 | 取值范围 |
|---------|---------|---------|---------|------|---------|
| 协议头 | 0 | `[待填写]` | byte[] | 协议头标识 | `[待填写]` |
| 消息类型 | `[待填写]` | `[待填写]` | byte | 消息类型码 | `[待填写]` |
| 设备编号 | `[待填写]` | `[待填写]` | string | 设备编号 | `[待填写]` |
| 用户ID | `[待填写]` | `[待填写]` | int/uint | 用户ID | `[待填写]` |
| 查询时间 | `[待填写]` | `[待填写]` | int/uint | Unix时间戳 | `[待填写]` |
| 校验和 | `[待填写]` | `[待填写]` | int/short | 校验和 | `[待填写]` |

### 校验和算法说明

**算法类型**: `[待填写]`

**计算范围**: `[待填写]`

**计算方式**: `[待填写]`

---

## 📝 填写说明

1. **打开PDF文档**，找到对应的章节
2. **逐字段填写**表格中的信息
3. **特别注意**：
   - 字节偏移从0开始计算
   - 字节长度要准确
   - 数据类型要明确（有符号/无符号、整数/浮点数）
   - 字符串编码要明确（ASCII/UTF-8等）
4. **填写完成后**，根据此文档更新代码实现

---

**文档维护**: IOE-DREAM Team  
**最后更新**: 2025-01-30

