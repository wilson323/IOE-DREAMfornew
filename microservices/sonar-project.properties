# SonarQube 项目配置文件
# 用于代码质量分析和持续集成监控

# ===================================================================
# 项目基本信息配置
# ===================================================================

# 项目唯一标识符 (必须唯一)
sonar.projectKey=ioedream-microservices

# 项目名称 (显示在SonarQube UI中)
sonar.projectName=IOE-DREAM 智慧园区一卡通管理平台

# 项目版本号
sonar.projectVersion=1.0.0

# 项目描述
sonar.projectDescription=企业级智慧安防管理平台，集成多模态生物识别、一卡通管理、智能门禁等核心功能。基于Spring Boot 3.5.8 + Spring Cloud 2025.0.0的微服务架构。

# ===================================================================
# 源代码配置
# ===================================================================

# 源代码编码格式
sonar.sourceEncoding=UTF-8

# 源代码目录 (相对路径)
sonar.sources=src/main/java

# 测试源代码目录
sonar.tests=src/test/java

# 资源文件目录
sonar.resources=src/main/resources

# 测试资源文件目录
sonar.testResources=src/test/resources

# Java版本
sonar.java.source=17

# ===================================================================
# 代码包含和排除配置
# ===================================================================

# 包含的文件模式
sonar.inclusions=**/*.java

# 排除的文件和目录
sonar.exclusions=\
  **/target/**,\
  **/node_modules/**,\
  **/dist/**,\
  **/build/**,\
  **/out/**,\
  **/.idea/**,\
  **/.vscode/**,\
  **/.git/**,\
  **/*.log,\
  **/*.tmp,\
  **/logs/**,\
  **/temp/**,\
  **/test-output/**,\
  **/generated-sources/**,\
  **/generated-test-sources/**,\
  **/generated/**,\
  **/src/main/generated/**,\
  **/src/test/generated/**,\
  **/src-gen/**,\
  **/gen/**,\
  **/docs/**,\
  **/documentation/**

# 排除的测试文件模式
sonar.test.exclusions=\
  **/target/**,\
  **/build/**,\
  **/out/**,\
  **/logs/**,\
  **/temp/**,\
  **/test-output/**,\
  **/*Test.java,\
  **/*Tests.java,\
  **/integration/**/*Test*.java,\
  **/performance/**/*Test*.java

# ===================================================================
# 代码质量分析配置
# ===================================================================

# 代码覆盖率阈值
sonar.coverage.exclusions=**/*Test*.java,**/test/**,**/integration/**,**/performance/**
sonar.unitTest.inclusions=**/*Test.java
sonar.integrationTest.inclusions=**/integration/**/*Test.java

# JaCoCo 二进制文件路径
sonar.jacoco.reportPaths=target/jacoco.exec,target/site/jacoco/jacoco.xml

# 测试报告路径
sonar.junit.reportPaths=target/surefire-reports,target/failsafe-reports

# Java 代码分析配置
sonar.java.binaries=target/classes

# 编码标准检查
sonar.java.pmd.reportPaths=target/pmd.xml
sonar.java.spotbugs.reportPaths=target/spotbugsXml.xml

# ===================================================================
# 质量门禁配置
# ===================================================================

# 覆盖率质量门禁
sonar.qualitygate.wait=true

# 质量阈值
sonar.coverageThreshold=80
sonar.lineCoverageThreshold=75
sonar.branchCoverageThreshold=70

# 可维护性评级阈值
sonar.maintainabilityRating=A
sonar.reliabilityRating=A
sonar.securityRating=A

# ===================================================================
# 自定义规则配置
# ===================================================================

# 重复代码配置
sonar.cpd.exclusions=**/*Test*.java,**/test/**,**/integration/**,**/performance/**
sonar.cpd.minimumTokens=30
sonar.cpd.ignoreLiterals=false

# 复杂度配置
sonar.java.metrics.complexityMethodThreshold=20
sonar.java.metrics.complexityClassThreshold=200

# 代码行数配置
sonar.java.metrics.squidComplexityThreshold=100
sonar.java.metrics.nclocDataFunctionThreshold=50

# ===================================================================
# 安全分析配置
# ===================================================================

# 安全漏洞分析
sonar.java.security.hotspots.enabled=true

# 安全规则配置
sonar.java.security.jirahub.enabled=false
sonar.java.security.jirahub.url=
sonar.java.security.jirahub.project=

# 依赖项安全分析
sonar.dependencyCheck.enabled=true
sonar.dependencyCheck.htmlReportPath=target/dependency-check-report.html
sonar.dependencyCheck.jsonReportPath=target/dependency-check-report.json
sonar.dependencyCheck.skipProvidedScope=true
sonar.dependencyCheck.skipRuntimeScope=false
sonar.dependencyCheck.skipTestScope=true
sonar.dependencyCheck.failBuildOnCVSS=7

# ===================================================================
# IOE-DREAM 项目特定配置
# ===================================================================

# 业务逻辑复杂度阈值 (针对IOE-DREAM业务特点)
sonar.java.metrics.complexityBusinessMethodThreshold=15

# 数据访问层复杂度阈值
sonar.java.metrics.complexityDaoMethodThreshold=10

# 控制器方法复杂度阈值
sonar.java.metrics.complexityControllerMethodThreshold=12

# 管理器类复杂度阈值
sonar.java.metrics.complexityManagerMethodThreshold=18

# 禁用的规则 (针对IOE-DREAM架构特点)
sonar.issue.ignore.multicriteria=e1,e2,e3

# 技术债务配置
sonar.technicalDebt.hoursInDay=8

# 新代码分析 (最近30天的代码)
sonar.newCodePeriod=30d

# ===================================================================
# 外部工具集成
# ===================================================================

# Checkstyle 配置
sonar.java.checkstyle.reportPaths=target/checkstyle-result.xml

# FindBugs/SpotBugs 配置
sonar.java.spotbugs.reportPaths=target/spotbugsXml.xml

# PMD 配置
sonar.java.pmd.reportPaths=target/pmd.xml

# Checkmarx SAST 配置 (如果使用)
sonar.checkmarx.enabled=false
sonar.checkmarx.url=
sonar.checkmarx.projectName=
sonar.checkmarx.token=

# Veracode 配置 (如果使用)
sonar.veracode.enabled=false
sonar.veracode.apiId=
sonar.veracode.apiKey=

# ===================================================================
# 分析器配置
# ===================================================================

# 启用/禁用特定分析器
sonar.java.binaries=target/classes

# 自定义分析器参数
sonar.java.source=17
sonar.java.target=17

# 字节码分析
sonar.java.bytecode.reportPaths=target/classes

# ===================================================================
# 报告配置
# ===================================================================

# 生成HTML报告
sonar.issuesReport.html.enable=true

# 生成PDF报告
sonar.pdf.enable=true

# 报告输出目录
sonar.report.export.path=target/sonar-reports

# ===================================================================
# CI/CD 集成配置
# ===================================================================

# 分析超时时间 (分钟)
sonar.ws.timeout=300

# 并行分析
sonar.analysis.mode=publish

# 跳过依赖分析 (提高分析速度)
sonar.scanner.skipPackageDesign=true

# 仅分析变更的代码 (Git集成时使用)
# sonar.scm.revision=${env.GIT_COMMIT}
# sonar.scm.branch=${env.GIT_BRANCH}

# ===================================================================
# 微服务架构特定配置
# ===================================================================

# 多模块项目配置
sonar.moduleKey=${project.groupId}:${project.artifactId}

# 服务发现和分析
sonar.microservice.enabled=true

# API 分析
sonar.openapi.analyze=true

# 数据库访问分析
sonar.jdbc.include=true