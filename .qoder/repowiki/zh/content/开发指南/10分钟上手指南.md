# 10分钟上手指南

<cite>
**本文档引用的文件**  
- [README.md](file://README.md)
- [docker-compose-services.yml](file://docker-compose-services.yml)
- [start-all-services.ps1](file://scripts/start-all-services.ps1)
- [build-all.ps1](file://scripts/build-all.ps1)
- [test-startup.ps1](file://scripts/test-startup.ps1)
- [smart-admin-web-javascript/package.json](file://smart-admin-web-javascript/package.json)
- [smart-admin-web-javascript/.env.development](file://smart-admin-web-javascript/.env.development)
- [smart-admin-web-javascript/vite.config.js](file://smart-admin-web-javascript/vite.config.js)
- [microservices/ioedream-gateway-service/pom.xml](file://microservices/ioedream-gateway-service/pom.xml)
- [microservices/ioedream-common-service/pom.xml](file://microservices/ioedream-common-service/pom.xml)
- [database-scripts/common-service/00-database-init.sql](file://database-scripts/common-service/00-database-init.sql)
- [database-scripts/common-service/02-t_user.sql](file://database-scripts/common-service/02-t_user.sql)
</cite>

## 目录
1. [简介](#简介)
2. [环境准备](#环境准备)
3. [启动基础服务](#启动基础服务)
4. [编译并启动核心微服务](#编译并启动核心微服务)
5. [启动前端项目](#启动前端项目)
6. [登录并体验核心功能](#登录并体验核心功能)
7. [常见问题排查](#常见问题排查)

## 简介
本指南旨在帮助新开发者在10分钟内快速搭建并运行IOE-DREAM智能建筑微服务项目。您将学习如何克隆代码仓库、启动Nacos、MySQL等基础服务、编译并启动gateway-service和common-service等核心微服务，以及如何安装和启动前端项目。最后，您将使用默认账号登录系统，快速体验门禁、考勤、消费等核心模块的基本操作。

**本文档引用的文件**  
- [README.md](file://README.md)

## 环境准备
在开始之前，请确保您的开发环境已安装以下软件：
- Git
- JDK 1.8 或 17
- Maven 3.6+
- Node.js 18+
- Docker
- MySQL 5.7+
- PowerShell 或 CMD（Windows）/ Terminal（Mac/Linux）

### 克隆代码仓库
打开终端，执行以下命令克隆项目代码：
```bash
git clone https://github.com/your-repo/IOE-DREAM.git
cd IOE-DREAM
```

**本文档引用的文件**  
- [README.md](file://README.md)

## 启动基础服务
本项目依赖Nacos作为服务注册与配置中心，Redis作为缓存，MySQL作为数据库。我们提供了`docker-compose`配置文件来一键启动这些服务。

### 启动Nacos、Redis和MySQL
在项目根目录下，执行以下命令：
```bash
docker-compose -f docker-compose-services.yml up -d
```
该命令将启动以下服务：
- **Nacos**: 服务注册与配置中心，端口 `8848`
- **Redis**: 缓存服务，端口 `6379`
- **MySQL**: 数据库服务，端口 `3306`（需您本地已安装MySQL并配置好）

启动完成后，您可以通过 `http://localhost:8848/nacos` 访问Nacos控制台，默认账号密码为 `nacos/nacos`。

**本文档引用的文件**  
- [docker-compose-services.yml](file://docker-compose-services.yml)

## 编译并启动核心微服务
项目采用Maven进行依赖管理和构建。我们提供了统一的构建脚本。

### 编译所有微服务
在项目根目录下，执行以下命令编译所有微服务：
```bash
.\scripts\build-all.ps1
```
该脚本会先构建`microservices-common`公共模块，再构建所有其他微服务，确保依赖关系正确。

### 启动核心微服务
编译成功后，执行以下命令启动所有微服务：
```bash
.\scripts\start-all-services.ps1
```
该脚本会按照依赖顺序分批启动服务：
1.  **第一批次**: `ioedream-config-service` (端口8888)
2.  **第二批次**: `ioedream-gateway-service` (端口8080)
3.  **第三批次**: `ioedream-common-service` (端口8088) 和 `ioedream-device-comm-service` (端口8087)
4.  **后续批次**: 其他业务服务（如门禁、考勤、消费等）

服务启动后，您可以通过 `.\scripts\start-all-services.ps1 -CheckOnly` 命令检查服务状态。

**本文档引用的文件**  
- [build-all.ps1](file://scripts/build-all.ps1)
- [start-all-services.ps1](file://scripts/start-all-services.ps1)
- [microservices/ioedream-gateway-service/pom.xml](file://microservices/ioedream-gateway-service/pom.xml)
- [microservices/ioedream-common-service/pom.xml](file://microservices/ioedream-common-service/pom.xml)

## 启动前端项目
前端项目位于 `smart-admin-web-javascript` 目录，基于Vue3和Vite构建。

### 安装依赖并启动
```bash
cd smart-admin-web-javascript
npm install
npm run dev
```
前端开发服务器默认在 `http://localhost:8081` 启动。

### 配置API代理
前端通过Vite的代理功能将API请求转发到后端网关。相关配置在 `vite.config.js` 中：
```javascript
server: {
  proxy: {
    '/': {
      target: 'http://127.0.0.1:1024/', // 后端网关地址
      changeOrigin: true,
    },
  }
}
```
`.env.development` 文件中定义了开发环境的API地址：
```
VITE_APP_API_URL='http://127.0.0.1:1024'
```

**本文档引用的文件**  
- [smart-admin-web-javascript/package.json](file://smart-admin-web-javascript/package.json)
- [smart-admin-web-javascript/vite.config.js](file://smart-admin-web-javascript/vite.config.js)
- [smart-admin-web-javascript/.env.development](file://smart-admin-web-javascript/.env.development)

## 登录并体验核心功能
### 初始化数据库
首次运行需要初始化数据库。请在您的MySQL中执行 `database-scripts/common-service/` 目录下的SQL脚本，按顺序从 `00-database-init.sql` 开始。

### 使用默认账号登录
1.  打开浏览器，访问 `http://localhost:8081`。
2.  在登录页面输入默认账号：
    - **用户名**: `admin`
    - **密码**: `123456`
3.  登录成功后，您将进入系统主界面。

### 体验核心模块
登录后，您可以快速体验以下核心功能：
- **门禁系统**: 在左侧菜单中找到“门禁管理”，可查看门禁设备、通行记录等。
- **考勤系统**: 访问“考勤管理”模块，查看员工考勤规则、打卡记录和考勤报表。
- **消费系统**: 进入“消费管理”，体验账户充值、消费记录查询等功能。

**本文档引用的文件**  
- [database-scripts/common-service/00-database-init.sql](file://database-scripts/common-service/00-database-init.sql)
- [database-scripts/common-service/02-t_user.sql](file://database-scripts/common-service/02-t_user.sql)

## 常见问题排查
如果在启动过程中遇到问题，请按以下步骤排查：

### 1. 检查基础服务
运行测试脚本，检查所有依赖服务是否正常：
```bash
.\scripts\test-startup.ps1
```
该脚本会检查Maven、服务目录、Nacos、MySQL和Redis的状态。

### 2. 检查端口占用
确保关键端口未被占用：
- Nacos: `8848`
- Gateway: `8080`
- Common Service: `8088`
- Frontend: `8081`

### 3. 清理并重新构建
如果编译失败，尝试清理Maven缓存并重新构建：
```bash
mvn clean install -f microservices/microservices-common/pom.xml
.\scripts\build-all.ps1 -Clean
```

**本文档引用的文件**  
- [scripts/test-startup.ps1](file://scripts/test-startup.ps1)